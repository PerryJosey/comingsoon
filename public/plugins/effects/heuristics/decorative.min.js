!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.THREE=e.THREE||{})}(this,function(e){function G(){}function n(e,t){this.x=e||0,this.y=t||0}function c(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function y(e,t,n,s){this._x=e||0,this._y=t||0,this._z=n||0,this._w=void 0!==s?s:1}function t(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0}function A(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function b(e,t,s,o,i,a,r,c,l,u){Object.defineProperty(this,"id",{value:ro++}),this.uuid=d.generateUUID(),this.name="",this.image=void 0!==e?e:b.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:b.DEFAULT_MAPPING,this.wrapS=void 0!==s?s:1001,this.wrapT=void 0!==o?o:1001,this.magFilter=void 0!==i?i:1006,this.minFilter=void 0!==a?a:1008,this.anisotropy=void 0!==l?l:1,this.format=void 0!==r?r:1023,this.type=void 0!==c?c:1009,this.offset=new n(0,0),this.repeat=new n(1,1),this.center=new n(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new A,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==u?u:3e3,this.version=0,this.onUpdate=null}function g(e,t,n,s){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==s?s:1}function _t(e,t,n){this.uuid=d.generateUUID(),this.width=e,this.height=t,this.scissor=new g(0,0,e,t),this.scissorTest=!1,this.viewport=new g(0,0,e,t),void 0===(n=n||{}).minFilter&&(n.minFilter=1006),this.texture=new b(void 0,void 0,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function yt(e,t,n){_t.call(this,e,t,n),this.activeMipMapLevel=this.activeCubeFace=0}function De(e,t,n,s,o,i,a,r,c,l,d,u){b.call(this,null,i,a,r,c,l,s,o,d,u),this.image={data:e,width:t,height:n},this.magFilter=void 0!==c?c:1003,this.minFilter=void 0!==l?l:1003,this.flipY=this.generateMipmaps=!1,this.unpackAlignment=1}function ae(e,t,n,s,o,i,a,r,c,l){e=void 0!==e?e:[],b.call(this,e,void 0!==t?t:301,n,s,o,i,a,r,c,l),this.flipY=!1}function jt(e,t,n){if(s=e[0],0>=s||0<s)return e;var s,o=t*n,i=no[o];if(void 0===i&&(i=new Float32Array(o),no[o]=i),0!==t)for(s.toArray(i,0),s=1,o=0;s!==t;++s)o+=n,e[s].toArray(i,o);return i}function Hs(e,t){var s,n=to[t];void 0===n&&(n=new Int32Array(t),to[t]=n);for(s=0;s!==t;++s)n[s]=e.allocTextureUnit();return n}function Zo(e,t){e.uniform1f(this.addr,t)}function Qo(e,t){e.uniform1i(this.addr,t)}function Xo(e,t){void 0===t.x?e.uniform2fv(this.addr,t):e.uniform2f(this.addr,t.x,t.y)}function qo(e,t){void 0!==t.x?e.uniform3f(this.addr,t.x,t.y,t.z):void 0!==t.r?e.uniform3f(this.addr,t.r,t.g,t.b):e.uniform3fv(this.addr,t)}function Ko(e,t){void 0===t.x?e.uniform4fv(this.addr,t):e.uniform4f(this.addr,t.x,t.y,t.z,t.w)}function go(e,t){e.uniformMatrix2fv(this.addr,!1,t.elements||t)}function Ho(e,t){void 0===t.elements?e.uniformMatrix3fv(this.addr,!1,t):(eo.set(t.elements),e.uniformMatrix3fv(this.addr,!1,eo))}function Po(e,t){void 0===t.elements?e.uniformMatrix4fv(this.addr,!1,t):(Os.set(t.elements),e.uniformMatrix4fv(this.addr,!1,Os))}function Ro(e,t,n){var s=n.allocTextureUnit();e.uniform1i(this.addr,s),n.setTexture2D(t||oo,s)}function ko(e,t,n){var s=n.allocTextureUnit();e.uniform1i(this.addr,s),n.setTextureCube(t||so,s)}function xs(e,t){e.uniform2iv(this.addr,t)}function fo(e,t){e.uniform3iv(this.addr,t)}function po(e,t){e.uniform4iv(this.addr,t)}function Do(e,t){e.uniform1fv(this.addr,t)}function jo(e,t){e.uniform1iv(this.addr,t)}function Co(e,t){e.uniform2fv(this.addr,jt(t,this.size,2))}function Ao(e,t){e.uniform3fv(this.addr,jt(t,this.size,3))}function Mo(e,t){e.uniform4fv(this.addr,jt(t,this.size,4))}function Fo(e,t){e.uniformMatrix2fv(this.addr,!1,jt(t,this.size,4))}function To(e,t){e.uniformMatrix3fv(this.addr,!1,jt(t,this.size,9))}function Io(e,t){e.uniformMatrix4fv(this.addr,!1,jt(t,this.size,16))}function Lo(e,t,n){var s=t.length,o=Hs(n,s);for(e.uniform1iv(this.addr,o),e=0;e!==s;++e)n.setTexture2D(t[e]||oo,o[e])}function Uo(e,t,n){var s=t.length,o=Hs(n,s);for(e.uniform1iv(this.addr,o),e=0;e!==s;++e)n.setTextureCube(t[e]||so,o[e])}function ni(e,t,n){this.id=e,this.addr=n,this.setValue=function(e){switch(e){case 5126:return Zo;case 35664:return Xo;case 35665:return qo;case 35666:return Ko;case 35674:return go;case 35675:return Ho;case 35676:return Po;case 35678:case 36198:return Ro;case 35680:return ko;case 5124:case 35670:return Qo;case 35667:case 35671:return xs;case 35668:case 35672:return fo;case 35669:case 35673:return po}}(t.type)}function di(e,t,n){this.id=e,this.addr=n,this.size=t.size,this.setValue=function(e){switch(e){case 5126:return Do;case 35664:return Co;case 35665:return Ao;case 35666:return Mo;case 35674:return Fo;case 35675:return To;case 35676:return Io;case 35678:return Lo;case 35680:return Uo;case 5124:case 35670:return jo;case 35667:case 35671:return xs;case 35668:case 35672:return fo;case 35669:case 35673:return po}}(t.type)}function Cs(e){this.id=e,this.seq=[],this.map={}}function _e(e,t,n){this.seq=[],this.map={},this.renderer=n,n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(c=0;c<n;++c){var c,s=e.getActiveUniform(t,c),d=e.getUniformLocation(t,s.name),o=this,r=s.name,u=r.length;for(_n.lastIndex=0;;){var l=_n.exec(r),h=_n.lastIndex,i=l[1],a=l[3];if("]"===l[2]&&(i|=0),void 0===a||"["===a&&h+2===u){r=o,s=void 0===a?new ni(i,s,d):new di(i,s,d),r.seq.push(s),r.map[s.id]=s;break}void 0===(a=o.map[i])&&(a=new Cs(i),i=o,o=a,i.seq.push(o),i.map[o.id]=o),o=a}}}function a(e,t,n){return void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}function vn(e,t){this.min=void 0!==e?e:new n(1/0,1/0),this.max=void 0!==t?t:new n(-1/0,-1/0)}function ri(e,s,o,i,a){var r,c,l,d,u,h,m,f,p,g,v,b,j,y,_;this.render=function(e,w,O,x){if(0!==e.length){w=new t;var C,R,D=x.w/x.z,P=.5*x.z,L=.5*x.w,M=new n((A=16/x.w)*D,A),k=new t(1,1,0),F=new n(1,1),N=new vn;if(N.min.set(x.x,x.y),N.max.set(x.x+(x.z-16),x.y+(x.w-16)),void 0===r){A=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),S=new Uint16Array([0,1,2,0,2,3]),d=s.createBuffer(),m=s.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,d),s.bufferData(s.ARRAY_BUFFER,A,s.STATIC_DRAW),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,m),s.bufferData(s.ELEMENT_ARRAY_BUFFER,S,s.STATIC_DRAW),c=s.createTexture(),u=s.createTexture(),o.bindTexture(s.TEXTURE_2D,c),s.texImage2D(s.TEXTURE_2D,0,s.RGB,16,16,0,s.RGB,s.UNSIGNED_BYTE,null),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.NEAREST),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.NEAREST),o.bindTexture(s.TEXTURE_2D,u),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,16,16,0,s.RGBA,s.UNSIGNED_BYTE,null),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.NEAREST),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.NEAREST);var A={vertexShader:`uniform lowp int renderType;
uniform vec3 screenPosition;
uniform vec2 scale;
uniform float rotation;
uniform sampler2D occlusionMap;
attribute vec2 position;
attribute vec2 uv;
varying vec2 vUV;
varying float vVisibility;
void main() {
	vUV = uv;
	vec2 pos = position;
	if ( renderType == 2 ) {
		vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );
		visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );
		visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );
		visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );
		visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );
		visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );
		visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );
		visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );
		visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );
		vVisibility =        visibility.r / 9.0;
		vVisibility *= 1.0 - visibility.g / 9.0;
		vVisibility *=       visibility.b / 9.0;
		vVisibility *= 1.0 - visibility.a / 9.0;
		pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;
		pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;
	}
	gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );
}`,fragmentShader:`uniform lowp int renderType;
uniform sampler2D map;
uniform float opacity;
uniform vec3 color;
varying vec2 vUV;
varying float vVisibility;
void main() {
	if ( renderType == 0 ) {
		gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );
	} else if ( renderType == 1 ) {
		gl_FragColor = texture2D( map, vUV );
	} else {
		vec4 texture = texture2D( map, vUV );
		texture.a *= opacity * vVisibility;
		gl_FragColor = texture;
		gl_FragColor.rgb *= color;
	}
}`},S=s.createProgram(),z=s.createShader(s.FRAGMENT_SHADER),E=s.createShader(s.VERTEX_SHADER),T="precision "+a.precision+` float;
`;s.shaderSource(z,T+A.fragmentShader),s.shaderSource(E,T+A.vertexShader),s.compileShader(z),s.compileShader(E),s.attachShader(S,z),s.attachShader(S,E),s.linkProgram(S),r=S,p=s.getAttribLocation(r,"position"),g=s.getAttribLocation(r,"uv"),l=s.getUniformLocation(r,"renderType"),_=s.getUniformLocation(r,"map"),y=s.getUniformLocation(r,"occlusionMap"),v=s.getUniformLocation(r,"opacity"),j=s.getUniformLocation(r,"color"),h=s.getUniformLocation(r,"scale"),b=s.getUniformLocation(r,"rotation"),f=s.getUniformLocation(r,"screenPosition")}for(o.useProgram(r),o.initAttributes(),o.enableAttribute(p),o.enableAttribute(g),o.disableUnusedAttributes(),s.uniform1i(y,0),s.uniform1i(_,1),s.bindBuffer(s.ARRAY_BUFFER,d),s.vertexAttribPointer(p,2,s.FLOAT,!1,16,0),s.vertexAttribPointer(g,2,s.FLOAT,!1,16,8),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,m),o.disable(s.CULL_FACE),o.buffers.depth.setMask(!1),S=0,z=e.length;S<z;S++)if(A=16/x.w,M.set(A*D,A),E=e[S],w.set(E.matrixWorld.elements[12],E.matrixWorld.elements[13],E.matrixWorld.elements[14]),w.applyMatrix4(O.matrixWorldInverse),w.applyMatrix4(O.projectionMatrix),k.copy(w),F.x=x.x+k.x*P+P-8,F.y=x.y+k.y*L+L-8,!0===N.containsPoint(F)){o.activeTexture(s.TEXTURE0),o.bindTexture(s.TEXTURE_2D,null),o.activeTexture(s.TEXTURE1),o.bindTexture(s.TEXTURE_2D,c),s.copyTexImage2D(s.TEXTURE_2D,0,s.RGB,F.x,F.y,16,16,0),s.uniform1i(l,0),s.uniform2f(h,M.x,M.y),s.uniform3f(f,k.x,k.y,k.z),o.disable(s.BLEND),o.enable(s.DEPTH_TEST),s.drawElements(s.TRIANGLES,6,s.UNSIGNED_SHORT,0),o.activeTexture(s.TEXTURE0),o.bindTexture(s.TEXTURE_2D,u),s.copyTexImage2D(s.TEXTURE_2D,0,s.RGBA,F.x,F.y,16,16,0),s.uniform1i(l,1),o.disable(s.DEPTH_TEST),o.activeTexture(s.TEXTURE1),o.bindTexture(s.TEXTURE_2D,c),s.drawElements(s.TRIANGLES,6,s.UNSIGNED_SHORT,0),E.positionScreen.copy(k),E.customUpdateCallback?E.customUpdateCallback(E):E.updateLensFlares(),s.uniform1i(l,2),o.enable(s.BLEND),T=0;for(R=E.lensFlares.length;T<R;T++)C=E.lensFlares[T],.001<C.opacity&&.001<C.scale&&(k.x=C.x,k.y=C.y,k.z=C.z,A=C.size*C.scale/x.w,M.x=A*D,M.y=A,s.uniform3f(f,k.x,k.y,k.z),s.uniform2f(h,M.x,M.y),s.uniform1f(b,C.rotation),s.uniform1f(v,C.opacity),s.uniform3f(j,C.color.r,C.color.g,C.color.b),o.setBlending(C.blending,C.blendEquation,C.blendSrc,C.blendDst),i.setTexture2D(C.texture,1),s.drawElements(s.TRIANGLES,6,s.UNSIGNED_SHORT,0))}o.enable(s.CULL_FACE),o.enable(s.DEPTH_TEST),o.buffers.depth.setMask(!0),o.reset()}}}function Qt(e,t,n,s,o,i,a,r,c){b.call(this,e,t,n,s,o,i,a,r,c),this.needsUpdate=!0}function si(e,n,s,o,i){function F(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:t.id-e.id}var a,r,c,d,u,h,m,f,p,g,v,b,j,_,w,O,x,C,E,k,A,S=new t,M=new y,l=new t;this.render=function(t,y,T){if(0!==t.length){if(void 0===a){var z,D,R,P,H,I,N=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),L=new Uint16Array([0,1,2,0,2,3]);u=n.createBuffer(),d=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,u),n.bufferData(n.ARRAY_BUFFER,N,n.STATIC_DRAW),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,d),n.bufferData(n.ELEMENT_ARRAY_BUFFER,L,n.STATIC_DRAW),N=n.createProgram(),L=n.createShader(n.VERTEX_SHADER),D=n.createShader(n.FRAGMENT_SHADER),n.shaderSource(L,["precision "+i.precision+" float;",`#define SHADER_NAME SpriteMaterial
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float rotation;
uniform vec2 scale;
uniform vec2 uvOffset;
uniform vec2 uvScale;
attribute vec2 position;
attribute vec2 uv;
varying vec2 vUV;
varying float fogDepth;
void main() {
	vUV = uvOffset + uv * uvScale;
	vec2 alignedPosition = position * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	vec4 mvPosition;
	mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	fogDepth = - mvPosition.z;
}`].join(`
`)),n.shaderSource(D,["precision "+i.precision+" float;",`#define SHADER_NAME SpriteMaterial
uniform vec3 color;
uniform sampler2D map;
uniform float opacity;
uniform int fogType;
uniform vec3 fogColor;
uniform float fogDensity;
uniform float fogNear;
uniform float fogFar;
uniform float alphaTest;
varying vec2 vUV;
varying float fogDepth;
void main() {
	vec4 texture = texture2D( map, vUV );
	gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );
	if ( gl_FragColor.a < alphaTest ) discard;
	if ( fogType > 0 ) {
		float fogFactor = 0.0;
		if ( fogType == 1 ) {
			fogFactor = smoothstep( fogNear, fogFar, fogDepth );
		} else {
			const float LOG2 = 1.442695;
			fogFactor = exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 );
			fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );
		}
		gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
	}
}`].join(`
`)),n.compileShader(L),n.compileShader(D),n.attachShader(N,L),n.attachShader(N,D),n.linkProgram(N),a=N,f=n.getAttribLocation(a,"position"),m=n.getAttribLocation(a,"uv"),h=n.getUniformLocation(a,"uvOffset"),c=n.getUniformLocation(a,"uvScale"),x=n.getUniformLocation(a,"rotation"),k=n.getUniformLocation(a,"scale"),E=n.getUniformLocation(a,"color"),C=n.getUniformLocation(a,"map"),p=n.getUniformLocation(a,"opacity"),g=n.getUniformLocation(a,"modelViewMatrix"),w=n.getUniformLocation(a,"projectionMatrix"),r=n.getUniformLocation(a,"fogType"),O=n.getUniformLocation(a,"fogDensity"),v=n.getUniformLocation(a,"fogNear"),b=n.getUniformLocation(a,"fogFar"),j=n.getUniformLocation(a,"fogColor"),n.getUniformLocation(a,"fogDepth"),_=n.getUniformLocation(a,"alphaTest"),(N=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=8,N.height=8,(L=N.getContext("2d")).fillStyle="white",L.fillRect(0,0,8,8),A=new Qt(N)}s.useProgram(a),s.initAttributes(),s.enableAttribute(f),s.enableAttribute(m),s.disableUnusedAttributes(),s.disable(n.CULL_FACE),s.enable(n.BLEND),n.bindBuffer(n.ARRAY_BUFFER,u),n.vertexAttribPointer(f,2,n.FLOAT,!1,16,0),n.vertexAttribPointer(m,2,n.FLOAT,!1,16,8),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,d),n.uniformMatrix4fv(w,!1,T.projectionMatrix.elements),s.activeTexture(n.TEXTURE0),n.uniform1i(C,0),L=N=0,(D=y.fog)?(n.uniform3f(j,D.color.r,D.color.g,D.color.b),D.isFog?(n.uniform1f(v,D.near),n.uniform1f(b,D.far),n.uniform1i(r,1),L=N=1):D.isFogExp2&&(n.uniform1f(O,D.density),n.uniform1i(r,2),L=N=2)):(n.uniform1i(r,0),L=N=0);for(R=0,H=t.length;R<H;R++)(D=t[R]).modelViewMatrix.multiplyMatrices(T.matrixWorldInverse,D.matrixWorld),D.z=-D.modelViewMatrix.elements[14];t.sort(F),I=[];for(R=0,H=t.length;R<H;R++)z=(D=t[R]).material,!1!==z.visible&&(D.onBeforeRender(e,y,T,void 0,z,void 0),n.uniform1f(_,z.alphaTest),n.uniformMatrix4fv(g,!1,D.modelViewMatrix.elements),D.matrixWorld.decompose(S,M,l),I[0]=l.x,I[1]=l.y,P=0,y.fog&&z.fog&&(P=L),N!==P&&(n.uniform1i(r,P),N=P),null!==z.map?(n.uniform2f(h,z.map.offset.x,z.map.offset.y),n.uniform2f(c,z.map.repeat.x,z.map.repeat.y)):(n.uniform2f(h,0,0),n.uniform2f(c,1,1)),n.uniform1f(p,z.opacity),n.uniform3f(E,z.color.r,z.color.g,z.color.b),n.uniform1f(x,z.rotation),n.uniform2fv(k,I),s.setBlending(z.blending,z.blendEquation,z.blendSrc,z.blendDst,z.blendEquationAlpha,z.blendSrcAlpha,z.blendDstAlpha,z.premultipliedAlpha),s.buffers.depth.setTest(z.depthTest),s.buffers.depth.setMask(z.depthWrite),s.buffers.color.setMask(z.colorWrite),o.setTexture2D(z.map||A,0),n.drawElements(n.TRIANGLES,6,n.UNSIGNED_SHORT,0),D.onAfterRender(e,y,T,void 0,z,void 0));s.enable(n.CULL_FACE),s.reset()}}}function h(){Object.defineProperty(this,"id",{value:Qs++}),this.uuid=d.generateUUID(),this.name="",this.type="Material",this.lights=this.fog=!0,this.blending=1,this.side=0,this.flatShading=!1,this.vertexColors=0,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null,this.depthFunc=3,this.depthWrite=this.depthTest=!0,this.clippingPlanes=null,this.clipShadows=this.clipIntersection=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetUnits=this.polygonOffsetFactor=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.userData={},this.needsUpdate=!0}function oe(e){h.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.lights=this.fog=!1,this.setValues(e)}function se(e){h.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new t,this.nearDistance=1,this.farDistance=1e3,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.lights=this.fog=!1,this.setValues(e)}function X(e,n){this.min=void 0!==e?e:new t(1/0,1/0,1/0),this.max=void 0!==n?n:new t(-1/0,-1/0,-1/0)}function V(e,n){this.center=void 0!==e?e:new t,this.radius=void 0!==n?n:0}function L(e,n){this.normal=void 0!==e?e:new t(1,0,0),this.constant=void 0!==n?n:0}function jn(e,t,n,s,o,i){this.planes=[void 0!==e?e:new L,void 0!==t?t:new L,void 0!==n?n:new L,void 0!==s?s:new L,void 0!==o?o:new L,void 0!==i?i:new L]}function Is(e,s,o){function m(t,n,s,o,i,r){var c=t.geometry,l=h,d=t.customDepthMaterial;return s&&(l=f,d=t.customDistanceMaterial),d?l=d:(d=!1,n.morphTargets&&(c&&c.isBufferGeometry?d=c.morphAttributes&&c.morphAttributes.position&&0<c.morphAttributes.position.length:c&&c.isGeometry&&(d=c.morphTargets&&0<c.morphTargets.length)),t.isSkinnedMesh&&!1===n.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t),c=0,d&&(c|=1),(t=t.isSkinnedMesh&&n.skinning)&&(c|=2),l=l[c]),e.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length&&(c=l.uuid,d=n.uuid,void 0===(t=p[c])&&(t={},p[c]=t),void 0===(c=t[d])&&(c=l.clone(),t[d]=c),l=c),l.visible=n.visible,l.wireframe=n.wireframe,d=n.side,a.renderSingleSided&&2==d&&(d=0),a.renderReverseSided&&(0===d?d=1:1===d&&(d=0)),l.side=d,l.clipShadows=n.clipShadows,l.clippingPlanes=n.clippingPlanes,l.clipIntersection=n.clipIntersection,l.wireframeLinewidth=n.wireframeLinewidth,l.linewidth=n.linewidth,s&&l.isMeshDistanceMaterial&&(l.referencePosition.copy(o),l.nearDistance=i,l.farDistance=r),l}function y(t,n,o,i){if(!1!==t.visible){if(t.layers.test(n.layers)&&(t.isMesh||t.isLine||t.isPoints)&&t.castShadow&&(!t.frustumCulled||b.intersectsObject(t)))if(t.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,t.matrixWorld),a=s.update(t),c=t.material,Array.isArray(c))for(var a,r,c,u,h=a.groups,d=0,f=h.length;d<f;d++)u=h[d],(r=c[u.materialIndex])&&r.visible&&(r=m(t,r,i,l,o.near,o.far),e.renderBufferDirect(o,null,a,r,t,u));else c.visible&&(r=m(t,c,i,l,o.near,o.far),e.renderBufferDirect(o,null,a,r,t,null));for(a=0,c=(t=t.children).length;a<c;a++)y(t[a],n,o,i)}}var a,b=new jn,v=new c,i=new n,_=new n(o,o),d=new t,l=new t,h=Array(4),f=Array(4),p={},w=[new t(1,0,0),new t(-1,0,0),new t(0,0,1),new t(0,0,-1),new t(0,1,0),new t(0,-1,0)],O=[new t(0,1,0),new t(0,1,0),new t(0,1,0),new t(0,1,0),new t(0,0,1),new t(0,0,-1)],r=[new g,new g,new g,new g,new g,new g];for(o=0;4!==o;++o){var u=0!=(1&o),j=0!=(2&o),x=new oe({depthPacking:3201,morphTargets:u,skinning:j});h[o]=x,u=new se({morphTargets:u,skinning:j}),f[o]=u}a=this,this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.renderSingleSided=this.renderReverseSided=!0,this.render=function(t,n,s){if(!1!==a.enabled&&(!1!==a.autoUpdate||!1!==a.needsUpdate)&&0!==t.length){f=e.state,f.disable(e.context.BLEND),f.buffers.color.setClear(1,1,1,1),f.buffers.depth.setTest(!0),f.setScissorTest(!1);for(var o,c,u,h,m,f,p,g=0,j=t.length;g<j;g++)if(c=t[g],u=c.shadow,p=c&&c.isPointLight,void 0===u)console.warn("THREE.WebGLShadowMap:",c,"has no shadow.");else{h=u.camera,(i.copy(u.mapSize),i.min(_),p)&&(m=i.x,o=i.y,r[0].set(2*m,o,m,o),r[1].set(0,o,m,o),r[2].set(3*m,o,m,o),r[3].set(m,o,m,o),r[4].set(3*m,0,m,o),r[5].set(m,0,m,o),i.x*=4,i.y*=2);for(null===u.map&&(u.map=new _t(i.x,i.y,{minFilter:1003,magFilter:1003,format:1023}),u.map.texture.name=c.name+".shadowMap",h.updateProjectionMatrix()),u.isSpotLightShadow&&u.update(c),m=u.map,o=u.matrix,l.setFromMatrixPosition(c.matrixWorld),h.position.copy(l),p?(u=6,o.makeTranslation(-l.x,-l.y,-l.z)):(u=1,d.setFromMatrixPosition(c.target.matrixWorld),h.lookAt(d),h.updateMatrixWorld(),o.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),o.multiply(h.projectionMatrix),o.multiply(h.matrixWorldInverse)),e.setRenderTarget(m),e.clear(),c=0;c<u;c++)p&&(d.copy(h.position),d.add(w[c]),h.up.copy(O[c]),h.lookAt(d),h.updateMatrixWorld(),f.viewport(r[c])),v.multiplyMatrices(h.projectionMatrix,h.matrixWorldInverse),b.setFromMatrix(v),y(n,s,h,p)}a.needsUpdate=!1}}}function Wo(e){var t={};return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t[e.uuid]},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);var s=t[n.uuid];s&&(e.deleteBuffer(s.buffer),delete t[n.uuid])},update:function(n,s){if(n.isInterleavedBufferAttribute&&(n=n.data),void 0===(r=t[n.uuid])){var r=n.uuid,o=n.array,i=n.dynamic?e.DYNAMIC_DRAW:e.STATIC_DRAW,a=e.createBuffer();e.bindBuffer(s,a),e.bufferData(s,o,i),n.onUploadCallback(),s=e.FLOAT,o instanceof Float32Array?s=e.FLOAT:o instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):o instanceof Uint16Array?s=e.UNSIGNED_SHORT:o instanceof Int16Array?s=e.SHORT:o instanceof Uint32Array?s=e.UNSIGNED_INT:o instanceof Int32Array?s=e.INT:o instanceof Int8Array?s=e.BYTE:o instanceof Uint8Array&&(s=e.UNSIGNED_BYTE),t[r]={buffer:a,type:s,bytesPerElement:o.BYTES_PER_ELEMENT,version:n.version}}else r.version<n.version&&(a=(o=n).array,i=o.updateRange,e.bindBuffer(s,r.buffer),!1===o.dynamic?e.bufferData(s,a,e.STATIC_DRAW):-1===i.count?e.bufferSubData(s,0,a):0===i.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(e.bufferSubData(s,i.offset*a.BYTES_PER_ELEMENT,a.subarray(i.offset,i.offset+i.count)),i.count=-1),r.version=n.version)}}}function ne(e,t,n,s){this._x=e||0,this._y=t||0,this._z=n||0,this._order=s||ne.DefaultOrder}function ms(){this.mask=1}function o(){Object.defineProperty(this,"id",{value:Ks++}),this.uuid=d.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=o.DefaultUp.clone();var s=new t,e=new ne,n=new y,i=new t(1,1,1);e.onChange(function(){n.setFromEuler(e,!1)}),n.onChange(function(){e.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:s},rotation:{enumerable:!0,value:e},quaternion:{enumerable:!0,value:n},scale:{enumerable:!0,value:i},modelViewMatrix:{value:new c},normalMatrix:{value:new A}}),this.matrix=new c,this.matrixWorld=new c,this.matrixAutoUpdate=o.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new ms,this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function K(){o.call(this),this.type="Camera",this.matrixWorldInverse=new c,this.projectionMatrix=new c}function Ze(e,t,n,s,o,i){K.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=s,this.near=void 0!==o?o:.1,this.far=void 0!==i?i:2e3,this.updateProjectionMatrix()}function Q(e,n,s,o,i,r){this.a=e,this.b=n,this.c=s,this.normal=o&&o.isVector3?o:new t,this.vertexNormals=Array.isArray(o)?o:[],this.color=i&&i.isColor?i:new a,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==r?r:0}function l(){Object.defineProperty(this,"id",{value:$s+=2}),this.uuid=d.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=!1}function u(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.uuid=d.generateUUID(),this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function Ut(e,t,n){u.call(this,new Int8Array(e),t,n)}function $t(e,t,n){u.call(this,new Uint8Array(e),t,n)}function Ht(e,t,n){u.call(this,new Uint8ClampedArray(e),t,n)}function Rt(e,t,n){u.call(this,new Int16Array(e),t,n)}function fe(e,t,n){u.call(this,new Uint16Array(e),t,n)}function Nt(e,t,n){u.call(this,new Int32Array(e),t,n)}function ge(e,t,n){u.call(this,new Uint32Array(e),t,n)}function s(e,t,n){u.call(this,new Float32Array(e),t,n)}function zt(e,t,n){u.call(this,new Float64Array(e),t,n)}function As(){this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}function Yn(e){if(0===e.length)return-1/0;for(var n=e[0],t=1,s=e.length;t<s;++t)e[t]>n&&(n=e[t]);return n}function i(){Object.defineProperty(this,"id",{value:Vs+=2}),this.uuid=d.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.drawRange={start:0,count:1/0}}function Ie(e,t,n,s,o,i){l.call(this),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:s,heightSegments:o,depthSegments:i},this.fromBufferGeometry(new ue(e,t,n,s,o,i)),this.mergeVertices()}function ue(e,n,o,a,r,c){function l(e,n,s,o,i,a,r,c,l,v,b){var O,x=a/l,C=r/v,E=a/2,k=r/2,A=c/2;r=l+1;var j,y,S=v+1,w=a=0,_=new t;for(y=0;y<S;y++){O=y*C-k;for(j=0;j<r;j++)_[e]=(j*x-E)*o,_[n]=O*i,_[s]=A,f.push(_.x,_.y,_.z),_[e]=0,_[n]=0,_[s]=0<c?1:-1,p.push(_.x,_.y,_.z),h.push(j/l),h.push(1-y/v),a+=1}for(y=0;y<v;y++)for(j=0;j<l;j++)e=d+j+r*(y+1),n=d+(j+1)+r*(y+1),s=d+(j+1)+r*y,u.push(d+j+r*y,e,s),u.push(e,n,s),w+=6;m.addGroup(g,w,b),g+=w,d+=a}i.call(this),this.type="BoxBufferGeometry",this.parameters={width:e,height:n,depth:o,widthSegments:a,heightSegments:r,depthSegments:c},m=this,e=e||1,n=n||1,o=o||1,a=Math.floor(a)||1,r=Math.floor(r)||1,c=Math.floor(c)||1;var m,u=[],f=[],p=[],h=[],d=0,g=0;l("z","y","x",-1,-1,o,n,e,c,r,0),l("z","y","x",1,-1,o,n,-e,c,r,1),l("x","z","y",1,1,e,o,n,a,c,2),l("x","z","y",1,-1,e,o,-n,a,c,3),l("x","y","z",1,-1,e,n,o,a,r,4),l("x","y","z",-1,-1,e,n,-o,a,r,5),this.setIndex(u),this.addAttribute("position",new s(f,3)),this.addAttribute("normal",new s(p,3)),this.addAttribute("uv",new s(h,2))}function xt(e,t,n,s){l.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:s},this.fromBufferGeometry(new Ce(e,t,n,s)),this.mergeVertices()}function Ce(e,t,n,o){i.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:o};var f,r=(e=e||1)/2,l=(t=t||1)/2,a=(n=Math.floor(n)||1)+1,c=(o=Math.floor(o)||1)+1,p=e/n,g=t/o,d=[],h=[],m=[],u=[];for(e=0;e<c;e++){f=e*g-l;for(t=0;t<a;t++)h.push(t*p-r,-f,0),m.push(0,0,1),u.push(t/n),u.push(1-e/o)}for(e=0;e<o;e++)for(t=0;t<n;t++)r=t+a*(e+1),l=t+1+a*(e+1),c=t+1+a*e,d.push(t+a*e,r,c),d.push(r,l,c);this.setIndex(d),this.addAttribute("position",new s(h,3)),this.addAttribute("normal",new s(m,3)),this.addAttribute("uv",new s(u,2))}function F(e){h.call(this),this.type="MeshBasicMaterial",this.color=new a(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.lights=this.morphTargets=this.skinning=!1,this.setValues(e)}function D(e){h.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,this.fragmentShader=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function Ae(e,n){this.origin=void 0!==e?e:new t,this.direction=void 0!==n?n:new t}function He(e,n){this.start=void 0!==e?e:new t,this.end=void 0!==n?n:new t}function Z(e,n,s){this.a=void 0!==e?e:new t,this.b=void 0!==n?n:new t,this.c=void 0!==s?s:new t}function x(e,t){o.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new i,this.material=void 0!==t?t:new F({color:16777215*Math.random()}),this.drawMode=0,this.updateMorphTargets()}function zo(e,t,n,s){function c(e,n){t.buffers.color.setClear(e.r,e.g,e.b,n,s)}var o,i,d,r=new a(0),l=0;return{getClearColor:function(){return r},setClearColor:function(e,t){r.set(e),c(r,l=void 0!==t?t:1)},getClearAlpha:function(){return l},setClearAlpha:function(e){c(r,l=e)},render:function(t,s,a,u){null===(s=s.background)?c(r,l):s&&s.isColor&&(c(s,1),u=!0),(e.autoClear||u)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),s&&s.isCubeTexture?(void 0===o&&((o=new x(new ue(1,1,1),new D({uniforms:Fe.cube.uniforms,vertexShader:Fe.cube.vertexShader,fragmentShader:Fe.cube.fragmentShader,side:1,depthTest:!0,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),o.geometry.removeAttribute("uv"),o.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},n.update(o.geometry)),o.material.uniforms.tCube.value=s,t.push(o,o.geometry,o.material,0,null)):s&&s.isTexture&&(void 0===d&&(d=new Ze(-1,1,1,-1,0,1),i=new x(new Ce(2,2),new F({depthTest:!1,depthWrite:!1,fog:!1})),n.update(i.geometry)),i.material.map=s,e.renderBufferDirect(d,null,i.geometry,i.material,i,null))}}}function hi(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program&&t.program&&e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function li(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function ci(){var s=[],n=0,e=[],t=[];return{opaque:e,transparent:t,init:function(){n=0,e.length=0,t.length=0},push:function(o,i,a,r,c){var l=s[n];void 0===l?(l={id:o.id,object:o,geometry:i,material:a,program:a.program,renderOrder:o.renderOrder,z:r,group:c},s[n]=l):(l.id=o.id,l.object=o,l.geometry=i,l.material=a,l.program=a.program,l.renderOrder=o.renderOrder,l.z=r,l.group=c),(!0===a.transparent?t:e).push(l),n++},sort:function(){1<e.length&&e.sort(hi),1<t.length&&t.sort(li)}}}function ai(){var e={};return{get:function(t,n){return t=t.id+","+n.id,void 0===(n=e[t])&&(n=new ci,e[t]=n),n},dispose:function(){e={}}}}function ei(e,t){return Math.abs(t[1])-Math.abs(e[1])}function xo(e){var n={},t=new Float32Array(8);return{update:function(s,o,i,a){var r,c,d,l=s.morphTargetInfluences,u=l.length;if(void 0===(s=n[o.id])){s=[];for(r=0;r<u;r++)s[r]=[r,0];n[o.id]=s}d=i.morphTargets&&o.morphAttributes.position;for(i=i.morphNormals&&o.morphAttributes.normal,r=0;r<u;r++)c=s[r],0!==c[1]&&(d&&o.removeAttribute("morphTarget"+r),i&&o.removeAttribute("morphNormal"+r));for(r=0;r<u;r++)(c=s[r])[0]=r,c[1]=l[r];for(s.sort(ei),r=0;8>r;r++)(c=s[r])&&(l=c[0],c=c[1])?(d&&o.addAttribute("morphTarget"+r,d[l]),i&&o.addAttribute("morphNormal"+r,i[l]),t[r]=c):t[r]=0;a.getUniforms().setValue(e,"morphTargetInfluences",t)}}}function Oo(e,t,n){var s,o,i;this.setMode=function(e){s=e},this.setIndex=function(e){o=e.type,i=e.bytesPerElement},this.render=function(t,a){e.drawElements(s,a,o,t*i),n.calls++,n.vertices+=a,s===e.TRIANGLES?n.faces+=a/3:s===e.POINTS&&(n.points+=a)},this.renderInstances=function(a,r,c){var l=t.get("ANGLE_instanced_arrays");null===l?console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays."):(l.drawElementsInstancedANGLE(s,c,o,r*i,a.maxInstancedCount),n.calls++,n.vertices+=c*a.maxInstancedCount,s===e.TRIANGLES?n.faces+=a.maxInstancedCount*c/3:s===e.POINTS&&(n.points+=a.maxInstancedCount*c))}}function ui(e,t,n){var s;this.setMode=function(e){s=e},this.render=function(t,o){e.drawArrays(s,t,o),n.calls++,n.vertices+=o,s===e.TRIANGLES?n.faces+=o/3:s===e.POINTS&&(n.points+=o)},this.renderInstances=function(o,i,a){var c,r=t.get("ANGLE_instanced_arrays");null===r?console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays."):(c=o.attributes.position,c.isInterleavedBufferAttribute?(a=c.data.count,r.drawArraysInstancedANGLE(s,0,a,o.maxInstancedCount)):r.drawArraysInstancedANGLE(s,i,a,o.maxInstancedCount),n.calls++,n.vertices+=a*o.maxInstancedCount,s===e.TRIANGLES?n.faces+=o.maxInstancedCount*a/3:s===e.POINTS&&(n.points+=o.maxInstancedCount*a))}}function $o(e,t,n){function a(e){e=e.target;var r,i=o[e.id];for(r in null!==i.index&&t.remove(i.index),i.attributes)t.remove(i.attributes[r]);e.removeEventListener("dispose",a),delete o[e.id],(r=s[e.id])&&(t.remove(r),delete s[e.id]),(r=s[i.id])&&(t.remove(r),delete s[i.id]),n.geometries--}var o={},s={};return{get:function(e,t){var s=o[t.id];return s||(t.addEventListener("dispose",a),t.isBufferGeometry?s=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new i).setFromObject(e)),s=t._bufferGeometry),o[t.id]=s,n.geometries++,s)},update:function(n){var i,a,o=n.index,s=n.attributes;for(i in null!==o&&t.update(o,e.ELEMENT_ARRAY_BUFFER),s)t.update(s[i],e.ARRAY_BUFFER);for(i in n=n.morphAttributes){s=0;for(a=(o=n[i]).length;s<a;s++)t.update(o[s],e.ARRAY_BUFFER)}},getWireframeAttribute:function(n){if(o=s[n.id],o)return o;if(o=[],a=n.index,r=n.attributes,null!==a)for(var o,a,r,c,l=a.array,i=0,d=l.length;i<d;i+=3)c=l[i+0],r=l[i+1],a=l[i+2],o.push(c,r,r,a,a,c);else for(i=0,d=(l=r.position.array).length/3-1;i<d;i+=3)c=i+0,r=i+1,a=i+2,o.push(c,r,r,a,a,c);return o=new(65535<Yn(o)?ge:fe)(o,1),t.update(o,e.ELEMENT_ARRAY_BUFFER),s[n.id]=o}}}function Jo(){var e={};return{get:function(s){if(void 0!==e[s.id])return e[s.id];switch(s.type){case"DirectionalLight":var o={direction:new t,color:new a,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new n};break;case"SpotLight":o={position:new t,direction:new t,color:new a,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new n};break;case"PointLight":o={position:new t,color:new a,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new n,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":o={direction:new t,skyColor:new a,groundColor:new a};break;case"RectAreaLight":o={color:new a,position:new t,halfWidth:new t,halfHeight:new t}}return e[s.id]=o}}}function ii(){var n=new Jo,e={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},s=new t,i=new c,o=new c;return{setup:function(t,a,r){for(var _=0,y=0,j=0,h=0,m=0,f=0,p=0,g=0,u=r.matrixWorldInverse,v=0,w=t.length;v<w;v++){var c=t[v],l=c.color,d=c.intensity,O=c.distance,b=c.shadow&&c.shadow.map?c.shadow.map.texture:null;c.isAmbientLight?(_+=l.r*d,y+=l.g*d,j+=l.b*d):c.isDirectionalLight?((r=n.get(c)).color.copy(c.color).multiplyScalar(c.intensity),r.direction.setFromMatrixPosition(c.matrixWorld),s.setFromMatrixPosition(c.target.matrixWorld),r.direction.sub(s),r.direction.transformDirection(u),(r.shadow=c.castShadow)&&(l=c.shadow,r.shadowBias=l.bias,r.shadowRadius=l.radius,r.shadowMapSize=l.mapSize),e.directionalShadowMap[h]=b,e.directionalShadowMatrix[h]=c.shadow.matrix,e.directional[h]=r,h++):c.isSpotLight?((r=n.get(c)).position.setFromMatrixPosition(c.matrixWorld),r.position.applyMatrix4(u),r.color.copy(l).multiplyScalar(d),r.distance=O,r.direction.setFromMatrixPosition(c.matrixWorld),s.setFromMatrixPosition(c.target.matrixWorld),r.direction.sub(s),r.direction.transformDirection(u),r.coneCos=Math.cos(c.angle),r.penumbraCos=Math.cos(c.angle*(1-c.penumbra)),r.decay=0===c.distance?0:c.decay,(r.shadow=c.castShadow)&&(l=c.shadow,r.shadowBias=l.bias,r.shadowRadius=l.radius,r.shadowMapSize=l.mapSize),e.spotShadowMap[f]=b,e.spotShadowMatrix[f]=c.shadow.matrix,e.spot[f]=r,f++):c.isRectAreaLight?((r=n.get(c)).color.copy(l).multiplyScalar(d/(c.width*c.height)),r.position.setFromMatrixPosition(c.matrixWorld),r.position.applyMatrix4(u),o.identity(),i.copy(c.matrixWorld),i.premultiply(u),o.extractRotation(i),r.halfWidth.set(.5*c.width,0,0),r.halfHeight.set(0,.5*c.height,0),r.halfWidth.applyMatrix4(o),r.halfHeight.applyMatrix4(o),e.rectArea[p]=r,p++):c.isPointLight?((r=n.get(c)).position.setFromMatrixPosition(c.matrixWorld),r.position.applyMatrix4(u),r.color.copy(c.color).multiplyScalar(c.intensity),r.distance=c.distance,r.decay=0===c.distance?0:c.decay,(r.shadow=c.castShadow)&&(l=c.shadow,r.shadowBias=l.bias,r.shadowRadius=l.radius,r.shadowMapSize=l.mapSize,r.shadowCameraNear=l.camera.near,r.shadowCameraFar=l.camera.far),e.pointShadowMap[m]=b,e.pointShadowMatrix[m]=c.shadow.matrix,e.point[m]=r,m++):c.isHemisphereLight&&((r=n.get(c)).direction.setFromMatrixPosition(c.matrixWorld),r.direction.transformDirection(u),r.direction.normalize(),r.skyColor.copy(c.color).multiplyScalar(d),r.groundColor.copy(c.groundColor).multiplyScalar(d),e.hemi[g]=r,g++)}e.ambient[0]=_,e.ambient[1]=y,e.ambient[2]=j,e.directional.length=h,e.spot.length=f,e.rectArea.length=p,e.point.length=m,e.hemi.length=g,e.hash=h+","+m+","+f+","+p+","+g+","+a.length},state:e}}function Vo(e,t){var n={};return{update:function(s){var i=t.frame,a=s.geometry,o=e.get(s,a);return n[o.id]!==i&&(a.isGeometry&&o.updateFromObject(s),e.update(o),n[o.id]=i),o},clear:function(){n={}}}}function ks(e,t,n){var s=e.createShader(t);return e.shaderSource(s,n),e.compileShader(s),!1===e.getShaderParameter(s,e.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(s)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",t===e.VERTEX_SHADER?"vertex":"fragment",e.getShaderInfoLog(s),function(e){e=e.split(`
`);for(var t=0;t<e.length;t++)e[t]=t+1+": "+e[t];return e.join(`
`)}(n)),s}function Ps(e){switch(e){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw Error("unsupported encoding: "+e)}}function ds(e,t){return"vec4 "+e+"( vec4 value ) { return "+(t=Ps(t))[0]+"ToLinear"+t[1]+"; }"}function wo(e,t){return"vec4 "+e+"( vec4 value ) { return LinearTo"+(t=Ps(t))[0]+t[1]+"; }"}function So(e,t){switch(t){case 1:t="Linear";break;case 2:t="Reinhard";break;case 3:t="Uncharted2";break;case 4:t="OptimizedCineon";break;default:throw Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function cn(e){return""!==e}function io(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights)}function ls(e){return e.replace(/^[ \t]*#include +<([\w\d.]+)>/gm,function(e,t){if(void 0===(e=f[t]))throw Error("Can not resolve #include <"+t+">");return ls(e)})}function co(e){return e.replace(/for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(e,t,n,s){for(e="",t=parseInt(t);t<parseInt(n);t++)e+=s.replace(/\[ i \]/g,"[ "+t+" ]");return e})}function vo(e,t,n,s,o,i){var a=e.context,m=s.defines,l=o.vertexShader,c=o.fragmentShader,d="SHADOWMAP_TYPE_BASIC";1===i.shadowMapType?d="SHADOWMAP_TYPE_PCF":2===i.shadowMapType&&(d="SHADOWMAP_TYPE_PCF_SOFT");var u="ENVMAP_TYPE_CUBE",h="ENVMAP_MODE_REFLECTION",p="ENVMAP_BLENDING_MULTIPLY";if(i.envMap){switch(s.envMap.mapping){case 301:case 302:u="ENVMAP_TYPE_CUBE";break;case 306:case 307:u="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:u="ENVMAP_TYPE_EQUIREC";break;case 305:u="ENVMAP_TYPE_SPHERE"}switch(s.envMap.mapping){case 302:case 304:h="ENVMAP_MODE_REFRACTION"}switch(s.combine){case 0:p="ENVMAP_BLENDING_MULTIPLY";break;case 1:p="ENVMAP_BLENDING_MIX";break;case 2:p="ENVMAP_BLENDING_ADD"}}var v,b,j=0<e.gammaFactor?e.gammaFactor:1,y=function(e,t,n){return[(e=e||{}).derivatives||t.envMapCubeUV||t.bumpMap||t.normalMap||t.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(e.fragDepth||t.logarithmicDepthBuffer)&&n.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",e.drawBuffers&&n.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(e.shaderTextureLOD||t.envMap)&&n.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(cn).join(`
`)}(s.extensions,i,t),g=function(e){var t,n,s=[];for(t in e)n=e[t],!1!==n&&s.push("#define "+t+" "+n);return s.join(`
`)}(m),r=a.createProgram();return s.isRawShaderMaterial?(0<(m=[g].filter(cn).join(`
`)).length&&(m+=`
`),0<(t=[y,g].filter(cn).join(`
`)).length&&(t+=`
`)):(m=["precision "+i.precision+" float;","precision "+i.precision+" int;","#define SHADER_NAME "+o.name,g,i.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+j,"#define MAX_BONES "+i.maxBones,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+h:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.vertexColors?"#define USE_COLOR":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.useVertexTexture?"#define BONE_TEXTURE":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&!1===i.flatShading?"#define USE_MORPHNORMALS":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+i.numClippingPlanes,i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+d:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&t.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(cn).join(`
`),t=[y,"precision "+i.precision+" float;","precision "+i.precision+" int;","#define SHADER_NAME "+o.name,g,i.alphaTest?"#define ALPHATEST "+i.alphaTest:"","#define GAMMA_FACTOR "+j,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+u:"",i.envMap?"#define "+h:"",i.envMap?"#define "+p:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.vertexColors?"#define USE_COLOR":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+i.numClippingPlanes,"#define UNION_CLIPPING_PLANES "+(i.numClippingPlanes-i.numClipIntersection),i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+d:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&t.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",i.envMap&&t.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",0!==i.toneMapping?"#define TONE_MAPPING":"",0!==i.toneMapping?f.tonemapping_pars_fragment:"",0!==i.toneMapping?So("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.outputEncoding||i.mapEncoding||i.envMapEncoding||i.emissiveMapEncoding?f.encodings_pars_fragment:"",i.mapEncoding?ds("mapTexelToLinear",i.mapEncoding):"",i.envMapEncoding?ds("envMapTexelToLinear",i.envMapEncoding):"",i.emissiveMapEncoding?ds("emissiveMapTexelToLinear",i.emissiveMapEncoding):"",i.outputEncoding?wo("linearToOutputTexel",i.outputEncoding):"",i.depthPacking?"#define DEPTH_PACKING "+s.depthPacking:"",`
`].filter(cn).join(`
`)),l=io(l=ls(l),i),c=io(c=ls(c),i),s.isShaderMaterial||(l=co(l),c=co(c)),c=t+c,l=ks(a,a.VERTEX_SHADER,m+l),c=ks(a,a.FRAGMENT_SHADER,c),a.attachShader(r,l),a.attachShader(r,c),void 0!==s.index0AttributeName?a.bindAttribLocation(r,0,s.index0AttributeName):!0===i.morphTargets&&a.bindAttribLocation(r,0,"position"),a.linkProgram(r),i=a.getProgramInfoLog(r),o=a.getShaderInfoLog(l),d=a.getShaderInfoLog(c),h=u=!0,!1===a.getProgramParameter(r,a.LINK_STATUS)?(u=!1,console.error("THREE.WebGLProgram: shader error: ",a.getError(),"gl.VALIDATE_STATUS",a.getProgramParameter(r,a.VALIDATE_STATUS),"gl.getProgramInfoLog",i,o,d)):""!==i?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",i):""!==o&&""!==d||(h=!1),h&&(this.diagnostics={runnable:u,material:s,programLog:i,vertexShader:{log:o,prefix:m},fragmentShader:{log:d,prefix:t}}),a.deleteShader(l),a.deleteShader(c),this.getUniforms=function(){return void 0===v&&(v=new _e(a,r,e)),v},this.getAttributes=function(){if(void 0===b){for(var t,n={},s=a.getProgramParameter(r,a.ACTIVE_ATTRIBUTES),e=0;e<s;e++)t=a.getActiveAttrib(r,e).name,n[t]=a.getAttribLocation(r,t);b=n}return b},this.destroy=function(){a.deleteProgram(r),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=Bs++,this.code=n,this.usedTimes=1,this.program=r,this.vertexShader=l,this.fragmentShader=c,this}function _o(e,t,n){function o(e,t){if(e)e.isTexture?n=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),n=e.texture.encoding);else var n=3e3;return 3e3===n&&t&&(n=3007),n}var s=[],a={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow"},i="precision supportsVertexTextures map mapEncoding envMap envMapMode envMapEncoding lightMap aoMap emissiveMap emissiveMapEncoding bumpMap normalMap displacementMap specularMap roughnessMap metalnessMap gradientMap alphaMap combine vertexColors fog useFog fogExp flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights numRectAreaLights shadowMapEnabled shadowMapType toneMapping physicallyCorrectLights alphaTest doubleSided flipSided numClippingPlanes numClipIntersection depthPacking dithering".split(" ");this.getParameters=function(t,s,i,r,c,l,d){var u,h,m,f=a[t.type];return d.isSkinnedMesh?(u=d.skeleton.bones,n.floatVertexTextures?u=1024:(h=Math.min(Math.floor((n.maxVertexUniforms-20)/4),u.length),h<u.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+u.length+" bones. This GPU supports "+h+"."),u=0):u=h)):u=0,h=n.precision,null!==t.precision&&(h=n.getMaxPrecision(t.precision))!==t.precision&&console.warn("THREE.WebGLProgram.getParameters:",t.precision,"not supported, using",h,"instead."),m=e.getRenderTarget(),{shaderID:f,precision:h,supportsVertexTextures:n.vertexTextures,outputEncoding:o(m?m.texture:null,e.gammaOutput),map:!!t.map,mapEncoding:o(t.map,e.gammaInput),envMap:!!t.envMap,envMapMode:t.envMap&&t.envMap.mapping,envMapEncoding:o(t.envMap,e.gammaInput),envMapCubeUV:!!t.envMap&&(306===t.envMap.mapping||307===t.envMap.mapping),lightMap:!!t.lightMap,aoMap:!!t.aoMap,emissiveMap:!!t.emissiveMap,emissiveMapEncoding:o(t.emissiveMap,e.gammaInput),bumpMap:!!t.bumpMap,normalMap:!!t.normalMap,displacementMap:!!t.displacementMap,roughnessMap:!!t.roughnessMap,metalnessMap:!!t.metalnessMap,specularMap:!!t.specularMap,alphaMap:!!t.alphaMap,gradientMap:!!t.gradientMap,combine:t.combine,vertexColors:t.vertexColors,fog:!!r,useFog:t.fog,fogExp:r&&r.isFogExp2,flatShading:t.flatShading,sizeAttenuation:t.sizeAttenuation,logarithmicDepthBuffer:n.logarithmicDepthBuffer,skinning:t.skinning&&0<u,maxBones:u,useVertexTexture:n.floatVertexTextures,morphTargets:t.morphTargets,morphNormals:t.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:s.directional.length,numPointLights:s.point.length,numSpotLights:s.spot.length,numRectAreaLights:s.rectArea.length,numHemiLights:s.hemi.length,numClippingPlanes:c,numClipIntersection:l,dithering:t.dithering,shadowMapEnabled:e.shadowMap.enabled&&d.receiveShadow&&0<i.length,shadowMapType:e.shadowMap.type,toneMapping:e.toneMapping,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:t.premultipliedAlpha,alphaTest:t.alphaTest,doubleSided:2===t.side,flipSided:1===t.side,depthPacking:void 0!==t.depthPacking&&t.depthPacking}},this.getProgramCode=function(t,n){var o,s=[];if(n.shaderID?s.push(n.shaderID):(s.push(t.fragmentShader),s.push(t.vertexShader)),void 0!==t.defines)for(o in t.defines)s.push(o),s.push(t.defines[o]);for(o=0;o<i.length;o++)s.push(n[i[o]]);return s.push(t.onBeforeCompile.toString()),s.push(e.gammaOutput),s.join()},this.acquireProgram=function(n,o,i,a){for(var r,l,c=0,d=s.length;c<d;c++)if(l=s[c],l.code===a){++(r=l).usedTimes;break}return void 0===r&&(r=new vo(e,t,a,n,o,i),s.push(r)),r},this.releaseProgram=function(e){if(0==--e.usedTimes){var t=s.indexOf(e);s[t]=s[s.length-1],s.pop(),e.destroy()}},this.programs=s}function bo(e,t,n,s,o,i,a){function h(e,t){if(e.width>t||e.height>t){t/=Math.max(e.width,e.height);var n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return n.width=Math.floor(e.width*t),n.height=Math.floor(e.height*t),n.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,n.width,n.height),console.warn("THREE.WebGLRenderer: image is too big ("+e.width+"x"+e.height+"). Resized to "+n.width+"x"+n.height,e),n}return e}function r(e){return d.isPowerOfTwo(e.width)&&d.isPowerOfTwo(e.height)}function c(e,t){return e.generateMipmaps&&t&&1003!==e.minFilter&&1006!==e.minFilter}function m(t){return 1003===t||1004===t||1005===t?e.NEAREST:e.LINEAR}function u(t){(t=t.target).removeEventListener("dispose",u);t:{var n=s.get(t);if(t.image&&n.__image__webglTextureCube)e.deleteTexture(n.__image__webglTextureCube);else{if(void 0===n.__webglInit)break t;e.deleteTexture(n.__webglTexture)}s.remove(t)}a.textures--}function f(t){(t=t.target).removeEventListener("dispose",f);var o=s.get(t),n=s.get(t.texture);if(t){if(void 0!==n.__webglTexture&&e.deleteTexture(n.__webglTexture),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLRenderTargetCube)for(n=0;6>n;n++)e.deleteFramebuffer(o.__webglFramebuffer[n]),o.__webglDepthbuffer&&e.deleteRenderbuffer(o.__webglDepthbuffer[n]);else e.deleteFramebuffer(o.__webglFramebuffer),o.__webglDepthbuffer&&e.deleteRenderbuffer(o.__webglDepthbuffer);s.remove(t.texture),s.remove(t)}a.textures--}function p(t,m){if(j=s.get(t),0<t.version&&j.__version!==t.version)if(void 0===(p=t.image))console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",t);else{if(!1!==p.complete){void 0===j.__webglInit&&(j.__webglInit=!0,t.addEventListener("dispose",u),j.__webglTexture=e.createTexture(),a.textures++),n.activeTexture(e.TEXTURE0+m),n.bindTexture(e.TEXTURE_2D,j.__webglTexture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,t.unpackAlignment),f=h(t.image,o.maxTextureSize),(1001!==t.wrapS||1001!==t.wrapT||1003!==t.minFilter&&1006!==t.minFilter)&&!1===r(f)&&((m=f)instanceof HTMLImageElement||m instanceof HTMLCanvasElement||m instanceof ImageBitmap?((p=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=d.floorPowerOfTwo(m.width),p.height=d.floorPowerOfTwo(m.height),p.getContext("2d").drawImage(m,0,0,p.width,p.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+m.width+"x"+m.height+"). Resized to "+p.width+"x"+p.height,m),f=p):f=m),m=r(f);var f,g,v,j,_,p=i.convert(t.format),y=i.convert(t.type);if(l(e.TEXTURE_2D,t,m),v=t.mipmaps,t.isDepthTexture){if(v=e.DEPTH_COMPONENT,1015===t.type){if(!b)throw Error("Float Depth Texture only supported in WebGL2.0");v=e.DEPTH_COMPONENT32F}else b&&(v=e.DEPTH_COMPONENT16);1026===t.format&&v===e.DEPTH_COMPONENT&&1012!==t.type&&1014!==t.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),t.type=1012,y=i.convert(t.type)),1027===t.format&&(v=e.DEPTH_STENCIL,1020!==t.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),t.type=1020,y=i.convert(t.type))),n.texImage2D(e.TEXTURE_2D,0,v,f.width,f.height,0,p,y,null)}else if(t.isDataTexture)if(0<v.length&&m){for(g=0,_=v.length;g<_;g++)f=v[g],n.texImage2D(e.TEXTURE_2D,g,p,f.width,f.height,0,p,y,f.data);t.generateMipmaps=!1}else n.texImage2D(e.TEXTURE_2D,0,p,f.width,f.height,0,p,y,f.data);else if(t.isCompressedTexture)for(g=0,_=v.length;g<_;g++)f=v[g],1023!==t.format&&1022!==t.format?-1<n.getCompressedTextureFormats().indexOf(p)?n.compressedTexImage2D(e.TEXTURE_2D,g,p,f.width,f.height,0,f.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(e.TEXTURE_2D,g,p,f.width,f.height,0,p,y,f.data);else if(0<v.length&&m){for(g=0,_=v.length;g<_;g++)f=v[g],n.texImage2D(e.TEXTURE_2D,g,p,p,y,f);t.generateMipmaps=!1}else n.texImage2D(e.TEXTURE_2D,0,p,p,y,f);return c(t,m)&&e.generateMipmap(e.TEXTURE_2D),j.__version=t.version,void(t.onUpdate&&t.onUpdate(t))}console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",t)}n.activeTexture(e.TEXTURE0+m),n.bindTexture(e.TEXTURE_2D,j.__webglTexture)}function l(n,a,r){r?(e.texParameteri(n,e.TEXTURE_WRAP_S,i.convert(a.wrapS)),e.texParameteri(n,e.TEXTURE_WRAP_T,i.convert(a.wrapT)),e.texParameteri(n,e.TEXTURE_MAG_FILTER,i.convert(a.magFilter)),e.texParameteri(n,e.TEXTURE_MIN_FILTER,i.convert(a.minFilter))):(e.texParameteri(n,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(n,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),1001===a.wrapS&&1001===a.wrapT||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",a),e.texParameteri(n,e.TEXTURE_MAG_FILTER,m(a.magFilter)),e.texParameteri(n,e.TEXTURE_MIN_FILTER,m(a.minFilter)),1003!==a.minFilter&&1006!==a.minFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",a)),!(r=t.get("EXT_texture_filter_anisotropic"))||1015===a.type&&null===t.get("OES_texture_float_linear")||1016===a.type&&null===t.get("OES_texture_half_float_linear")||!(1<a.anisotropy||s.get(a).__currentAnisotropy)||(e.texParameterf(n,r.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,o.getMaxAnisotropy())),s.get(a).__currentAnisotropy=a.anisotropy)}function g(t,o,a,r){var c=i.convert(o.texture.format),l=i.convert(o.texture.type);n.texImage2D(r,0,c,o.width,o.height,0,c,l,null),e.bindFramebuffer(e.FRAMEBUFFER,t),e.framebufferTexture2D(e.FRAMEBUFFER,a,r,s.get(o.texture).__webglTexture,0),e.bindFramebuffer(e.FRAMEBUFFER,null)}function v(t,n){e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer&&!n.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)):n.depthBuffer&&n.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t)):e.renderbufferStorage(e.RENDERBUFFER,e.RGBA4,n.width,n.height),e.bindRenderbuffer(e.RENDERBUFFER,null)}var b="undefined"!=typeof WebGL2RenderingContext&&e instanceof window.WebGL2RenderingContext;this.setTexture2D=p,this.setTextureCube=function(t,d){if(p=s.get(t),6===t.image.length)if(0<t.version&&p.__version!==t.version){p.__image__webglTextureCube||(t.addEventListener("dispose",u),p.__image__webglTextureCube=e.createTexture(),a.textures++),n.activeTexture(e.TEXTURE0+d),n.bindTexture(e.TEXTURE_CUBE_MAP,p.__image__webglTextureCube),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY),d=t&&t.isCompressedTexture;for(var p,j=t.image[0]&&t.image[0].isDataTexture,g=[],m=0;6>m;m++)g[m]=d||j?j?t.image[m].image:t.image[m]:h(t.image[m],o.maxCubemapSize);var _=r(g[0]),f=i.convert(t.format),y=i.convert(t.type);for(l(e.TEXTURE_CUBE_MAP,t,_),m=0;6>m;m++)if(d)for(var v,w=g[m].mipmaps,b=0,O=w.length;b<O;b++)v=w[b],1023!==t.format&&1022!==t.format?-1<n.getCompressedTextureFormats().indexOf(f)?n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+m,b,f,v.width,v.height,0,v.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+m,b,f,v.width,v.height,0,f,y,v.data);else j?n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+m,0,f,g[m].width,g[m].height,0,f,y,g[m].data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+m,0,f,f,y,g[m]);c(t,_)&&e.generateMipmap(e.TEXTURE_CUBE_MAP),p.__version=t.version,t.onUpdate&&t.onUpdate(t)}else n.activeTexture(e.TEXTURE0+d),n.bindTexture(e.TEXTURE_CUBE_MAP,p.__image__webglTextureCube)},this.setTextureCubeDynamic=function(t,o){n.activeTexture(e.TEXTURE0+o),n.bindTexture(e.TEXTURE_CUBE_MAP,s.get(t).__webglTexture)},this.setupRenderTarget=function(t){var d,u,h,o=s.get(t),i=s.get(t.texture);if(t.addEventListener("dispose",f),i.__webglTexture=e.createTexture(),a.textures++,h=!0===t.isWebGLRenderTargetCube,u=r(t),h){o.__webglFramebuffer=[];for(d=0;6>d;d++)o.__webglFramebuffer[d]=e.createFramebuffer()}else o.__webglFramebuffer=e.createFramebuffer();if(h){for(n.bindTexture(e.TEXTURE_CUBE_MAP,i.__webglTexture),l(e.TEXTURE_CUBE_MAP,t.texture,u),d=0;6>d;d++)g(o.__webglFramebuffer[d],t,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+d);c(t.texture,u)&&e.generateMipmap(e.TEXTURE_CUBE_MAP),n.bindTexture(e.TEXTURE_CUBE_MAP,null)}else n.bindTexture(e.TEXTURE_2D,i.__webglTexture),l(e.TEXTURE_2D,t.texture,u),g(o.__webglFramebuffer,t,e.COLOR_ATTACHMENT0,e.TEXTURE_2D),c(t.texture,u)&&e.generateMipmap(e.TEXTURE_2D),n.bindTexture(e.TEXTURE_2D,null);if(t.depthBuffer){if(o=s.get(t),i=!0===t.isWebGLRenderTargetCube,t.depthTexture){if(i)throw Error("target.depthTexture not supported in Cube render targets");if(t&&t.isWebGLRenderTargetCube)throw Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(e.FRAMEBUFFER,o.__webglFramebuffer),!t.depthTexture||!t.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");if(s.get(t.depthTexture).__webglTexture&&t.depthTexture.image.width===t.width&&t.depthTexture.image.height===t.height||(t.depthTexture.image.width=t.width,t.depthTexture.image.height=t.height,t.depthTexture.needsUpdate=!0),p(t.depthTexture,0),o=s.get(t.depthTexture).__webglTexture,1026===t.depthTexture.format)e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,o,0);else{if(1027!==t.depthTexture.format)throw Error("Unknown depthTexture format");e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,o,0)}}else if(i)for(o.__webglDepthbuffer=[],i=0;6>i;i++)e.bindFramebuffer(e.FRAMEBUFFER,o.__webglFramebuffer[i]),o.__webglDepthbuffer[i]=e.createRenderbuffer(),v(o.__webglDepthbuffer[i],t);else e.bindFramebuffer(e.FRAMEBUFFER,o.__webglFramebuffer),o.__webglDepthbuffer=e.createRenderbuffer(),v(o.__webglDepthbuffer,t);e.bindFramebuffer(e.FRAMEBUFFER,null)}},this.updateRenderTargetMipmap=function(t){var o=t.texture;c(o,r(t))&&(t=t.isWebGLRenderTargetCube?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,o=s.get(o).__webglTexture,n.bindTexture(t,o),e.generateMipmap(t),n.bindTexture(t,null))}}function Bo(){var e={};return{get:function(t){t=t.uuid;var n=e[t];return void 0===n&&(n={},e[t]=n),n},remove:function(t){delete e[t.uuid]},clear:function(){e={}}}}function yo(e,t,n){function F(t,n,s){var i=new Uint8Array(4),o=e.createTexture();for(e.bindTexture(t,o),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST),t=0;t<s;t++)e.texImage2D(n+t,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,i);return o}function s(t){!0!==d[t]&&(e.enable(t),d[t]=!0)}function i(t){!1!==d[t]&&(e.disable(t),d[t]=!1)}function h(t,o,a,r,c,l,d,u){if(0!==t?s(e.BLEND):i(e.BLEND),5!==t){if(t!==p||u!==M)switch(t){case 2:u?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE,e.ONE,e.ONE)):(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE));break;case 3:u?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ZERO,e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ONE_MINUS_SRC_ALPHA)):(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.ONE_MINUS_SRC_COLOR));break;case 4:u?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA)):(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.SRC_COLOR));break;default:u?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA)):(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA))}A=k=E=C=x=v=null}else c=c||o,l=l||a,d=d||r,o===v&&c===E||(e.blendEquationSeparate(n.convert(o),n.convert(c)),v=o,E=c),a===x&&r===C&&l===k&&d===A||(e.blendFuncSeparate(n.convert(a),n.convert(r),n.convert(l),n.convert(d)),x=a,C=r,k=l,A=d);p=t,M=u}function y(t){O!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),O=t)}function N(t){0!==t?(s(e.CULL_FACE),t!==w&&(1===t?e.cullFace(e.BACK):2===t?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):i(e.CULL_FACE),w=t}function L(t,n,o){t?(s(e.POLYGON_OFFSET_FILL),(z!==n||D!==o)&&(e.polygonOffset(n,o),z=n,D=o)):i(e.POLYGON_OFFSET_FILL)}function H(t){void 0===t&&(t=e.TEXTURE0+I-1),r!==t&&(e.activeTexture(t),r=t)}var f=new function(){var t=!1,n=new g,s=null,o=new g(0,0,0,0);return{setMask:function(n){s===n||t||(e.colorMask(n,n,n,n),s=n)},setLocked:function(e){t=e},setClear:function(t,s,i,a,r){!0===r&&(t*=a,s*=a,i*=a),n.set(t,s,i,a),!1===o.equals(n)&&(e.clearColor(t,s,i,a),o.copy(n))},reset:function(){t=!1,s=null,o.set(-1,0,0,0)}}},a=new function(){var t=!1,n=null,o=null,a=null;return{setTest:function(t){t?s(e.DEPTH_TEST):i(e.DEPTH_TEST)},setMask:function(s){n===s||t||(e.depthMask(s),n=s)},setFunc:function(t){if(o!==t){if(t)switch(t){case 0:e.depthFunc(e.NEVER);break;case 1:e.depthFunc(e.ALWAYS);break;case 2:e.depthFunc(e.LESS);break;case 3:default:e.depthFunc(e.LEQUAL);break;case 4:e.depthFunc(e.EQUAL);break;case 5:e.depthFunc(e.GEQUAL);break;case 6:e.depthFunc(e.GREATER);break;case 7:e.depthFunc(e.NOTEQUAL)}else e.depthFunc(e.LEQUAL);o=t}},setLocked:function(e){t=e},setClear:function(t){a!==t&&(e.clearDepth(t),a=t)},reset:function(){t=!1,a=o=n=null}}},S=new function(){var t=!1,n=null,o=null,a=null,r=null,c=null,l=null,d=null,u=null;return{setTest:function(t){t?s(e.STENCIL_TEST):i(e.STENCIL_TEST)},setMask:function(s){n===s||t||(e.stencilMask(s),n=s)},setFunc:function(t,n,s){o===t&&a===n&&r===s||(e.stencilFunc(t,n,s),o=t,a=n,r=s)},setOp:function(t,n,s){c===t&&l===n&&d===s||(e.stencilOp(t,n,s),c=t,l=n,d=s)},setLocked:function(e){t=e},setClear:function(t){u!==t&&(e.clearStencil(t),u=t)},reset:function(){t=!1,u=d=l=c=r=a=o=n=null}}},u=e.getParameter(e.MAX_VERTEX_ATTRIBS),c=new Uint8Array(u),o=new Uint8Array(u),m=new Uint8Array(u),d={},l=null,_=null,p=null,v=null,x=null,C=null,E=null,k=null,A=null,M=!1,O=null,w=null,T=null,z=null,D=null,I=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),B=(u=parseFloat(/^WebGL ([0-9])/.exec(e.getParameter(e.VERSION))[1]),1<=parseFloat(u)),r=null,j={},R=new g,P=new g,b={};return b[e.TEXTURE_2D]=F(e.TEXTURE_2D,e.TEXTURE_2D,1),b[e.TEXTURE_CUBE_MAP]=F(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),f.setClear(0,0,0,1),a.setClear(1),S.setClear(0),s(e.DEPTH_TEST),a.setFunc(3),y(!1),N(1),s(e.CULL_FACE),s(e.BLEND),h(1),{buffers:{color:f,depth:a,stencil:S},initAttributes:function(){for(var e=0,t=c.length;e<t;e++)c[e]=0},enableAttribute:function(n){c[n]=1,0===o[n]&&(e.enableVertexAttribArray(n),o[n]=1),0!==m[n]&&(t.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(n,0),m[n]=0)},enableAttributeAndDivisor:function(n,s){c[n]=1,0===o[n]&&(e.enableVertexAttribArray(n),o[n]=1),m[n]!==s&&(t.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(n,s),m[n]=s)},disableUnusedAttributes:function(){for(var t=0,n=o.length;t!==n;++t)o[t]!==c[t]&&(e.disableVertexAttribArray(t),o[t]=0)},enable:s,disable:i,getCompressedTextureFormats:function(){if(null===l&&(l=[],t.get("WEBGL_compressed_texture_pvrtc")||t.get("WEBGL_compressed_texture_s3tc")||t.get("WEBGL_compressed_texture_etc1")))for(var s=e.getParameter(e.COMPRESSED_TEXTURE_FORMATS),n=0;n<s.length;n++)l.push(s[n]);return l},useProgram:function(t){return _!==t&&(e.useProgram(t),_=t,!0)},setBlending:h,setMaterial:function(t){2===t.side?i(e.CULL_FACE):s(e.CULL_FACE),y(1===t.side),!0===t.transparent?h(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha):h(0),a.setFunc(t.depthFunc),a.setTest(t.depthTest),a.setMask(t.depthWrite),f.setMask(t.colorWrite),L(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:y,setCullFace:N,setLineWidth:function(t){t!==T&&(B&&e.lineWidth(t),T=t)},setPolygonOffset:L,setScissorTest:function(t){t?s(e.SCISSOR_TEST):i(e.SCISSOR_TEST)},activeTexture:H,bindTexture:function(t,n){null===r&&H();var s=j[r];void 0===s&&(s={type:void 0,texture:void 0},j[r]=s),s.type===t&&s.texture===n||(e.bindTexture(t,n||b[t]),s.type=t,s.texture=n)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===R.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),R.copy(t))},viewport:function(t){!1===P.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),P.copy(t))},reset:function(){for(var t=0;t<o.length;t++)1===o[t]&&(e.disableVertexAttribArray(t),o[t]=0);d={},r=l=null,j={},w=O=p=_=null,f.reset(),a.reset(),S.reset()}}}function Eo(e,t,n){function l(t){if("highp"===t){if(0<e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision&&0<e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision)return"highp";t="mediump"}return"mediump"===t&&0<e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision&&0<e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision?"mediump":"lowp"}s=void 0!==n.precision?n.precision:"highp",(o=l(s))!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",o,"instead."),s=o),n=!0===n.logarithmicDepthBuffer;var s,i,o=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),r=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),p=e.getParameter(e.MAX_TEXTURE_SIZE),d=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),f=e.getParameter(e.MAX_VERTEX_ATTRIBS),u=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),h=e.getParameter(e.MAX_VARYING_VECTORS),m=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),a=0<r,c=!!t.get("OES_texture_float");return{getMaxAnisotropy:function(){if(void 0!==i)return i;var n=t.get("EXT_texture_filter_anisotropic");return i=null!==n?e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:l,precision:s,logarithmicDepthBuffer:n,maxTextures:o,maxVertexTextures:r,maxTextureSize:p,maxCubemapSize:d,maxAttributes:f,maxVertexUniforms:u,maxVaryings:h,maxFragmentUniforms:m,vertexTextures:a,floatFragmentTextures:c,floatVertexTextures:a&&c}}function _(e,t,n,s){K.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==s?s:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function yn(e){_.call(this),this.cameras=e||[]}function No(e){function u(){if(null!==t&&t.isPresenting){var s=(n=t.getEyeParameters("left")).renderWidth,n=n.renderHeight,h=e.getPixelRatio(),d=e.getSize();e.setDrawingBufferSize(2*s,n,1)}else m.enabled&&e.setDrawingBufferSize(d.width,d.height,h)}var m=this,t=null,o=null;"undefined"!=typeof window&&"VRFrameData"in window&&(o=new window.VRFrameData);var s,i,d,h,l=new c,a=new c,r=new c,n=new _;n.bounds=new g(0,0,.5,1),n.layers.enable(1),s=new _,s.bounds=new g(.5,0,.5,1),s.layers.enable(2),i=new yn([n,s]),i.layers.enable(1),i.layers.enable(2),"undefined"!=typeof window&&window.addEventListener("vrdisplaypresentchange",u,!1),this.standing=this.enabled=!1,this.getDevice=function(){return t},this.setDevice=function(e){void 0!==e&&(t=e)},this.getCamera=function(e){if(null===t)return e;t.depthNear=e.near,t.depthFar=e.far,t.getFrameData(o);var c=o.pose;return null!==c.position?e.position.fromArray(c.position):e.position.set(0,0,0),null!==c.orientation&&e.quaternion.fromArray(c.orientation),e.updateMatrixWorld(),c=t.stageParameters,this.standing&&c&&(a.fromArray(c.sittingToStandingTransform),r.getInverse(a),e.matrixWorld.multiply(a),e.matrixWorldInverse.multiply(r)),!1===t.isPresenting?e:(n.near=e.near,s.near=e.near,n.far=e.far,s.far=e.far,i.matrixWorld.copy(e.matrixWorld),i.matrixWorldInverse.copy(e.matrixWorldInverse),n.matrixWorldInverse.fromArray(o.leftViewMatrix),s.matrixWorldInverse.fromArray(o.rightViewMatrix),this.standing&&c&&(n.matrixWorldInverse.multiply(r),s.matrixWorldInverse.multiply(r)),null!==(e=e.parent)&&(l.getInverse(e.matrixWorld),n.matrixWorldInverse.multiply(l),s.matrixWorldInverse.multiply(l)),n.matrixWorld.getInverse(n.matrixWorldInverse),s.matrixWorld.getInverse(s.matrixWorldInverse),n.projectionMatrix.fromArray(o.leftProjectionMatrix),s.projectionMatrix.fromArray(o.rightProjectionMatrix),i.projectionMatrix.copy(n.projectionMatrix),(e=t.getLayers()).length&&(null!==(e=e[0]).leftBounds&&4===e.leftBounds.length&&n.bounds.fromArray(e.leftBounds),null!==e.rightBounds&&4===e.rightBounds.length&&s.bounds.fromArray(e.rightBounds)),i)},this.getStandingMatrix=function(){return a},this.submitFrame=function(){t&&t.isPresenting&&t.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",u)}}function Go(e){var t={};return{get:function(n){if(void 0!==t[n])return t[n];switch(n){case"WEBGL_depth_texture":var s=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":s=e.getExtension("WEBGL_compressed_texture_etc1");break;default:s=e.getExtension(n)}return null===s&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),t[n]=s}}}function oi(){function c(){e.value!==o&&(e.value=o,e.needsUpdate=0<t),i.numPlanes=t,i.numIntersection=0}function s(t,n,s,o){var c=null!==t?t.length:0,a=null;if(0!==c){if(a=e.value,!0!==o||null===a)for(o=s+4*c,n=n.matrixWorldInverse,l.getNormalMatrix(n),(null===a||a.length<o)&&(a=new Float32Array(o)),o=0;o!==c;++o,s+=4)r.copy(t[o]).applyMatrix4(n,l),r.normal.toArray(a,s),a[s+3]=r.constant;e.value=a,e.needsUpdate=!0}return i.numPlanes=c,a}var i=this,o=null,t=0,a=!1,n=!1,r=new L,l=new A,e={value:null,needsUpdate:!1};this.uniform=e,this.numIntersection=this.numPlanes=0,this.init=function(e,n,i){var r=0!==e.length||n||0!==t||a;return a=n,o=s(e,i,0),t=e.length,r},this.beginShadows=function(){n=!0,s(null)},this.endShadows=function(){n=!1,c()},this.setState=function(i,r,l,d,u,h){if(!a||null===i||0===i.length||n&&!l)n?s(null):c();else{var f=4*(l=n?0:t),m=u.clippingState||null;for(e.value=m,m=s(i,d,f,h),i=0;i!==f;++i)m[i]=o[i];u.clippingState=m,this.numIntersection=r?this.numPlanes:0,this.numPlanes+=l}}}function Fs(e,t){return{convert:function(n){if(1e3===n)return e.REPEAT;if(1001===n)return e.CLAMP_TO_EDGE;if(1002===n)return e.MIRRORED_REPEAT;if(1003===n)return e.NEAREST;if(1004===n)return e.NEAREST_MIPMAP_NEAREST;if(1005===n)return e.NEAREST_MIPMAP_LINEAR;if(1006===n)return e.LINEAR;if(1007===n)return e.LINEAR_MIPMAP_NEAREST;if(1008===n)return e.LINEAR_MIPMAP_LINEAR;if(1009===n)return e.UNSIGNED_BYTE;if(1017===n)return e.UNSIGNED_SHORT_4_4_4_4;if(1018===n)return e.UNSIGNED_SHORT_5_5_5_1;if(1019===n)return e.UNSIGNED_SHORT_5_6_5;if(1010===n)return e.BYTE;if(1011===n)return e.SHORT;if(1012===n)return e.UNSIGNED_SHORT;if(1013===n)return e.INT;if(1014===n)return e.UNSIGNED_INT;if(1015===n)return e.FLOAT;if(1016===n){var s=t.get("OES_texture_half_float");if(null!==s)return s.HALF_FLOAT_OES}if(1021===n)return e.ALPHA;if(1022===n)return e.RGB;if(1023===n)return e.RGBA;if(1024===n)return e.LUMINANCE;if(1025===n)return e.LUMINANCE_ALPHA;if(1026===n)return e.DEPTH_COMPONENT;if(1027===n)return e.DEPTH_STENCIL;if(100===n)return e.FUNC_ADD;if(101===n)return e.FUNC_SUBTRACT;if(102===n)return e.FUNC_REVERSE_SUBTRACT;if(200===n)return e.ZERO;if(201===n)return e.ONE;if(202===n)return e.SRC_COLOR;if(203===n)return e.ONE_MINUS_SRC_COLOR;if(204===n)return e.SRC_ALPHA;if(205===n)return e.ONE_MINUS_SRC_ALPHA;if(206===n)return e.DST_ALPHA;if(207===n)return e.ONE_MINUS_DST_ALPHA;if(208===n)return e.DST_COLOR;if(209===n)return e.ONE_MINUS_DST_COLOR;if(210===n)return e.SRC_ALPHA_SATURATE;if((2001===n||2002===n||2003===n||2004===n)&&null!==(s=t.get("WEBGL_compressed_texture_s3tc"))){if(2001===n)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(2002===n)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(2003===n)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(2004===n)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((2100===n||2101===n||2102===n||2103===n)&&null!==(s=t.get("WEBGL_compressed_texture_pvrtc"))){if(2100===n)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(2101===n)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(2102===n)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(2103===n)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(2151===n&&null!==(s=t.get("WEBGL_compressed_texture_etc1")))return s.COMPRESSED_RGB_ETC1_WEBGL;if((103===n||104===n)&&null!==(s=t.get("EXT_blend_minmax"))){if(103===n)return s.MIN_EXT;if(104===n)return s.MAX_EXT}return 1020===n&&null!==(s=t.get("WEBGL_depth_texture"))?s.UNSIGNED_INT_24_8_WEBGL:0}}}function ts(e){function be(){(i=new Go(n)).get("WEBGL_depth_texture"),i.get("OES_texture_float"),i.get("OES_texture_float_linear"),i.get("OES_texture_half_float"),i.get("OES_texture_half_float_linear"),i.get("OES_standard_derivatives"),i.get("OES_element_index_uint"),i.get("ANGLE_instanced_arrays"),C=new Fs(n,i),f=new Eo(n,i,e),(s=new yo(n,i,C)).scissor(T.copy(V).multiplyScalar(l)),s.viewport(x.copy(W).multiplyScalar(l)),h=new Bo,b=new bo(n,i,s,h,f,C,ee),P=new Wo(n),H=new $o(n,P,ee),ne=new Vo(H,y),ce=new xo(n),S=new _o(o,i,f),a=new ii,$=new ai,_=new zo(o,s,H,pe),we=new ui(n,i,y),ue=new Oo(n,i,y),de=new ri(o,n,s,b,f),ye=new si(o,n,s,b,f),o.info.programs=S.programs,o.context=n,o.capabilities=f,o.extensions=i,o.properties=h,o.renderLists=$,o.state=s}function le(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),Z=!0}function he(){console.log("THREE.WebGLRenderer: Context Restored."),Z=!1,be()}function ve(e){(e=e.target).removeEventListener("dispose",ve),Oe(e),h.remove(e)}function Oe(e){var t=h.get(e).program;e.program=void 0,void 0!==t&&S.releaseProgram(t)}function z(e){null!==Y&&Y(e),(e=v.getDevice())&&e.isPresenting?e.requestAnimationFrame(z):window.requestAnimationFrame(z)}function re(e,t,n){if(!1!==e.visible){if(e.layers.test(t.layers))if(e.isLight)M.push(e),e.castShadow&&O.push(e);else if(e.isSprite)e.frustumCulled&&!ae.intersectsSprite(e)||oe.push(e);else if(e.isLensFlare)se.push(e);else if(e.isImmediateRenderObject)n&&A.setFromMatrixPosition(e.matrixWorld).applyMatrix4(N),w.push(e,null,e.material,A.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.update(),!e.frustumCulled||ae.intersectsObject(e)))if(n&&A.setFromMatrixPosition(e.matrixWorld).applyMatrix4(N),i=ne.update(e),o=e.material,Array.isArray(o))for(var o,i,a,c,l=i.groups,s=0,r=l.length;s<r;s++)c=l[s],a=o[c.materialIndex],a&&a.visible&&w.push(e,i,a,A.z,c);else o.visible&&w.push(e,i,o,A.z,null);for(s=0,r=(e=e.children).length;s<r;s++)re(e[s],t,n)}}function I(e,t,n,o){for(r=0,h=e.length;r<h;r++){var a,r,c,h,d=(i=e[r]).object,f=i.geometry,p=void 0===o?i.material:o,i=i.group;if(n.isArrayCamera){L=n;for(var g=n.cameras,u=0,v=g.length;u<v;u++)c=g[u],d.layers.test(c.layers)&&(a=c.bounds,s.viewport(x.set(a.x*j,a.y*m,a.z*j,a.w*m).multiplyScalar(l)),je(d,t,c,f,p,i))}else L=null,je(d,t,n,f,p,i)}}function je(e,t,n,i,a,r){if(e.onBeforeRender(o,t,n,i,a,r),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){s.setMaterial(a);var c=ge(n,t.fog,a,e),D="";(function(e,t,n){e.render(function(e){o.renderBufferImmediate(e,t,n)})})(e,c,a)}else o.renderBufferDirect(n,t.fog,i,a,e,r);e.onAfterRender(o,t,n,i,a,r)}function ie(e,t,n){s=h.get(e),n=S.getParameters(e,a.state,O,t,p.numPlanes,p.numIntersection,n);var s,i=S.getProgramCode(e,n),r=s.program,c=!0;if(void 0===r)e.addEventListener("dispose",ve);else if(r.code!==i)Oe(e);else{if(void 0!==n.shaderID)return;c=!1}if(c&&(n.shaderID?(r=Fe[n.shaderID],s.shader={name:e.type,uniforms:E.clone(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader}):s.shader={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader},e.onBeforeCompile(s.shader),r=S.acquireProgram(e,s.shader,n,i),s.program=r,e.program=r),n=r.getAttributes(),e.morphTargets)for(i=e.numSupportedMorphTargets=0;i<o.maxMorphTargets;i++)0<=n["morphTarget"+i]&&e.numSupportedMorphTargets++;if(e.morphNormals)for(i=e.numSupportedMorphNormals=0;i<o.maxMorphNormals;i++)0<=n["morphNormal"+i]&&e.numSupportedMorphNormals++;n=s.shader.uniforms,(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(s.numClippingPlanes=p.numPlanes,s.numIntersection=p.numIntersection,n.clippingPlanes=p.uniform),s.fog=t,s.lightsHash=a.state.hash,e.lights&&(n.ambientLightColor.value=a.state.ambient,n.directionalLights.value=a.state.directional,n.spotLights.value=a.state.spot,n.rectAreaLights.value=a.state.rectArea,n.pointLights.value=a.state.point,n.hemisphereLights.value=a.state.hemi,n.directionalShadowMap.value=a.state.directionalShadowMap,n.directionalShadowMatrix.value=a.state.directionalShadowMatrix,n.spotShadowMap.value=a.state.spotShadowMap,n.spotShadowMatrix.value=a.state.spotShadowMatrix,n.pointShadowMap.value=a.state.pointShadowMap,n.pointShadowMatrix.value=a.state.pointShadowMatrix),e=s.program.getUniforms(),e=_e.seqWithValue(e.seq,n),s.uniformsList=e}function ge(e,t,i,c){X=0,j=h.get(i),R&&(te||e!==F)&&p.setState(i.clippingPlanes,i.clipIntersection,i.clipShadows,e,j,e===F&&i.id===U),!1===i.needsUpdate&&(void 0===j.program||i.fog&&j.fog!==t||i.lights&&j.lightsHash!==a.state.hash?i.needsUpdate=!0:void 0===j.numClippingPlanes||j.numClippingPlanes===p.numPlanes&&j.numIntersection===p.numIntersection||(i.needsUpdate=!0)),i.needsUpdate&&(ie(i,t,c),i.needsUpdate=!1);var j,_,O,g=!1,v=!1,y=!1,w=j.program,b=w.getUniforms(),u=j.shader.uniforms;return(s.useProgram(w.program)&&(y=v=g=!0),i.id!==U&&(U=i.id,v=!0),(g||e!==F)&&(b.setValue(n,"projectionMatrix",e.projectionMatrix),f.logarithmicDepthBuffer&&b.setValue(n,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),F!==(L||e)&&(F=L||e,y=v=!0),(i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshStandardMaterial||i.envMap)&&void 0!==(g=b.map.cameraPosition)&&g.setValue(n,A.setFromMatrixPosition(e.matrixWorld)),(i.isMeshPhongMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.skinning)&&b.setValue(n,"viewMatrix",e.matrixWorldInverse)),i.skinning&&(b.setOptional(n,c,"bindMatrix"),b.setOptional(n,c,"bindMatrixInverse"),e=c.skeleton))&&(g=e.bones,f.floatVertexTextures?(void 0===e.boneTexture&&(g=Math.sqrt(4*g.length),g=d.ceilPowerOfTwo(g),g=Math.max(g,4),_=new Float32Array(g*g*4),_.set(e.boneMatrices),O=new De(_,g,g,1023,1015),e.boneMatrices=_,e.boneTexture=O,e.boneTextureSize=g),b.setValue(n,"boneTexture",e.boneTexture),b.setValue(n,"boneTextureSize",e.boneTextureSize)):b.setOptional(n,e,"boneMatrices")),v&&(b.setValue(n,"toneMappingExposure",o.toneMappingExposure),b.setValue(n,"toneMappingWhitePoint",o.toneMappingWhitePoint),i.lights&&(v=y,u.ambientLightColor.needsUpdate=v,u.directionalLights.needsUpdate=v,u.pointLights.needsUpdate=v,u.spotLights.needsUpdate=v,u.rectAreaLights.needsUpdate=v,u.hemisphereLights.needsUpdate=v),t&&i.fog&&(u.fogColor.value=t.color,t.isFog?(u.fogNear.value=t.near,u.fogFar.value=t.far):t.isFogExp2&&(u.fogDensity.value=t.density)),i.isMeshBasicMaterial?k(u,i):i.isMeshLambertMaterial?(k(u,i),i.emissiveMap&&(u.emissiveMap.value=i.emissiveMap)):i.isMeshPhongMaterial?(k(u,i),i.isMeshToonMaterial?(me(u,i),i.gradientMap&&(u.gradientMap.value=i.gradientMap)):me(u,i)):i.isMeshStandardMaterial?(k(u,i),i.isMeshPhysicalMaterial&&(u.clearCoat.value=i.clearCoat,u.clearCoatRoughness.value=i.clearCoatRoughness),u.roughness.value=i.roughness,u.metalness.value=i.metalness,i.roughnessMap&&(u.roughnessMap.value=i.roughnessMap),i.metalnessMap&&(u.metalnessMap.value=i.metalnessMap),i.emissiveMap&&(u.emissiveMap.value=i.emissiveMap),i.bumpMap&&(u.bumpMap.value=i.bumpMap,u.bumpScale.value=i.bumpScale),i.normalMap&&(u.normalMap.value=i.normalMap,u.normalScale.value.copy(i.normalScale)),i.displacementMap&&(u.displacementMap.value=i.displacementMap,u.displacementScale.value=i.displacementScale,u.displacementBias.value=i.displacementBias),i.envMap&&(u.envMapIntensity.value=i.envMapIntensity)):i.isMeshDepthMaterial?(k(u,i),i.displacementMap&&(u.displacementMap.value=i.displacementMap,u.displacementScale.value=i.displacementScale,u.displacementBias.value=i.displacementBias)):i.isMeshDistanceMaterial?(k(u,i),i.displacementMap&&(u.displacementMap.value=i.displacementMap,u.displacementScale.value=i.displacementScale,u.displacementBias.value=i.displacementBias),u.referencePosition.value.copy(i.referencePosition),u.nearDistance.value=i.nearDistance,u.farDistance.value=i.farDistance):i.isMeshNormalMaterial?(k(u,i),i.bumpMap&&(u.bumpMap.value=i.bumpMap,u.bumpScale.value=i.bumpScale),i.normalMap&&(u.normalMap.value=i.normalMap,u.normalScale.value.copy(i.normalScale)),i.displacementMap&&(u.displacementMap.value=i.displacementMap,u.displacementScale.value=i.displacementScale,u.displacementBias.value=i.displacementBias)):i.isLineBasicMaterial?(u.diffuse.value=i.color,u.opacity.value=i.opacity,i.isLineDashedMaterial&&(u.dashSize.value=i.dashSize,u.totalSize.value=i.dashSize+i.gapSize,u.scale.value=i.scale)):i.isPointsMaterial?(u.diffuse.value=i.color,u.opacity.value=i.opacity,u.size.value=i.size*l,u.scale.value=.5*m,u.map.value=i.map,null!==i.map&&(!0===i.map.matrixAutoUpdate&&(t=i.map.offset,v=i.map.repeat,y=i.map.center,i.map.matrix.setUvTransform(t.x,t.y,v.x,v.y,i.map.rotation,y.x,y.y)),u.uvTransform.value.copy(i.map.matrix))):i.isShadowMaterial&&(u.color.value=i.color,u.opacity.value=i.opacity),void 0!==u.ltcMat&&(u.ltcMat.value=r.LTC_MAT_TEXTURE),void 0!==u.ltcMag&&(u.ltcMag.value=r.LTC_MAG_TEXTURE),_e.upload(n,j.uniformsList,u,o)),b.setValue(n,"modelViewMatrix",c.modelViewMatrix),b.setValue(n,"normalMatrix",c.normalMatrix),b.setValue(n,"modelMatrix",c.matrixWorld),w}function k(e,t){if(e.opacity.value=t.opacity,t.color&&(e.diffuse.value=t.color),t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity),t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.specularMap&&(e.specularMap.value=t.specularMap),t.envMap&&(e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap&&t.envMap.isCubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity),t.map?(n=t.map):t.specularMap?n=t.specularMap:t.displacementMap?n=t.displacementMap:t.normalMap?n=t.normalMap:t.bumpMap?n=t.bumpMap:t.roughnessMap?n=t.roughnessMap:t.metalnessMap?n=t.metalnessMap:t.alphaMap?n=t.alphaMap:t.emissiveMap&&(n=t.emissiveMap),void 0!==n){if(n.isWebGLRenderTarget&&(n=n.texture),!0===n.matrixAutoUpdate){t=n.offset;var n,s=n.repeat,o=n.center;n.matrix.setUvTransform(t.x,t.y,s.x,s.y,n.rotation,o.x,o.y)}e.uvTransform.value.copy(n.matrix)}}function me(e,t){e.specular.value=t.specular,e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale)),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}console.log("THREE.WebGLRenderer","88");var u=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),Ce=void 0!==e.context?e.context:null,B=void 0!==e.alpha&&e.alpha,Ee=void 0===e.depth||e.depth,ke=void 0===e.stencil||e.stencil,Ae=void 0!==e.antialias&&e.antialias,pe=void 0===e.premultipliedAlpha||e.premultipliedAlpha,xe=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,M=[],O=[],w=null,oe=[],se=[];this.domElement=u,this.context=null,this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.physicallyCorrectLights=this.gammaOutput=this.gammaInput=!1,this.toneMappingWhitePoint=this.toneMappingExposure=this.toneMapping=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var n,s,i,a,h,f,v,b,_,C,S,P,H,$,Y,Q,J,ne,ce,we,ue,de,ye,o=this,Z=!1,q=null,K=null,U=-1,D="",F=null,L=null,x=new g,T=new g,G=null,X=0,j=u.width,m=u.height,l=1,W=new g(0,0,j,m),V=new g(0,0,j,m),fe=!1,ae=new jn,p=new oi,R=!1,te=!1,N=new c,A=new t,ee={geometries:0,textures:0},y={frame:0,calls:0,vertices:0,faces:0,points:0};this.info={render:y,memory:ee,programs:null};try{if(B={alpha:B,depth:Ee,stencil:ke,antialias:Ae,premultipliedAlpha:pe,preserveDrawingBuffer:xe},n=Ce||u.getContext("webgl",B)||u.getContext("experimental-webgl",B),null===n)throw null!==u.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context.";void 0===n.getShaderPrecisionFormat&&(n.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),u.addEventListener("webglcontextlost",le,!1),u.addEventListener("webglcontextrestored",he,!1)}catch(e){console.error("THREE.WebGLRenderer: "+e)}be(),v=new No(o),this.vr=v,J=new Is(o,ne,f.maxTextureSize),this.shadowMap=J,this.getContext=function(){return n},this.getContextAttributes=function(){return n.getContextAttributes()},this.forceContextLoss=function(){var e=i.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=i.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return l},this.setPixelRatio=function(e){void 0!==e&&(l=e,this.setSize(j,m,!1))},this.getSize=function(){return{width:j,height:m}},this.setSize=function(e,t,n){var s=v.getDevice();s&&s.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(j=e,m=t,u.width=e*l,u.height=t*l,!1!==n&&(u.style.width=e+"px",u.style.height=t+"px"),this.setViewport(0,0,e,t))},this.getDrawingBufferSize=function(){return{width:j*l,height:m*l}},this.setDrawingBufferSize=function(e,t,n){j=e,m=t,l=n,u.width=e*n,u.height=t*n,this.setViewport(0,0,e,t)},this.setViewport=function(e,t,n,o){W.set(e,m-t-o,n,o),s.viewport(x.copy(W).multiplyScalar(l))},this.setScissor=function(e,t,n,o){V.set(e,m-t-o,n,o),s.scissor(T.copy(V).multiplyScalar(l))},this.setScissorTest=function(e){s.setScissorTest(fe=e)},this.getClearColor=function(){return _.getClearColor()},this.setClearColor=function(){_.setClearColor.apply(_,arguments)},this.getClearAlpha=function(){return _.getClearAlpha()},this.setClearAlpha=function(){_.setClearAlpha.apply(_,arguments)},this.clear=function(e,t,s){var o=0;(void 0===e||e)&&(o|=n.COLOR_BUFFER_BIT),(void 0===t||t)&&(o|=n.DEPTH_BUFFER_BIT),(void 0===s||s)&&(o|=n.STENCIL_BUFFER_BIT),n.clear(o)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(e,t,n,s){this.setRenderTarget(e),this.clear(t,n,s)},this.dispose=function(){u.removeEventListener("webglcontextlost",le,!1),u.removeEventListener("webglcontextrestored",he,!1),$.dispose(),v.dispose()},this.renderBufferImmediate=function(e,t,o){if(s.initAttributes(),r=h.get(e),e.hasPositions&&!r.position&&(r.position=n.createBuffer()),e.hasNormals&&!r.normal&&(r.normal=n.createBuffer()),e.hasUvs&&!r.uv&&(r.uv=n.createBuffer()),e.hasColors&&!r.color&&(r.color=n.createBuffer()),t=t.getAttributes(),e.hasPositions&&(n.bindBuffer(n.ARRAY_BUFFER,r.position),n.bufferData(n.ARRAY_BUFFER,e.positionArray,n.DYNAMIC_DRAW),s.enableAttribute(t.position),n.vertexAttribPointer(t.position,3,n.FLOAT,!1,0,0)),e.hasNormals){if(n.bindBuffer(n.ARRAY_BUFFER,r.normal),!o.isMeshPhongMaterial&&!o.isMeshStandardMaterial&&!o.isMeshNormalMaterial&&!0===o.flatShading)for(i=0,u=3*e.count;i<u;i+=9){var i,r,u,a=e.normalArray,c=(a[i+0]+a[i+3]+a[i+6])/3,l=(a[i+1]+a[i+4]+a[i+7])/3,d=(a[i+2]+a[i+5]+a[i+8])/3;a[i+0]=c,a[i+1]=l,a[i+2]=d,a[i+3]=c,a[i+4]=l,a[i+5]=d,a[i+6]=c,a[i+7]=l,a[i+8]=d}n.bufferData(n.ARRAY_BUFFER,e.normalArray,n.DYNAMIC_DRAW),s.enableAttribute(t.normal),n.vertexAttribPointer(t.normal,3,n.FLOAT,!1,0,0)}e.hasUvs&&o.map&&(n.bindBuffer(n.ARRAY_BUFFER,r.uv),n.bufferData(n.ARRAY_BUFFER,e.uvArray,n.DYNAMIC_DRAW),s.enableAttribute(t.uv),n.vertexAttribPointer(t.uv,2,n.FLOAT,!1,0,0)),e.hasColors&&0!==o.vertexColors&&(n.bindBuffer(n.ARRAY_BUFFER,r.color),n.bufferData(n.ARRAY_BUFFER,e.colorArray,n.DYNAMIC_DRAW),s.enableAttribute(t.color),n.vertexAttribPointer(t.color,3,n.FLOAT,!1,0,0)),s.disableUnusedAttributes(),n.drawArrays(n.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,o,a,r,c){if(s.setMaterial(a),b=ge(e,t,a,r),m=!1,(e=o.id+"_"+b.id+"_"+(!0===a.wireframe))!==D&&(D=e,m=!0),r.morphTargetInfluences&&(ce.update(r,o,a,b),m=!0),h=o.index,y=o.attributes.position,(t=1,!0===a.wireframe&&(h=H.getWireframeAttribute(o),t=2),e=we,null!==h)&&(g=P.get(h),(e=ue).setIndex(g)),m){if(m=void 0,o&&o.isInstancedBufferGeometry&&null===i.get("ANGLE_instanced_arrays"))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{void 0===m&&(m=0),s.initAttributes(),O=o.attributes,w=(b=b.getAttributes(),a.defaultAttributeValues);for(p in b)if(d=b[p],0<=d)if(void 0!==(u=O[p])){if(f=u.normalized,_=u.itemSize,void 0!==(v=P.get(u))){var d,h,m,f,p,g,b,y,_,w,O,x=v.buffer,C=v.type,v=v.bytesPerElement;if(u.isInterleavedBufferAttribute){var j=u.data,E=j.stride,u=u.offset;j&&j.isInstancedInterleavedBuffer?(s.enableAttributeAndDivisor(d,j.meshPerAttribute),void 0===o.maxInstancedCount&&(o.maxInstancedCount=j.meshPerAttribute*j.count)):s.enableAttribute(d),n.bindBuffer(n.ARRAY_BUFFER,x),n.vertexAttribPointer(d,_,C,f,E*v,(m*E+u)*v)}else u.isInstancedBufferAttribute?(s.enableAttributeAndDivisor(d,u.meshPerAttribute),void 0===o.maxInstancedCount&&(o.maxInstancedCount=u.meshPerAttribute*u.count)):s.enableAttribute(d),n.bindBuffer(n.ARRAY_BUFFER,x),n.vertexAttribPointer(d,_,C,f,0,m*_*v)}}else if(void 0!==w&&void 0!==(f=w[p]))switch(f.length){case 2:n.vertexAttrib2fv(d,f);break;case 3:n.vertexAttrib3fv(d,f);break;case 4:n.vertexAttrib4fv(d,f);break;default:n.vertexAttrib1fv(d,f)}s.disableUnusedAttributes()}null!==h&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,g.buffer)}if(g=0,null!==h?g=h.count:void 0!==y&&(g=y.count),h=o.drawRange.start*t,y=null!==c?c.start*t:0,p=Math.max(h,y),0!==(c=Math.max(0,Math.min(g,h+o.drawRange.count*t,y+(null!==c?c.count*t:1/0))-1-p+1))){if(r.isMesh)if(!0===a.wireframe)s.setLineWidth(a.wireframeLinewidth*(null===q?l:1)),e.setMode(n.LINES);else switch(r.drawMode){case 0:e.setMode(n.TRIANGLES);break;case 1:e.setMode(n.TRIANGLE_STRIP);break;case 2:e.setMode(n.TRIANGLE_FAN)}else r.isLine?(void 0===(a=a.linewidth)&&(a=1),s.setLineWidth(a*(null===q?l:1)),r.isLineSegments?e.setMode(n.LINES):r.isLineLoop?e.setMode(n.LINE_LOOP):e.setMode(n.LINE_STRIP)):r.isPoints&&e.setMode(n.POINTS);o&&o.isInstancedBufferGeometry?0<o.maxInstancedCount&&e.renderInstances(o,p,c):e.render(p,c)}},this.compile=function(e,t){M.length=0,O.length=0,e.traverse(function(e){e.isLight&&(M.push(e),e.castShadow&&O.push(e))}),a.setup(M,O,t),e.traverse(function(t){if(t.material)if(Array.isArray(t.material))for(var n=0;n<t.material.length;n++)ie(t.material[n],e.fog,t);else ie(t.material,e.fog,t)})},Q=!1,Y=null,this.animate=function(e){Y=e,Q||((e=v.getDevice())&&e.isPresenting?e.requestAnimationFrame(z):window.requestAnimationFrame(z),Q=!0)},this.render=function(e,t,n,i){if(t&&t.isCamera){if(!Z){D="",U=-1,F=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),v.enabled&&(t=v.getCamera(t)),N.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),ae.setFromMatrix(N),M.length=0,O.length=0,oe.length=0,se.length=0,te=this.localClippingEnabled,R=p.init(this.clippingPlanes,te,t),(w=$.get(e,t)).init(),re(e,t,o.sortObjects),!0===o.sortObjects&&w.sort(),R&&p.beginShadows(),J.render(O,e,t),a.setup(M,O,t),R&&p.endShadows(),y.frame++,y.calls=0,y.vertices=0,y.faces=0,y.points=0,void 0===n&&(n=null),this.setRenderTarget(n),_.render(w,e,t,i),i=w.opaque;var c,r=w.transparent;e.overrideMaterial?(c=e.overrideMaterial,i.length&&I(i,e,t,c),r.length&&I(r,e,t,c)):(i.length&&I(i,e,t),r.length&&I(r,e,t)),ye.render(oe,e,t),de.render(se,e,t,x),n&&b.updateRenderTargetMipmap(n),s.buffers.depth.setTest(!0),s.buffers.depth.setMask(!0),s.buffers.color.setMask(!0),s.setPolygonOffset(!1),v.enabled&&v.submitFrame()}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFaceCulling=function(e,t){s.setCullFace(e),s.setFlipSided(0===t)},this.allocTextureUnit=function(){var e=X;return e>=f.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+e+" texture units while this GPU supports only "+f.maxTextures),X+=1,e},this.setTexture2D=function(){var e=!1;return function(t,n){t&&t.isWebGLRenderTarget&&(e||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),e=!0),t=t.texture),b.setTexture2D(t,n)}}(),this.setTexture=function(){var e=!1;return function(t,n){e||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),e=!0),b.setTexture2D(t,n)}}(),this.setTextureCube=function(){var e=!1;return function(t,n){t&&t.isWebGLRenderTargetCube&&(e||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),e=!0),t=t.texture),t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?b.setTextureCube(t,n):b.setTextureCubeDynamic(t,n)}}(),this.getRenderTarget=function(){return q},this.setRenderTarget=function(e){(q=e)&&void 0===h.get(e).__webglFramebuffer&&b.setupRenderTarget(e);var t=null,o=!1;e?(t=h.get(e).__webglFramebuffer,e.isWebGLRenderTargetCube&&(t=t[e.activeCubeFace],o=!0),x.copy(e.viewport),T.copy(e.scissor),G=e.scissorTest):(x.copy(W).multiplyScalar(l),T.copy(V).multiplyScalar(l),G=fe),K!==t&&(n.bindFramebuffer(n.FRAMEBUFFER,t),K=t),s.viewport(x),s.scissor(T),s.setScissorTest(G),o&&(o=h.get(e.texture),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+e.activeCubeFace,o.__webglTexture,e.activeMipMapLevel))},this.readRenderTargetPixels=function(e,t,s,o,a,r){if(e&&e.isWebGLRenderTarget){if(l=h.get(e).__webglFramebuffer,l){d=!1,l!==K&&(n.bindFramebuffer(n.FRAMEBUFFER,l),d=!0);try{var l,d,m=e.texture,u=m.format,c=m.type;1023!==u&&C.convert(u)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_FORMAT)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):1009===c||C.convert(c)===n.getParameter(n.IMPLEMENTATION_COLOR_READ_TYPE)||1015===c&&(i.get("OES_texture_float")||i.get("WEBGL_color_buffer_float"))||1016===c&&i.get("EXT_color_buffer_half_float")?n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE?0<=t&&t<=e.width-o&&0<=s&&s<=e.height-a&&n.readPixels(t,s,o,a,C.convert(u),C.convert(c),r):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{d&&n.bindFramebuffer(n.FRAMEBUFFER,K)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")}}function mt(e,t){this.name="",this.color=new a(e),this.density=void 0!==t?t:25e-5}function ft(e,t,n){this.name="",this.color=new a(e),this.near=void 0!==t?t:1,this.far=void 0!==n?n:1e3}function Sn(){o.call(this),this.type="Scene",this.overrideMaterial=this.fog=this.background=null,this.autoUpdate=!0}function Jn(e,n,s,i,a){o.call(this),this.lensFlares=[],this.positionScreen=new t,this.customUpdateCallback=void 0,void 0!==e&&this.add(e,n,s,i,a)}function le(e){h.call(this),this.type="SpriteMaterial",this.color=new a(16777215),this.map=null,this.rotation=0,this.lights=this.fog=!1,this.setValues(e)}function At(e){o.call(this),this.type="Sprite",this.material=void 0!==e?e:new le}function kt(){o.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function Ct(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else for(console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[],e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new c)}function Wn(){o.call(this),this.type="Bone"}function bn(e,t){x.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new c,this.bindMatrixInverse=new c,e=new Ct(e=this.initBones()),this.bind(e,this.matrixWorld),this.normalizeSkinWeights()}function p(e){h.call(this),this.type="LineBasicMaterial",this.color=new a(16777215),this.linewidth=1,this.linejoin=this.linecap="round",this.lights=!1,this.setValues(e)}function C(e,t,n){if(1===n)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new v(e,t);o.call(this),this.type="Line",this.geometry=void 0!==e?e:new i,this.material=void 0!==t?t:new p({color:16777215*Math.random()})}function v(e,t){C.call(this,e,t),this.type="LineSegments"}function Ln(e,t){C.call(this,e,t),this.type="LineLoop"}function P(e){h.call(this),this.type="PointsMaterial",this.color=new a(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(e)}function bt(e,t){o.call(this),this.type="Points",this.geometry=void 0!==e?e:new i,this.material=void 0!==t?t:new P({color:16777215*Math.random()})}function St(){o.call(this),this.type="Group"}function Fn(e,t,n,s,o,i,a,r,c){b.call(this,e,t,n,s,o,i,a,r,c),this.generateMipmaps=!1;var l=this;requestAnimationFrame(function e(){var t=l.image;t.readyState>=t.HAVE_CURRENT_DATA&&(l.needsUpdate=!0),requestAnimationFrame(e)})}function gt(e,t,n,s,o,i,a,r,c,l,d,u){b.call(this,null,i,a,r,c,l,s,o,d,u),this.image={width:t,height:n},this.mipmaps=e,this.generateMipmaps=this.flipY=!1}function Tt(e,t,n,s,o,i,a,r,c,l){if(1026!==(l=void 0!==l?l:1026)&&1027!==l)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&1026===l&&(n=1012),void 0===n&&1027===l&&(n=1020),b.call(this,null,s,o,i,a,r,l,n,c),this.image={width:e,height:t},this.magFilter=void 0!==a?a:1003,this.minFilter=void 0!==r?r:1003,this.generateMipmaps=this.flipY=!1}function pt(e){i.call(this),this.type="WireframeGeometry";var o,a,r,d,u,m,f,p,g,h=[],c=[0,0],l={},n=["a","b","c"];if(e&&e.isGeometry){d=e.faces,o=0;for(u=d.length;o<u;o++){m=d[o];for(a=0;3>a;a++)r=m[n[a]],f=m[n[(a+1)%3]],c[0]=Math.min(r,f),c[1]=Math.max(r,f),void 0===l[r=c[0]+","+c[1]]&&(l[r]={index1:c[0],index2:c[1]})}for(r in l)o=l[r],n=e.vertices[o.index1],h.push(n.x,n.y,n.z),n=e.vertices[o.index2],h.push(n.x,n.y,n.z)}else if(e&&e.isBufferGeometry)if(n=new t,null!==e.index){d=e.attributes.position,m=e.index,p=e.groups;for(0===p.length&&(p=[{start:0,count:m.count,materialIndex:0}]),e=0,g=p.length;e<g;++e)for(a=(o=p[e]).start,u=o.count,o=a,u=a+u;o<u;o+=3)for(a=0;3>a;a++)r=m.getX(o+a),f=m.getX(o+(a+1)%3),c[0]=Math.min(r,f),c[1]=Math.max(r,f),void 0===l[r=c[0]+","+c[1]]&&(l[r]={index1:c[0],index2:c[1]});for(r in l)o=l[r],n.fromBufferAttribute(d,o.index1),h.push(n.x,n.y,n.z),n.fromBufferAttribute(d,o.index2),h.push(n.x,n.y,n.z)}else for(o=0,u=(d=e.attributes.position).count/3;o<u;o++)for(a=0;3>a;a++)l=3*o+a,n.fromBufferAttribute(d,l),h.push(n.x,n.y,n.z),l=3*o+(a+1)%3,n.fromBufferAttribute(d,l),h.push(n.x,n.y,n.z);this.addAttribute("position",new s(h,3))}function Dt(e,t,n){l.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n},this.fromBufferGeometry(new ht(e,t,n)),this.mergeVertices()}function ht(e,n,o){i.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:n,stacks:o};var c,l,d,u,g=[],j=[],b=[],v=[],h=new t,r=new t,a=new t,f=new t,p=new t,m=n+1;for(l=0;l<=o;l++){u=l/o;for(c=0;c<=n;c++)d=c/n,r=e(d,u,r),j.push(r.x,r.y,r.z),0<=d-1e-5?(a=e(d-1e-5,u,a),f.subVectors(r,a)):(a=e(d+1e-5,u,a),f.subVectors(a,r)),0<=u-1e-5?(a=e(d,u-1e-5,a),p.subVectors(r,a)):(a=e(d,u+1e-5,a),p.subVectors(a,r)),h.crossVectors(f,p).normalize(),b.push(h.x,h.y,h.z),v.push(d,u)}for(l=0;l<o;l++)for(c=0;c<n;c++)e=l*m+c+1,h=(l+1)*m+c+1,r=(l+1)*m+c,g.push(l*m+c,e,r),g.push(e,h,r);this.setIndex(g),this.addAttribute("position",new s(j,3)),this.addAttribute("normal",new s(b,3)),this.addAttribute("uv",new s(v,2))}function Lt(e,t,n,s){l.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:s},this.fromBufferGeometry(new k(e,t,n,s)),this.mergeVertices()}function k(e,o,a,r){function d(e){c.push(e.x,e.y,e.z)}function u(t,n){t*=3,n.x=e[t+0],n.y=e[t+1],n.z=e[t+2]}function h(e,t,n,s){0>s&&1===e.x&&(l[t]=e.x-1),0===n.x&&0===n.z&&(l[t]=s/2/Math.PI+.5)}i.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:o,radius:a,detail:r},a=a||1;var c=[],l=[];!function(e){for(var m=new t,f=new t,l=new t,c=0;c<o.length;c+=3){u(o[c+0],m),u(o[c+1],f),u(o[c+2],l);var n,s,a=m,v=f,h=l,r=Math.pow(2,e),i=[];for(n=0;n<=r;n++){i[n]=[];var p=a.clone().lerp(h,n/r),b=v.clone().lerp(h,n/r),g=r-n;for(s=0;s<=g;s++)i[n][s]=0===s&&n===r?p:p.clone().lerp(b,s/g)}for(n=0;n<r;n++)for(s=0;s<2*(r-n)-1;s++)a=Math.floor(s/2),0==s%2?(d(i[n][a+1]),d(i[n+1][a]),d(i[n][a])):(d(i[n][a+1]),d(i[n+1][a+1]),d(i[n+1][a]))}}(r=r||0),function(e){for(var s=new t,n=0;n<c.length;n+=3)s.x=c[n+0],s.y=c[n+1],s.z=c[n+2],s.normalize().multiplyScalar(e),c[n+0]=s.x,c[n+1]=s.y,c[n+2]=s.z}(a),function(){for(e=new t,s=0;s<c.length;s+=3)e.x=c[s+0],e.y=c[s+1],e.z=c[s+2],l.push(Math.atan2(e.z,-e.x)/2/Math.PI+.5,1-(Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))/Math.PI+.5));e=new t,s=new t;for(var e,s,u,a=new t,r=new t,d=new n,m=new n,f=new n,o=0,i=0;o<c.length;o+=9,i+=6)e.set(c[o+0],c[o+1],c[o+2]),s.set(c[o+3],c[o+4],c[o+5]),a.set(c[o+6],c[o+7],c[o+8]),d.set(l[i+0],l[i+1]),m.set(l[i+2],l[i+3]),f.set(l[i+4],l[i+5]),r.copy(e).add(s).add(a).divideScalar(3),u=Math.atan2(r.z,-r.x),h(d,i+0,e,u),h(m,i+2,s,u),h(f,i+4,a,u);for(e=0;e<l.length;e+=6)s=l[e+0],a=l[e+2],r=l[e+4],d=Math.min(s,a,r),.9<Math.max(s,a,r)&&.1>d&&(.2>s&&(l[e+0]+=1),.2>a&&(l[e+2]+=1),.2>r&&(l[e+4]+=1))}(),this.addAttribute("position",new s(c,3)),this.addAttribute("normal",new s(c.slice(),3)),this.addAttribute("uv",new s(l,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}function Pt(e,t){l.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new dt(e,t)),this.mergeVertices()}function dt(e,t){k.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function It(e,t){l.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new de(e,t)),this.mergeVertices()}function de(e,t){k.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Vt(e,t){l.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new ct(e,t)),this.mergeVertices()}function ct(e,t){var n=(1+Math.sqrt(5))/2;k.call(this,[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Wt(e,t){l.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new rt(e,t)),this.mergeVertices()}function rt(e,t){var n=(1+Math.sqrt(5))/2,s=1/n;k.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-s,-n,0,-s,n,0,s,-n,0,s,n,-s,-n,0,-s,n,0,s,-n,0,s,n,0,-n,0,-s,n,0,-s,-n,0,s,n,0,s],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Kt(e,t,n,s,o,i){l.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:s,closed:o},void 0!==i&&console.warn("THREE.TubeGeometry: taper has been removed."),e=new it(e,t,n,s,o),this.tangents=e.tangents,this.normals=e.normals,this.binormals=e.binormals,this.fromBufferGeometry(e),this.mergeVertices()}function it(e,o,a,r,c){function v(t){f=e.getPointAt(t/o,f),s=h.normals[t];for(t=h.binormals[t],d=0;d<=r;d++){var s,n=d/r*Math.PI*2,i=Math.sin(n),n=-Math.cos(n);u.x=n*s.x+i*t.x,u.y=n*s.y+i*t.y,u.z=n*s.z+i*t.z,u.normalize(),j.push(u.x,u.y,u.z),m.x=f.x+a*u.x,m.y=f.y+a*u.y,m.z=f.z+a*u.z,b.push(m.x,m.y,m.z)}}i.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:o,radius:a,radialSegments:r,closed:c},o=o||64,a=a||1,r=r||8,c=c||!1,h=e.computeFrenetFrames(o,c),this.tangents=h.tangents,this.normals=h.normals,this.binormals=h.binormals;var l,d,h,m=new t,u=new t,p=new n,f=new t,b=[],j=[],y=[],g=[];for(l=0;l<o;l++)v(l);for(v(!1===c?o:0),l=0;l<=o;l++)for(d=0;d<=r;d++)p.x=l/o,p.y=d/r,y.push(p.x,p.y);!function(){for(d=1;d<=o;d++)for(l=1;l<=r;l++){var e=(r+1)*d+(l-1),n=(r+1)*d+l,t=(r+1)*(d-1)+l;g.push((r+1)*(d-1)+(l-1),e,t),g.push(e,n,t)}}(),this.setIndex(g),this.addAttribute("position",new s(b,3)),this.addAttribute("normal",new s(j,3)),this.addAttribute("uv",new s(y,2))}function Yt(e,t,n,s,o,i,a){l.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:s,p:o,q:i},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new ot(e,t,n,s,o,i)),this.mergeVertices()}function ot(e,n,o,a,r,c){function O(e,t,n,s,o){var i=Math.sin(e);t=n/t*e,n=Math.cos(t),o.x=s*(2+n)*.5*Math.cos(e),o.y=s*(2+n)*i*.5,o.z=s*Math.sin(t)*.5}i.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:n,tubularSegments:o,radialSegments:a,p:r,q:c},e=e||1,n=n||.4,o=Math.floor(o)||64,a=Math.floor(a)||8,r=r||2,c=c||3;var l,d,h,g,y=[],w=[],x=[],_=[],m=new t,v=new t,f=new t,b=new t,p=new t,j=new t,u=new t;for(d=0;d<=o;++d){l=d/o*r*Math.PI*2;for(O(l,r,c,e,f),O(l+.01,r,c,e,b),j.subVectors(b,f),u.addVectors(b,f),p.crossVectors(j,u),u.crossVectors(p,j),p.normalize(),u.normalize(),l=0;l<=a;++l)h=l/a*Math.PI*2,g=-n*Math.cos(h),h=n*Math.sin(h),m.x=f.x+(g*u.x+h*p.x),m.y=f.y+(g*u.y+h*p.y),m.z=f.z+(g*u.z+h*p.z),w.push(m.x,m.y,m.z),v.subVectors(m,f).normalize(),x.push(v.x,v.y,v.z),_.push(d/o),_.push(l/a)}for(l=1;l<=o;l++)for(d=1;d<=a;d++)e=(a+1)*l+(d-1),n=(a+1)*l+d,r=(a+1)*(l-1)+d,y.push((a+1)*(l-1)+(d-1),e,r),y.push(e,n,r);this.setIndex(y),this.addAttribute("position",new s(w,3)),this.addAttribute("normal",new s(x,3)),this.addAttribute("uv",new s(_,2))}function Xt(e,t,n,s,o){l.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:s,arc:o},this.fromBufferGeometry(new st(e,t,n,s,o)),this.mergeVertices()}function st(e,n,o,a,r){i.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:n,radialSegments:o,tubularSegments:a,arc:r},e=e||1,n=n||.4,o=Math.floor(o)||8,a=Math.floor(a)||6,r=r||2*Math.PI;var c,l,u,m,f=[],v=[],b=[],p=[],g=new t,d=new t,h=new t;for(c=0;c<=o;c++)for(l=0;l<=a;l++)u=l/a*r,m=c/o*Math.PI*2,d.x=(e+n*Math.cos(m))*Math.cos(u),d.y=(e+n*Math.cos(m))*Math.sin(u),d.z=n*Math.sin(m),v.push(d.x,d.y,d.z),g.x=e*Math.cos(u),g.y=e*Math.sin(u),h.subVectors(d,g).normalize(),b.push(h.x,h.y,h.z),p.push(l/a),p.push(c/o);for(c=1;c<=o;c++)for(l=1;l<=a;l++)e=(a+1)*(c-1)+l-1,n=(a+1)*(c-1)+l,r=(a+1)*c+l,f.push((a+1)*c+l-1,e,r),f.push(e,n,r);this.setIndex(f),this.addAttribute("position",new s(v,3)),this.addAttribute("normal",new s(b,3)),this.addAttribute("uv",new s(p,2))}function te(e,t){l.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new H(e,t)),this.mergeVertices()}function H(e,t){void 0!==e&&(i.call(this),this.type="ExtrudeBufferGeometry",e=Array.isArray(e)?e:[e],this.addShapeList(e,t),this.computeVertexNormals())}function en(e,t){l.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new et(e,t)),this.mergeVertices()}function et(e,t){var n=(t=t||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new l;e=n.generateShapes(e,t.size,t.curveSegments),t.amount=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),H.call(this,e,t),this.type="TextBufferGeometry"}function nn(e,t,n,s,o,i,a){l.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:s,phiLength:o,thetaStart:i,thetaLength:a},this.fromBufferGeometry(new ve(e,t,n,s,o,i,a)),this.mergeVertices()}function ve(e,n,o,a,r,c,l){i.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:o,phiStart:a,phiLength:r,thetaStart:c,thetaLength:l},e=e||1,n=Math.max(3,Math.floor(n)||8),o=Math.max(2,Math.floor(o)||6),a=void 0!==a?a:0,r=void 0!==r?r:2*Math.PI;var d,u,m,p,b,O=(c=void 0!==c?c:0)+(l=void 0!==l?l:Math.PI),w=0,f=[],h=new t,g=new t,v=[],_=[],j=[],y=[];for(d=0;d<=o;d++){b=[],m=d/o;for(u=0;u<=n;u++)p=u/n,h.x=-e*Math.cos(a+p*r)*Math.sin(c+m*l),h.y=e*Math.cos(c+m*l),h.z=e*Math.sin(a+p*r)*Math.sin(c+m*l),_.push(h.x,h.y,h.z),g.set(h.x,h.y,h.z).normalize(),j.push(g.x,g.y,g.z),y.push(p,1-m),b.push(w++);f.push(b)}for(d=0;d<o;d++)for(u=0;u<n;u++)e=f[d][u+1],a=f[d][u],r=f[d+1][u],l=f[d+1][u+1],(0!==d||0<c)&&v.push(e,a,l),(d!==o-1||O<Math.PI)&&v.push(a,r,l);this.setIndex(v),this.addAttribute("position",new s(_,3)),this.addAttribute("normal",new s(j,3)),this.addAttribute("uv",new s(y,2))}function wt(e,t,n,s,o,i){l.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:s,thetaStart:o,thetaLength:i},this.fromBufferGeometry(new Qe(e,t,n,s,o,i)),this.mergeVertices()}function Qe(e,o,a,r,c,l){i.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:o,thetaSegments:a,phiSegments:r,thetaStart:c,thetaLength:l},e=e||.5,o=o||1,c=void 0!==c?c:0,l=void 0!==l?l:2*Math.PI,a=void 0!==a?Math.max(3,a):8;var d,u,p=[],g=[],v=[],b=[],m=e,j=(o-e)/(r=void 0!==r?Math.max(1,r):1),h=new t,f=new n;for(u=0;u<=r;u++){for(d=0;d<=a;d++)e=c+d/a*l,h.x=m*Math.cos(e),h.y=m*Math.sin(e),g.push(h.x,h.y,h.z),v.push(0,0,1),f.x=(h.x/o+1)/2,f.y=(h.y/o+1)/2,b.push(f.x,f.y);m+=j}for(u=0;u<r;u++)for(o=u*(a+1),d=0;d<a;d++)c=(e=d+o)+a+1,l=e+a+2,m=e+1,p.push(e,c,m),p.push(c,l,m);this.setIndex(p),this.addAttribute("position",new s(g,3)),this.addAttribute("normal",new s(v,3)),this.addAttribute("uv",new s(b,2))}function Ot(e,t,n,s){l.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:s},this.fromBufferGeometry(new Xe(e,t,n,s)),this.mergeVertices()}function Xe(e,o,a,r){i.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:o,phiStart:a,phiLength:r},o=Math.floor(o)||12,a=a||0,r=r||2*Math.PI,r=d.clamp(r,0,2*Math.PI);var l,u=[],m=[],f=[],g=1/o,h=new t,p=new n;for(l=0;l<=o;l++){var c=a+l*g*r,v=Math.sin(c),b=Math.cos(c);for(c=0;c<=e.length-1;c++)h.x=e[c].x*v,h.y=e[c].y,h.z=e[c].x*b,m.push(h.x,h.y,h.z),p.x=l/o,p.y=c/(e.length-1),f.push(p.x,p.y)}for(l=0;l<o;l++)for(c=0;c<e.length-1;c++)g=(a=c+l*e.length)+e.length,h=a+e.length+1,p=a+1,u.push(a,g,p),u.push(g,h,p);if(this.setIndex(u),this.addAttribute("position",new s(m,3)),this.addAttribute("uv",new s(f,2)),this.computeVertexNormals(),r===2*Math.PI)for(r=this.attributes.normal.array,u=new t,m=new t,f=new t,a=o*e.length*3,c=l=0;l<e.length;l++,c+=3)u.x=r[c+0],u.y=r[c+1],u.z=r[c+2],m.x=r[a+c+0],m.y=r[a+c+1],m.z=r[a+c+2],f.addVectors(u,m).normalize(),r[c+0]=r[a+c+0]=f.x,r[c+1]=r[a+c+1]=f.y,r[c+2]=r[a+c+2]=f.z}function Ge(e,t){l.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new Ye(e,t)),this.mergeVertices()}function Ye(e,t){function r(e){var s,i,h,u=a.length/3,n=(e=e.extractPoints(t)).shape,r=e.holes;if(!1===R.isClockWise(n))for(n=n.reverse(),e=0,i=r.length;e<i;e++)s=r[e],!0===R.isClockWise(s)&&(r[e]=s.reverse());h=R.triangulateShape(n,r);for(e=0,i=r.length;e<i;e++)s=r[e],n=n.concat(s);for(e=0,i=n.length;e<i;e++)s=n[e],a.push(s.x,s.y,0),l.push(0,0,1),d.push(s.x,s.y);for(e=0,i=h.length;e<i;e++)n=h[e],c.push(n[0]+u,n[1]+u,n[2]+u),o+=3}i.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;var n,c=[],a=[],l=[],d=[],u=0,o=0;if(!1===Array.isArray(e))r(e);else for(n=0;n<e.length;n++)r(e[n]),this.addGroup(u,o,n),u+=o,o=0;this.setIndex(c),this.addAttribute("position",new s(a,3)),this.addAttribute("normal",new s(l,3)),this.addAttribute("uv",new s(d,2))}function qe(e,t){i.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},m=[],t=Math.cos(d.DEG2RAD*(void 0!==t?t:1));var o,r,c,h,m,f,p,g,n=[0,0],u={},a=["a","b","c"];e.isBufferGeometry?(o=new l,o.fromBufferGeometry(e)):o=e.clone(),o.mergeVertices(),o.computeFaceNormals(),e=o.vertices;for(c=0,g=(o=o.faces).length;c<g;c++)for(f=o[c],h=0;3>h;h++)r=f[a[h]],p=f[a[(h+1)%3]],n[0]=Math.min(r,p),n[1]=Math.max(r,p),void 0===u[r=n[0]+","+n[1]]?u[r]={index1:n[0],index2:n[1],face1:c,face2:void 0}:u[r].face2=c;for(r in u)(void 0===(n=u[r]).face2||o[n.face1].normal.dot(o[n.face2].normal)<=t)&&(a=e[n.index1],m.push(a.x,a.y,a.z),a=e[n.index2],m.push(a.x,a.y,a.z));this.addAttribute("position",new s(m,3))}function he(e,t,n,s,o,i,a,r){l.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:s,heightSegments:o,openEnded:i,thetaStart:a,thetaLength:r},this.fromBufferGeometry(new J(e,t,n,s,o,i,a,r)),this.mergeVertices()}function J(e,o,a,r,c,l,d,u){function _(s){var i,l,w,x,c=new n,a=new t,_=0,O=!0===s?e:o,f=!0===s?1:-1,C=m;for(i=1;i<=r;i++)p.push(0,y*f,0),g.push(0,f,0),v.push(.5,.5),m++;x=m;for(i=0;i<=r;i++)l=i/r*u+d,w=Math.cos(l),l=Math.sin(l),a.x=O*l,a.y=y*f,a.z=O*w,p.push(a.x,a.y,a.z),g.push(0,f,0),c.x=.5*w+.5,c.y=.5*l*f+.5,v.push(c.x,c.y),m++;for(i=0;i<r;i++)c=C+i,a=x+i,!0===s?h.push(a,a+1,c):h.push(a+1,a,c),_+=3;j.addGroup(b,_,!0===s?1:2),b+=_}i.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:o,height:a,radialSegments:r,heightSegments:c,openEnded:l,thetaStart:d,thetaLength:u},j=this,e=void 0!==e?e:1,o=void 0!==o?o:1,a=a||1,r=Math.floor(r)||8,c=Math.floor(c)||1,l=void 0!==l&&l,d=void 0!==d?d:0,u=void 0!==u?u:2*Math.PI;var j,h=[],p=[],g=[],v=[],m=0,f=[],y=a/2,b=0;!function(){var n,s,l=new t,i=new t,O=0,w=(o-e)/a;for(s=0;s<=c;s++){var C=[],x=s/c,E=x*(o-e)+e;for(n=0;n<=r;n++){var k=n/r,_=k*u+d,A=Math.sin(_),_=Math.cos(_);i.x=E*A,i.y=-x*a+y,i.z=E*_,p.push(i.x,i.y,i.z),l.set(A,w,_).normalize(),g.push(l.x,l.y,l.z),v.push(k,1-x),C.push(m++)}f.push(C)}for(n=0;n<r;n++)for(s=0;s<c;s++)l=f[s+1][n],i=f[s+1][n+1],w=f[s][n+1],h.push(f[s][n],l,w),h.push(l,i,w),O+=6;j.addGroup(b,O,0),b+=O}(),!1===l&&(0<e&&_(!0),0<o&&_(!1)),this.setIndex(h),this.addAttribute("position",new s(p,3)),this.addAttribute("normal",new s(g,3)),this.addAttribute("uv",new s(v,2))}function hn(e,t,n,s,o,i,a){he.call(this,0,e,t,n,s,o,i,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:s,openEnded:o,thetaStart:i,thetaLength:a}}function rn(e,t,n,s,o,i,a){J.call(this,0,e,t,n,s,o,i,a),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:s,openEnded:o,thetaStart:i,thetaLength:a}}function an(e,t,n,s){l.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:s},this.fromBufferGeometry(new We(e,t,n,s)),this.mergeVertices()}function We(e,o,a,r){i.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:o,thetaStart:a,thetaLength:r},e=e||1,o=void 0!==o?Math.max(3,o):8,a=void 0!==a?a:0,r=void 0!==r?r:2*Math.PI;var c,h,p,g=[],l=[],m=[],f=[],d=new t,u=new n;l.push(0,0,0),m.push(0,0,1),f.push(.5,.5),h=0;for(c=3;h<=o;h++,c+=3)p=a+h/o*r,d.x=e*Math.cos(p),d.y=e*Math.sin(p),l.push(d.x,d.y,d.z),m.push(0,0,1),u.x=(l[c]/e+1)/2,u.y=(l[c+1]/e+1)/2,f.push(u.x,u.y);for(c=1;c<=o;c++)g.push(c,c+1,0);this.setIndex(g),this.addAttribute("position",new s(l,3)),this.addAttribute("normal",new s(m,3)),this.addAttribute("uv",new s(f,2))}function $e(e){h.call(this),this.type="ShadowMaterial",this.color=new a(0),this.opacity=1,this.transparent=this.lights=!0,this.setValues(e)}function Ve(e){D.call(this,e),this.type="RawShaderMaterial"}function U(e){h.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new a(16777215),this.metalness=this.roughness=.5,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new a(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new n(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function we(e){U.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoatRoughness=this.clearCoat=0,this.setValues(e)}function B(e){h.call(this),this.type="MeshPhongMaterial",this.color=new a(16777215),this.specular=new a(1118481),this.shininess=30,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new a(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new n(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function ze(e){B.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(e)}function Re(e){h.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new n(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.lights=this.fog=!1,this.setValues(e)}function Le(e){h.call(this),this.type="MeshLambertMaterial",this.color=new a(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new a(0),this.emissiveIntensity=1,this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function Ne(e){p.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}function es(e,t,n){var s=this,a=!1,o=0,i=0,r=void 0;this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){i++,!1===a&&void 0!==s.onStart&&s.onStart(e,o,i),a=!0},this.itemEnd=function(e){o++,void 0!==s.onProgress&&s.onProgress(e,o,i),o===i&&(a=!1,void 0!==s.onLoad)&&s.onLoad()},this.itemError=function(e){void 0!==s.onError&&s.onError(e)},this.resolveURL=function(e){return r?r(e):e},this.setURLModifier=function(e){r=e}}function $(e){this.manager=void 0!==e?e:z}function Ss(e){this.manager=void 0!==e?e:z,this._parser=null}function Qn(e){this.manager=void 0!==e?e:z,this._parser=null}function Mt(e){this.manager=void 0!==e?e:z}function Xn(e){this.manager=void 0!==e?e:z}function zn(e){this.manager=void 0!==e?e:z}function j(e,t){o.call(this),this.type="Light",this.color=new a(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function Nn(e,t,n){j.call(this,e,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(o.DefaultUp),this.updateMatrix(),this.groundColor=new a(t)}function Te(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new n(512,512),this.map=null,this.matrix=new c}function Rn(){Te.call(this,new _(50,1,.5,500))}function Pn(e,t,n,s,i,a){j.call(this,e,t),this.type="SpotLight",this.position.copy(o.DefaultUp),this.updateMatrix(),this.target=new o,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==s?s:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==a?a:1,this.shadow=new Rn}function Hn(e,t,n,s){j.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==s?s:1,this.shadow=new Te(new _(90,1,.5,500))}function In(){Te.call(this,new Ze(-5,5,5,-5,.5,500))}function Bn(e,t){j.call(this,e,t),this.type="DirectionalLight",this.position.copy(o.DefaultUp),this.updateMatrix(),this.target=new o,this.shadow=new In}function Vn(e,t){j.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function $n(e,t,n,s){j.call(this,e,t),this.type="RectAreaLight",this.position.set(0,1,0),this.updateMatrix(),this.width=void 0!==n?n:10,this.height=void 0!==s?s:10}function T(e,t,n,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==s?s:new t.constructor(n),this.sampleValues=t,this.valueSize=n}function pn(e,t,n,s){T.call(this,e,t,n,s),this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0}function Et(e,t,n,s){T.call(this,e,t,n,s)}function Dn(e,t,n,s){T.call(this,e,t,n,s)}function ye(e,t,n,s){if(void 0===e)throw Error("track name is undefined");if(void 0===t||0===t.length)throw Error("no keyframes in track named "+e);this.name=e,this.times=w.convertArray(t,this.TimeBufferType),this.values=w.convertArray(n,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation),this.validate(),this.optimize()}function Be(e,t,n,s){ye.call(this,e,t,n,s)}function Tn(e,t,n,s){T.call(this,e,t,n,s)}function Ft(e,t,n,s){ye.call(this,e,t,n,s)}function Ue(e,t,n,s){ye.call(this,e,t,n,s)}function An(e,t,n,s){ye.call(this,e,t,n,s)}function kn(e,t,n){ye.call(this,e,t,n)}function En(e,t,n,s){ye.call(this,e,t,n,s)}function pe(e,t,n,s){ye.apply(this,e,t,n,s)}function N(e,t,n){this.name=e,this.tracks=n,this.duration=void 0!==t?t:-1,this.uuid=d.generateUUID(),0>this.duration&&this.resetDuration(),this.optimize()}function On(e){this.manager=void 0!==e?e:z,this.textures={}}function is(e){this.manager=void 0!==e?e:z}function Ke(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}}function cs(e){"boolean"==typeof e&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),e=void 0),this.manager=void 0!==e?e:z,this.withCredentials=!1}function ao(e){this.manager=void 0!==e?e:z,this.texturePath=""}function Xs(e,t,n,s,o){var i=e*e;return(2*n-2*s+(t=.5*(s-t))+(o=.5*(o-n)))*e*i+(-3*n+3*s-2*t-o)*i+t*e+n}function Oe(e,t,n,s){var o=1-e;return o*o*t+2*(1-e)*e*n+e*e*s}function be(e,t,n,s,o){var i=1-e,a=1-e;return i*i*i*t+3*a*a*e*n+3*(1-e)*e*e*s+e*e*e*o}function m(){this.type="Curve",this.arcLengthDivisions=200}function I(e,t){m.call(this),this.type="LineCurve",this.v1=e||new n,this.v2=t||new n}function je(){m.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function W(e,t,n,s,o,i,a,r){m.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=n||1,this.yRadius=s||1,this.aStartAngle=o||0,this.aEndAngle=i||2*Math.PI,this.aClockwise=a||!1,this.aRotation=r||0}function ie(e){m.call(this),this.type="SplineCurve",this.points=e||[]}function ee(e,t,s,o){m.call(this),this.type="CubicBezierCurve",this.v0=e||new n,this.v1=t||new n,this.v2=s||new n,this.v3=o||new n}function re(e,t,s){m.call(this),this.type="QuadraticBezierCurve",this.v0=e||new n,this.v1=t||new n,this.v2=s||new n}function Me(e){je.call(this),this.type="Path",this.currentPoint=new n,e&&this.setFromPoints(e)}function me(e){Me.call(this,e),this.type="Shape",this.holes=[]}function ws(){this.type="ShapePath",this.subPaths=[],this.currentPath=null}function Kn(e){this.type="Font",this.data=e}function mo(e){this.manager=void 0!==e?e:z}function _s(e){this.manager=void 0!==e?e:z}function Es(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new _,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new _,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function mn(e,n,s){o.call(this),this.type="CubeCamera";var i,a,r,c,l,d=new _(90,1,e,n);d.up.set(0,-1,0),d.lookAt(new t(1,0,0)),this.add(d),i=new _(90,1,e,n),i.up.set(0,-1,0),i.lookAt(new t(-1,0,0)),this.add(i),a=new _(90,1,e,n),a.up.set(0,0,1),a.lookAt(new t(0,1,0)),this.add(a),r=new _(90,1,e,n),r.up.set(0,0,-1),r.lookAt(new t(0,-1,0)),this.add(r),c=new _(90,1,e,n),c.up.set(0,-1,0),c.lookAt(new t(0,0,1)),this.add(c),l=new _(90,1,e,n),l.up.set(0,-1,0),l.lookAt(new t(0,0,-1)),this.add(l),this.renderTarget=new yt(s,s,{format:1022,magFilter:1006,minFilter:1006}),this.renderTarget.texture.name="CubeCamera",this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,s=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,n.activeCubeFace=0,e.render(t,d,n),n.activeCubeFace=1,e.render(t,i,n),n.activeCubeFace=2,e.render(t,a,n),n.activeCubeFace=3,e.render(t,r,n),n.activeCubeFace=4,e.render(t,c,n),n.texture.generateMipmaps=s,n.activeCubeFace=5,e.render(t,l,n),e.setRenderTarget(null)},this.clear=function(e,t,n,s){for(var i=this.renderTarget,o=0;6>o;o++)i.activeCubeFace=o,e.setRenderTarget(i),e.clear(t,n,s);e.setRenderTarget(null)}}function ys(){o.call(this),this.type="AudioListener",this.context=Cn.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function Je(e){o.call(this),this.type="Audio",this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.offset=this.startTime=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function js(e){Je.call(this,e),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function bs(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function vs(e,t,n){switch(this.binding=e,this.valueSize=n,e=Float64Array,t){case"quaternion":t=this._slerp;break;case"string":case"bool":e=Array,t=this._select;break;default:t=this._lerp}this.buffer=new e(4*n),this._mixBufferRegion=t,this.referenceCount=this.useCount=this.cumulativeWeight=0}function zs(e,t,n){n=n||O.parseTrackName(t),this._targetGroup=e,this._bindings=e.subscribe_(t,n)}function O(e,t,n){this.path=t,this.parsedPath=n||O.parseTrackName(t),this.node=O.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function Ns(){this.uuid=d.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0,n={},this._indicesByUUID=n;for(var t,n,e=0,s=arguments.length;e!==s;++e)n[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={},t=this,this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}function Ls(e,t,n){this._mixer=e,this._clip=t,this._localRoot=n||null,t=(e=t.tracks).length,n=Array(t);for(var o,i={endingStart:2400,endingEnd:2400},s=0;s!==t;++s)o=e[s].createInterpolant(null),n[s]=o,o.settings=i;this._interpolantSettings=i,this._interpolants=n,this._propertyBindings=Array(t),this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0}function Rs(e){this._root=e,this._initMemoryManager(),this.time=this._accuIndex=0,this.timeScale=1}function fn(e,t){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=t),this.value=e}function gs(){i.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function ps(e,t,n,s){this.uuid=d.generateUUID(),this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===s}function tt(e,t){this.uuid=d.generateUUID(),this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function fs(e,t,n){tt.call(this,e,t),this.meshPerAttribute=n||1}function hs(e,t,n){u.call(this,e,t),this.meshPerAttribute=n||1}function Ws(e,t,n,s){this.ray=new Ae(e,t),this.near=n||0,this.far=s||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Us(e,t){return e.distance-t.distance}function us(e,t,n,s){if(!1!==e.visible&&(e.raycast(t,n),!0===s)){s=0;for(var o=(e=e.children).length;s<o;s++)us(e[s],t,n,!0)}}function qs(e){this.autoStart=void 0===e||e,this.elapsedTime=this.oldTime=this.startTime=0,this.running=!1}function Ys(e,t,n){return this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==n?n:0,this}function Gs(e,t,n){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==n?n:0,this}function un(e){o.call(this),this.material=e,this.render=function(){}}function dn(e,t,n,o){this.object=e,this.size=void 0!==t?t:1,e=void 0!==n?n:16711680,o=void 0!==o?o:1,t=0,(n=this.object.geometry)&&n.isGeometry?t=3*n.faces.length:n&&n.isBufferGeometry&&(t=n.attributes.normal.count),n=new i,t=new s(6*t,3),n.addAttribute("position",t),v.call(this,n,new p({color:e,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function nt(e,t){o.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,e=new i,t=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(var a,r,n=0,c=1;32>n;n++,c++)a=n/32*Math.PI*2,r=c/32*Math.PI*2,t.push(Math.cos(a),Math.sin(a),1,Math.cos(r),Math.sin(r),1);e.addAttribute("position",new s(t,3)),t=new p({fog:!1}),this.cone=new v(e,t),this.add(this.cone),this.update()}function Js(e){var n,t=[];e&&e.isBone&&t.push(e);for(n=0;n<e.children.length;n++)t.push.apply(t,Js(e.children[n]));return t}function at(e){for(var u,n=Js(e),o=new i,t=[],r=[],c=new a(0,0,1),l=new a(0,1,0),d=0;d<n.length;d++)u=n[d],u.parent&&u.parent.isBone&&(t.push(0,0,0),t.push(0,0,0),r.push(c.r,c.g,c.b),r.push(l.r,l.g,l.b));o.addAttribute("position",new s(t,3)),o.addAttribute("color",new s(r,3)),t=new p({vertexColors:2,depthTest:!1,depthWrite:!1,transparent:!0}),v.call(this,o,t),this.root=e,this.bones=n,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function lt(e,t,n){this.light=e,this.light.updateMatrixWorld(),this.color=n,e=new ve(t,4,2),t=new F({wireframe:!0,fog:!1}),x.call(this,e,t),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function Pe(e,t){o.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,e=new p({fog:!1}),(t=new i).addAttribute("position",new u(new Float32Array(15),3)),this.line=new C(t,e),this.add(this.line),this.update()}function ut(e,t,n){o.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,(e=new de(t)).rotateY(.5*Math.PI),this.material=new F({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=2),t=e.getAttribute("position"),t=new Float32Array(3*t.count),e.addAttribute("color",new u(t,3)),this.add(new x(e,this.material)),this.update()}function ln(e,t,n,o){e=e||10,t=t||10,n=new a(void 0!==n?n:4473924),o=new a(void 0!==o?o:8947848);var m=t/2,f=e/t,c=e/2;e=[];for(var u,l=[],h=0,r=0,d=-c;h<=t;h++,d+=f)e.push(-c,0,d,c,0,d),e.push(d,0,-c,d,0,c),u=h===m?n:o,u.toArray(l,r),r+=3,u.toArray(l,r),r+=3,u.toArray(l,r),r+=3,u.toArray(l,r),r+=3;(t=new i).addAttribute("position",new s(e,3)),t.addAttribute("color",new s(l,3)),n=new p({vertexColors:2}),v.call(this,t,n)}function gn(e,t,n,o,r,c){e=e||10,t=t||16,n=n||8,o=o||64,r=new a(void 0!==r?r:4473924),c=new a(void 0!==c?c:8947848);var l,d,u,m,g,h=[],f=[];for(u=0;u<=t;u++)l=u/t*2*Math.PI,m=Math.sin(l)*e,l=Math.cos(l)*e,h.push(0,0,0),h.push(m,0,l),d=1&u?r:c,f.push(d.r,d.g,d.b),f.push(d.r,d.g,d.b);for(u=0;u<=n;u++){d=1&u?r:c,g=e-e/n*u;for(t=0;t<o;t++)l=t/o*2*Math.PI,m=Math.sin(l)*g,l=Math.cos(l)*g,h.push(m,0,l),f.push(d.r,d.g,d.b),l=(t+1)/o*2*Math.PI,m=Math.sin(l)*g,l=Math.cos(l)*g,h.push(m,0,l),f.push(d.r,d.g,d.b)}(e=new i).addAttribute("position",new s(h,3)),e.addAttribute("color",new s(f,3)),h=new p({vertexColors:2}),v.call(this,e,h)}function on(e,t,n,o){this.object=e,this.size=void 0!==t?t:1,e=void 0!==n?n:16776960,o=void 0!==o?o:1,t=0,(n=this.object.geometry)&&n.isGeometry?t=n.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead."),n=new i,t=new s(6*t,3),n.addAttribute("position",t),v.call(this,n,new p({color:e,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function vt(e,t,n){o.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===t&&(t=1),(e=new i).addAttribute("position",new s([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3)),t=new p({fog:!1}),this.lightPlane=new C(e,t),this.add(this.lightPlane),(e=new i).addAttribute("position",new s([0,0,0,0,0,1],3)),this.targetLine=new C(e,t),this.add(this.targetLine),this.update()}function sn(e){function t(e,t,n){h(e,n),h(t,n)}function h(e,t){d.push(0,0,0),m.push(t.r,t.g,t.b),void 0===r[e]&&(r[e]=[]),r[e].push(d.length/3-1)}var l=new i,f=new p({color:16777215,vertexColors:1}),d=[],m=[],r={},n=new a(16755200),c=new a(16711680),u=new a(43775),g=new a(16777215),o=new a(3355443);t("n1","n2",n),t("n2","n4",n),t("n4","n3",n),t("n3","n1",n),t("f1","f2",n),t("f2","f4",n),t("f4","f3",n),t("f3","f1",n),t("n1","f1",n),t("n2","f2",n),t("n3","f3",n),t("n4","f4",n),t("p","n1",c),t("p","n2",c),t("p","n3",c),t("p","n4",c),t("u1","u2",u),t("u2","u3",u),t("u3","u1",u),t("c","t",g),t("p","c",o),t("cn1","cn2",o),t("cn3","cn4",o),t("cf1","cf2",o),t("cf3","cf4",o),l.addAttribute("position",new s(d,3)),l.addAttribute("color",new s(m,3)),v.call(this,l,f),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=r,this.update()}function xe(e,t){this.object=e,void 0===t&&(t=16776960),e=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var s=new Float32Array(24),n=new i;n.setIndex(new u(e,1)),n.addAttribute("position",new u(s,3)),v.call(this,n,new p({color:t})),this.matrixAutoUpdate=!1,this.update()}function tn(e,t){this.type="Box3Helper",this.box=e,e=void 0!==t?t:16776960,t=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var n=new i;n.setIndex(new u(t,1)),n.addAttribute("position",new s([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),v.call(this,n,new p({color:e})),this.geometry.computeBoundingSphere()}function Jt(e,t,n){this.type="PlaneHelper",this.plane=e,this.size=void 0===t?1:t,e=void 0!==n?n:16776960,(t=new i).addAttribute("position",new s([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),t.computeBoundingSphere(),C.call(this,t,new p({color:e})),(t=new i).addAttribute("position",new s([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),t.computeBoundingSphere(),this.add(new x(t,new F({color:e,opacity:.2,transparent:!0,depthWrite:!1})))}function Ee(e,t,n,a,r,c){o.call(this),void 0===a&&(a=16776960),void 0===n&&(n=1),void 0===r&&(r=.2*n),void 0===c&&(c=.2*r),void 0===ns&&((ns=new i).addAttribute("position",new s([0,0,0,0,1,0],3)),(Ms=new J(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new C(ns,new p({color:a})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new x(Ms,new F({color:a})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,r,c)}function Zt(e){var t=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e];(e=new i).addAttribute("position",new s(t,3)),e.addAttribute("color",new s([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),t=new p({vertexColors:2}),v.call(this,e,t)}function Un(){var e=0,t=0,n=0,s=0;return{initCatmullRom:function(o,i,a,r,c){e=i,t=o=c*(a-o),n=-3*i+3*a-2*o-(r=c*(r-i)),s=2*i-2*a+o+r},initNonuniformCatmullRom:function(o,i,a,r,c,l,d){e=i,t=o=((i-o)/c-(a-o)/(c+l)+(a-i)/l)*l,n=-3*i+3*a-2*o-(r=((a-i)/l-(r-i)/(l+d)+(r-a)/d)*l),s=2*i-2*a+o+r},calc:function(o){var i=o*o;return e+t*o+n*i+s*i*o}}}function M(e,t,n,s){m.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=n||"centripetal",this.tension=s||.5}function ke(e,n,s,o){m.call(this),this.type="CubicBezierCurve3",this.v0=e||new t,this.v1=n||new t,this.v2=s||new t,this.v3=o||new t}function Se(e,n,s){m.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new t,this.v1=n||new t,this.v2=s||new t}function ce(e,n){m.call(this),this.type="LineCurve3",this.v1=e||new t,this.v2=n||new t}function Gt(e,t,n,s,o,i){W.call(this,e,t,n,n,s,o,i),this.type="ArcCurve"}function ho(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),M.call(this,e),this.type="catmullrom",this.closed=!0}function uo(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),M.call(this,e),this.type="catmullrom"}function rs(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),M.call(this,e),this.type="catmullrom"}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return 0>e?-1:0<e?1:+e}),!1=="name"in Function.prototype&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var t,s,o=Object(e),n=1;n<arguments.length;n++)if(t=arguments[n],t!=null)for(s in t)Object.prototype.hasOwnProperty.call(t,s)&&(o[s]=t[s]);return o}),Object.assign(G.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)},removeEventListener:function(e,t){void 0!==this._listeners&&void 0!==(e=this._listeners[e])&&-1!==(t=e.indexOf(t))&&e.splice(t,1)},dispatchEvent:function(e){if(void 0!==this._listeners&&void 0!==(t=this._listeners[e.type])){e.target=this;for(var t,n=0,s=(t=t.slice(0)).length;n<s;n++)t[n].call(this,e)}}}),d={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:(lo="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),qt=0,function(){for(var t="",e=0;36>e;e++)8===e||13===e||18===e||23===e?t+="-":14===e?t+="4":(2>=qt&&(qt=33554432+16777216*Math.random()|0),os=15&qt,qt>>=4,t+=lo[19===e?3&os|8:os]);return t}),clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,s,o){return s+(e-t)*(o-s)/(n-t)},lerp:function(e,t,n){return(1-n)*e+n*t},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*d.DEG2RAD},radToDeg:function(e){return e*d.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}},Object.defineProperties(n.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(n.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.y=this.x=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,n=this.y;return e=e.elements,this.x=e[0]*t+e[3]*n+e[6],this.y=e[1]*t+e[4]*n+e[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:function(){var e=new n,t=new n;return function(n,s){return e.set(n,n),t.set(s,s),this.clamp(e,t)}}(),clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return 0>e&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x;return t*t+(e=this.y-e.y)*e},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){n=Math.cos(t),t=Math.sin(t);var n,s=this.x-e.x,o=this.y-e.y;return this.x=s*n-o*t+e.x,this.y=s*t+o*n+e.y,this}}),Object.assign(c.prototype,{isMatrix4:!0,set:function(e,t,n,s,o,i,a,r,c,l,d,u,h,m,f,p){var g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=s,g[1]=o,g[5]=i,g[9]=a,g[13]=r,g[2]=c,g[6]=l,g[10]=d,g[14]=u,g[3]=h,g[7]=m,g[11]=f,g[15]=p,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new c).fromArray(this.elements)},copy:function(e){var t=this.elements;return e=e.elements,t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],this},copyPosition:function(e){var t=this.elements;return e=e.elements,t[12]=e[12],t[13]=e[13],t[14]=e[14],this},extractBasis:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this},extractRotation:function(){var e=new t;return function(t){var n=this.elements,s=t.elements,o=1/e.setFromMatrixColumn(t,0).length(),i=1/e.setFromMatrixColumn(t,1).length();return t=1/e.setFromMatrixColumn(t,2).length(),n[0]=s[0]*o,n[1]=s[1]*o,n[2]=s[2]*o,n[4]=s[4]*i,n[5]=s[5]*i,n[6]=s[6]*i,n[8]=s[8]*t,n[9]=s[9]*t,n[10]=s[10]*t,this}}(),makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,s=e.y,o=e.z,i=Math.cos(n),a=(n=Math.sin(n),Math.cos(s)),r=(s=Math.sin(s),Math.cos(o)),o=Math.sin(o);if("XYZ"===e.order){var c=i*r,l=i*o,d=n*r;e=n*o,t[0]=a*r,t[4]=-a*o,t[8]=s,t[1]=l+d*s,t[5]=c-e*s,t[9]=-n*a,t[2]=e-c*s,t[6]=d+l*s,t[10]=i*a}else"YXZ"===e.order?(c=a*r,l=a*o,d=s*r,e=s*o,t[0]=c+e*n,t[4]=d*n-l,t[8]=i*s,t[1]=i*o,t[5]=i*r,t[9]=-n,t[2]=l*n-d,t[6]=e+c*n,t[10]=i*a):"ZXY"===e.order?(c=a*r,l=a*o,d=s*r,e=s*o,t[0]=c-e*n,t[4]=-i*o,t[8]=d+l*n,t[1]=l+d*n,t[5]=i*r,t[9]=e-c*n,t[2]=-i*s,t[6]=n,t[10]=i*a):"ZYX"===e.order?(c=i*r,l=i*o,d=n*r,e=n*o,t[0]=a*r,t[4]=d*s-l,t[8]=c*s+e,t[1]=a*o,t[5]=e*s+c,t[9]=l*s-d,t[2]=-s,t[6]=n*a,t[10]=i*a):"YZX"===e.order?(c=i*a,l=i*s,d=n*a,e=n*s,t[0]=a*r,t[4]=e-c*o,t[8]=d*o+l,t[1]=o,t[5]=i*r,t[9]=-n*r,t[2]=-s*r,t[6]=l*o+d,t[10]=c-e*o):"XZY"===e.order&&(c=i*a,l=i*s,d=n*a,e=n*s,t[0]=a*r,t[4]=-o,t[8]=s*r,t[1]=c*o+e,t[5]=i*r,t[9]=l*o-d,t[2]=d*o-l,t[6]=n*r,t[10]=e*o+c);return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(e){var t=this.elements,n=e._x,s=e._y,o=e._z,i=e._w,r=o+o;e=n*(c=n+n);var l=n*(a=s+s),d=(n=n*r,s*a),c=(s=s*r,o=o*r,i*c),a=i*a;return i*=r,t[0]=1-(d+o),t[4]=l-i,t[8]=n+a,t[1]=l+i,t[5]=1-(e+o),t[9]=s-c,t[2]=n-a,t[6]=s+c,t[10]=1-(e+d),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},lookAt:function(){var n=new t,s=new t,e=new t;return function(t,o,i){var a=this.elements;return e.subVectors(t,o),0===e.lengthSq()&&(e.z=1),e.normalize(),n.crossVectors(i,e),0===n.lengthSq()&&(1===Math.abs(i.z)?e.x+=1e-4:e.z+=1e-4,e.normalize(),n.crossVectors(i,e)),n.normalize(),s.crossVectors(e,n),a[0]=n.x,a[4]=s.x,a[8]=e.x,a[1]=n.y,a[5]=s.y,a[9]=e.y,a[2]=n.z,a[6]=s.z,a[10]=e.z,this}}(),multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){n=e.elements,s=t.elements,t=this.elements,e=n[0];var n,o=n[4],i=n[8],a=n[12],r=n[1],c=n[5],l=n[9],d=n[13],u=n[2],h=n[6],m=n[10],f=n[14],p=n[3],g=n[7],v=n[11],b=(n=n[15],s[0]),j=s[4],y=s[8],_=s[12],w=s[1],O=s[5],x=s[9],C=s[13],E=s[2],k=s[6],A=s[10],S=s[14],M=s[3],F=s[7],T=s[11],s=s[15];return t[0]=e*b+o*w+i*E+a*M,t[4]=e*j+o*O+i*k+a*F,t[8]=e*y+o*x+i*A+a*T,t[12]=e*_+o*C+i*S+a*s,t[1]=r*b+c*w+l*E+d*M,t[5]=r*j+c*O+l*k+d*F,t[9]=r*y+c*x+l*A+d*T,t[13]=r*_+c*C+l*S+d*s,t[2]=u*b+h*w+m*E+f*M,t[6]=u*j+h*O+m*k+f*F,t[10]=u*y+h*x+m*A+f*T,t[14]=u*_+h*C+m*S+f*s,t[3]=p*b+g*w+v*E+n*M,t[7]=p*j+g*O+v*k+n*F,t[11]=p*y+g*x+v*A+n*T,t[15]=p*_+g*C+v*S+n*s,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToBufferAttribute:function(){var e=new t;return function(t){for(var n=0,s=t.count;n<s;n++)e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.applyMatrix4(this),t.setXYZ(n,e.x,e.y,e.z);return t}}(),determinant:function(){var e=this.elements,t=e[0],n=e[4],s=e[8],o=e[12],i=e[1],a=e[5],r=e[9],c=e[13],l=e[2],d=e[6],u=e[10],h=e[14];return e[3]*(+o*r*d-s*c*d-o*a*u+n*c*u+s*a*h-n*r*h)+e[7]*(+t*r*h-t*c*u+o*i*u-s*i*h+s*c*l-o*r*l)+e[11]*(+t*c*d-t*a*h-o*i*d+n*i*h+o*a*l-n*c*l)+e[15]*(-s*a*l-t*r*d+t*a*u+s*i*d-n*i*u+n*r*l)},transpose:function(){var e=this.elements,t=e[1];return e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){v=this.elements,e=(n=e.elements)[0];var n,v,o=n[1],i=n[2],s=n[3],p=n[4],c=n[5],l=n[6],d=n[7],u=n[8],a=n[9],m=n[10],f=n[11],r=n[12],g=n[13],h=n[14],b=a*h*d-g*m*d+g*l*f-c*h*f-a*l*(n=n[15])+c*m*n,j=r*m*d-u*h*d-r*l*f+p*h*f+u*l*n-p*m*n,y=u*g*d-r*a*d+r*c*f-p*g*f-u*c*n+p*a*n,_=r*a*l-u*g*l-r*c*m+p*g*m+u*c*h-p*a*h,w=e*b+o*j+i*y+s*_;if(0===w){if(!0===t)throw Error("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0");return console.warn("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0"),this.identity()}return t=1/w,v[0]=b*t,v[1]=(g*m*s-a*h*s-g*i*f+o*h*f+a*i*n-o*m*n)*t,v[2]=(c*h*s-g*l*s+g*i*d-o*h*d-c*i*n+o*l*n)*t,v[3]=(a*l*s-c*m*s-a*i*d+o*m*d+c*i*f-o*l*f)*t,v[4]=j*t,v[5]=(u*h*s-r*m*s+r*i*f-e*h*f-u*i*n+e*m*n)*t,v[6]=(r*l*s-p*h*s-r*i*d+e*h*d+p*i*n-e*l*n)*t,v[7]=(p*m*s-u*l*s+u*i*d-e*m*d-p*i*f+e*l*f)*t,v[8]=y*t,v[9]=(r*a*s-u*g*s-r*o*f+e*g*f+u*o*n-e*a*n)*t,v[10]=(p*g*s-r*c*s+r*o*d-e*g*d-p*o*n+e*c*n)*t,v[11]=(u*c*s-p*a*s-u*o*d+e*a*d+p*o*f-e*c*f)*t,v[12]=_*t,v[13]=(u*g*i-r*a*i+r*o*m-e*g*m-u*o*h+e*a*h)*t,v[14]=(r*c*i-p*g*i-r*o*l+e*g*l+p*o*h-e*c*h)*t,v[15]=(p*a*i-u*c*i+u*o*l-e*a*l-p*o*m+e*c*m)*t,this},scale:function(e){var t=this.elements,n=e.x,s=e.y;return e=e.z,t[0]*=n,t[4]*=s,t[8]*=e,t[1]*=n,t[5]*=s,t[9]*=e,t[2]*=n,t[6]*=s,t[10]*=e,t[3]*=n,t[7]*=s,t[11]*=e,this},getMaxScaleOnAxis:function(){var e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e);return e=Math.sin(e),this.set(1,0,0,0,0,t,-e,0,0,e,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e);return e=Math.sin(e),this.set(t,0,e,0,0,1,0,0,-e,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e);return e=Math.sin(e),this.set(t,-e,0,0,e,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){o=Math.cos(t),t=Math.sin(t);var s,o,a,r=1-o,i=e.x,n=e.y;return e=e.z,s=r*i,a=r*n,this.set(s*i+o,s*n-t*e,s*e+t*n,0,s*n+t*e,a*n+o,a*e-t*i,0,s*e-t*n,a*e+t*i,r*e*e+o,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,n){return this.makeRotationFromQuaternion(t),this.scale(n),this.setPosition(e),this},decompose:function(){var n=new t,e=new c;return function(t,s,o){var r,i=this.elements,a=n.set(i[0],i[1],i[2]).length(),c=n.set(i[4],i[5],i[6]).length(),l=n.set(i[8],i[9],i[10]).length();return 0>this.determinant()&&(a=-a),t.x=i[12],t.y=i[13],t.z=i[14],e.copy(this),t=1/a,i=1/c,r=1/l,e.elements[0]*=t,e.elements[1]*=t,e.elements[2]*=t,e.elements[4]*=i,e.elements[5]*=i,e.elements[6]*=i,e.elements[8]*=r,e.elements[9]*=r,e.elements[10]*=r,s.setFromRotationMatrix(e),o.x=a,o.y=c,o.z=l,this}}(),makePerspective:function(e,t,n,s,o,i){void 0===i&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements;return a[0]=2*o/(t-e),a[4]=0,a[8]=(t+e)/(t-e),a[12]=0,a[1]=0,a[5]=2*o/(n-s),a[9]=(n+s)/(n-s),a[13]=0,a[2]=0,a[6]=0,a[10]=-(i+o)/(i-o),a[14]=-2*i*o/(i-o),a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(e,t,n,s,o,i){var a=this.elements,r=1/(t-e),c=1/(n-s),l=1/(i-o);return a[0]=2*r,a[4]=0,a[8]=0,a[12]=-(t+e)*r,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-(n+s)*c,a[2]=0,a[6]=0,a[10]=-2*l,a[14]=-(i+o)*l,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(e){var t,n=this.elements;e=e.elements;for(t=0;16>t;t++)if(n[t]!==e[t])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;16>n;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}),Object.assign(y,{slerp:function(e,t,n,s){return n.copy(e).slerp(t,s)},slerpFlat:function(e,t,n,s,o,i,a){var m,f,r=n[s+0],c=n[s+1],l=n[s+2];if(n=n[s+3],s=o[i+0],m=o[i+1],f=o[i+2],n!==(o=o[i+3])||r!==s||c!==m||l!==f){i=1-a;var d=r*s+c*m+l*f+n*o,h=0<=d?1:-1,u=1-d*d;u>Number.EPSILON&&(u=Math.sqrt(u),d=Math.atan2(u,d*h),i=Math.sin(i*d)/u,a=Math.sin(a*d)/u),r=r*i+s*(h*=a),c=c*i+m*h,l=l*i+f*h,n=n*i+o*h,i===1-a&&(r*=a=1/Math.sqrt(r*r+c*c+l*l+n*n),c*=a,l*=a,n*=a)}e[t]=r,e[t+1]=c,e[t+2]=l,e[t+3]=n}}),Object.defineProperties(y.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this.onChangeCallback()}}}),Object.assign(y.prototype,{set:function(e,t,n,s){return this._x=e,this._y=t,this._z=n,this._w=s,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var s=e._x,o=e._y,i=e._z;e=e.order;var n=Math.cos,c=Math.sin,a=n(s/2),r=n(o/2),n=n(i/2),s=c(s/2),o=c(o/2),i=c(i/2);return"XYZ"===e?(this._x=s*r*n+a*o*i,this._y=a*o*n-s*r*i,this._z=a*r*i+s*o*n,this._w=a*r*n-s*o*i):"YXZ"===e?(this._x=s*r*n+a*o*i,this._y=a*o*n-s*r*i,this._z=a*r*i-s*o*n,this._w=a*r*n+s*o*i):"ZXY"===e?(this._x=s*r*n-a*o*i,this._y=a*o*n+s*r*i,this._z=a*r*i+s*o*n,this._w=a*r*n-s*o*i):"ZYX"===e?(this._x=s*r*n-a*o*i,this._y=a*o*n+s*r*i,this._z=a*r*i-s*o*n,this._w=a*r*n+s*o*i):"YZX"===e?(this._x=s*r*n+a*o*i,this._y=a*o*n+s*r*i,this._z=a*r*i-s*o*n,this._w=a*r*n-s*o*i):"XZY"===e&&(this._x=s*r*n-a*o*i,this._y=a*o*n-s*r*i,this._z=a*r*i+s*o*n,this._w=a*r*n+s*o*i),!1!==t&&this.onChangeCallback(),this},setFromAxisAngle:function(e,t){t/=2;var n=Math.sin(t);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(t),this.onChangeCallback(),this},setFromRotationMatrix:function(e){t=(n=e.elements)[0],e=n[4];var t,n,o=n[8],i=n[1],s=n[5],a=n[9],r=n[2],c=n[6],l=t+s+(n=n[10]);return 0<l?(t=.5/Math.sqrt(l+1),this._w=.25/t,this._x=(c-a)*t,this._y=(o-r)*t,this._z=(i-e)*t):t>s&&t>n?(t=2*Math.sqrt(1+t-s-n),this._w=(c-a)/t,this._x=.25*t,this._y=(e+i)/t,this._z=(o+r)/t):s>n?(t=2*Math.sqrt(1+s-t-n),this._w=(o-r)/t,this._x=(e+i)/t,this._y=.25*t,this._z=(a+c)/t):(t=2*Math.sqrt(1+n-t-s),this._w=(i-e)/t,this._x=(o+r)/t,this._y=(a+c)/t,this._z=.25*t),this.onChangeCallback(),this},setFromUnitVectors:function(){var n,e=new t;return function(s,o){return void 0===e&&(e=new t),1e-6>(n=s.dot(o)+1)?(n=0,Math.abs(s.x)>Math.abs(s.z)?e.set(-s.y,s.x,0):e.set(0,-s.z,s.y)):e.crossVectors(s,o),this._x=e.x,this._y=e.y,this._z=e.z,this._w=n,this.normalize()}}(),inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._z=this._y=this._x=0,this._w=1):(e=1/e,this._x*=e,this._y*=e,this._z*=e,this._w*=e),this.onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var n=e._x,s=e._y,o=e._z;e=e._w;var i=t._x,a=t._y,r=t._z;return t=t._w,this._x=n*t+e*i+s*r-o*a,this._y=s*t+e*a+o*i-n*r,this._z=o*t+e*r+n*a-s*i,this._w=e*t-n*i-s*a-o*r,this.onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n,r,s=this._x,o=this._y,i=this._z,a=this._w;return 0>(n=a*e._w+s*e._x+o*e._y+i*e._z)?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,n=-n):this.copy(e),1<=n?(this._w=a,this._x=s,this._y=o,this._z=i,this):(e=Math.sqrt(1-n*n),.001>Math.abs(e)?(this._w=.5*(a+this._w),this._x=.5*(s+this._x),this._y=.5*(o+this._y),this._z=.5*(i+this._z),this):(r=Math.atan2(e,n),n=Math.sin((1-t)*r)/e,t=Math.sin(t*r)/e,this._w=a*n+this._w*t,this._x=s*n+this._x*t,this._y=o*n+this._y*t,this._z=i*n+this._z*t,this.onChangeCallback(),this))},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(t.prototype,{isVector3:!0,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setScalar:function(e){return this.z=this.y=this.x=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(){var e=new y;return function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(e.setFromEuler(t))}}(),applyAxisAngle:function(){var e=new y;return function(t,n){return this.applyQuaternion(e.setFromAxisAngle(t,n))}}(),applyMatrix3:function(e){var t=this.x,n=this.y,s=this.z;return e=e.elements,this.x=e[0]*t+e[3]*n+e[6]*s,this.y=e[1]*t+e[4]*n+e[7]*s,this.z=e[2]*t+e[5]*n+e[8]*s,this},applyMatrix4:function(e){var t=this.x,n=this.y,s=this.z,o=1/((e=e.elements)[3]*t+e[7]*n+e[11]*s+e[15]);return this.x=(e[0]*t+e[4]*n+e[8]*s+e[12])*o,this.y=(e[1]*t+e[5]*n+e[9]*s+e[13])*o,this.z=(e[2]*t+e[6]*n+e[10]*s+e[14])*o,this},applyQuaternion:function(e){var t=this.x,i=this.y,a=this.z,n=e.x,s=e.y,o=e.z,r=(e=e.w)*t+s*a-o*i,c=e*i+o*t-n*a,l=e*a+n*i-s*t,t=-n*t-s*i-o*a;return this.x=r*e+t*-n+c*-o-l*-s,this.y=c*e+t*-s+l*-n-r*-o,this.z=l*e+t*-o+r*-s-c*-n,this},project:function(){var e=new c;return function(t){return e.multiplyMatrices(t.projectionMatrix,e.getInverse(t.matrixWorld)),this.applyMatrix4(e)}}(),unproject:function(){var e=new c;return function(t){return e.multiplyMatrices(t.matrixWorld,e.getInverse(t.projectionMatrix)),this.applyMatrix4(e)}}(),transformDirection:function(e){var t=this.x,n=this.y,s=this.z;return e=e.elements,this.x=e[0]*t+e[4]*n+e[8]*s,this.y=e[1]*t+e[5]*n+e[9]*s,this.z=e[2]*t+e[6]*n+e[10]*s,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(){var e=new t,n=new t;return function(t,s){return e.set(t,t,t),n.set(s,s,s),this.clamp(e,n)}}(),clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},cross:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var n,s,o=e.x,i=e.y;return e=e.z,n=t.x,s=t.y,t=t.z,this.x=i*t-e*s,this.y=e*n-o*t,this.z=o*s-i*n,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:function(){var e=new t;return function(t){return e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e=new t;return function(t){return this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){return e=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq()),Math.acos(d.clamp(e,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n+(e=this.z-e.z)*e},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){var t=Math.sin(e.phi)*e.radius;return this.x=t*Math.sin(e.theta),this.y=Math.cos(e.phi)*e.radius,this.z=t*Math.cos(e.theta),this},setFromCylindrical:function(e){return this.x=e.radius*Math.sin(e.theta),this.y=e.y,this.z=e.radius*Math.cos(e.theta),this},setFromMatrixPosition:function(e){return e=e.elements,this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length();return e=this.setFromMatrixColumn(e,2).length(),this.x=t,this.y=n,this.z=e,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}}),Object.assign(A.prototype,{isMatrix3:!0,set:function(e,t,n,s,o,i,a,r,c){var l=this.elements;return l[0]=e,l[1]=s,l[2]=a,l[3]=t,l[4]=o,l[5]=r,l[6]=n,l[7]=i,l[8]=c,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements;return e=e.elements,t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],this},setFromMatrix4:function(e){return e=e.elements,this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},applyToBufferAttribute:function(){var e=new t;return function(t){for(var n=0,s=t.count;n<s;n++)e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.applyMatrix3(this),t.setXYZ(n,e.x,e.y,e.z);return t}}(),multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){n=e.elements,s=t.elements,t=this.elements,e=n[0];var n,o=n[3],i=n[6],a=n[1],r=n[4],c=n[7],l=n[2],d=n[5],u=(n=n[8],s[0]),h=s[3],m=s[6],f=s[1],p=s[4],g=s[7],v=s[2],b=s[5],s=s[8];return t[0]=e*u+o*f+i*v,t[3]=e*h+o*p+i*b,t[6]=e*m+o*g+i*s,t[1]=a*u+r*f+c*v,t[4]=a*h+r*p+c*b,t[7]=a*m+r*g+c*s,t[2]=l*u+d*f+n*v,t[5]=l*h+d*p+n*b,t[8]=l*m+d*g+n*s,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e,t=(e=this.elements)[0],n=e[1],s=e[2],o=e[3],i=e[4],a=e[5],r=e[6],c=e[7];return t*i*(e=e[8])-t*a*c-n*o*e+n*a*r+s*o*c-s*i*r},getInverse:function(e,t){e&&e.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument."),n=e.elements,e=this.elements;var n,s=n[0],o=n[1],i=n[2],a=n[3],r=n[4],c=n[5],l=n[6],d=n[7],u=(n=n[8])*r-c*d,h=c*l-n*a,m=d*a-r*l,f=s*u+o*h+i*m;if(0===f){if(!0===t)throw Error("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0");return console.warn("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0"),this.identity()}return t=1/f,e[0]=u*t,e[1]=(i*d-n*o)*t,e[2]=(c*o-i*r)*t,e[3]=h*t,e[4]=(n*s-i*l)*t,e[5]=(i*a-c*s)*t,e[6]=m*t,e[7]=(o*l-d*s)*t,e[8]=(r*s-o*a)*t,this},transpose:function(){var e=this.elements,t=e[1];return e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,n,s,o,i,a){var r=Math.cos(o);o=Math.sin(o),this.set(n*r,n*o,-n*(r*i+o*a)+i+e,-s*o,s*r,-s*(-o*i+r*a)+a+t,0,0,1)},scale:function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this},rotate:function(e){n=Math.cos(e),e=Math.sin(e);var n,t=this.elements,s=t[0],o=t[3],i=t[6],a=t[1],r=t[4],c=t[7];return t[0]=n*s+e*a,t[3]=n*o+e*r,t[6]=n*i+e*c,t[1]=-e*s+n*a,t[4]=-e*o+n*r,t[7]=-e*i+n*c,this},translate:function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this},equals:function(e){var t,n=this.elements;e=e.elements;for(t=0;9>t;t++)if(n[t]!==e[t])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;9>n;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}}),ro=0,b.DEFAULT_IMAGE=void 0,b.DEFAULT_MAPPING=300,Object.defineProperty(b.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(b.prototype,G.prototype,{constructor:b,isTexture:!0,clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){if(s=void 0===e||"string"==typeof e,!s&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];if(o={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY},void 0!==this.image){if(t=this.image,void 0===t.uuid&&(t.uuid=d.generateUUID()),!s&&void 0===e.images[t.uuid]){var t,n,s,o,i,a=e.images,r=t.uuid,c=t.uuid;t instanceof HTMLCanvasElement?(n=t):((n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=t.width,n.height=t.height,i=n.getContext("2d"),t instanceof ImageData?i.putImageData(t,0,0):i.drawImage(t,0,0,t.width,t.height)),n=2048<n.width||2048<n.height?n.toDataURL("image/jpeg",.6):n.toDataURL("image/png"),a[r]={uuid:c,url:n}}o.image=t.uuid}return s||(e.textures[this.uuid]=o),o},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(300===this.mapping){if(e.applyMatrix3(this.matrix),0>e.x||1<e.x)switch(this.wrapS){case 1e3:e.x-=Math.floor(e.x);break;case 1001:e.x=0>e.x?0:1;break;case 1002:e.x=1===Math.abs(Math.floor(e.x)%2)?Math.ceil(e.x)-e.x:e.x-Math.floor(e.x)}if(0>e.y||1<e.y)switch(this.wrapT){case 1e3:e.y-=Math.floor(e.y);break;case 1001:e.y=0>e.y?0:1;break;case 1002:e.y=1===Math.abs(Math.floor(e.y)%2)?Math.ceil(e.y)-e.y:e.y-Math.floor(e.y)}this.flipY&&(e.y=1-e.y)}}}),Object.assign(g.prototype,{isVector4:!0,set:function(e,t,n,s){return this.x=e,this.y=t,this.z=n,this.w=s,this},setScalar:function(e){return this.w=this.z=this.y=this.x=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,n=this.y,s=this.z,o=this.w;return e=e.elements,this.x=e[0]*t+e[4]*n+e[8]*s+e[12]*o,this.y=e[1]*t+e[5]*n+e[9]*s+e[13]*o,this.z=e[2]*t+e[6]*n+e[10]*s+e[14]*o,this.w=e[3]*t+e[7]*n+e[11]*s+e[15]*o,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return 1e-4>t?(this.x=1,this.z=this.y=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var r=(e=e.elements)[0],t=e[4],o=e[8],l=e[1],c=e[5],i=e[9],n=e[2],s=e[6],a=e[10];return.01>Math.abs(t-l)&&.01>Math.abs(o-n)&&.01>Math.abs(i-s)?.1>Math.abs(t+l)&&.1>Math.abs(o+n)&&.1>Math.abs(i+s)&&.1>Math.abs(r+c+a-3)?(this.set(1,0,0,0),this):(e=Math.PI,a=(a+1)/2,t=(t+l)/4,o=(o+n)/4,i=(i+s)/4,(r=(r+1)/2)>(c=(c+1)/2)&&r>a?.01>r?(s=0,t=n=.707106781):(n=t/(s=Math.sqrt(r)),t=o/s):c>a?.01>c?(s=.707106781,n=0,t=.707106781):(s=t/(n=Math.sqrt(c)),t=i/n):.01>a?(n=s=.707106781,t=0):(s=o/(t=Math.sqrt(a)),n=i/t),this.set(s,n,t,e),this):(e=Math.sqrt((s-i)*(s-i)+(o-n)*(o-n)+(l-t)*(l-t)),.001>Math.abs(e)&&(e=1),this.x=(s-i)/e,this.y=(o-n)/e,this.z=(l-t)/e,this.w=Math.acos((r+c+a-1)/2),this)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(){var e,t;return function(n,s){return void 0===e&&(e=new g,t=new g),e.set(n,n,n,n),t.set(s,s,s,s),this.clamp(e,t)}}(),clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),Object.assign(_t.prototype,G.prototype,{isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),yt.prototype=Object.create(_t.prototype),yt.prototype.constructor=yt,yt.prototype.isWebGLRenderTargetCube=!0,De.prototype=Object.create(b.prototype),De.prototype.constructor=De,De.prototype.isDataTexture=!0,ae.prototype=Object.create(b.prototype),ae.prototype.constructor=ae,ae.prototype.isCubeTexture=!0,Object.defineProperty(ae.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}});var d,w,S,R,Y,os,lo,qt,ro,oo=new b,so=new ae,no=[],to=[],Os=new Float32Array(16),eo=new Float32Array(9),_n,Zs,Qs,Ks,$s,Vs,Bs,ss,wn,xn,ns,Ms,Cn;Cs.prototype.setValue=function(e,t){for(var s,o=this.seq,n=0,i=o.length;n!==i;++n)s=o[n],s.setValue(e,t[s.id])},_n=/([\w\d_]+)(\])?(\[|\.)?/g,_e.prototype.setValue=function(e,t,n){void 0!==(t=this.map[t])&&t.setValue(e,n,this.renderer)},_e.prototype.setOptional=function(e,t,n){void 0!==(t=t[n])&&this.setValue(e,n,t)},_e.upload=function(e,t,n,s){for(var i,a,o=0,r=t.length;o!==r;++o)i=t[o],a=n[i.id],!1!==a.needsUpdate&&i.setValue(e,a.value,s)},_e.seqWithValue=function(e,t){for(var s,o=[],n=0,i=e.length;n!==i;++n)s=e[n],s.id in t&&o.push(s);return o},Zs={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Object.assign(a.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.b=this.g=this.r=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,n){return this.r=e,this.g=t,this.b=n,this},setHSL:function(){function e(e,t,n){return 0>n&&(n+=1),1<n&&--n,n<1/6?e+6*(t-e)*n:.5>n?t:n<2/3?e+6*(t-e)*(2/3-n):e}return function(t,n,s){return t=d.euclideanModulo(t,1),n=d.clamp(n,0,1),s=d.clamp(s,0,1),0===n?this.r=this.g=this.b=s:(s=2*s-(n=.5>=s?s*(1+n):s+n-s*n),this.r=e(s,n,t+1/3),this.g=e(s,n,t),this.b=e(s,n,t-1/3)),this}}(),setStyle:function(e){function s(t){void 0!==t&&1>parseFloat(t)&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}if(t=/^((?:rgb|hsl)a?)\(\s*([^)]*)\)/.exec(e))switch(n=t[2],t[1]){case"rgb":case"rgba":if(t=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n))return this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,s(t[5]),this;if(t=/^(\d+)%\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n))return this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,s(t[5]),this;break;case"hsl":case"hsla":if(t=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n)){n=parseFloat(t[1])/360;var t,n,o=parseInt(t[2],10)/100,i=parseInt(t[3],10)/100;return s(t[5]),this.setHSL(n,o,i)}}else if(t=/^#([A-Fa-f0-9]+)$/.exec(e)){if(3===(n=(t=t[1]).length))return this.r=parseInt(t.charAt(0)+t.charAt(0),16)/255,this.g=parseInt(t.charAt(1)+t.charAt(1),16)/255,this.b=parseInt(t.charAt(2)+t.charAt(2),16)/255,this;if(6===n)return this.r=parseInt(t.charAt(0)+t.charAt(1),16)/255,this.g=parseInt(t.charAt(2)+t.charAt(3),16)/255,this.b=parseInt(t.charAt(4)+t.charAt(5),16)/255,this}return e&&0<e.length&&(void 0!==(t=Zs[e])?this.setHex(t):console.warn("THREE.Color: Unknown color "+e)),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){return void 0===t&&(t=2),t=0<t?1/t:1,this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},convertGammaToLinear:function(){var e=this.r,t=this.g,n=this.b;return this.r=e*e,this.g=t*t,this.b=n*n,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){e=e||{h:0,s:0,l:0};var t,n,a,r=this.r,s=this.g,o=this.b,i=Math.max(r,s,o),c=((t=Math.min(r,s,o))+i)/2;if(t===i)t=n=0;else{switch(a=i-t,t=.5>=c?a/(i+t):a/(2-i-t),i){case r:n=(s-o)/a+(s<o?6:0);break;case s:n=(o-r)/a+2;break;case o:n=(r-s)/a+4}n/=6}return e.h=n,e.s=t,e.l=c,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,n){var s=this.getHSL();return s.h+=e,s.s+=t,s.l+=n,this.setHSL(s.h,s.s,s.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}});var r={common:{diffuse:{value:new a(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new A},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new n(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new a(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new a(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new A}}},E={merge:function(e){for(var n,s,o={},t=0;t<e.length;t++){s=this.clone(e[t]);for(n in s)o[n]=s[n]}return o},clone:function(e){var t,n,o,s={};for(n in e)for(o in s[n]={},e[n])t=e[n][o],t&&(t.isColor||t.isMatrix3||t.isMatrix4||t.isVector2||t.isVector3||t.isVector4||t.isTexture)?s[n][o]=t.clone():Array.isArray(t)?s[n][o]=t.slice():s[n][o]=t;return s}},f={alphamap_fragment:`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif
`,alphamap_pars_fragment:`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif
`,alphatest_fragment:`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif
`,aomap_fragment:`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( PHYSICAL )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif
`,aomap_pars_fragment:`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,begin_vertex:`
vec3 transformed = vec3( position );
`,beginnormal_vertex:`
vec3 objectNormal = vec3( normal );
`,bsdfs:`float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	if( decayExponent > 0.0 ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		float maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		return distanceFalloff * maxDistanceCutoffFactor;
#else
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
#endif
	}
	return 1.0;
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE  = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS  = 0.5 / LUT_SIZE;
	float theta = acos( dot( N, V ) );
	vec2 uv = vec2(
		sqrt( saturate( roughness ) ),
		saturate( theta / ( 0.5 * PI ) ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.86267 + (0.49788 + 0.01436 * y ) * y;
	float b = 3.45068 + (4.18814 + y) * y;
	float v = a / b;
	float theta_sintheta = (x > 0.0) ? v : 0.5 * inversesqrt( 1.0 - x * x ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	vec3 result = vec3( LTC_ClippedSphereFormFactor( vectorFormFactor ) );
	return result;
}
vec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;
	return specularColor * AB.x + AB.y;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
`,bumpmap_pars_fragment:`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif
`,clipping_planes_fragment:`#if NUM_CLIPPING_PLANES > 0
	for ( int i = 0; i < UNION_CLIPPING_PLANES; ++ i ) {
		vec4 plane = clippingPlanes[ i ];
		if ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;
	}
		
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; ++ i ) {
			vec4 plane = clippingPlanes[ i ];
			clipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;
		}
		if ( clipped ) discard;
	
	#endif
#endif
`,clipping_planes_pars_fragment:`#if NUM_CLIPPING_PLANES > 0
	#if ! defined( PHYSICAL ) && ! defined( PHONG )
		varying vec3 vViewPosition;
	#endif
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif
`,clipping_planes_pars_vertex:`#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )
	varying vec3 vViewPosition;
#endif
`,clipping_planes_vertex:`#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )
	vViewPosition = - mvPosition.xyz;
#endif
`,color_fragment:`#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment:`#ifdef USE_COLOR
	varying vec3 vColor;
#endif
`,color_pars_vertex:`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,color_vertex:`#ifdef USE_COLOR
	vColor.xyz = color.xyz;
#endif`,common:`#define PI 3.14159265359
#define PI2 6.28318530718
#define PI_HALF 1.5707963267949
#define RECIPROCAL_PI 0.31830988618
#define RECIPROCAL_PI2 0.15915494
#define LOG2 1.442695
#define EPSILON 1e-6
#define saturate(a) clamp( a, 0.0, 1.0 )
#define whiteCompliment(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
`,cube_uv_reflection_fragment:`#ifdef ENVMAP_TYPE_CUBE_UV
#define cubeUV_textureSize (1024.0)
int getFaceFromDirection(vec3 direction) {
	vec3 absDirection = abs(direction);
	int face = -1;
	if( absDirection.x > absDirection.z ) {
		if(absDirection.x > absDirection.y )
			face = direction.x > 0.0 ? 0 : 3;
		else
			face = direction.y > 0.0 ? 1 : 4;
	}
	else {
		if(absDirection.z > absDirection.y )
			face = direction.z > 0.0 ? 2 : 5;
		else
			face = direction.y > 0.0 ? 1 : 4;
	}
	return face;
}
#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)
#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))
vec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {
	float scale = exp2(cubeUV_maxLods1 - roughnessLevel);
	float dxRoughness = dFdx(roughness);
	float dyRoughness = dFdy(roughness);
	vec3 dx = dFdx( vec * scale * dxRoughness );
	vec3 dy = dFdy( vec * scale * dyRoughness );
	float d = max( dot( dx, dx ), dot( dy, dy ) );
	d = clamp(d, 1.0, cubeUV_rangeClamp);
	float mipLevel = 0.5 * log2(d);
	return vec2(floor(mipLevel), fract(mipLevel));
}
#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)
#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)
vec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {
	mipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;
	float a = 16.0 * cubeUV_rcpTextureSize;
	vec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );
	vec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;
	float powScale = exp2_packed.x * exp2_packed.y;
	float scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;
	float mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;
	bool bRes = mipLevel == 0.0;
	scale =  bRes && (scale < a) ? a : scale;
	vec3 r;
	vec2 offset;
	int face = getFaceFromDirection(direction);
	float rcpPowScale = 1.0 / powScale;
	if( face == 0) {
		r = vec3(direction.x, -direction.z, direction.y);
		offset = vec2(0.0+mipOffset,0.75 * rcpPowScale);
		offset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;
	}
	else if( face == 1) {
		r = vec3(direction.y, direction.x, direction.z);
		offset = vec2(scale+mipOffset, 0.75 * rcpPowScale);
		offset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;
	}
	else if( face == 2) {
		r = vec3(direction.z, direction.x, direction.y);
		offset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);
		offset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;
	}
	else if( face == 3) {
		r = vec3(direction.x, direction.z, direction.y);
		offset = vec2(0.0+mipOffset,0.5 * rcpPowScale);
		offset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;
	}
	else if( face == 4) {
		r = vec3(direction.y, direction.x, -direction.z);
		offset = vec2(scale+mipOffset, 0.5 * rcpPowScale);
		offset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;
	}
	else {
		r = vec3(direction.z, -direction.x, direction.y);
		offset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);
		offset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;
	}
	r = normalize(r);
	float texelOffset = 0.5 * cubeUV_rcpTextureSize;
	vec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;
	vec2 base = offset + vec2( texelOffset );
	return base + s * ( scale - 2.0 * texelOffset );
}
#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)
vec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {
	float roughnessVal = roughness* cubeUV_maxLods3;
	float r1 = floor(roughnessVal);
	float r2 = r1 + 1.0;
	float t = fract(roughnessVal);
	vec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);
	float s = mipInfo.y;
	float level0 = mipInfo.x;
	float level1 = level0 + 1.0;
	level1 = level1 > 5.0 ? 5.0 : level1;
	level0 += min( floor( s + 0.5 ), 5.0 );
	vec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);
	vec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));
	vec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);
	vec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));
	vec4 result = mix(color10, color20, t);
	return vec4(result.rgb, 1.0);
}
#endif
`,defaultnormal_vertex:`vec3 transformedNormal = normalMatrix * objectNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
`,displacementmap_pars_vertex:`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif
`,displacementmap_vertex:`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );
#endif
`,emissivemap_fragment:`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif
`,emissivemap_pars_fragment:`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif
`,encodings_fragment:`  gl_FragColor = linearToOutputTexel( gl_FragColor );
`,encodings_pars_fragment:`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.xyz * value.w * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.x, max( value.g, value.b ) );
	float M      = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M            = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.x, max( value.g, value.b ) );
	float D      = max( maxRange / maxRGB, 1.0 );
	D            = min( floor( D ) / 255.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value )  {
	vec3 Xp_Y_XYZp = value.rgb * cLogLuvM;
	Xp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract(Le);
	vResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;
	return vec4( max(vRGB, 0.0), 1.0 );
}
`,envmap_fragment:`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToVertex, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_EQUIREC )
		vec2 sampleUV;
		reflectVec = normalize( reflectVec );
		sampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
		sampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;
		vec4 envColor = texture2D( envMap, sampleUV );
	#elif defined( ENVMAP_TYPE_SPHERE )
		reflectVec = normalize( reflectVec );
		vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );
		vec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	envColor = envMapTexelToLinear( envColor );
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif
`,envmap_pars_fragment:`#if defined( USE_ENVMAP ) || defined( PHYSICAL )
	uniform float reflectivity;
	uniform float envMapIntensity;
#endif
#ifdef USE_ENVMAP
	#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )
		varying vec3 vWorldPosition;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	uniform float flipEnvMap;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif
`,envmap_pars_vertex:`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif
`,envmap_vertex:`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif
`,fog_vertex:`
#ifdef USE_FOG
fogDepth = -mvPosition.z;
#endif`,fog_pars_vertex:`#ifdef USE_FOG
  varying float fogDepth;
#endif
`,fog_fragment:`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif
`,fog_pars_fragment:`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif
`,gradientmap_pars_fragment:`#ifdef TOON
	uniform sampler2D gradientMap;
	vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
		float dotNL = dot( normal, lightDirection );
		vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
		#ifdef USE_GRADIENTMAP
			return texture2D( gradientMap, coord ).rgb;
		#else
			return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
		#endif
	}
#endif
`,lightmap_fragment:`#ifdef USE_LIGHTMAP
	reflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;
#endif
`,lightmap_pars_fragment:`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_vertex:`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
#if NUM_POINT_LIGHTS > 0
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
#endif
#if NUM_DIR_LIGHTS > 0
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
#endif
#if NUM_HEMI_LIGHTS > 0
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
#endif
`,lights_pars:`uniform vec3 ambientLightColor;
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
		int shadow;
		float shadowBias;
		float shadowRadius;
		vec2 shadowMapSize;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
		int shadow;
		float shadowBias;
		float shadowRadius;
		vec2 shadowMapSize;
		float shadowCameraNear;
		float shadowCameraFar;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
		int shadow;
		float shadowBias;
		float shadowRadius;
		vec2 shadowMapSize;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltcMat;	uniform sampler2D ltcMag;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif
#if defined( USE_ENVMAP ) && defined( PHYSICAL )
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			vec4 envMapColor = textureCubeUV( queryVec, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );
		#else
			vec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			vec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));
		#elif defined( ENVMAP_TYPE_EQUIREC )
			vec2 sampleUV;
			sampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
			sampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_SPHERE )
			vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif
`,lights_phong_fragment:`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;
`,lights_phong_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3	diffuseColor;
	vec3	specularColor;
	float	specularShininess;
	float	specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	#ifdef TOON
		vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#else
		float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
		vec3 irradiance = dotNL * directLight.color;
	#endif
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)
`,lights_physical_fragment:`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
material.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );
#ifdef STANDARD
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
	material.clearCoat = saturate( clearCoat );	material.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );
#endif
`,lights_physical_pars_fragment:`struct PhysicalMaterial {
	vec3	diffuseColor;
	float	specularRoughness;
	vec3	specularColor;
	#ifndef STANDARD
		float clearCoat;
		float clearCoatRoughness;
	#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearCoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos - halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos + halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos + halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos - halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		float norm = texture2D( ltcMag, uv ).a;
		vec4 t = texture2D( ltcMat, uv );
		mat3 mInv = mat3(
			vec3(   1,   0, t.y ),
			vec3(   0, t.z,   0 ),
			vec3( t.w,   0, t.x )
		);
		reflectedLight.directSpecular += lightColor * material.specularColor * norm * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifndef STANDARD
		float clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );
	#else
		float clearCoatDHR = 0.0;
	#endif
	reflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );
	reflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	#ifndef STANDARD
		reflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );
	#endif
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	#ifndef STANDARD
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		float dotNL = dotNV;
		float clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );
	#else
		float clearCoatDHR = 0.0;
	#endif
	reflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );
	#ifndef STANDARD
		reflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );
	#endif
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )
#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}
`,lights_template:`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = normalize( vViewPosition );
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#ifdef USE_SHADOWMAP
		directLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#ifdef USE_SHADOWMAP
		directLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#ifdef USE_SHADOWMAP
		directLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
#endif
#if defined( RE_IndirectDiffuse )
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#ifdef USE_LIGHTMAP
		vec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
	#endif
	#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )
		irradiance += getLightProbeIndirectIrradiance( geometry, 8 );
	#endif
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	vec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );
	#ifndef STANDARD
		vec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );
	#else
		vec3 clearCoatRadiance = vec3( 0.0 );
	#endif
	RE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );
#endif
`,logdepthbuf_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment:`#ifdef USE_LOGDEPTHBUF
	uniform float logDepthBufFC;
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
	#endif
#endif
`,logdepthbuf_pars_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
	#endif
	uniform float logDepthBufFC;
#endif`,logdepthbuf_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
	#else
		gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
		gl_Position.z *= gl_Position.w;
	#endif
#endif
`,map_fragment:`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif
`,map_pars_fragment:`#ifdef USE_MAP
	uniform sampler2D map;
#endif
`,map_particle_fragment:`#ifdef USE_MAP
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
`,map_particle_pars_fragment:`#ifdef USE_MAP
	uniform mat3 uvTransform;
	uniform sampler2D map;
#endif
`,metalnessmap_fragment:`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif
`,metalnessmap_pars_fragment:`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphnormal_vertex:`#ifdef USE_MORPHNORMALS
	objectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];
	objectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];
	objectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];
	objectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];
#endif
`,morphtarget_pars_vertex:`#ifdef USE_MORPHTARGETS
	#ifndef USE_MORPHNORMALS
	uniform float morphTargetInfluences[ 8 ];
	#else
	uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,morphtarget_vertex:`#ifdef USE_MORPHTARGETS
	transformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];
	transformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];
	transformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];
	transformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
	transformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];
	transformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];
	transformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];
	transformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];
	#endif
#endif
`,normal_fragment:`#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
#endif
#ifdef USE_NORMALMAP
	normal = perturbNormal2Arb( -vViewPosition, normal );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif
`,normalmap_pars_fragment:`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 S = normalize( q0 * st1.t - q1 * st0.t );
		vec3 T = normalize( -q0 * st1.s + q1 * st0.s );
		vec3 N = normalize( surf_norm );
		vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
		mapN.xy = normalScale * mapN.xy;
		mat3 tsn = mat3( S, T, N );
		return normalize( tsn * mapN );
	}
#endif
`,packing:`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}
`,premultiplied_alpha_fragment:`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif
`,project_vertex:`vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );
gl_Position = projectionMatrix * mvPosition;
`,dithering_fragment:`#if defined( DITHERING )
  gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif
`,dithering_pars_fragment:`#if defined( DITHERING )
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif
`,roughnessmap_fragment:`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif
`,roughnessmap_pars_fragment:`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHTS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];
	#endif
	#if NUM_SPOT_LIGHTS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];
	#endif
	#if NUM_POINT_LIGHTS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	float texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {
		const vec2 offset = vec2( 0.0, 1.0 );
		vec2 texelSize = vec2( 1.0 ) / size;
		vec2 centroidUV = floor( uv * size + 0.5 ) / size;
		float lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );
		float lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );
		float rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );
		float rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );
		vec2 f = fract( uv * size + 0.5 );
		float a = mix( lb, lt, f.y );
		float b = mix( rb, rt, f.y );
		float c = mix( a, b, f.x );
		return c;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			shadow = (
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 9.0 );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif
`,shadowmap_pars_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHTS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];
	#endif
	#if NUM_SPOT_LIGHTS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];
	#endif
	#if NUM_POINT_LIGHTS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];
	#endif
#endif
`,shadowmap_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHTS > 0
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;
	}
	#endif
	#if NUM_SPOT_LIGHTS > 0
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;
	}
	#endif
	#if NUM_POINT_LIGHTS > 0
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;
	}
	#endif
#endif
`,shadowmask_pars_fragment:`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHTS > 0
	DirectionalLight directionalLight;
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		shadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#endif
	#if NUM_SPOT_LIGHTS > 0
	SpotLight spotLight;
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		shadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#endif
	#if NUM_POINT_LIGHTS > 0
	PointLight pointLight;
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		shadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#endif
	#endif
	return shadow;
}
`,skinbase_vertex:`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex:`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif
`,skinning_vertex:`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif
`,skinnormal_vertex:`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
#endif
`,specularmap_fragment:`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment:`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment:`#if defined( TONE_MAPPING )
  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif
`,tonemapping_pars_fragment:`#ifndef saturate
	#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
uniform float toneMappingWhitePoint;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )
vec3 Uncharted2ToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
`,uv_pars_fragment:`#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )
	varying vec2 vUv;
#endif`,uv_pars_vertex:`#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
`,uv_vertex:`#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,uv2_pars_fragment:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,uv2_pars_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
#endif`,uv2_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = uv2;
#endif`,worldpos_vertex:`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );
#endif
`,cube_frag:`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldPosition;
void main() {
	gl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );
	gl_FragColor.a *= opacity;
}
`,cube_vert:`varying vec3 vWorldPosition;
#include <common>
void main() {
	vWorldPosition = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}
`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( gl_FragCoord.z );
	#endif
}
`,depth_vert:`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
}
`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}
`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}
`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldPosition;
#include <common>
void main() {
	vec3 direction = normalize( vWorldPosition );
	vec2 sampleUV;
	sampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;
	gl_FragColor = texture2D( tEquirect, sampleUV );
}
`,equirect_vert:`varying vec3 vWorldPosition;
#include <common>
void main() {
	vWorldPosition = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}
`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <premultiplied_alpha_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}
`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	vLineDistance = scale * lineDistance;
	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}
`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		reflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <premultiplied_alpha_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}
`,meshbasic_vert:`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}
`,meshlambert_frag:`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_pars_fragment>
#include <bsdfs>
#include <lights_pars>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	reflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}
`,meshlambert_vert:`#define LAMBERT
varying vec3 vLightFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}
`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_template>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}
`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}
`,meshphysical_frag:`#define PHYSICAL
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifndef STANDARD
	uniform float clearCoat;
	uniform float clearCoatRoughness;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <lights_pars>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_template>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}
`,meshphysical_vert:`#define PHYSICAL
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}
`,normal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	#include <normal_fragment>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}
`,normal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}
`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <packing>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <premultiplied_alpha_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}
`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <project_vertex>
	#ifdef USE_SIZEATTENUATION
		gl_PointSize = size * ( scale / - mvPosition.z );
	#else
		gl_PointSize = size;
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}
`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <fog_fragment>
}
`,shadow_vert:`#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}
`},Fe={basic:{uniforms:E.merge([r.common,r.specularmap,r.envmap,r.aomap,r.lightmap,r.fog]),vertexShader:f.meshbasic_vert,fragmentShader:f.meshbasic_frag},lambert:{uniforms:E.merge([r.common,r.specularmap,r.envmap,r.aomap,r.lightmap,r.emissivemap,r.fog,r.lights,{emissive:{value:new a(0)}}]),vertexShader:f.meshlambert_vert,fragmentShader:f.meshlambert_frag},phong:{uniforms:E.merge([r.common,r.specularmap,r.envmap,r.aomap,r.lightmap,r.emissivemap,r.bumpmap,r.normalmap,r.displacementmap,r.gradientmap,r.fog,r.lights,{emissive:{value:new a(0)},specular:{value:new a(1118481)},shininess:{value:30}}]),vertexShader:f.meshphong_vert,fragmentShader:f.meshphong_frag},standard:{uniforms:E.merge([r.common,r.envmap,r.aomap,r.lightmap,r.emissivemap,r.bumpmap,r.normalmap,r.displacementmap,r.roughnessmap,r.metalnessmap,r.fog,r.lights,{emissive:{value:new a(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:f.meshphysical_vert,fragmentShader:f.meshphysical_frag},points:{uniforms:E.merge([r.points,r.fog]),vertexShader:f.points_vert,fragmentShader:f.points_frag},dashed:{uniforms:E.merge([r.common,r.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:f.linedashed_vert,fragmentShader:f.linedashed_frag},depth:{uniforms:E.merge([r.common,r.displacementmap]),vertexShader:f.depth_vert,fragmentShader:f.depth_frag},normal:{uniforms:E.merge([r.common,r.bumpmap,r.normalmap,r.displacementmap,{opacity:{value:1}}]),vertexShader:f.normal_vert,fragmentShader:f.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:f.cube_vert,fragmentShader:f.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:f.equirect_vert,fragmentShader:f.equirect_frag},distanceRGBA:{uniforms:E.merge([r.common,r.displacementmap,{referencePosition:{value:new t},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:f.distanceRGBA_vert,fragmentShader:f.distanceRGBA_frag},shadow:{uniforms:E.merge([r.lights,r.fog,{color:{value:new a(0)},opacity:{value:1}}]),vertexShader:f.shadow_vert,fragmentShader:f.shadow_frag}};Fe.physical={uniforms:E.merge([Fe.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:f.meshphysical_vert,fragmentShader:f.meshphysical_frag},Object.assign(vn.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new n;return function(t,n){return n=e.copy(n).multiplyScalar(.5),this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return e=e||new n,this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return e=e||new n,this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return(t||new n).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return(t||new n).copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new n;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Qt.prototype=Object.create(b.prototype),Qt.prototype.constructor=Qt,Qs=0,Object.assign(h.prototype,G.prototype,{isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(s in e){var n,s,t=e[s];void 0===t?console.warn("THREE.Material: '"+s+"' parameter is undefined."):"shading"===s?(console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===t):(n=this[s],void 0===n?console.warn("THREE."+this.type+": '"+s+"' is not a property of this material."):n&&n.isColor?n.set(t):n&&n.isVector3&&t&&t.isVector3?n.copy(t):this[s]="overdraw"===s?Number(t):t)}},toJSON:function(e){function s(e){var t,n,s=[];for(n in e)t=e[n],delete t.metadata,s.push(t);return s}var t,n=void 0===e||"string"==typeof e;return n&&(e={textures:{},images:{}}),t={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}},t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),this.color&&this.color.isColor&&(t.color=this.color.getHex()),void 0!==this.roughness&&(t.roughness=this.roughness),void 0!==this.metalness&&(t.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(t.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(t.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(t.specular=this.specular.getHex()),void 0!==this.shininess&&(t.shininess=this.shininess),void 0!==this.clearCoat&&(t.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(t.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(t.map=this.map.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(t.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(t.lightMap=this.lightMap.toJSON(e).uuid),this.bumpMap&&this.bumpMap.isTexture&&(t.bumpMap=this.bumpMap.toJSON(e).uuid,t.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(t.normalMap=this.normalMap.toJSON(e).uuid,t.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(t.displacementMap=this.displacementMap.toJSON(e).uuid,t.displacementScale=this.displacementScale,t.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(t.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(t.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(t.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(t.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(t.envMap=this.envMap.toJSON(e).uuid,t.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(t.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(t.size=this.size),void 0!==this.sizeAttenuation&&(t.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(t.blending=this.blending),!0===this.flatShading&&(t.flatShading=this.flatShading),0!==this.side&&(t.side=this.side),0!==this.vertexColors&&(t.vertexColors=this.vertexColors),1>this.opacity&&(t.opacity=this.opacity),!0===this.transparent&&(t.transparent=this.transparent),t.depthFunc=this.depthFunc,t.depthTest=this.depthTest,t.depthWrite=this.depthWrite,0!==this.rotation&&(t.rotation=this.rotation),1!==this.linewidth&&(t.linewidth=this.linewidth),void 0!==this.dashSize&&(t.dashSize=this.dashSize),void 0!==this.gapSize&&(t.gapSize=this.gapSize),void 0!==this.scale&&(t.scale=this.scale),!0===this.dithering&&(t.dithering=!0),0<this.alphaTest&&(t.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(t.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(t.wireframe=this.wireframe),1<this.wireframeLinewidth&&(t.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(t.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(t.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(t.morphTargets=!0),!0===this.skinning&&(t.skinning=!0),!1===this.visible&&(t.visible=!1),"{}"!==JSON.stringify(this.userData)&&(t.userData=this.userData),n&&(n=s(e.textures),e=s(e.images),0<n.length&&(t.textures=n),0<e.length&&(t.images=e)),t},clone:function(){return(new this.constructor).copy(this)},copy:function(e){if(this.name=e.name,this.fog=e.fog,this.lights=e.lights,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.overdraw=e.overdraw,this.visible=e.visible,this.userData=JSON.parse(JSON.stringify(e.userData)),this.clipShadows=e.clipShadows,this.clipIntersection=e.clipIntersection,t=null,null!==(e=e.clippingPlanes))for(var t,s=e.length,n=(t=Array(s),0);n!==s;++n)t[n]=e[n].clone();return this.clippingPlanes=t,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),oe.prototype=Object.create(h.prototype),oe.prototype.constructor=oe,oe.prototype.isMeshDepthMaterial=!0,oe.prototype.copy=function(e){return h.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},se.prototype=Object.create(h.prototype),se.prototype.constructor=se,se.prototype.isMeshDistanceMaterial=!0,se.prototype.copy=function(e){return h.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this},Object.assign(X.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var i=1/0,a=1/0,r=1/0,c=-1/0,l=-1/0,d=-1/0,t=0,u=e.length;t<u;t+=3){var n=e[t],s=e[t+1],o=e[t+2];n<i&&(i=n),s<a&&(a=s),o<r&&(r=o),n>c&&(c=n),s>l&&(l=s),o>d&&(d=o)}return this.min.set(i,a,r),this.max.set(c,l,d),this},setFromBufferAttribute:function(e){for(var i=1/0,a=1/0,r=1/0,c=-1/0,l=-1/0,d=-1/0,t=0,u=e.count;t<u;t++){var n=e.getX(t),s=e.getY(t),o=e.getZ(t);n<i&&(i=n),s<a&&(a=s),o<r&&(r=o),n>c&&(c=n),s>l&&(l=s),o>d&&(d=o)}return this.min.set(i,a,r),this.max.set(c,l,d),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new t;return function(t,n){return n=e.copy(n).multiplyScalar(.5),this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return e=e||new t,this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return e=e||new t,this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(){function i(t){var i=t.geometry;if(void 0!==i)if(i.isGeometry)for(i=i.vertices,e=0,s=i.length;e<s;e++)n.copy(i[e]),n.applyMatrix4(t.matrixWorld),o.expandByPoint(n);else if(i.isBufferGeometry&&void 0!==(i=i.attributes.position))for(e=0,s=i.count;e<s;e++)n.fromBufferAttribute(i,e).applyMatrix4(t.matrixWorld),o.expandByPoint(n)}var e,s,o,n=new t;return function(e){return o=this,e.updateMatrixWorld(!0),e.traverse(i),this}}(),containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,n){return(n||new t).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(){var e=new t;return function(t){return this.clampPoint(t.center,e),e.distanceToSquared(t.center)<=t.radius*t.radius}}(),intersectsPlane:function(e){if(0<e.normal.x)var t=e.normal.x*this.min.x,n=e.normal.x*this.max.x;else t=e.normal.x*this.max.x,n=e.normal.x*this.min.x;return 0<e.normal.y?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),0<e.normal.z?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=e.constant&&n>=e.constant},clampPoint:function(e,n){return(n||new t).copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new t;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),getBoundingSphere:function(){var e=new t;return function(t){return t=t||new V,this.getCenter(t.center),t.radius=.5*this.getSize(e).length(),t}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(){var e=[new t,new t,new t,new t,new t,new t,new t,new t];return function(t){return this.isEmpty()||(e[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),e[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),e[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),e[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),e[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),e[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),e[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),e[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(e)),this}}(),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(V.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(){var e=new X;return function(t,n){s=this.center,void 0!==n?s.copy(n):e.setFromPoints(t).getCenter(s);for(var s,o=n=0,i=t.length;o<i;o++)n=Math.max(n,s.distanceToSquared(t[o]));return this.radius=Math.sqrt(n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return 0>=this.radius},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,n){var s=this.center.distanceToSquared(e);return(n=n||new t).copy(e),s>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n},getBoundingBox:function(e){return(e=e||new X).set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius*=e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}}),Object.assign(L.prototype,{set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,n,s){return this.normal.set(e,t,n),this.constant=s,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new t,n=new t;return function(t,s,o){return s=e.subVectors(o,s).cross(n.subVectors(t,s)).normalize(),this.setFromNormalAndCoplanarPoint(s,t),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,n){return(n||new t).copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(){var e=new t;return function(n,s){s=s||new t;var i=n.delta(e),o=this.normal.dot(i);if(0===o){if(0===this.distanceToPoint(n.start))return s.copy(n.start)}else if(!(0>(o=-(n.start.dot(this.normal)+this.constant)/o)||1<o))return s.copy(i).multiplyScalar(o).add(n.start)}}(),intersectsLine:function(e){var t=this.distanceToPoint(e.start);return e=this.distanceToPoint(e.end),0>t&&0<e||0>e&&0<t},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return(e||new t).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new t,n=new A;return function(t,s){return s=s||n.getNormalMatrix(t),t=this.coplanarPoint(e).applyMatrix4(t),s=this.normal.applyMatrix3(s).normalize(),this.constant=-t.dot(s),this}}(),translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}}),Object.assign(jn.prototype,{set:function(e,t,n,s,o,i){var a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(s),a[4].copy(o),a[5].copy(i),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var n=this.planes,t=0;6>t;t++)n[t].copy(e.planes[t]);return this},setFromMatrix:function(e){n=this.planes,e=(t=e.elements)[0];var n,g=t[1],h=t[2],i=t[3],l=t[4],c=t[5],r=t[6],s=t[7],a=t[8],d=t[9],u=t[10],o=t[11],m=t[12],f=t[13],p=t[14],t=t[15];return n[0].setComponents(i-e,s-l,o-a,t-m).normalize(),n[1].setComponents(i+e,s+l,o+a,t+m).normalize(),n[2].setComponents(i+g,s+c,o+d,t+f).normalize(),n[3].setComponents(i-g,s-c,o-d,t-f).normalize(),n[4].setComponents(i-h,s-r,o-u,t-p).normalize(),n[5].setComponents(i+h,s+r,o+u,t+p).normalize(),this},intersectsObject:function(){var e=new V;return function(t){var n=t.geometry;return null===n.boundingSphere&&n.computeBoundingSphere(),e.copy(n.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSprite:function(){var e=new V;return function(t){return e.center.set(0,0,0),e.radius=.7071067811865476,e.applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSphere:function(e){var t,n=this.planes,s=e.center;e=-e.radius;for(t=0;6>t;t++)if(n[t].distanceToPoint(s)<e)return!1;return!0},intersectsBox:function(){var e=new t,n=new t;return function(t){for(var s,i,a=this.planes,o=0;6>o;o++)if(s=a[o],e.x=0<s.normal.x?t.min.x:t.max.x,n.x=0<s.normal.x?t.max.x:t.min.x,e.y=0<s.normal.y?t.min.y:t.max.y,n.y=0<s.normal.y?t.max.y:t.min.y,e.z=0<s.normal.z?t.min.z:t.max.z,n.z=0<s.normal.z?t.max.z:t.min.z,i=s.distanceToPoint(e),s=s.distanceToPoint(n),0>i&&0>s)return!1;return!0}}(),containsPoint:function(e){for(var n=this.planes,t=0;6>t;t++)if(0>n[t].distanceToPoint(e))return!1;return!0}}),ne.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" "),ne.DefaultOrder="XYZ",Object.defineProperties(ne.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this.onChangeCallback()}}}),Object.assign(ne.prototype,{isEuler:!0,set:function(e,t,n,s){return this._x=e,this._y=t,this._z=n,this._order=s||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,t,n){o=d.clamp,e=(s=e.elements)[0];var o,a=s[4],r=s[8],c=s[1],i=s[5],l=s[9],u=s[2],h=s[6],s=s[10];return"XYZ"===(t=t||this._order)?(this._y=Math.asin(o(r,-1,1)),.99999>Math.abs(r)?(this._x=Math.atan2(-l,s),this._z=Math.atan2(-a,e)):(this._x=Math.atan2(h,i),this._z=0)):"YXZ"===t?(this._x=Math.asin(-o(l,-1,1)),.99999>Math.abs(l)?(this._y=Math.atan2(r,s),this._z=Math.atan2(c,i)):(this._y=Math.atan2(-u,e),this._z=0)):"ZXY"===t?(this._x=Math.asin(o(h,-1,1)),.99999>Math.abs(h)?(this._y=Math.atan2(-u,s),this._z=Math.atan2(-a,i)):(this._y=0,this._z=Math.atan2(c,e))):"ZYX"===t?(this._y=Math.asin(-o(u,-1,1)),.99999>Math.abs(u)?(this._x=Math.atan2(h,s),this._z=Math.atan2(c,e)):(this._x=0,this._z=Math.atan2(-a,i))):"YZX"===t?(this._z=Math.asin(o(c,-1,1)),.99999>Math.abs(c)?(this._x=Math.atan2(-l,i),this._y=Math.atan2(-u,e)):(this._x=0,this._y=Math.atan2(r,s))):"XZY"===t?(this._z=Math.asin(-o(a,-1,1)),.99999>Math.abs(a)?(this._x=Math.atan2(h,i),this._y=Math.atan2(r,e)):(this._x=Math.atan2(-l,s),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==n&&this.onChangeCallback(),this},setFromQuaternion:function(){var e=new c;return function(t,n,s){return e.makeRotationFromQuaternion(t),this.setFromRotationMatrix(e,n,s)}}(),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(){var e=new y;return function(t){return e.setFromEuler(this),this.setFromQuaternion(e,t)}}(),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new t(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(ms.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask=this.mask|1<<e|0},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},test:function(e){return 0!=(this.mask&e.mask)}}),Ks=0,o.DefaultUp=new t(0,1,0),o.DefaultMatrixAutoUpdate=!0,Object.assign(o.prototype,G.prototype,{isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(){var e=new y;return function(t,n){return e.setFromAxisAngle(t,n),this.quaternion.multiply(e),this}}(),rotateOnWorldAxis:function(){var e=new y;return function(t,n){return e.setFromAxisAngle(t,n),this.quaternion.premultiply(e),this}}(),rotateX:function(){var e=new t(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new t(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new t(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new t;return function(t,n){return e.copy(t).applyQuaternion(this.quaternion),this.position.add(e.multiplyScalar(n)),this}}(),translateX:function(){var e=new t(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new t(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new t(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var e=new c;return function(t){return t.applyMatrix4(e.getInverse(this.matrixWorld))}}(),lookAt:function(){var n=new c,e=new t;return function(t,s,o){t.isVector3?e.copy(t):e.set(t,s,o),this.isCamera?n.lookAt(this.position,e,this.up):n.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(n)}}(),add:function(e){if(1<arguments.length){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(1<arguments.length){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}return-1!==(t=this.children.indexOf(e))&&(e.parent=null,e.dispatchEvent({type:"removed"}),this.children.splice(t,1)),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var s,n=0,o=this.children.length;n<o;n++)if(s=this.children[n].getObjectByProperty(e,t),void 0!==s)return s},getWorldPosition:function(e){return e=e||new t,this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var e=new t,n=new t;return function(t){return t=t||new y,this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,t,n),t}}(),getWorldRotation:function(){var e=new y;return function(t){return t=t||new ne,this.getWorldQuaternion(e),t.setFromQuaternion(e,this.rotation.order,!1)}}(),getWorldScale:function(){var e=new t,n=new y;return function(s){return s=s||new t,this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,n,s),s}}(),getWorldDirection:function(){var e=new y;return function(n){return n=n||new t,this.getWorldQuaternion(e),n.set(0,0,1).applyQuaternion(e)}}(),raycast:function(){},traverse:function(e){e(this);for(var n=this.children,t=0,s=n.length;t<s;t++)n[t].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var n=this.children,t=0,s=n.length;t<s;t++)n[t].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var n=this.children,t=0,s=n.length;t<s;t++)n[t].updateMatrixWorld(e)},toJSON:function(e){function c(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}function a(e){var t,n,s=[];for(n in e)t=e[n],delete t.metadata,s.push(t);return s}if(o=void 0===e||"string"==typeof e,s={},o&&(e={geometries:{},materials:{},textures:{},images:{}},s.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"}),t={},t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),!0===this.castShadow&&(t.castShadow=!0),!0===this.receiveShadow&&(t.receiveShadow=!0),!1===this.visible&&(t.visible=!1),"{}"!==JSON.stringify(this.userData)&&(t.userData=this.userData),t.matrix=this.matrix.toArray(),void 0!==this.geometry&&(t.geometry=c(e.geometries,this.geometry)),void 0!==this.material)if(Array.isArray(this.material)){for(var t,s,o,i=[],n=0,r=this.material.length;n<r;n++)i.push(c(e.materials,this.material[n]));t.material=i}else t.material=c(e.materials,this.material);if(0<this.children.length)for(t.children=[],n=0;n<this.children.length;n++)t.children.push(this.children[n].toJSON(e).object);return o&&(o=a(e.geometries),i=a(e.materials),n=a(e.textures),r=a(e.images),0<o.length&&(s.geometries=o),0<i.length&&(s.materials=i),0<n.length&&(s.textures=n),0<r.length&&(s.images=r)),s.object=t,s},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(t=0;t<e.children.length;t++)this.add(e.children[t].clone());return this}}),K.prototype=Object.assign(Object.create(o.prototype),{constructor:K,isCamera:!0,copy:function(e,t){return o.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this},getWorldDirection:function(){var e=new y;return function(n){return n=n||new t,this.getWorldQuaternion(e),n.set(0,0,-1).applyQuaternion(e)}}(),updateMatrixWorld:function(e){o.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),Ze.prototype=Object.assign(Object.create(K.prototype),{constructor:Ze,isOrthographicCamera:!0,copy:function(e,t){return K.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,n,s,o,i){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=s,this.view.width=o,this.view.height=i,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var s,i,n=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),o=(t=(this.right+this.left)/2)-n,t=t+n,n=(s=(this.top+this.bottom)/2)+e,e=s-e;null!==this.view&&this.view.enabled&&(t=this.zoom/(this.view.width/this.view.fullWidth),e=this.zoom/(this.view.height/this.view.fullHeight),i=(this.right-this.left)/this.view.width,s=(this.top-this.bottom)/this.view.height,t=(o=o+this.view.offsetX/t*i)+this.view.width/t*i,e=(n=n-this.view.offsetY/e*s)-this.view.height/e*s),this.projectionMatrix.makeOrthographic(o,t,n,e,this.near,this.far)},toJSON:function(e){return(e=o.prototype.toJSON.call(this,e)).object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}),Object.assign(Q.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,n=e.vertexNormals.length;t<n;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,n=e.vertexColors.length;t<n;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}}),$s=0,Object.assign(l.prototype,G.prototype,{isGeometry:!0,applyMatrix:function(e){for(var n,i,o=(new A).getNormalMatrix(e),t=0,s=this.vertices.length;t<s;t++)this.vertices[t].applyMatrix4(e);for(t=0,s=this.faces.length;t<s;t++){(e=this.faces[t]).normal.applyMatrix3(o).normalize();for(n=0,i=e.vertexNormals.length;n<i;n++)e.vertexNormals[n].applyMatrix3(o).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.normalsNeedUpdate=this.verticesNeedUpdate=!0,this},rotateX:function(){var e=new c;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new c;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new c;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new c;return function(t,n,s){return e.makeTranslation(t,n,s),this.applyMatrix(e),this}}(),scale:function(){var e=new c;return function(t,n,s){return e.makeScale(t,n,s),this.applyMatrix(e),this}}(),lookAt:function(){var e=new o;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),fromBufferGeometry:function(e){function h(e,t,n,s){s=new Q(e,t,n,void 0!==u?[f[e].clone(),f[t].clone(),f[n].clone()]:[],void 0!==l?[c.colors[e].clone(),c.colors[t].clone(),c.colors[n].clone()]:[],s),c.faces.push(s),void 0!==m&&c.faceVertexUvs[0].push([p[e].clone(),p[t].clone(),p[n].clone()]),void 0!==d&&c.faceVertexUvs[1].push([g[e].clone(),g[t].clone(),g[n].clone()])}var v,b,c=this,i=null!==e.index?e.index.array:void 0,s=e.attributes,r=s.position.array,u=void 0!==s.normal?s.normal.array:void 0,l=void 0!==s.color?s.color.array:void 0,m=void 0!==s.uv?s.uv.array:void 0,d=void 0!==s.uv2?s.uv2.array:void 0;void 0!==d&&(this.faceVertexUvs[1]=[]);for(var f=[],p=[],g=[],o=s=0;s<r.length;s+=3,o+=2)c.vertices.push(new t(r[s],r[s+1],r[s+2])),void 0!==u&&f.push(new t(u[s],u[s+1],u[s+2])),void 0!==l&&c.colors.push(new a(l[s],l[s+1],l[s+2])),void 0!==m&&p.push(new n(m[o],m[o+1])),void 0!==d&&g.push(new n(d[o],d[o+1]));if(v=e.groups,0<v.length)for(s=0;s<v.length;s++){o=b=(r=v[s]).start;for(b=b+r.count;o<b;o+=3)void 0!==i?h(i[o],i[o+1],i[o+2],r.materialIndex):h(o,o+1,o+2,r.materialIndex)}else if(void 0!==i)for(s=0;s<i.length;s+=3)h(i[s],i[s+1],i[s+2]);else for(s=0;s<r.length/3;s+=3)h(s,s+1,s+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var e=this.boundingBox.getCenter().negate();return this.translate(e.x,e.y,e.z),e},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=0===(e=this.boundingSphere.radius)?1:1/e,n=new c;return n.set(e,0,0,-e*t.x,0,e,0,-e*t.y,0,0,e,-e*t.z,0,0,0,1),this.applyMatrix(n),this},computeFaceNormals:function(){for(var e=new t,o=new t,s=0,a=this.faces.length;s<a;s++){var n=this.faces[s],r=this.vertices[n.a],i=this.vertices[n.b];e.subVectors(this.vertices[n.c],i),o.subVectors(r,i),e.cross(o),e.normalize(),n.normal.copy(e)}},computeVertexNormals:function(e){void 0===e&&(e=!0),s=Array(this.vertices.length),o=0;for(n=this.vertices.length;o<n;o++)s[o]=new t;if(e){a=new t,r=new t;for(e=0,o=this.faces.length;e<o;e++){n=this.faces[e];var n,s,o,a,r,i=this.vertices[n.a],c=this.vertices[n.b],l=this.vertices[n.c];a.subVectors(l,c),r.subVectors(i,c),a.cross(r),s[n.a].add(a),s[n.b].add(a),s[n.c].add(a)}}else for(this.computeFaceNormals(),e=0,o=this.faces.length;e<o;e++)s[(n=this.faces[e]).a].add(n.normal),s[n.b].add(n.normal),s[n.c].add(n.normal);for(o=0,n=this.vertices.length;o<n;o++)s[o].normalize();for(e=0,o=this.faces.length;e<o;e++)3===(i=(n=this.faces[e]).vertexNormals).length?(i[0].copy(s[n.a]),i[1].copy(s[n.b]),i[2].copy(s[n.c])):(i[0]=s[n.a].clone(),i[1]=s[n.b].clone(),i[2]=s[n.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){this.computeFaceNormals(),n=0;for(s=this.faces.length;n<s;n++){var n,s,e=this.faces[n],t=e.vertexNormals;3===t.length?(t[0].copy(e.normal),t[1].copy(e.normal),t[2].copy(e.normal)):(t[0]=e.normal.clone(),t[1]=e.normal.clone(),t[2]=e.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){s=0;for(o=this.faces.length;s<o;s++){e=this.faces[s],e.__originalFaceNormal?e.__originalFaceNormal.copy(e.normal):e.__originalFaceNormal=e.normal.clone(),e.__originalVertexNormals||(e.__originalVertexNormals=[]),n=0;for(c=e.vertexNormals.length;n<c;n++)e.__originalVertexNormals[n]?e.__originalVertexNormals[n].copy(e.vertexNormals[n]):e.__originalVertexNormals[n]=e.vertexNormals[n].clone()}i=new l;for(i.faces=this.faces,n=0,c=this.morphTargets.length;n<c;n++){if(!this.morphNormals[n]){this.morphNormals[n]={},this.morphNormals[n].faceNormals=[],this.morphNormals[n].vertexNormals=[],e=this.morphNormals[n].faceNormals,a=this.morphNormals[n].vertexNormals;for(s=0,o=this.faces.length;s<o;s++){var e,n,s,o,i,a,c,d=new t,r={a:new t,b:new t,c:new t};e.push(d),a.push(r)}}for(a=this.morphNormals[n],i.vertices=this.morphTargets[n].vertices,i.computeFaceNormals(),i.computeVertexNormals(),s=0,o=this.faces.length;s<o;s++)e=this.faces[s],d=a.faceNormals[s],r=a.vertexNormals[s],d.copy(e.normal),r.a.copy(e.vertexNormals[0]),r.b.copy(e.vertexNormals[1]),r.c.copy(e.vertexNormals[2])}for(s=0,o=this.faces.length;s<o;s++)(e=this.faces[s]).normal=e.__originalFaceNormal,e.vertexNormals=e.__originalVertexNormals},computeLineDistances:function(){for(var n=0,t=this.vertices,e=0,s=t.length;e<s;e++)0<e&&(n+=t[e].distanceTo(t[e-1])),this.lineDistances[e]=n},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new X),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new V),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,n){if(e&&e.isGeometry){{var i,a,r,u,d=this.vertices.length,c=this.vertices,s=e.vertices,p=this.faces,m=e.faces,f=this.faceVertexUvs[0],h=e.faceVertexUvs[0],o=this.colors,l=e.colors;void 0===n&&(n=0),void 0!==t&&(r=(new A).getNormalMatrix(t)),e=0;for(a=s.length;e<a;e++)i=s[e].clone(),void 0!==t&&i.applyMatrix4(t),c.push(i);for(e=0,a=l.length;e<a;e++)o.push(l[e].clone());for(e=0,a=m.length;e<a;e++){u=(s=m[e]).vertexNormals,l=s.vertexColors;for((o=new Q(s.a+d,s.b+d,s.c+d)).normal.copy(s.normal),void 0!==r&&o.normal.applyMatrix3(r).normalize(),t=0,c=u.length;t<c;t++)i=u[t].clone(),void 0!==r&&i.applyMatrix3(r).normalize(),o.vertexNormals.push(i);for(o.color.copy(s.color),t=0,c=l.length;t<c;t++)i=l[t],o.vertexColors.push(i.clone());o.materialIndex=s.materialIndex+n,p.push(o)}for(e=0,a=h.length;e<a;e++)if(r=[],void 0!==(n=h[e])){for(t=0,c=n.length;t<c;t++)r.push(n[t].clone());f.push(r)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var n,i,o={},a=[],s=[],e=Math.pow(10,4),t=0;for(i=this.vertices.length;t<i;t++)n=this.vertices[t],void 0===o[n=Math.round(n.x*e)+"_"+Math.round(n.y*e)+"_"+Math.round(n.z*e)]?(o[n]=t,a.push(this.vertices[t]),s[t]=a.length-1):s[t]=s[o[n]];for(o=[],t=0,i=this.faces.length;t<i;t++)for((e=this.faces[t]).a=s[e.a],e.b=s[e.b],e.c=s[e.c],e=[e.a,e.b,e.c],n=0;3>n;n++)if(e[n]===e[(n+1)%3]){o.push(t);break}for(t=o.length-1;0<=t;t--)for(e=o[t],this.faces.splice(e,1),s=0,i=this.faceVertexUvs.length;s<i;s++)this.faceVertexUvs[s].splice(e,1);return t=this.vertices.length-a.length,this.vertices=a,t},setFromPoints:function(e){this.vertices=[];for(var n,s=0,o=e.length;s<o;s++)n=e[s],this.vertices.push(new t(n.x,n.y,n.z||0));return this},sortFacesByMaterialIndex:function(){for(var t,n,i,a,r,s=this.faces,o=s.length,e=0;e<o;e++)s[e]._id=e;s.sort(function(e,t){return e.materialIndex-t.materialIndex}),i=this.faceVertexUvs[0],a=this.faceVertexUvs[1];for(i&&i.length===o&&(t=[]),a&&a.length===o&&(n=[]),e=0;e<o;e++)r=s[e]._id,t&&t.push(i[r]),n&&n.push(a[r]);t&&(this.faceVertexUvs[0]=t),n&&(this.faceVertexUvs[1]=n)},toJSON:function(){function i(e,t,n){return n?e|1<<t:e&~(1<<t)}function d(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==v[t]||(v[t]=f.length/3,f.push(e.x,e.y,e.z)),v[t]}function l(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==g[t]||(g[t]=u.length,u.push(e.getHex())),g[t]}function m(e){var t=e.x.toString()+e.y.toString();return void 0!==p[t]||(p[t]=h.length/2,h.push(e.x,e.y)),p[t]}if(o={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}},o.uuid=this.uuid,o.type=this.type,""!==this.name&&(o.name=this.name),void 0!==this.parameters){a=this.parameters;for(n in a)void 0!==a[n]&&(o[n]=a[n]);return o}for(a=[],n=0;n<this.vertices.length;n++)s=this.vertices[n],a.push(s.x,s.y,s.z);var s=[],f=[],v={},u=[],g={},h=[],p={};for(n=0;n<this.faces.length;n++){var n,o,a,e=this.faces[n],r=void 0!==this.faceVertexUvs[0][n],c=0<e.normal.length(),b=0<e.vertexNormals.length,j=1!==e.color.r||1!==e.color.g||1!==e.color.b,y=0<e.vertexColors.length,t=i(t=0,0,0),t=i(t,1,!0),t=i(t,2,!1),t=i(t,3,r),t=i(t,4,c),t=i(t,5,b),t=i(t,6,j),t=i(t,7,y);s.push(t),s.push(e.a,e.b,e.c),s.push(e.materialIndex),r&&(r=this.faceVertexUvs[0][n],s.push(m(r[0]),m(r[1]),m(r[2]))),c&&s.push(d(e.normal)),b&&(c=e.vertexNormals,s.push(d(c[0]),d(c[1]),d(c[2]))),j&&s.push(l(e.color)),y&&(e=e.vertexColors,s.push(l(e[0]),l(e[1]),l(e[2])))}return o.data={},o.data.vertices=a,o.data.normals=f,0<u.length&&(o.data.colors=u),0<h.length&&(o.data.uvs=[h]),o.data.faces=s,o},clone:function(){return(new l).copy(this)},copy:function(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.name=e.name,n=e.vertices,t=0;for(s=n.length;t<s;t++)this.vertices.push(n[t].clone());for(t=0,s=(n=e.colors).length;t<s;t++)this.colors.push(n[t].clone());for(t=0,s=(n=e.faces).length;t<s;t++)this.faces.push(n[t].clone());for(t=0,s=e.faceVertexUvs.length;t<s;t++){r=e.faceVertexUvs[t];for(void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]),n=0,a=r.length;n<a;n++){var t,n,s,i,a,r,c=r[n],l=[],o=0;for(i=c.length;o<i;o++)l.push(c[o].clone());this.faceVertexUvs[t].push(l)}}for(t=0,s=(o=e.morphTargets).length;t<s;t++){if((i={}).name=o[t].name,void 0!==o[t].vertices)for(i.vertices=[],n=0,a=o[t].vertices.length;n<a;n++)i.vertices.push(o[t].vertices[n].clone());if(void 0!==o[t].normals)for(i.normals=[],n=0,a=o[t].normals.length;n<a;n++)i.normals.push(o[t].normals[n].clone());this.morphTargets.push(i)}for(t=0,s=(o=e.morphNormals).length;t<s;t++){if(i={},void 0!==o[t].vertexNormals)for(i.vertexNormals=[],n=0,a=o[t].vertexNormals.length;n<a;n++)r=o[t].vertexNormals[n],(c={}).a=r.a.clone(),c.b=r.b.clone(),c.c=r.c.clone(),i.vertexNormals.push(c);if(void 0!==o[t].faceNormals)for(i.faceNormals=[],n=0,a=o[t].faceNormals.length;n<a;n++)i.faceNormals.push(o[t].faceNormals[n].clone());this.morphNormals.push(i)}for(t=0,s=(n=e.skinWeights).length;t<s;t++)this.skinWeights.push(n[t].clone());for(t=0,s=(n=e.skinIndices).length;t<s;t++)this.skinIndices.push(n[t].clone());for(t=0,s=(n=e.lineDistances).length;t<s;t++)this.lineDistances.push(n[t]);return null!==(t=e.boundingBox)&&(this.boundingBox=t.clone()),null!==(t=e.boundingSphere)&&(this.boundingSphere=t.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(u.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(u.prototype,{isBufferAttribute:!0,setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==e?e.length/this.itemSize:0,this.array=e},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.dynamic=e.dynamic,this},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var s=0,o=this.itemSize;s<o;s++)this.array[e+s]=t.array[n+s];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t,s=this.array,o=0,n=0,i=e.length;n<i;n++)t=e[n],void 0===t&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),t=new a),s[o++]=t.r,s[o++]=t.g,s[o++]=t.b;return this},copyIndicesArray:function(e){for(var t,n=this.array,s=0,o=0,i=e.length;o<i;o++)t=e[o],n[s++]=t.a,n[s++]=t.b,n[s++]=t.c;return this},copyVector2sArray:function(e){for(var t,o=this.array,i=0,s=0,a=e.length;s<a;s++)t=e[s],void 0===t&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",s),t=new n),o[i++]=t.x,o[i++]=t.y;return this},copyVector3sArray:function(e){for(var n,o=this.array,i=0,s=0,a=e.length;s<a;s++)n=e[s],void 0===n&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",s),n=new t),o[i++]=n.x,o[i++]=n.y,o[i++]=n.z;return this},copyVector4sArray:function(e){for(var t,n=this.array,s=0,o=0,i=e.length;o<i;o++)t=e[o],void 0===t&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",o),t=new g),n[s++]=t.x,n[s++]=t.y,n[s++]=t.z,n[s++]=t.w;return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,s){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=s,this},setXYZW:function(e,t,n,s,o){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=s,this.array[e+3]=o,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),Ut.prototype=Object.create(u.prototype),Ut.prototype.constructor=Ut,$t.prototype=Object.create(u.prototype),$t.prototype.constructor=$t,Ht.prototype=Object.create(u.prototype),Ht.prototype.constructor=Ht,Rt.prototype=Object.create(u.prototype),Rt.prototype.constructor=Rt,fe.prototype=Object.create(u.prototype),fe.prototype.constructor=fe,Nt.prototype=Object.create(u.prototype),Nt.prototype.constructor=Nt,ge.prototype=Object.create(u.prototype),ge.prototype.constructor=ge,s.prototype=Object.create(u.prototype),s.prototype.constructor=s,zt.prototype=Object.create(u.prototype),zt.prototype.constructor=zt,Object.assign(As.prototype,{computeGroups:function(e){var t,n,i,s=[],o=void 0;e=e.faces;for(n=0;n<e.length;n++)i=e[n],i.materialIndex!==o&&(o=i.materialIndex,void 0!==t&&(t.count=3*n-t.start,s.push(t)),t={start:3*n,materialIndex:o});void 0!==t&&(t.count=3*n-t.start,s.push(t)),this.groups=s},fromGeometry:function(e){var t,s,o,i,l,d,u,f,p=e.faces,r=e.vertices,a=e.faceVertexUvs,y=a[0]&&0<a[0].length,j=a[1]&&0<a[1].length,g=e.morphTargets,m=g.length;if(0<m){for(l=[],s=0;s<m;s++)l[s]=[];this.morphTargets.position=l}if(f=e.morphNormals,d=f.length,0<d){u=[];for(s=0;s<d;s++)u[s]=[];this.morphTargets.normal=u}var c=e.skinIndices,h=e.skinWeights,v=c.length===r.length,b=h.length===r.length;for(s=0;s<p.length;s++){o=p[s],this.vertices.push(r[o.a],r[o.b],r[o.c]),t=o.vertexNormals;for(3===t.length?this.normals.push(t[0],t[1],t[2]):(t=o.normal,this.normals.push(t,t,t)),3===(t=o.vertexColors).length?this.colors.push(t[0],t[1],t[2]):(t=o.color,this.colors.push(t,t,t)),!0===y&&(void 0!==(t=a[0][s])?this.uvs.push(t[0],t[1],t[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",s),this.uvs.push(new n,new n,new n))),!0===j&&(void 0!==(t=a[1][s])?this.uvs2.push(t[0],t[1],t[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",s),this.uvs2.push(new n,new n,new n))),t=0;t<m;t++)i=g[t].vertices,l[t].push(i[o.a],i[o.b],i[o.c]);for(t=0;t<d;t++)i=f[t].vertexNormals[s],u[t].push(i.a,i.b,i.c);v&&this.skinIndices.push(c[o.a],c[o.b],c[o.c]),b&&this.skinWeights.push(h[o.a],h[o.b],h[o.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}}),Vs=1,Object.assign(i.prototype,G.prototype,{isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(65535<Yn(e)?ge:fe)(e,1):this.index=e},addAttribute:function(e,t,n){if(t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute){if("index"!==e)return this.attributes[e]=t,this;console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t)}else console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(e,new u(t,n))},getAttribute:function(e){return this.attributes[e]},removeAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,n){this.groups.push({start:e,count:t,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;return void 0!==t&&(e.applyToBufferAttribute(t),t.needsUpdate=!0),void 0!==(t=this.attributes.normal)&&((new A).getNormalMatrix(e).applyToBufferAttribute(t),t.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var e=new c;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new c;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new c;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new c;return function(t,n,s){return e.makeTranslation(t,n,s),this.applyMatrix(e),this}}(),scale:function(){var e=new c;return function(t,n,s){return e.makeScale(t,n,s),this.applyMatrix(e),this}}(),lookAt:function(){var e=new o;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),center:function(){this.computeBoundingBox();var e=this.boundingBox.getCenter().negate();return this.translate(e.x,e.y,e.z),e},setFromObject:function(e){var n,t=e.geometry;return e.isPoints||e.isLine?(e=new s(3*t.vertices.length,3),n=new s(3*t.colors.length,3),this.addAttribute("position",e.copyVector3sArray(t.vertices)),this.addAttribute("color",n.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length&&(e=new s(t.lineDistances.length,1),this.addAttribute("lineDistance",e.copyArray(t.lineDistances))),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())):e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t),this},setFromPoints:function(e){for(var t,o=[],n=0,i=e.length;n<i;n++)t=e[n],o.push(t.x,t.y,t.z||0);return this.addAttribute("position",new s(o,3)),this},updateFromObject:function(e){var n,t=e.geometry;if(e.isMesh){if(n=t.__directGeometry,!0===t.elementsNeedUpdate&&(n=void 0,t.elementsNeedUpdate=!1),void 0===n)return this.fromGeometry(t);n.verticesNeedUpdate=t.verticesNeedUpdate,n.normalsNeedUpdate=t.normalsNeedUpdate,n.colorsNeedUpdate=t.colorsNeedUpdate,n.uvsNeedUpdate=t.uvsNeedUpdate,n.groupsNeedUpdate=t.groupsNeedUpdate,t.verticesNeedUpdate=!1,t.normalsNeedUpdate=!1,t.colorsNeedUpdate=!1,t.uvsNeedUpdate=!1,t.groupsNeedUpdate=!1,t=n}return!0===t.verticesNeedUpdate&&(void 0!==(n=this.attributes.position)&&(n.copyVector3sArray(t.vertices),n.needsUpdate=!0),t.verticesNeedUpdate=!1),!0===t.normalsNeedUpdate&&(void 0!==(n=this.attributes.normal)&&(n.copyVector3sArray(t.normals),n.needsUpdate=!0),t.normalsNeedUpdate=!1),!0===t.colorsNeedUpdate&&(void 0!==(n=this.attributes.color)&&(n.copyColorsArray(t.colors),n.needsUpdate=!0),t.colorsNeedUpdate=!1),t.uvsNeedUpdate&&(void 0!==(n=this.attributes.uv)&&(n.copyVector2sArray(t.uvs),n.needsUpdate=!0),t.uvsNeedUpdate=!1),t.lineDistancesNeedUpdate&&(void 0!==(n=this.attributes.lineDistance)&&(n.copyArray(t.lineDistances),n.needsUpdate=!0),t.lineDistancesNeedUpdate=!1),t.groupsNeedUpdate&&(t.computeGroups(e.geometry),this.groups=t.groups,t.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new As).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){t=new Float32Array(3*e.vertices.length);for(n in this.addAttribute("position",new u(t,3).copyVector3sArray(e.vertices)),0<e.normals.length&&(t=new Float32Array(3*e.normals.length),this.addAttribute("normal",new u(t,3).copyVector3sArray(e.normals))),0<e.colors.length&&(t=new Float32Array(3*e.colors.length),this.addAttribute("color",new u(t,3).copyColorsArray(e.colors))),0<e.uvs.length&&(t=new Float32Array(2*e.uvs.length),this.addAttribute("uv",new u(t,2).copyVector2sArray(e.uvs))),0<e.uvs2.length&&(t=new Float32Array(2*e.uvs2.length),this.addAttribute("uv2",new u(t,2).copyVector2sArray(e.uvs2))),0<e.indices.length&&(t=new(65535<Yn(e.indices)?Uint32Array:Uint16Array)(3*e.indices.length),this.setIndex(new u(t,1).copyIndicesArray(e.indices))),this.groups=e.groups,e.morphTargets){t=[];for(var t,n,i,r,a=e.morphTargets[n],o=0,c=a.length;o<c;o++)i=a[o],r=new s(3*i.length,3),t.push(r.copyVector3sArray(i));this.morphAttributes[n]=t}return 0<e.skinIndices.length&&(n=new s(4*e.skinIndices.length,4),this.addAttribute("skinIndex",n.copyVector4sArray(e.skinIndices))),0<e.skinWeights.length&&(n=new s(4*e.skinWeights.length,4),this.addAttribute("skinWeight",n.copyVector4sArray(e.skinWeights))),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new X);var e=this.attributes.position;void 0!==e?this.boundingBox.setFromBufferAttribute(e):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var n=new X,e=new t;return function(){if(null===this.boundingSphere&&(this.boundingSphere=new V),t=this.attributes.position,t){o=this.boundingSphere.center,n.setFromBufferAttribute(t),n.getCenter(o);for(var t,o,i=0,s=0,a=t.count;s<a;s++)e.x=t.getX(s),e.y=t.getY(s),e.z=t.getZ(s),i=Math.max(i,o.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var a=this.index,l=this.attributes,v=this.groups;if(l.position){if(o=l.position.array,void 0===l.normal)this.addAttribute("normal",new u(new Float32Array(o.length),3));else for(e=0,i=(s=l.normal.array).length;e<i;e++)s[e]=0;var e,o,i,r,d,h,g,b,s=l.normal.array,m=new t,c=new t,f=new t,n=new t,p=new t;if(a){a=a.array,0===v.length&&this.addGroup(0,a.length);for(g=0,b=v.length;g<b;++g){i=(e=v[g]).start,r=e.count;for(e=i,i+=r;e<i;e+=3)r=3*a[e+0],d=3*a[e+1],h=3*a[e+2],m.fromArray(o,r),c.fromArray(o,d),f.fromArray(o,h),n.subVectors(f,c),p.subVectors(m,c),n.cross(p),s[r]+=n.x,s[r+1]+=n.y,s[r+2]+=n.z,s[d]+=n.x,s[d+1]+=n.y,s[d+2]+=n.z,s[h]+=n.x,s[h+1]+=n.y,s[h+2]+=n.z}}else for(e=0,i=o.length;e<i;e+=9)m.fromArray(o,e),c.fromArray(o,e+3),f.fromArray(o,e+6),n.subVectors(f,c),p.subVectors(m,c),n.cross(p),s[e]=n.x,s[e+1]=n.y,s[e+2]=n.z,s[e+3]=n.x,s[e+4]=n.y,s[e+5]=n.z,s[e+6]=n.x,s[e+7]=n.y,s[e+8]=n.z;this.normalizeNormals(),l.normal.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0),o=this.attributes;for(n in o)if(void 0!==e.attributes[n])for(var n,o,r=o[n].array,a=(s=e.attributes[n]).array,i=0,s=s.itemSize*t;i<a.length;i++,s++)r[s]=a[i];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){var e=new t;return function(){for(var n=this.attributes.normal,t=0,s=n.count;t<s;t++)e.x=n.getX(t),e.y=n.getY(t),e.z=n.getZ(t),e.normalize(),n.setXYZ(t,e.x,e.y,e.z)}}(),toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t,a=new i,n=this.index.array,r=this.attributes;for(t in r){for(var o,c,l=(e=r[t]).array,e=e.itemSize,d=new l.constructor(n.length*e),h=0,s=0,m=n.length;s<m;s++){c=n[s]*e;for(o=0;o<e;o++)d[h++]=l[c++]}a.addAttribute(t,new u(d,e))}return a},toJSON:function(){var t,n,s,o,e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){n=this.parameters;for(t in n)void 0!==n[t]&&(e[t]=n[t]);return e}e.data={attributes:{}},s=this.index;for(t in null!==s&&(n=Array.prototype.slice.call(s.array),e.data.index={type:s.array.constructor.name,array:n}),s=this.attributes)o=s[t],n=Array.prototype.slice.call(o.array),e.data.attributes[t]={itemSize:o.itemSize,type:o.array.constructor.name,array:n,normalized:o.normalized};return 0<(t=this.groups).length&&(e.data.groups=JSON.parse(JSON.stringify(t))),null!==(t=this.boundingSphere)&&(e.data.boundingSphere={center:t.center.toArray(),radius:t.radius}),e},clone:function(){return(new i).copy(this)},copy:function(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.name=e.name,t=e.index;for(n in null!==t&&this.setIndex(t.clone()),t=e.attributes)this.addAttribute(n,t[n].clone());s=e.morphAttributes;for(n in s){var t,n,s,o,i=[],a=s[n];for(t=0,o=a.length;t<o;t++)i.push(a[t].clone());this.morphAttributes[n]=i}n=e.groups;for(t=0,o=n.length;t<o;t++)s=n[t],this.addGroup(s.start,s.count,s.materialIndex);return null!==(n=e.boundingBox)&&(this.boundingBox=n.clone()),null!==(n=e.boundingSphere)&&(this.boundingSphere=n.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Ie.prototype=Object.create(l.prototype),Ie.prototype.constructor=Ie,ue.prototype=Object.create(i.prototype),ue.prototype.constructor=ue,xt.prototype=Object.create(l.prototype),xt.prototype.constructor=xt,Ce.prototype=Object.create(i.prototype),Ce.prototype.constructor=Ce,F.prototype=Object.create(h.prototype),F.prototype.constructor=F,F.prototype.isMeshBasicMaterial=!0,F.prototype.copy=function(e){return h.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},D.prototype=Object.create(h.prototype),D.prototype.constructor=D,D.prototype.isShaderMaterial=!0,D.prototype.copy=function(e){return h.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=E.clone(e.uniforms),this.defines=e.defines,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},D.prototype.toJSON=function(e){return(e=h.prototype.toJSON.call(this,e)).uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e},Object.assign(Ae.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,n){return(n||new t).copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(){var e=new t;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,n){return(n=n||new t).subVectors(e,this.origin),0>(e=n.dot(this.direction))?n.copy(this.origin):n.copy(this.direction).multiplyScalar(e).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(){var e=new t;return function(t){var n=e.subVectors(t,this.origin).dot(this.direction);return 0>n?this.origin.distanceToSquared(t):(e.copy(this.direction).multiplyScalar(n).add(this.origin),e.distanceToSquared(t))}}(),distanceSqToSegment:function(){var s=new t,e=new t,n=new t;return function(t,o,i,a){s.copy(t).add(o).multiplyScalar(.5),e.copy(o).sub(t).normalize(),n.copy(this.origin).sub(s);var h,c=.5*t.distanceTo(o),r=-this.direction.dot(e),d=n.dot(this.direction),l=-n.dot(e),u=n.lengthSq(),m=Math.abs(1-r*r);return 0<m?(o=r*d-l,h=c*m,0<=(t=r*l-d)?o>=-h?o<=h?r=(t*=c=1/m)*(t+r*(o*=c)+2*d)+o*(r*t+o+2*l)+u:(o=c,r=-(t=Math.max(0,-(r*o+d)))*t+o*(o+2*l)+u):(o=-c,r=-(t=Math.max(0,-(r*o+d)))*t+o*(o+2*l)+u):o<=-h?r=-(t=Math.max(0,-(-r*c+d)))*t+(o=0<t?-c:Math.min(Math.max(-c,-l),c))*(o+2*l)+u:o<=h?(t=0,r=(o=Math.min(Math.max(-c,-l),c))*(o+2*l)+u):r=-(t=Math.max(0,-(r*c+d)))*t+(o=0<t?c:Math.min(Math.max(-c,-l),c))*(o+2*l)+u):(o=0<r?-c:c,r=-(t=Math.max(0,-(r*o+d)))*t+o*(o+2*l)+u),i&&i.copy(this.direction).multiplyScalar(t).add(this.origin),a&&a.copy(e).multiplyScalar(o).add(s),r}}(),intersectSphere:function(){var e=new t;return function(t,n){e.subVectors(t.center,this.origin);var s=e.dot(this.direction),o=e.dot(e)-s*s;return o>(t=t.radius*t.radius)?null:(o=s-(t=Math.sqrt(t-o)),s+=t,0>o&&0>s?null:0>o?this.at(s,n):this.at(o,n))}}(),intersectsSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);return 0===t?0===e.distanceToPoint(this.origin)?0:null:0<=(e=-(this.origin.dot(e.normal)+e.constant)/t)?e:null},intersectPlane:function(e,t){return null===(e=this.distanceToPlane(e))?null:this.at(e,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||0>e.normal.dot(this.direction)*t},intersectBox:function(e,t){var s,i,n=1/this.direction.x,a=1/this.direction.y,r=1/this.direction.z,o=this.origin;return 0<=n?(s=(e.min.x-o.x)*n,n*=e.max.x-o.x):(s=(e.max.x-o.x)*n,n*=e.min.x-o.x),0<=a?(i=(e.min.y-o.y)*a,a*=e.max.y-o.y):(i=(e.max.y-o.y)*a,a*=e.min.y-o.y),s>a||i>n?null:((i>s||s!=s)&&(s=i),(a<n||n!=n)&&(n=a),0<=r?(i=(e.min.z-o.z)*r,e=(e.max.z-o.z)*r):(i=(e.max.z-o.z)*r,e=(e.min.z-o.z)*r),s>e||i>n?null:((i>s||s!=s)&&(s=i),(e<n||n!=n)&&(n=e),0>n?null:this.at(0<=s?s:n,t)))},intersectsBox:function(){var e=new t;return function(t){return null!==this.intersectBox(t,e)}}(),intersectTriangle:function(){var e=new t,s=new t,n=new t,o=new t;return function(t,i,a,r,c){if(s.subVectors(i,t),n.subVectors(a,t),o.crossVectors(s,n),0<(i=this.direction.dot(o))){if(r)return null;r=1}else{if(!(0>i))return null;r=-1,i=-i}return e.subVectors(this.origin,t),0>(t=r*this.direction.dot(n.crossVectors(e,n)))||0>(a=r*this.direction.dot(s.cross(e)))||t+a>i||0>(t=-r*e.dot(o))?null:this.at(t/i,c)}}(),applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}}),Object.assign(He.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return(e||new t).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return(e||new t).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,n){return n=n||new t,this.delta(n).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(){var n=new t,e=new t;return function(t,s){return n.subVectors(t,this.start),e.subVectors(this.end,this.start),t=e.dot(e),t=e.dot(n)/t,s&&(t=d.clamp(t,0,1)),t}}(),closestPointToPoint:function(e,n,s){return e=this.closestPointToPointParameter(e,n),s=s||new t,this.delta(s).multiplyScalar(e).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),Object.assign(Z,{normal:function(){var e=new t;return function(n,s,o,i){return(i=i||new t).subVectors(o,s),e.subVectors(n,s),i.cross(e),0<(n=i.lengthSq())?i.multiplyScalar(1/Math.sqrt(n)):i.set(0,0,0)}}(),barycoordFromPoint:function(){var e=new t,n=new t,s=new t;return function(o,i,a,r,c){e.subVectors(r,i),n.subVectors(a,i),s.subVectors(o,i),o=e.dot(e),i=e.dot(n),a=e.dot(s);var d,l=n.dot(n);return r=n.dot(s),d=o*l-i*i,c=c||new t,0===d?c.set(-2,-1,-1):(l=(l*a-i*r)*(d=1/d),o=(o*r-i*a)*d,c.set(1-l-o,o,l))}}(),containsPoint:function(){var e=new t;return function(t,n,s,o){return 0<=(t=Z.barycoordFromPoint(t,n,s,o,e)).x&&0<=t.y&&1>=t.x+t.y}}()}),Object.assign(Z.prototype,{set:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this},setFromPointsAndIndices:function(e,t,n,s){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[s]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},area:function(){var e=new t,n=new t;return function(){return e.subVectors(this.c,this.b),n.subVectors(this.a,this.b),.5*e.cross(n).length()}}(),midpoint:function(e){return(e||new t).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(e){return Z.normal(this.a,this.b,this.c,e)},plane:function(e){return(e||new L).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(e,t){return Z.barycoordFromPoint(e,this.a,this.b,this.c,t)},containsPoint:function(e){return Z.containsPoint(e,this.a,this.b,this.c)},closestPointToPoint:function(){var o=new L,e=[new He,new He,new He],n=new t,s=new t;return function(i,a){a=a||new t;var r,c=1/0;if(o.setFromCoplanarPoints(this.a,this.b,this.c),o.projectPoint(i,n),!0===this.containsPoint(n))a.copy(n);else for(e[0].set(this.a,this.b),e[1].set(this.b,this.c),e[2].set(this.c,this.a),i=0;i<e.length;i++)e[i].closestPointToPoint(n,!0,s),r=n.distanceToSquared(s),r<c&&(c=r,a.copy(s));return a}}(),equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}),x.prototype=Object.assign(Object.create(o.prototype),{constructor:x,isMesh:!0,setDrawMode:function(e){this.drawMode=e},copy:function(e){return o.prototype.copy.call(this,e),this.drawMode=e.drawMode,void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var t,n,s,e=this.geometry;if(e.isBufferGeometry){if(e=e.morphAttributes,n=Object.keys(e),0<n.length&&(t=e[n[0]],void 0!==t))for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,n=t.length;e<n;e++)s=t[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=e}else if(void 0!==(t=e.morphTargets)&&0<t.length)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,n=t.length;e<n;e++)s=t[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=e},raycast:function(){function g(e,t,n,s,o,i,a){return Z.barycoordFromPoint(e,t,n,s,d),o.multiplyScalar(d.x),i.multiplyScalar(d.y),a.multiplyScalar(d.z),o.add(i).add(a),o.clone()}function p(e,t,n,s,o,i,a,c){return null===(1===t.side?s.intersectTriangle(a,i,o,!0,c):s.intersectTriangle(o,i,a,2!==t.side,c))?null:(r.copy(c),r.applyMatrix4(e.matrixWorld),(t=n.ray.origin.distanceTo(r))<n.near||t>n.far?null:{distance:t,point:r.clone(),object:e})}function f(t,n,i,r,c,d,m,f){return e.fromBufferAttribute(r,d),o.fromBufferAttribute(r,m),s.fromBufferAttribute(r,f),(t=p(t,t.material,n,i,e,o,s,l))&&(c&&(a.fromBufferAttribute(c,d),h.fromBufferAttribute(c,m),u.fromBufferAttribute(c,f),t.uv=g(l,e,o,s,a,h,u)),t.face=new Q(d,m,f,Z.normal(e,o,s)),t.faceIndex=d),t}var v=new c,i=new Ae,m=new V,e=new t,o=new t,s=new t,y=new t,j=new t,b=new t,a=new n,h=new n,u=new n,d=new t,l=new t,r=new t;return function(t,n){var c,d,_,O,x,C,E,k,S,M,F,T,z,D,N,L,r=this.geometry,w=this.material,A=this.matrixWorld;if(void 0!==w&&(null===r.boundingSphere&&r.computeBoundingSphere(),m.copy(r.boundingSphere),m.applyMatrix4(A),!1!==t.ray.intersectsSphere(m)&&(v.getInverse(A),i.copy(t.ray).applyMatrix4(v),null===r.boundingBox||!1!==i.intersectsBox(r.boundingBox))))if(r.isBufferGeometry){if(w=r.index,C=r.attributes.position,A=r.attributes.uv,null!==w){c=0;for(E=w.count;c<E;c+=3)r=w.getX(c),_=w.getX(c+1),O=w.getX(c+2),(d=f(this,t,i,C,A,r,_,O))&&(d.faceIndex=Math.floor(c/3),n.push(d))}else if(void 0!==C)for(c=0,E=C.count;c<E;c+=3)(d=f(this,t,i,C,A,r=c,_=c+1,O=c+2))&&(d.index=r,n.push(d))}else if(r.isGeometry){A=Array.isArray(w),c=r.vertices,E=r.faces,0<(_=r.faceVertexUvs[0]).length&&(C=_);for(k=0,D=E.length;k<D;k++)if(x=E[k],void 0!==(d=A?w[x.materialIndex]:w)){if(_=c[x.a],O=c[x.b],M=c[x.c],!0===d.morphTargets){S=r.morphTargets,N=this.morphTargetInfluences,e.set(0,0,0),o.set(0,0,0),s.set(0,0,0);for(F=0,L=S.length;F<L;F++)T=N[F],0!==T&&(z=S[F].vertices,e.addScaledVector(y.subVectors(z[x.a],_),T),o.addScaledVector(j.subVectors(z[x.b],O),T),s.addScaledVector(b.subVectors(z[x.c],M),T));e.add(_),o.add(O),s.add(M),_=e,O=o,M=s}(d=p(this,d,t,i,_,O,M,l))&&(C&&C[k]&&(S=C[k],a.copy(S[0]),h.copy(S[1]),u.copy(S[2]),d.uv=g(l,_,O,M,a,h,u)),d.face=x,d.faceIndex=k,n.push(d))}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Bs=0,_.prototype=Object.assign(Object.create(K.prototype),{constructor:_,isPerspectiveCamera:!0,copy:function(e,t){return K.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){e=.5*this.getFilmHeight()/e,this.fov=2*d.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*d.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*d.RAD2DEG*Math.atan(Math.tan(.5*d.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,n,s,o,i){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=s,this.view.width=o,this.view.height=i,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var i=this.near,t=2*(s=i*Math.tan(.5*d.DEG2RAD*this.fov)/this.zoom),n=-.5*(o=this.aspect*t),e=this.view;if(null!==this.view&&this.view.enabled){var a=e.fullWidth,r=e.fullHeight,s=(n=n+e.offsetX*o/a,s-e.offsetY*t/r),o=e.width/a*o;t=e.height/r*t}0!==(e=this.filmOffset)&&(n+=i*e/this.getFilmWidth()),this.projectionMatrix.makePerspective(n,n+o,s,s-t,i,this.far)},toJSON:function(e){return(e=o.prototype.toJSON.call(this,e)).object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}),yn.prototype=Object.assign(Object.create(_.prototype),{constructor:yn,isArrayCamera:!0}),mt.prototype.isFogExp2=!0,mt.prototype.clone=function(){return new mt(this.color.getHex(),this.density)},mt.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},ft.prototype.isFog=!0,ft.prototype.clone=function(){return new ft(this.color.getHex(),this.near,this.far)},ft.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},Sn.prototype=Object.assign(Object.create(o.prototype),{constructor:Sn,copy:function(e,t){return o.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=o.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}),Jn.prototype=Object.assign(Object.create(o.prototype),{constructor:Jn,isLensFlare:!0,copy:function(e){o.prototype.copy.call(this,e),this.positionScreen.copy(e.positionScreen),this.customUpdateCallback=e.customUpdateCallback;for(var t=0,n=e.lensFlares.length;t<n;t++)this.lensFlares.push(e.lensFlares[t]);return this},add:function(e,t,n,s,o,i){void 0===t&&(t=-1),void 0===n&&(n=0),void 0===i&&(i=1),void 0===o&&(o=new a(16777215)),void 0===s&&(s=1),n=Math.min(n,Math.max(0,n)),this.lensFlares.push({texture:e,size:t,distance:n,x:0,y:0,z:0,scale:1,rotation:0,opacity:i,color:o,blending:s})},updateLensFlares:function(){var e,t,n=this.lensFlares.length,s=2*-this.positionScreen.x,o=2*-this.positionScreen.y;for(t=0;t<n;t++)e=this.lensFlares[t],e.x=this.positionScreen.x+s*e.distance,e.y=this.positionScreen.y+o*e.distance,e.wantedRotation=e.x*Math.PI*.25,e.rotation+=.25*(e.wantedRotation-e.rotation)}}),le.prototype=Object.create(h.prototype),le.prototype.constructor=le,le.prototype.isSpriteMaterial=!0,le.prototype.copy=function(e){return h.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.rotation=e.rotation,this},At.prototype=Object.assign(Object.create(o.prototype),{constructor:At,isSprite:!0,raycast:function(){var e=new t,n=new t,s=new t;return function(t,o){n.setFromMatrixPosition(this.matrixWorld),t.ray.closestPointToPoint(n,e),s.setFromMatrixScale(this.matrixWorld);var i=s.x*s.y/4;n.distanceToSquared(e)>i||(i=t.ray.origin.distanceTo(e))<t.near||i>t.far||o.push({distance:i,point:e.clone(),face:null,object:this})}}(),clone:function(){return new this.constructor(this.material).copy(this)}}),kt.prototype=Object.assign(Object.create(o.prototype),{constructor:kt,copy:function(e){o.prototype.copy.call(this,e,!1);for(var n,t=0,s=(e=e.levels).length;t<s;t++)n=e[t],this.addLevel(n.object.clone(),n.distance);return this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var s=this.levels,n=0;n<s.length&&!(t<s[n].distance);n++);s.splice(n,0,{distance:t,object:e}),this.add(e)},getObjectForDistance:function(e){for(var n=this.levels,t=1,s=n.length;t<s&&!(e<n[t].distance);t++);return n[t-1].object},raycast:function(){var e=new t;return function(t,n){e.setFromMatrixPosition(this.matrixWorld);var s=t.ray.origin.distanceTo(e);this.getObjectForDistance(s).raycast(t,n)}}(),update:function(){var e=new t,n=new t;return function(t){if(s=this.levels,1<s.length){e.setFromMatrixPosition(t.matrixWorld),n.setFromMatrixPosition(this.matrixWorld),t=e.distanceTo(n),s[0].object.visible=!0;for(var s,o=1,i=s.length;o<i&&t>=s[o].distance;o++)s[o-1].object.visible=!1,s[o].object.visible=!0;for(;o<i;o++)s[o].object.visible=!1}}}(),toJSON:function(e){(e=o.prototype.toJSON.call(this,e)).object.levels=[];for(var n,s=this.levels,t=0,i=s.length;t<i;t++)n=s[t],e.object.levels.push({object:n.object.uuid,distance:n.distance});return e}}),Object.assign(Ct.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t,e=0,n=this.bones.length;e<n;e++)t=new c,this.bones[e]&&t.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(t)},pose:function(){var e,n,t=0;for(n=this.bones.length;t<n;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:function(){var e=new c,t=new c;return function(){for(var s=this.bones,i=this.boneInverses,a=this.boneMatrices,o=this.boneTexture,n=0,r=s.length;n<r;n++)e.multiplyMatrices(s[n]?s[n].matrixWorld:t,i[n]),e.toArray(a,16*n);void 0!==o&&(o.needsUpdate=!0)}}(),clone:function(){return new Ct(this.bones,this.boneInverses)}}),Wn.prototype=Object.assign(Object.create(o.prototype),{constructor:Wn,isBone:!0}),bn.prototype=Object.assign(Object.create(x.prototype),{constructor:bn,isSkinnedMesh:!0,initBones:function(){if(n=[],this.geometry&&void 0!==this.geometry.bones){e=0;for(o=this.geometry.bones.length;e<o;e++){var e,n,o,t=this.geometry.bones[e],s=new Wn;n.push(s),s.name=t.name,s.position.fromArray(t.pos),s.quaternion.fromArray(t.rotq),void 0!==t.scl&&s.scale.fromArray(t.scl)}for(e=0,o=this.geometry.bones.length;e<o;e++)-1!==(t=this.geometry.bones[e]).parent&&null!==t.parent&&void 0!==n[t.parent]?n[t.parent].add(n[e]):this.add(n[e])}return this.updateMatrixWorld(!0),n},bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){if(this.geometry&&this.geometry.isGeometry)for(t=0;t<this.geometry.skinWeights.length;t++)s=1/(e=this.geometry.skinWeights[t]).manhattanLength(),1/0!==s?e.multiplyScalar(s):e.set(1,0,0,0);else if(this.geometry&&this.geometry.isBufferGeometry){var t,s,e=new g,n=this.geometry.attributes.skinWeight;for(t=0;t<n.count;t++)e.x=n.getX(t),e.y=n.getY(t),e.z=n.getZ(t),e.w=n.getW(t),1/0!==(s=1/e.manhattanLength())?e.multiplyScalar(s):e.set(1,0,0,0),n.setXYZW(t,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){x.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),p.prototype=Object.create(h.prototype),p.prototype.constructor=p,p.prototype.isLineBasicMaterial=!0,p.prototype.copy=function(e){return h.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this},C.prototype=Object.assign(Object.create(o.prototype),{constructor:C,isLine:!0,raycast:function(){var s=new c,e=new Ae,n=new V;return function(o,i){var m=(m=o.linePrecision)*m,a=this.geometry,c=this.matrixWorld;if(null===a.boundingSphere&&a.computeBoundingSphere(),n.copy(a.boundingSphere),n.applyMatrix4(c),!1!==o.ray.intersectsSphere(n)){s.getInverse(c),e.copy(o.ray).applyMatrix4(s);var r,h,f,p,d=new t,u=new t,l=(c=new t,new t),g=this&&this.isLineSegments?2:1;if(a.isBufferGeometry)if(r=a.index,h=a.attributes.position.array,null!==r)for(f=r.array,p=(a=0,f.length-1);a<p;a+=g)r=f[a+1],d.fromArray(h,3*f[a]),u.fromArray(h,3*r),(r=e.distanceSqToSegment(d,u,l,c))>m||(l.applyMatrix4(this.matrixWorld),(r=o.ray.origin.distanceTo(l))<o.near||r>o.far||i.push({distance:r,point:c.clone().applyMatrix4(this.matrixWorld),index:a,face:null,faceIndex:null,object:this}));else for(a=0,p=h.length/3-1;a<p;a+=g)d.fromArray(h,3*a),u.fromArray(h,3*a+3),(r=e.distanceSqToSegment(d,u,l,c))>m||(l.applyMatrix4(this.matrixWorld),(r=o.ray.origin.distanceTo(l))<o.near||r>o.far||i.push({distance:r,point:c.clone().applyMatrix4(this.matrixWorld),index:a,face:null,faceIndex:null,object:this}));else if(a.isGeometry)for(u=(d=a.vertices).length,a=0;a<u-1;a+=g)(r=e.distanceSqToSegment(d[a],d[a+1],l,c))>m||(l.applyMatrix4(this.matrixWorld),(r=o.ray.origin.distanceTo(l))<o.near||r>o.far||i.push({distance:r,point:c.clone().applyMatrix4(this.matrixWorld),index:a,face:null,faceIndex:null,object:this}))}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),v.prototype=Object.assign(Object.create(C.prototype),{constructor:v,isLineSegments:!0}),Ln.prototype=Object.assign(Object.create(C.prototype),{constructor:Ln,isLineLoop:!0}),P.prototype=Object.create(h.prototype),P.prototype.constructor=P,P.prototype.isPointsMaterial=!0,P.prototype.copy=function(e){return h.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this},bt.prototype=Object.assign(Object.create(o.prototype),{constructor:bt,isPoints:!0,raycast:function(){var s=new c,n=new Ae,e=new V;return function(o,i){function d(e,t){var s,a=n.distanceSqToPoint(e);a<m&&((e=n.closestPointToPoint(e)).applyMatrix4(u),s=o.ray.origin.distanceTo(e),s<o.near||s>o.far||i.push({distance:s,distanceToRay:Math.sqrt(a),point:e.clone(),index:t,face:null,object:p}))}var a,l,h,m,f,p=this,r=this.geometry,u=this.matrixWorld,c=o.params.Points.threshold;if(null===r.boundingSphere&&r.computeBoundingSphere(),e.copy(r.boundingSphere),e.applyMatrix4(u),e.radius+=c,!1!==o.ray.intersectsSphere(e))if(s.getInverse(u),n.copy(o.ray).applyMatrix4(s),m=(c=c/((this.scale.x+this.scale.y+this.scale.z)/3))*c,c=new t,r.isBufferGeometry)if(a=r.index,r=r.attributes.position.array,null!==a)for(l=a.array,f=(a=0,l.length);a<f;a++)h=l[a],c.fromArray(r,3*h),d(c,h);else for(a=0,l=r.length/3;a<l;a++)c.fromArray(r,3*a),d(c,a);else for(a=0,l=(c=r.vertices).length;a<l;a++)d(c[a],a)}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),St.prototype=Object.assign(Object.create(o.prototype),{constructor:St}),Fn.prototype=Object.create(b.prototype),Fn.prototype.constructor=Fn,gt.prototype=Object.create(b.prototype),gt.prototype.constructor=gt,gt.prototype.isCompressedTexture=!0,Tt.prototype=Object.create(b.prototype),Tt.prototype.constructor=Tt,Tt.prototype.isDepthTexture=!0,pt.prototype=Object.create(i.prototype),pt.prototype.constructor=pt,Dt.prototype=Object.create(l.prototype),Dt.prototype.constructor=Dt,ht.prototype=Object.create(i.prototype),ht.prototype.constructor=ht,Lt.prototype=Object.create(l.prototype),Lt.prototype.constructor=Lt,k.prototype=Object.create(i.prototype),k.prototype.constructor=k,Pt.prototype=Object.create(l.prototype),Pt.prototype.constructor=Pt,dt.prototype=Object.create(k.prototype),dt.prototype.constructor=dt,It.prototype=Object.create(l.prototype),It.prototype.constructor=It,de.prototype=Object.create(k.prototype),de.prototype.constructor=de,Vt.prototype=Object.create(l.prototype),Vt.prototype.constructor=Vt,ct.prototype=Object.create(k.prototype),ct.prototype.constructor=ct,Wt.prototype=Object.create(l.prototype),Wt.prototype.constructor=Wt,rt.prototype=Object.create(k.prototype),rt.prototype.constructor=rt,Kt.prototype=Object.create(l.prototype),Kt.prototype.constructor=Kt,it.prototype=Object.create(i.prototype),it.prototype.constructor=it,Yt.prototype=Object.create(l.prototype),Yt.prototype.constructor=Yt,ot.prototype=Object.create(i.prototype),ot.prototype.constructor=ot,Xt.prototype=Object.create(l.prototype),Xt.prototype.constructor=Xt,st.prototype=Object.create(i.prototype),st.prototype.constructor=st,R={area:function(e){for(var s=e.length,o=0,n=s-1,t=0;t<s;n=t++)o+=e[n].x*e[t].y-e[t].x*e[n].y;return.5*o},triangulate:function(e,t){if(o=e.length,3>o)return null;var n,_=[],s=[],j=[];if(0<R.area(e))for(n=0;n<o;n++)s[n]=n;else for(n=0;n<o;n++)s[n]=o-1-n;v=2*o;for(n=o-1;2<o;){if(0>=v--){console.warn("THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()");break}i=n,o<=i&&(i=0),o<=(n=i+1)&&(n=0),a=n+1,o<=a&&(a=0);t:{var o,i,a,r,c,d,m,v,u=e[s[i]].x,l=e[s[i]].y,g=e[s[n]].x,h=e[s[n]].y,f=e[s[a]].x,p=e[s[a]].y;if(0>=(g-u)*(p-l)-(h-l)*(f-u))d=!1;else{var k=f-g,w=p-h,C=u-f,x=l-p,O=g-u;for(d=h-l,m=0;m<o;m++)if(r=e[s[m]].x,c=e[s[m]].y,!(r===u&&c===l||r===g&&c===h||r===f&&c===p)){var b=c-l,E=r-g,y=c-h;if(b=O*b-d*(r-u),r=C*(c-=p)-x*(r-=f),(y=k*y-w*E)>=-Number.EPSILON&&r>=-Number.EPSILON&&b>=-Number.EPSILON){d=!1;break t}}d=!0}}if(d){for(_.push([e[s[i]],e[s[n]],e[s[a]]]),j.push([s[i],s[n],s[a]]),i=n,a=n+1;a<o;i++,a++)s[i]=s[a];v=2*--o}}return t?j:_},triangulateShape:function(e,t){function r(e){var t=e.length;2<t&&e[t-1].equals(e[0])&&e.pop()}function c(e,t,n){return e.x!==t.x?e.x<t.x?e.x<=n.x&&n.x<=t.x:t.x<=n.x&&n.x<=e.x:e.y<t.y?e.y<=n.y&&n.y<=t.y:t.y<=n.y&&n.y<=e.y}function l(e,t,n,s,o){var r=t.x-e.x,l=t.y-e.y,i=s.x-n.x,d=s.y-n.y,h=e.x-n.x,m=e.y-n.y,a=l*i-r*d,u=l*h-r*m;if(Math.abs(a)>Number.EPSILON){if(0<a){{if(0>u||u>a)return[];if(0>(i=d*h-i*m)||i>a)return[]}}else{if(0<u||u<a)return[];if(0<(i=d*h-i*m)||i<a)return[]}return 0===i?!o||0!==u&&u!==a?[e]:[]:i===a?!o||0!==u&&u!==a?[t]:[]:0===u?[n]:u===a?[s]:(o=i/a,[{x:e.x+o*r,y:e.y+o*l}])}return 0!==u||d*h!=i*m?[]:(i=0===i&&0===d,(l=0===r&&0===l)&&i?e.x!==n.x||e.y!==n.y?[]:[e]:l?c(n,s,e)?[e]:[]:i?c(e,t,n)?[n]:[]:(0!==r?(e.x<t.x?(r=e,i=e.x,l=t,e=t.x):(r=t,i=t.x,l=e,e=e.x),n.x<s.x?(t=n,a=n.x,d=s,n=s.x):(t=s,a=s.x,d=n,n=n.x)):(e.y<t.y?(r=e,i=e.y,l=t,e=t.y):(r=t,i=t.y,l=e,e=e.y),n.y<s.y?(t=n,a=n.y,d=s,n=s.y):(t=s,a=s.y,d=n,n=n.y)),i<=a?e<a?[]:e===a?o?[]:[t]:e<=n?[t,l]:[t,d]:i>n?[]:i===n?o?[]:[r]:e<=n?[r,l]:[r,d]))}function d(e,t,n,s){var i,o=t.x-e.x,a=t.y-e.y;return t=n.x-e.x,n=n.y-e.y,i=s.x-e.x,s=s.y-e.y,e=o*n-a*t,o=o*s-a*i,Math.abs(e)>Number.EPSILON?(t=i*n-s*t,0<e?0<=o&&0<=t:0<=o||0<=t):0<o}r(e),t.forEach(r);var o,i,a={},s=e.concat(),n=0;for(i=t.length;n<i;n++)Array.prototype.push.apply(s,t[n]);for(n=0,i=s.length;n<i;n++)o=s[n].x+":"+s[n].y,void 0!==a[o]&&console.warn("THREE.ShapeUtils: Duplicate point",o,n),a[o]=n;for(n=function(e,t){function v(e,t){var i,o=n.length-1,a=e-1;return 0>a&&(a=o),i=e+1,i>o&&(i=0),!!(o=d(n[e],n[a],n[i],s[t]))&&(o=s.length-1,0>(a=t-1)&&(a=o),(i=t+1)>o&&(i=0),!!(o=d(s[t],s[a],s[i],n[e])))}function j(e,t){for(s=0;s<n.length;s++){var s,o=s+1;if(o%=n.length,0<(o=l(e,t,n[s],n[o],!0)).length)return!0}return!1}function b(e,n){for(o=0;o<r.length;o++){var s,o,a,i=t[r[o]];for(s=0;s<i.length;s++)if(a=s+1,a%=i.length,0<(a=l(e,n,i[s],i[a],!0)).length)return!0}return!1}var s,o,i,a,c,u,h,m,f,p,g,n=e.concat(),r=[];e=[],o=0;for(a=t.length;o<a;o++)r.push(o);for(h=0,p=2*r.length;0<r.length;){if(0>--p){console.log('THREE.ShapeUtils: Infinite Loop! Holes left:" + indepHoles.length + ", Probably Hole outside Shape!');break}for(i=h;i<n.length;i++){m=n[i];for(a=-1,o=0;o<r.length;o++)if(u=r[o],f=m.x+":"+m.y+":"+u,void 0===e[f]){s=t[u];for(c=0;c<s.length;c++)if(u=s[c],v(i,c)&&!j(m,u)&&!b(m,u)){a=c,r.splice(o,1),h=n.slice(0,i+1),u=n.slice(i),c=s.slice(a),g=s.slice(0,a+1),n=h.concat(c).concat(g).concat(u),h=i;break}if(0<=a)break;e[f]=!0}if(0<=a)break}}return n}(e,t),s=R.triangulate(n,!1),n=0,i=s.length;n<i;n++)for(t=s[n],e=0;3>e;e++)void 0!==(o=a[o=t[e].x+":"+t[e].y])&&(t[e]=o);return s.concat()},isClockWise:function(e){return 0>R.area(e)}},te.prototype=Object.create(l.prototype),te.prototype.constructor=te,H.prototype=Object.create(i.prototype),H.prototype.constructor=H,H.prototype.getArrays=function(){var e,t,n;return{position:e=(e=this.getAttribute("position"))?Array.prototype.slice.call(e.array):[],uv:t=(t=this.getAttribute("uv"))?Array.prototype.slice.call(t.array):[],index:n=(n=this.index)?Array.prototype.slice.call(n.array):[]}},H.prototype.addShapeList=function(e,t){var n,o=e.length;t.arrays=this.getArrays();for(n=0;n<o;n++)this.addShape(e[n],t);this.setIndex(t.arrays.index),this.addAttribute("position",new s(t.arrays.position,3)),this.addAttribute("uv",new s(t.arrays.uv,2))},H.prototype.addShape=function(e,o){function F(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}function G(e,t,s){var l,d,i=e.x-t.x,o=e.y-t.y,a=s.x-e.x,r=s.y-e.y,c=i*i+o*o;if(Math.abs(i*r-o*a)>Number.EPSILON){if(l=Math.sqrt(c),d=Math.sqrt(a*a+r*r),c=t.x-o/l,t=t.y+i/l,2>=(o=(a=c+i*(r=((s.x-r/d-c)*r-(s.y+a/d-t)*a)/(i*r-o*a))-e.x)*a+(i=t+o*r-e.y)*i))return new n(a,i);o=Math.sqrt(o/2)}else e=!1,i>Number.EPSILON?a>Number.EPSILON&&(e=!0):i<-Number.EPSILON?a<-Number.EPSILON&&(e=!0):Math.sign(o)===Math.sign(r)&&(e=!0),e?(a=-o,o=Math.sqrt(c)):(a=i,i=o,o=Math.sqrt(c/2));return new n(a/o,i/o)}function Y(e,t){for(i=e.length;0<=--i;){r=i,s=i-1,0>s&&(s=e.length-1),c=v+2*C;for(o=0;o<c;o++){var s,o,r,c,n=b*o,l=t+s+n,d=t+s+(a=b*(o+1)),a=t+r+a;_(t+r+n),_(l),_(a),_(l),_(d),_(a),n=m.length/3,j((n=U.generateSideWallUV(T,m,n-6,n-3,n-2,n-1))[0]),j(n[1]),j(n[3]),j(n[1]),j(n[2]),j(n[3])}}}function w(e,t,n){M.push(e),M.push(t),M.push(n)}function W(e,t,n){_(e),_(t),_(n),e=m.length/3,j((e=U.generateTopUV(T,m,e-3,e-2,e-1))[0]),j(e[1]),j(e[2])}function _(e){K.push(m.length/3),m.push(M[3*e+0]),m.push(M[3*e+1]),m.push(M[3*e+2])}function j(e){q.push(e.x),q.push(e.y)}var r,c,d,h,p,g,x,k,S,T,z,N,m=(A=o.arrays?o.arrays:this.getArrays()).position,K=A.index,q=A.uv,M=[],A=void 0!==o.amount?o.amount:100,I=void 0!==o.bevelThickness?o.bevelThickness:6,H=void 0!==o.bevelSize?o.bevelSize:I-2,C=void 0!==o.bevelSegments?o.bevelSegments:3,D=void 0===o.bevelEnabled||o.bevelEnabled,y=void 0!==o.curveSegments?o.curveSegments:12,v=void 0!==o.steps?o.steps:1,E=o.extrudePath,L=!1,U=void 0!==o.UVGenerator?o.UVGenerator:te.WorldUVGenerator;if(E){z=E.getSpacedPoints(v),L=!0,D=!1;var B=void 0!==o.frames?o.frames:E.computeFrenetFrames(v,!1),$=new t,P=new t,O=new t}if(D||(H=I=C=0),T=this,y=e.extractPoints(y),e=y.shape,h=y.holes,!R.isClockWise(e)){e=e.reverse(),r=0;for(p=h.length;r<p;r++)d=h[r],R.isClockWise(d)&&(h[r]=d.reverse())}S=R.triangulateShape(e,h),g=e;for(r=0,p=h.length;r<p;r++)d=h[r],e=e.concat(d);var l,f,b=e.length,V=S.length,i=(y=[],0),a=g.length,u=a-1;for(l=i+1;i<a;i++,u++,l++)u===a&&(u=0),l===a&&(l=0),y[i]=G(g[i],g[u],g[l]);E=[],N=y.concat();for(r=0,p=h.length;r<p;r++){d=h[r],x=[];for(i=0,u=(a=d.length)-1,l=i+1;i<a;i++,u++,l++)u===a&&(u=0),l===a&&(l=0),x[i]=G(d[i],d[u],d[l]);E.push(x),N=N.concat(x)}for(u=0;u<C;u++){a=u/C,k=I*Math.cos(a*Math.PI/2);for(l=H*Math.sin(a*Math.PI/2),i=0,a=g.length;i<a;i++)c=F(g[i],y[i],l),w(c.x,c.y,-k);for(r=0,p=h.length;r<p;r++)for(d=h[r],x=E[r],i=0,a=d.length;i<a;i++)w((c=F(d[i],x[i],l)).x,c.y,-k)}for(l=H,i=0;i<b;i++)c=D?F(e[i],N[i],l):e[i],L?(P.copy(B.normals[0]).multiplyScalar(c.x),$.copy(B.binormals[0]).multiplyScalar(c.y),O.copy(z[0]).add(P).add($),w(O.x,O.y,O.z)):w(c.x,c.y,0);for(a=1;a<=v;a++)for(i=0;i<b;i++)c=D?F(e[i],N[i],l):e[i],L?(P.copy(B.normals[a]).multiplyScalar(c.x),$.copy(B.binormals[a]).multiplyScalar(c.y),O.copy(z[a]).add(P).add($),w(O.x,O.y,O.z)):w(c.x,c.y,A/v*a);for(u=C-1;0<=u;u--){for(a=u/C,k=I*Math.cos(a*Math.PI/2),l=H*Math.sin(a*Math.PI/2),i=0,a=g.length;i<a;i++)w((c=F(g[i],y[i],l)).x,c.y,A+k);for(r=0,p=h.length;r<p;r++)for(d=h[r],x=E[r],i=0,a=d.length;i<a;i++)c=F(d[i],x[i],l),L?w(c.x,c.y+z[v-1].y,z[v-1].x+k):w(c.x,c.y,A+k)}!function(){var e,t=m.length/3;if(D){e=0*b;for(i=0;i<V;i++)W((f=S[i])[2]+e,f[1]+e,f[0]+e);for(e=b*(v+2*C),i=0;i<V;i++)W((f=S[i])[0]+e,f[1]+e,f[2]+e)}else{for(i=0;i<V;i++)W((f=S[i])[2],f[1],f[0]);for(i=0;i<V;i++)W((f=S[i])[0]+b*v,f[1]+b*v,f[2]+b*v)}T.addGroup(t,m.length/3-t,void 0!==o.material?o.material:0)}(),function(){var t=m.length/3,e=0;for(Y(g,e),e+=g.length,r=0,p=h.length;r<p;r++)Y(d=h[r],e),e+=d.length;T.addGroup(t,m.length/3-t,void 0!==o.extrudeMaterial?o.extrudeMaterial:1)}(),o.arrays||(this.setIndex(K),this.addAttribute("position",new s(m,3)),this.addAttribute("uv",new s(o.arrays.uv,2)))},te.WorldUVGenerator={generateTopUV:function(e,t,s,o,i){e=t[3*o],o=t[3*o+1];var a=t[3*i];return i=t[3*i+1],[new n(t[3*s],t[3*s+1]),new n(e,o),new n(a,i)]},generateSideWallUV:function(e,t,s,o,i,a){e=t[3*s],r=t[3*s+1],s=t[3*s+2];var r,l,d,u,h,m=t[3*o],c=t[3*o+1];return o=t[3*o+2],l=t[3*i],d=t[3*i+1],i=t[3*i+2],u=t[3*a],h=t[3*a+1],t=t[3*a+2],.01>Math.abs(r-c)?[new n(e,1-s),new n(m,1-o),new n(l,1-i),new n(u,1-t)]:[new n(r,1-s),new n(c,1-o),new n(d,1-i),new n(h,1-t)]}},en.prototype=Object.create(l.prototype),en.prototype.constructor=en,et.prototype=Object.create(H.prototype),et.prototype.constructor=et,nn.prototype=Object.create(l.prototype),nn.prototype.constructor=nn,ve.prototype=Object.create(i.prototype),ve.prototype.constructor=ve,wt.prototype=Object.create(l.prototype),wt.prototype.constructor=wt,Qe.prototype=Object.create(i.prototype),Qe.prototype.constructor=Qe,Ot.prototype=Object.create(l.prototype),Ot.prototype.constructor=Ot,Xe.prototype=Object.create(i.prototype),Xe.prototype.constructor=Xe,Ge.prototype=Object.create(l.prototype),Ge.prototype.constructor=Ge,Ye.prototype=Object.create(i.prototype),Ye.prototype.constructor=Ye,qe.prototype=Object.create(i.prototype),qe.prototype.constructor=qe,he.prototype=Object.create(l.prototype),he.prototype.constructor=he,J.prototype=Object.create(i.prototype),J.prototype.constructor=J,hn.prototype=Object.create(he.prototype),hn.prototype.constructor=hn,rn.prototype=Object.create(J.prototype),rn.prototype.constructor=rn,an.prototype=Object.create(l.prototype),an.prototype.constructor=an,We.prototype=Object.create(i.prototype),We.prototype.constructor=We,S=Object.freeze({WireframeGeometry:pt,ParametricGeometry:Dt,ParametricBufferGeometry:ht,TetrahedronGeometry:Pt,TetrahedronBufferGeometry:dt,OctahedronGeometry:It,OctahedronBufferGeometry:de,IcosahedronGeometry:Vt,IcosahedronBufferGeometry:ct,DodecahedronGeometry:Wt,DodecahedronBufferGeometry:rt,PolyhedronGeometry:Lt,PolyhedronBufferGeometry:k,TubeGeometry:Kt,TubeBufferGeometry:it,TorusKnotGeometry:Yt,TorusKnotBufferGeometry:ot,TorusGeometry:Xt,TorusBufferGeometry:st,TextGeometry:en,TextBufferGeometry:et,SphereGeometry:nn,SphereBufferGeometry:ve,RingGeometry:wt,RingBufferGeometry:Qe,PlaneGeometry:xt,PlaneBufferGeometry:Ce,LatheGeometry:Ot,LatheBufferGeometry:Xe,ShapeGeometry:Ge,ShapeBufferGeometry:Ye,ExtrudeGeometry:te,ExtrudeBufferGeometry:H,EdgesGeometry:qe,ConeGeometry:hn,ConeBufferGeometry:rn,CylinderGeometry:he,CylinderBufferGeometry:J,CircleGeometry:an,CircleBufferGeometry:We,BoxGeometry:Ie,BoxBufferGeometry:ue}),$e.prototype=Object.create(h.prototype),$e.prototype.constructor=$e,$e.prototype.isShadowMaterial=!0,Ve.prototype=Object.create(D.prototype),Ve.prototype.constructor=Ve,Ve.prototype.isRawShaderMaterial=!0,U.prototype=Object.create(h.prototype),U.prototype.constructor=U,U.prototype.isMeshStandardMaterial=!0,U.prototype.copy=function(e){return h.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},we.prototype=Object.create(U.prototype),we.prototype.constructor=we,we.prototype.isMeshPhysicalMaterial=!0,we.prototype.copy=function(e){return U.prototype.copy.call(this,e),this.defines={PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearCoat=e.clearCoat,this.clearCoatRoughness=e.clearCoatRoughness,this},B.prototype=Object.create(h.prototype),B.prototype.constructor=B,B.prototype.isMeshPhongMaterial=!0,B.prototype.copy=function(e){return h.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},ze.prototype=Object.create(B.prototype),ze.prototype.constructor=ze,ze.prototype.isMeshToonMaterial=!0,ze.prototype.copy=function(e){return B.prototype.copy.call(this,e),this.gradientMap=e.gradientMap,this},Re.prototype=Object.create(h.prototype),Re.prototype.constructor=Re,Re.prototype.isMeshNormalMaterial=!0,Re.prototype.copy=function(e){return h.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Le.prototype=Object.create(h.prototype),Le.prototype.constructor=Le,Le.prototype.isMeshLambertMaterial=!0,Le.prototype.copy=function(e){return h.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Ne.prototype=Object.create(p.prototype),Ne.prototype.constructor=Ne,Ne.prototype.isLineDashedMaterial=!0,Ne.prototype.copy=function(e){return p.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var Yo=Object.freeze({ShadowMaterial:$e,SpriteMaterial:le,RawShaderMaterial:Ve,ShaderMaterial:D,PointsMaterial:P,MeshPhysicalMaterial:we,MeshStandardMaterial:U,MeshPhongMaterial:B,MeshToonMaterial:ze,MeshNormalMaterial:Re,MeshLambertMaterial:Le,MeshDepthMaterial:oe,MeshDistanceMaterial:se,MeshBasicMaterial:F,LineDashedMaterial:Ne,LineBasicMaterial:p,Material:h}),Bt={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},z=new es,q={};Object.assign($.prototype,{load:function(e,t,n,s){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var o,a,r,c,l,u,i=this,d=Bt.get(e);if(void 0!==d)return i.manager.itemStart(e),setTimeout(function(){t&&t(d),i.manager.itemEnd(e)},0),d;if(void 0===q[e]){if(o=e.match(/^data:(.*?)(;base64)?,(.*)$/)){n=o[1],r=!!o[2],o=o[3],o=window.decodeURIComponent(o),r&&(o=window.atob(o));try{switch(u=(this.responseType||"").toLowerCase(),u){case"arraybuffer":case"blob":l=new Uint8Array(o.length);for(r=0;r<o.length;r++)l[r]=o.charCodeAt(r);c="blob"===u?new Blob([l.buffer],{type:n}):l.buffer;break;case"document":c=(new DOMParser).parseFromString(o,n);break;case"json":c=JSON.parse(o);break;default:c=o}window.setTimeout(function(){t&&t(c),i.manager.itemEnd(e)},0)}catch(t){window.setTimeout(function(){s&&s(t),i.manager.itemEnd(e),i.manager.itemError(e)},0)}}else{q[e]=[],q[e].push({onLoad:t,onProgress:n,onError:s}),a=new XMLHttpRequest;for(r in a.open("GET",e,!0),a.addEventListener("load",function(t){if(r=t.target.response,Bt.add(e,r),s=q[e],delete q[e],200===this.status){for(var s,o,r,n=0,a=s.length;n<a;n++)o=s[n],o.onLoad&&o.onLoad(r);i.manager.itemEnd(e)}else if(0===this.status){for(console.warn("THREE.FileLoader: HTTP Status 0 received."),n=0,a=s.length;n<a;n++)(o=s[n]).onLoad&&o.onLoad(r);i.manager.itemEnd(e)}else{for(n=0,a=s.length;n<a;n++)(o=s[n]).onError&&o.onError(t);i.manager.itemEnd(e),i.manager.itemError(e)}},!1),a.addEventListener("progress",function(t){for(var s,o=q[e],n=0,i=o.length;n<i;n++)s=o[n],s.onProgress&&s.onProgress(t)},!1),a.addEventListener("error",function(t){n=q[e],delete q[e];for(var n,o,s=0,a=n.length;s<a;s++)o=n[s],o.onError&&o.onError(t);i.manager.itemEnd(e),i.manager.itemError(e)},!1),void 0!==this.responseType&&(a.responseType=this.responseType),void 0!==this.withCredentials&&(a.withCredentials=this.withCredentials),a.overrideMimeType&&a.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)a.setRequestHeader(r,this.requestHeader[r]);a.send(null)}return i.manager.itemStart(e),a}q[e].push({onLoad:t,onProgress:n,onError:s})},setPath:function(e){return this.path=e,this},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),Object.assign(Ss.prototype,{load:function(e,t,n,s){function u(r){a.load(e[r],function(e){e=l._parser(e,!0),i[r]={width:e.width,height:e.height,format:e.format,mipmaps:e.mipmaps},6===(c+=1)&&(1===e.mipmapCount&&(o.minFilter=1006),o.format=e.format,o.needsUpdate=!0,t&&t(o))},n,s)}var a,r,c,d,l=this,i=[],o=new gt;if(o.image=i,a=new $(this.manager),a.setPath(this.path),a.setResponseType("arraybuffer"),Array.isArray(e))for(r=c=0,d=e.length;r<d;++r)u(r);else a.load(e,function(e){if((e=l._parser(e,!0)).isCubemap)for(var s,a=e.mipmaps.length/e.mipmapCount,n=0;n<a;n++){i[n]={mipmaps:[]};for(s=0;s<e.mipmapCount;s++)i[n].mipmaps.push(e.mipmaps[n*e.mipmapCount+s]),i[n].format=e.format,i[n].width=e.width,i[n].height=e.height}else o.image.width=e.width,o.image.height=e.height,o.mipmaps=e.mipmaps;1===e.mipmapCount&&(o.minFilter=1006),o.format=e.format,o.needsUpdate=!0,t&&t(o)},n,s);return o},setPath:function(e){return this.path=e,this}}),Object.assign(Qn.prototype,{load:function(e,t,n,s){var a=this,o=new De,i=new $(this.manager);return i.setResponseType("arraybuffer"),i.load(e,function(e){(e=a._parser(e))&&(void 0!==e.image?o.image=e.image:void 0!==e.data&&(o.image.width=e.width,o.image.height=e.height,o.image.data=e.data),o.wrapS=void 0!==e.wrapS?e.wrapS:1001,o.wrapT=void 0!==e.wrapT?e.wrapT:1001,o.magFilter=void 0!==e.magFilter?e.magFilter:1006,o.minFilter=void 0!==e.minFilter?e.minFilter:1008,o.anisotropy=void 0!==e.anisotropy?e.anisotropy:1,void 0!==e.format&&(o.format=e.format),void 0!==e.type&&(o.type=e.type),void 0!==e.mipmaps&&(o.mipmaps=e.mipmaps),1===e.mipmapCount&&(o.minFilter=1006),o.needsUpdate=!0,t&&t(o,e))},n,s),o}}),Object.assign(Mt.prototype,{crossOrigin:"Anonymous",load:function(e,t,n,s){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var o=this,i=Bt.get(e);return void 0!==i?(o.manager.itemStart(e),setTimeout(function(){t&&t(i),o.manager.itemEnd(e)},0),i):((n=document.createElementNS("http://www.w3.org/1999/xhtml","img")).addEventListener("load",function(){Bt.add(e,this),t&&t(this),o.manager.itemEnd(e)},!1),n.addEventListener("error",function(t){s&&s(t),o.manager.itemEnd(e),o.manager.itemError(e)},!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(n.crossOrigin=this.crossOrigin),o.manager.itemStart(e),n.src=e,n)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Xn.prototype,{crossOrigin:"Anonymous",load:function(e,t,n,s){function r(n){i.load(e[n],function(e){o.images[n]=e,6===++a&&(o.needsUpdate=!0,t&&t(o))},void 0,s)}var a,o=new ae,i=new Mt(this.manager);i.setCrossOrigin(this.crossOrigin),i.setPath(this.path),a=0;for(n=0;n<e.length;++n)r(n);return o},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(zn.prototype,{crossOrigin:"Anonymous",load:function(e,t,n,s){var o,i=new Mt(this.manager);return i.setCrossOrigin(this.crossOrigin),i.setPath(this.path),o=new b,o.image=i.load(e,function(){var n=0<e.search(/\.(jpg|jpeg)$/)||0===e.search(/^data:image\/jpeg/);o.format=n?1022:1023,o.needsUpdate=!0,void 0!==t&&t(o)},n,s),o},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),j.prototype=Object.assign(Object.create(o.prototype),{constructor:j,isLight:!0,copy:function(e){return o.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){return(e=o.prototype.toJSON.call(this,e)).object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),Nn.prototype=Object.assign(Object.create(j.prototype),{constructor:Nn,isHemisphereLight:!0,copy:function(e){return j.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(Te.prototype,{copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),Rn.prototype=Object.assign(Object.create(Te.prototype),{constructor:Rn,isSpotLightShadow:!0,update:function(e){var t=this.camera,n=2*d.RAD2DEG*e.angle,s=this.mapSize.width/this.mapSize.height;e=e.distance||t.far,n===t.fov&&s===t.aspect&&e===t.far||(t.fov=n,t.aspect=s,t.far=e,t.updateProjectionMatrix())}}),Pn.prototype=Object.assign(Object.create(j.prototype),{constructor:Pn,isSpotLight:!0,copy:function(e){return j.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Hn.prototype=Object.assign(Object.create(j.prototype),{constructor:Hn,isPointLight:!0,copy:function(e){return j.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),In.prototype=Object.assign(Object.create(Te.prototype),{constructor:In}),Bn.prototype=Object.assign(Object.create(j.prototype),{constructor:Bn,isDirectionalLight:!0,copy:function(e){return j.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Vn.prototype=Object.assign(Object.create(j.prototype),{constructor:Vn,isAmbientLight:!0}),$n.prototype=Object.assign(Object.create(j.prototype),{constructor:$n,isRectAreaLight:!0,copy:function(e){return j.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){return(e=j.prototype.toJSON.call(this,e)).object.width=this.width,e.object.height=this.height,e}}),w={arraySlice:function(e,t,n){return w.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var s=e.length,n=Array(s),t=0;t!==s;++t)n[t]=t;return n.sort(function(t,n){return e[t]-e[n]}),n},sortedArray:function(e,t,n){for(var s,c,o=e.length,i=new e.constructor(o),a=0,r=0;r!==o;++a)for(c=n[a]*t,s=0;s!==t;++s)i[r++]=e[c+s];return i},flattenJSON:function(e,t,n,s){for(var i,a=1,o=e[0];void 0!==o&&void 0===o[s];)o=e[a++];if(void 0!==o&&(i=o[s],void 0!==i))if(Array.isArray(i))do void 0!==(i=o[s])&&(t.push(o.time),n.push.apply(n,i)),o=e[a++];while(void 0!==o)else if(void 0!==i.toArray)do void 0!==(i=o[s])&&(t.push(o.time),i.toArray(n,n.length)),o=e[a++];while(void 0!==o)else do void 0!==(i=o[s])&&(t.push(o.time),n.push(i)),o=e[a++];while(void 0!==o)}},Object.assign(T.prototype,{evaluate:function(e){var i,o=this.parameterPositions,t=this._cachedIndex,n=o[t],s=o[t-1];t:{e:{i:{n:if(!(e<n)){for(i=t+2;;){if(void 0===n){if(e<s)break n;return this._cachedIndex=t=o.length,this.afterEnd_(t-1,e,s)}if(t===i)break;if(s=n,e<(n=o[++t]))break e}n=o.length;break i}if(e>=s)break t;for(e<(i=o[1])&&(t=2,s=i),i=t-2;;){if(void 0===s)return this._cachedIndex=0,this.beforeStart_(0,e,n);if(t===i)break;if(n=s,e>=(s=o[--t-1]))break e}n=t,t=0}for(;t<n;)e<o[s=t+n>>>1]?n=s:t=s+1;if(n=o[t],void 0===(s=o[t-1]))return this._cachedIndex=0,this.beforeStart_(0,e,n);if(void 0===n)return this._cachedIndex=t=o.length,this.afterEnd_(t-1,s,e)}this._cachedIndex=t,this.intervalChanged_(t,s,n)}return this.interpolate_(t,s,e,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){var t,n=this.resultBuffer,o=this.sampleValues,s=this.valueSize;e*=s;for(t=0;t!==s;++t)n[t]=o[e+t];return n},interpolate_:function(){throw Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(T.prototype,{beforeStart_:T.prototype.copySampleValue_,afterEnd_:T.prototype.copySampleValue_}),pn.prototype=Object.assign(Object.create(T.prototype),{constructor:pn,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(e,t,n){var s=this.parameterPositions,o=e-2,i=e+1,a=s[o],r=s[i];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:o=e,a=2*t-n;break;case 2402:a=t+s[o=s.length-2]-s[o+1];break;default:o=e,a=n}if(void 0===r)switch(this.getSettings_().endingEnd){case 2401:i=e,r=2*n-t;break;case 2402:i=1,r=n+s[1]-s[0];break;default:i=e-1,r=t}e=.5*(n-t),s=this.valueSize,this._weightPrev=e/(t-a),this._weightNext=e/(r-n),this._offsetPrev=o*s,this._offsetNext=i*s},interpolate_:function(e,t,n,s){var l=this.resultBuffer,r=this.sampleValues,c=this.valueSize,d=(e*=c)-c,u=this._offsetPrev,h=this._offsetNext,o=this._weightPrev,a=this._weightNext,i=(n-t)/(s-t);for(t=-o*(s=(n=i*i)*i)+2*o*n-o*i,o=(1+o)*s+(-1.5-2*o)*n+(-.5+o)*i+1,i=(-1-a)*s+(1.5+a)*n+.5*i,a=a*s-a*n,n=0;n!==c;++n)l[n]=t*r[u+n]+o*r[d+n]+i*r[e+n]+a*r[h+n];return l}}),Et.prototype=Object.assign(Object.create(T.prototype),{constructor:Et,interpolate_:function(e,t,n,s){var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,r=(e*=o)-o;for(n=1-(t=(n-t)/(s-t)),s=0;s!==o;++s)i[s]=a[r+s]*n+a[e+s]*t;return i}}),Dn.prototype=Object.assign(Object.create(T.prototype),{constructor:Dn,interpolate_:function(e){return this.copySampleValue_(e-1)}}),Y={TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(e){return new Dn(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Et(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new pn(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){switch(e){case 2300:var t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){if(t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name,void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw Error(t);this.setInterpolation(this.DefaultInterpolation)}console.warn("THREE.KeyframeTrackPrototype:",t)}else this.createInterpolant=t},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var n=this.times,t=0,s=n.length;t!==s;++t)n[t]+=e;return this},scale:function(e){if(1!==e)for(var n=this.times,t=0,s=n.length;t!==s;++t)n[t]*=e;return this},trim:function(e,t){for(var o=this.times,i=o.length,s=0,n=i-1;s!==i&&o[s]<e;)++s;for(;-1!==n&&o[n]>t;)--n;return++n,0===s&&n===i||(s>=n&&(s=(n=Math.max(n,1))-1),e=this.getValueSize(),this.times=w.arraySlice(o,s,n),this.values=w.arraySlice(this.values,s*e,n*e)),this},validate:function(){t=!0,0!=(s=this.getValueSize())-Math.floor(s)&&(console.error("THREE.KeyframeTrackPrototype: Invalid value size in track.",this),t=!1);var e,t,n,i,a=this.times,s=this.values,o=a.length;0===o&&(console.error("THREE.KeyframeTrackPrototype: Track is empty.",this),t=!1);for(i=null,e=0;e!==o;e++){if(n=a[e],"number"==typeof n&&isNaN(n)){console.error("THREE.KeyframeTrackPrototype: Time is not a valid number.",this,e,n),t=!1;break}if(null!==i&&i>n){console.error("THREE.KeyframeTrackPrototype: Out of order keys.",this,e,n,i),t=!1;break}i=n}if(void 0!==s&&w.isTypedArray(s))for(e=0,a=s.length;e!==a;++e)if(o=s[e],isNaN(o)){console.error("THREE.KeyframeTrackPrototype: Value is not a valid number.",this,e,o),t=!1;break}return t},optimize:function(){for(var a,r,l,s=this.times,i=this.values,t=this.getValueSize(),d=2302===this.getInterpolation(),n=1,c=s.length-1,o=1;o<c;++o){if(a=!1,(e=s[o])!==s[o+1]&&(1!==o||e!==e[0]))if(d)a=!0;else for(var u=(r=o*t)-t,h=r+t,e=0;e!==t;++e)if(l=i[r+e],l!==i[u+e]||l!==i[h+e]){a=!0;break}if(a){if(o!==n)for(s[n]=s[o],r=o*t,a=n*t,e=0;e!==t;++e)i[a+e]=i[r+e];++n}}if(0<c){for(s[n]=s[c],r=c*t,a=n*t,e=0;e!==t;++e)i[a+e]=i[r+e];++n}return n!==s.length&&(this.times=w.arraySlice(s,0,n),this.values=w.arraySlice(i,0,n*t)),this}},Be.prototype=Object.assign(Object.create(Y),{constructor:Be,ValueTypeName:"vector"}),Tn.prototype=Object.assign(Object.create(T.prototype),{constructor:Tn,interpolate_:function(e,t,n,s){var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize;for(t=(n-t)/(s-t),n=(e*=o)+o;e!==n;e+=4)y.slerpFlat(i,0,a,e-o,a,e,t);return i}}),Ft.prototype=Object.assign(Object.create(Y),{constructor:Ft,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(e){return new Tn(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),Ue.prototype=Object.assign(Object.create(Y),{constructor:Ue,ValueTypeName:"number"}),An.prototype=Object.assign(Object.create(Y),{constructor:An,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),kn.prototype=Object.assign(Object.create(Y),{constructor:kn,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),En.prototype=Object.assign(Object.create(Y),{constructor:En,ValueTypeName:"color"}),pe.prototype=Y,Y.constructor=pe,Object.assign(pe,{parse:function(e){if(void 0===e.type)throw Error("track type undefined, can not parse");if(t=pe._getTrackTypeForValueTypeName(e.type),void 0===e.times){var t,n=[],s=[];w.flattenJSON(e.keys,n,s,"value"),e.times=n,e.values=s}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)},toJSON:function(e){if(void 0!==(t=e.constructor).toJSON)t=t.toJSON(e);else{var t={name:e.name,times:w.convertArray(e.times,Array),values:w.convertArray(e.values,Array)},n=e.getInterpolation();n!==e.DefaultInterpolation&&(t.interpolation=n)}return t.type=e.ValueTypeName,t},_getTrackTypeForValueTypeName:function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Ue;case"vector":case"vector2":case"vector3":case"vector4":return Be;case"color":return En;case"quaternion":return Ft;case"bool":case"boolean":return kn;case"string":return An}throw Error("Unsupported typeName: "+e)}}),Object.assign(N,{parse:function(e){for(var n=[],s=e.tracks,o=1/(e.fps||1),t=0,i=s.length;t!==i;++t)n.push(pe.parse(s[t]).scale(o));return new N(e.name,e.duration,n)},toJSON:function(e){var t,o,n=[],s=e.tracks;e={name:e.name,duration:e.duration,tracks:n};for(t=0,o=s.length;t!==o;++t)n.push(pe.toJSON(s[t]));return e},CreateFromMorphTargetSequence:function(e,t,n,s){for(var o,i,c,r=t.length,l=[],a=0;a<r;a++)o=[],(i=[]).push((a+r-1)%r,a,(a+1)%r),o.push(0,1,0),c=w.getKeyframeOrder(i),i=w.sortedArray(i,1,c),o=w.sortedArray(o,1,c),s||0!==i[0]||(i.push(r),o.push(o[0])),l.push(new Ue(".morphTargetInfluences["+t[a].name+"]",i,o).scale(1/n));return new N(e,-1,l)},findByName:function(e,t){var n=e;for(Array.isArray(e)||(n=e.geometry&&e.geometry.animations||e.animations),e=0;e<n.length;e++)if(n[e].name===t)return n[e];return null},CreateClipsFromMorphTargetSequences:function(e,t,n){for(var s,o,r,i={},c=/^([\w-]*?)([\d]+)$/,a=0,l=e.length;a<l;a++)r=e[a],s=r.name.match(c),s&&1<s.length&&((s=i[o=s[1]])||(i[o]=s=[]),s.push(r));for(o in e=[],i)e.push(N.CreateFromMorphTargetSequence(o,i[o],t,n));return e},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;var n,s,o,r,l,d,u,h,c=function(e,t,n,s,o){if(0!==n.length){var i=[],a=[];w.flattenJSON(n,i,a,s),0!==i.length&&o.push(new e(t,i,a))}},a=[],f=e.name||"default",i=e.length||-1,m=e.fps||30;e=e.hierarchy||[];for(r=0;r<e.length;r++)if(n=e[r].keys,n&&0!==n.length)if(n[0].morphTargets){i={};for(s=0;s<n.length;s++)if(n[s].morphTargets)for(o=0;o<n[s].morphTargets.length;o++)i[n[s].morphTargets[o]]=-1;for(h in i){l=[],d=[];for(o=0;o!==n[s].morphTargets.length;++o)u=n[s],l.push(u.time),d.push(u.morphTarget===h?1:0);a.push(new Ue(".morphTargetInfluence["+h+"]",l,d))}i=i.length*(m||1)}else c(Be,(s=".bones["+t[r].name+"]")+".position",n,"pos",a),c(Ft,s+".quaternion",n,"rot",a),c(Be,s+".scale",n,"scl",a);return 0===a.length?null:new N(f,i,a)}}),Object.assign(N.prototype,{resetDuration:function(){for(var n,e=0,t=0,s=this.tracks.length;t!==s;++t)n=this.tracks[t],e=Math.max(e,n.times[n.times.length-1]);this.duration=e},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}}),Object.assign(On.prototype,{load:function(e,t,n,s){var o=this;new $(o.manager).load(e,function(e){t(o.parse(JSON.parse(e)))},n,s)},setTextures:function(e){this.textures=e},parse:function(e){function s(e){return void 0===i[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),i[e]}var o,i=this.textures,t=new Yo[e.type];return(void 0!==e.uuid&&(t.uuid=e.uuid),void 0!==e.name&&(t.name=e.name),void 0!==e.color&&t.color.setHex(e.color),void 0!==e.roughness&&(t.roughness=e.roughness),void 0!==e.metalness&&(t.metalness=e.metalness),void 0!==e.emissive&&t.emissive.setHex(e.emissive),void 0!==e.specular&&t.specular.setHex(e.specular),void 0!==e.shininess&&(t.shininess=e.shininess),void 0!==e.clearCoat&&(t.clearCoat=e.clearCoat),void 0!==e.clearCoatRoughness&&(t.clearCoatRoughness=e.clearCoatRoughness),void 0!==e.uniforms&&(t.uniforms=e.uniforms),void 0!==e.vertexShader&&(t.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(t.fragmentShader=e.fragmentShader),void 0!==e.vertexColors&&(t.vertexColors=e.vertexColors),void 0!==e.fog&&(t.fog=e.fog),void 0!==e.flatShading&&(t.flatShading=e.flatShading),void 0!==e.blending&&(t.blending=e.blending),void 0!==e.side&&(t.side=e.side),void 0!==e.opacity&&(t.opacity=e.opacity),void 0!==e.transparent&&(t.transparent=e.transparent),void 0!==e.alphaTest&&(t.alphaTest=e.alphaTest),void 0!==e.depthTest&&(t.depthTest=e.depthTest),void 0!==e.depthWrite&&(t.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(t.colorWrite=e.colorWrite),void 0!==e.wireframe&&(t.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(t.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(t.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(t.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(t.rotation=e.rotation),1!==e.linewidth&&(t.linewidth=e.linewidth),void 0!==e.dashSize&&(t.dashSize=e.dashSize),void 0!==e.gapSize&&(t.gapSize=e.gapSize),void 0!==e.scale&&(t.scale=e.scale),void 0!==e.skinning&&(t.skinning=e.skinning),void 0!==e.morphTargets&&(t.morphTargets=e.morphTargets),void 0!==e.dithering&&(t.dithering=e.dithering),void 0!==e.visible&&(t.visible=e.visible),void 0!==e.userData&&(t.userData=e.userData),void 0!==e.shading&&(t.flatShading=1===e.shading),void 0!==e.size&&(t.size=e.size),void 0!==e.sizeAttenuation&&(t.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(t.map=s(e.map)),void 0!==e.alphaMap&&(t.alphaMap=s(e.alphaMap),t.transparent=!0),void 0!==e.bumpMap&&(t.bumpMap=s(e.bumpMap)),void 0!==e.bumpScale&&(t.bumpScale=e.bumpScale),void 0!==e.normalMap&&(t.normalMap=s(e.normalMap)),void 0!==e.normalScale)&&(o=e.normalScale,!1===Array.isArray(o)&&(o=[o,o]),t.normalScale=(new n).fromArray(o)),void 0!==e.displacementMap&&(t.displacementMap=s(e.displacementMap)),void 0!==e.displacementScale&&(t.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(t.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(t.roughnessMap=s(e.roughnessMap)),void 0!==e.metalnessMap&&(t.metalnessMap=s(e.metalnessMap)),void 0!==e.emissiveMap&&(t.emissiveMap=s(e.emissiveMap)),void 0!==e.emissiveIntensity&&(t.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(t.specularMap=s(e.specularMap)),void 0!==e.envMap&&(t.envMap=s(e.envMap)),void 0!==e.reflectivity&&(t.reflectivity=e.reflectivity),void 0!==e.lightMap&&(t.lightMap=s(e.lightMap)),void 0!==e.lightMapIntensity&&(t.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(t.aoMap=s(e.aoMap)),void 0!==e.aoMapIntensity&&(t.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(t.gradientMap=s(e.gradientMap)),t}}),Object.assign(is.prototype,{load:function(e,t,n,s){var o=this;new $(o.manager).load(e,function(e){t(o.parse(JSON.parse(e)))},n,s)},parse:function(e){var s,o,r,a=new i,n=e.data.index;void 0!==n&&(n=new ss[n.type](n.array),a.setIndex(new u(n,1))),r=e.data.attributes;for(s in r)o=r[s],n=new ss[o.type](o.array),a.addAttribute(s,new u(n,o.itemSize,o.normalized));if(s=e.data.groups||e.data.drawcalls||e.data.offsets,void 0!==s)for(n=0,r=s.length;n!==r;++n)o=s[n],a.addGroup(o.start,o.count,o.materialIndex);return void 0!==(e=e.data.boundingSphere)&&(s=new t,void 0!==e.center&&s.fromArray(e.center),a.boundingSphere=new V(s,e.radius)),a}}),ss={Int8Array,Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array},Ke.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var s,n=this.handlers,t=0,o=n.length;t<o;t+=2)if(s=n[t+1],n[t].test(e))return s;return null}},Object.assign(Ke.prototype,{crossOrigin:void 0,extractUrlBase:function(e){return 1===(e=e.split("/")).length?"./":(e.pop(),e.join("/")+"/")},initMaterials:function(e,t,n){for(var o=[],s=0;s<e.length;++s)o[s]=this.createMaterial(e[s],t,n);return o},createMaterial:function(){var s={NoBlending:0,NormalBlending:1,AdditiveBlending:2,SubtractiveBlending:3,MultiplyBlending:4,CustomBlending:5},e=new a,t=new zn,n=new On;return function(o,i,a){function l(e,n,s,o,r){e=i+e;var c=Ke.Handlers.get(e);return null!==c?e=c.load(e):(t.setCrossOrigin(a),e=t.load(e)),void 0!==n&&(e.repeat.fromArray(n),1!==n[0]&&(e.wrapS=1e3),1!==n[1]&&(e.wrapT=1e3)),void 0!==s&&e.offset.fromArray(s),void 0!==o&&("repeat"===o[0]&&(e.wrapS=1e3),"mirror"===o[0]&&(e.wrapS=1002),"repeat"===o[1]&&(e.wrapT=1e3),"mirror"===o[1]&&(e.wrapT=1002)),void 0!==r&&(e.anisotropy=r),n=d.generateUUID(),h[n]=e,n}var c,u,h={},r={uuid:d.generateUUID(),type:"MeshLambertMaterial"};for(u in o)switch(c=o[u],u){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"DbgName":r.name=c;break;case"blending":r.blending=s[c];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",u,"is no longer supported.");break;case"colorDiffuse":r.color=e.fromArray(c).getHex();break;case"colorSpecular":r.specular=e.fromArray(c).getHex();break;case"colorEmissive":r.emissive=e.fromArray(c).getHex();break;case"specularCoef":r.shininess=c;break;case"shading":"basic"===c.toLowerCase()&&(r.type="MeshBasicMaterial"),"phong"===c.toLowerCase()&&(r.type="MeshPhongMaterial"),"standard"===c.toLowerCase()&&(r.type="MeshStandardMaterial");break;case"mapDiffuse":r.map=l(c,o.mapDiffuseRepeat,o.mapDiffuseOffset,o.mapDiffuseWrap,o.mapDiffuseAnisotropy);break;case"mapEmissive":r.emissiveMap=l(c,o.mapEmissiveRepeat,o.mapEmissiveOffset,o.mapEmissiveWrap,o.mapEmissiveAnisotropy);break;case"mapLight":r.lightMap=l(c,o.mapLightRepeat,o.mapLightOffset,o.mapLightWrap,o.mapLightAnisotropy);break;case"mapAO":r.aoMap=l(c,o.mapAORepeat,o.mapAOOffset,o.mapAOWrap,o.mapAOAnisotropy);break;case"mapBump":r.bumpMap=l(c,o.mapBumpRepeat,o.mapBumpOffset,o.mapBumpWrap,o.mapBumpAnisotropy);break;case"mapBumpScale":r.bumpScale=c;break;case"mapNormal":r.normalMap=l(c,o.mapNormalRepeat,o.mapNormalOffset,o.mapNormalWrap,o.mapNormalAnisotropy);break;case"mapNormalFactor":r.normalScale=[c,c];break;case"mapSpecular":r.specularMap=l(c,o.mapSpecularRepeat,o.mapSpecularOffset,o.mapSpecularWrap,o.mapSpecularAnisotropy);break;case"mapMetalness":r.metalnessMap=l(c,o.mapMetalnessRepeat,o.mapMetalnessOffset,o.mapMetalnessWrap,o.mapMetalnessAnisotropy);break;case"mapRoughness":r.roughnessMap=l(c,o.mapRoughnessRepeat,o.mapRoughnessOffset,o.mapRoughnessWrap,o.mapRoughnessAnisotropy);break;case"mapAlpha":r.alphaMap=l(c,o.mapAlphaRepeat,o.mapAlphaOffset,o.mapAlphaWrap,o.mapAlphaAnisotropy);break;case"flipSided":r.side=1;break;case"doubleSided":r.side=2;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),r.opacity=c;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":r[u]=c;break;case"vertexColors":!0===c&&(r.vertexColors=2),"face"===c&&(r.vertexColors=1);break;default:console.error("THREE.Loader.createMaterial: Unsupported",u,c)}return"MeshBasicMaterial"===r.type&&delete r.emissive,"MeshPhongMaterial"!==r.type&&delete r.specular,1>r.opacity&&(r.transparent=!0),n.setTextures(h),n.parse(r)}}()}),Object.assign(cs.prototype,{load:function(e,t,n,s){var i=this,a=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:Ke.prototype.extractUrlBase(e),o=new $(this.manager);o.setWithCredentials(this.withCredentials),o.load(e,function(n){var s=(n=JSON.parse(n)).metadata;if(void 0!==s&&void 0!==(s=s.type)){if("object"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+e+" should be loaded with THREE.ObjectLoader instead.");if("scene"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+e+" should be loaded with THREE.SceneLoader instead.")}n=i.parse(n,a),t(n.geometry,n.materials)},n,s)},setTexturePath:function(e){this.texturePath=e},parse:function(e,s){void 0!==e.data&&(e=e.data),e.scale=void 0!==e.scale?1/e.scale:1;var o,r,c,m,f,p,y,w,O,x,C,E,d=new l,i=e,u=i.faces,v=i.vertices,b=i.normals,_=i.colors,h=i.scale,j=0;if(void 0!==i.uvs){for(r=0;r<i.uvs.length;r++)i.uvs[r].length&&j++;for(r=0;r<j;r++)d.faceVertexUvs[r]=[]}o=0;for(c=v.length;o<c;)(r=new t).x=v[o++]*h,r.y=v[o++]*h,r.z=v[o++]*h,d.vertices.push(r);for(o=0,c=u.length;o<c;)if(m=1&(v=u[o++]),p=2&v,r=8&v,f=16&v,O=32&v,h=64&v,v&=128,m){if((m=new Q).a=u[o],m.b=u[o+1],m.c=u[o+3],y=new Q,y.a=u[o+1],y.b=u[o+2],y.c=u[o+3],o+=4,p&&(p=u[o++],m.materialIndex=p,y.materialIndex=p),p=d.faces.length,r)for(r=0;r<j;r++){E=i.uvs[r];for(d.faceVertexUvs[r][p]=[],d.faceVertexUvs[r][p+1]=[],w=0;4>w;w++)C=u[o++],x=E[2*C],x=new n(x,C=E[2*C+1]),2!==w&&d.faceVertexUvs[r][p].push(x),0!==w&&d.faceVertexUvs[r][p+1].push(x)}if(f&&(f=3*u[o++],m.normal.set(b[f++],b[f++],b[f]),y.normal.copy(m.normal)),O)for(r=0;4>r;r++)f=3*u[o++],O=new t(b[f++],b[f++],b[f]),2!==r&&m.vertexNormals.push(O),0!==r&&y.vertexNormals.push(O);if(h&&(h=_[h=u[o++]],m.color.setHex(h),y.color.setHex(h)),v)for(r=0;4>r;r++)h=_[h=u[o++]],2!==r&&m.vertexColors.push(new a(h)),0!==r&&y.vertexColors.push(new a(h));d.faces.push(m),d.faces.push(y)}else{if((m=new Q).a=u[o++],m.b=u[o++],m.c=u[o++],p&&(p=u[o++],m.materialIndex=p),p=d.faces.length,r)for(r=0;r<j;r++)for(E=i.uvs[r],d.faceVertexUvs[r][p]=[],w=0;3>w;w++)x=new n(x=E[2*(C=u[o++])],C=E[2*C+1]),d.faceVertexUvs[r][p].push(x);if(f&&(f=3*u[o++],m.normal.set(b[f++],b[f++],b[f])),O)for(r=0;3>r;r++)f=3*u[o++],O=new t(b[f++],b[f++],b[f]),m.vertexNormals.push(O);if(h&&(h=u[o++],m.color.setHex(_[h])),v)for(r=0;3>r;r++)h=u[o++],m.vertexColors.push(new a(_[h]));d.faces.push(m)}if(o=void 0!==(i=e).influencesPerVertex?i.influencesPerVertex:2,i.skinWeights)for(c=0,u=i.skinWeights.length;c<u;c+=o)d.skinWeights.push(new g(i.skinWeights[c],1<o?i.skinWeights[c+1]:0,2<o?i.skinWeights[c+2]:0,3<o?i.skinWeights[c+3]:0));if(i.skinIndices)for(c=0,u=i.skinIndices.length;c<u;c+=o)d.skinIndices.push(new g(i.skinIndices[c],1<o?i.skinIndices[c+1]:0,2<o?i.skinIndices[c+2]:0,3<o?i.skinIndices[c+3]:0));if(d.bones=i.bones,d.bones&&0<d.bones.length&&(d.skinWeights.length!==d.skinIndices.length||d.skinIndices.length!==d.vertices.length)&&console.warn("When skinning, number of vertices ("+d.vertices.length+"), skinIndices ("+d.skinIndices.length+"), and skinWeights ("+d.skinWeights.length+") should match."),u=(c=e).scale,void 0!==c.morphTargets)for(i=0,o=c.morphTargets.length;i<o;i++)for(d.morphTargets[i]={},d.morphTargets[i].name=c.morphTargets[i].name,d.morphTargets[i].vertices=[],b=d.morphTargets[i].vertices,j=0,v=(_=c.morphTargets[i].vertices).length;j<v;j+=3)(h=new t).x=_[j]*u,h.y=_[j+1]*u,h.z=_[j+2]*u,b.push(h);if(void 0!==c.morphColors&&0<c.morphColors.length)for(console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.'),u=d.faces,c=c.morphColors[0].colors,i=0,o=u.length;i<o;i++)u[i].color.fromArray(c,3*i);for(i=[],o=[],void 0!==(c=e).animation&&o.push(c.animation),void 0!==c.animations&&(c.animations.length?o=o.concat(c.animations):o.push(c.animations)),c=0;c<o.length;c++)(u=N.parseAnimation(o[c],d.bones))&&i.push(u);return d.morphTargets&&(o=N.CreateClipsFromMorphTargetSequences(d.morphTargets,10),i=i.concat(o)),0<i.length&&(d.animations=i),d.computeFaceNormals(),d.computeBoundingSphere(),void 0===e.materials||0===e.materials.length?{geometry:d}:{geometry:d,materials:e=Ke.prototype.initMaterials(e.materials,s,this.crossOrigin)}}}),Object.assign(ao.prototype,{load:function(e,t,n,s){""===this.texturePath&&(this.texturePath=e.substring(0,e.lastIndexOf("/")+1));var o=this;new $(o.manager).load(e,function(n){var i=null;try{i=JSON.parse(n)}catch(t){return void 0!==s&&s(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}void 0===(n=i.metadata)||void 0===n.type||"geometry"===n.type.toLowerCase()?console.error("THREE.ObjectLoader: Can't load "+e+". Use THREE.JSONLoader instead."):o.parse(i,t)},n,s)},setTexturePath:function(e){this.texturePath=e},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e,t){var o=this.parseGeometries(e.geometries),n=this.parseImages(e.images,function(){void 0!==t&&t(s)}),s=(n=this.parseTextures(e.textures,n),n=this.parseMaterials(e.materials,n),this.parseObject(e.object,o,n));return e.animations&&(s.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0===t||t(s),s},parseGeometries:function(e){if(s={},void 0!==e)for(var t,n,s,i=new cs,a=new is,o=0,r=e.length;o<r;o++){switch(t=e[o],t.type){case"PlaneGeometry":case"PlaneBufferGeometry":n=new S[t.type](t.width,t.height,t.widthSegments,t.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":n=new S[t.type](t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":n=new S[t.type](t.radius,t.segments,t.thetaStart,t.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":n=new S[t.type](t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":n=new S[t.type](t.radius,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":n=new S[t.type](t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":n=new S[t.type](t.radius,t.detail);break;case"RingGeometry":case"RingBufferGeometry":n=new S[t.type](t.innerRadius,t.outerRadius,t.thetaSegments,t.phiSegments,t.thetaStart,t.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":n=new S[t.type](t.radius,t.tube,t.radialSegments,t.tubularSegments,t.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":n=new S[t.type](t.radius,t.tube,t.tubularSegments,t.radialSegments,t.p,t.q);break;case"LatheGeometry":case"LatheBufferGeometry":n=new S[t.type](t.points,t.segments,t.phiStart,t.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":n=new S[t.type](t.vertices,t.indices,t.radius,t.details);break;case"BufferGeometry":n=a.parse(t);break;case"Geometry":n=i.parse(t,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+t.type+'"');continue}n.uuid=t.uuid,void 0!==t.name&&(n.name=t.name),s[t.uuid]=n}return s},parseMaterials:function(e,t){if(s={},void 0!==e){o=new On,o.setTextures(t),t=0;for(a=e.length;t<a;t++)if(n=e[t],"MultiMaterial"===n.type){for(var n,s,o,a,r=[],i=0;i<n.materials.length;i++)r.push(o.parse(n.materials[i]));s[n.uuid]=r}else s[n.uuid]=o.parse(n)}return s},parseAnimations:function(e){for(var s,n=[],t=0;t<e.length;t++)s=N.parse(e[t]),n.push(s);return n},parseImages:function(e,t){function c(e){return n.manager.itemStart(e),o.load(e,function(){n.manager.itemEnd(e)},void 0,function(){n.manager.itemEnd(e),n.manager.itemError(e)})}var s,o,a,r,n=this,i={};if(void 0!==e&&0<e.length){o=new Mt(t=new es(t)),o.setCrossOrigin(this.crossOrigin),t=0;for(a=e.length;t<a;t++)s=e[t],r=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(s.url)?s.url:n.texturePath+s.url,i[s.uuid]=c(r)}return i},parseTextures:function(e,t){function o(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}if(i={},void 0!==e)for(var n,s,i,a=0,r=e.length;a<r;a++)n=e[a],void 0===n.image&&console.warn('THREE.ObjectLoader: No "image" specified for',n.uuid),void 0===t[n.image]&&console.warn("THREE.ObjectLoader: Undefined image",n.image),s=new b(t[n.image]),s.needsUpdate=!0,s.uuid=n.uuid,void 0!==n.name&&(s.name=n.name),void 0!==n.mapping&&(s.mapping=o(n.mapping,ti)),void 0!==n.offset&&s.offset.fromArray(n.offset),void 0!==n.repeat&&s.repeat.fromArray(n.repeat),void 0!==n.center&&s.center.fromArray(n.center),void 0!==n.rotation&&(s.rotation=n.rotation),void 0!==n.wrap&&(s.wrapS=o(n.wrap[0],Ds),s.wrapT=o(n.wrap[1],Ds)),void 0!==n.minFilter&&(s.minFilter=o(n.minFilter,Ts)),void 0!==n.magFilter&&(s.magFilter=o(n.magFilter,Ts)),void 0!==n.anisotropy&&(s.anisotropy=n.anisotropy),void 0!==n.flipY&&(s.flipY=n.flipY),i[n.uuid]=s;return i},parseObject:function(){var e=new c;return function(t,n,s){function d(e){return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),n[e]}function l(e){if(void 0!==e){if(Array.isArray(e)){for(var t,o=[],n=0,i=e.length;n<i;n++)t=e[n],void 0===s[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),o.push(s[t]);return o}return void 0===s[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),s[e]}}switch(t.type){case"Scene":var r,c,u,i=new Sn;void 0!==t.background&&Number.isInteger(t.background)&&(i.background=new a(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?i.fog=new ft(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(i.fog=new mt(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":i=new _(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(i.focus=t.focus),void 0!==t.zoom&&(i.zoom=t.zoom),void 0!==t.filmGauge&&(i.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(i.filmOffset=t.filmOffset),void 0!==t.view&&(i.view=Object.assign({},t.view));break;case"OrthographicCamera":i=new Ze(t.left,t.right,t.top,t.bottom,t.near,t.far);break;case"AmbientLight":i=new Vn(t.color,t.intensity);break;case"DirectionalLight":i=new Bn(t.color,t.intensity);break;case"PointLight":i=new Hn(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":i=new $n(t.color,t.intensity,t.width,t.height);break;case"SpotLight":i=new Pn(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":i=new Nn(t.color,t.groundColor,t.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":i=d(t.geometry),r=l(t.material),i=i.bones&&0<i.bones.length?new bn(i,r):new x(i,r);break;case"LOD":i=new kt;break;case"Line":i=new C(d(t.geometry),l(t.material),t.mode);break;case"LineLoop":i=new Ln(d(t.geometry),l(t.material));break;case"LineSegments":i=new v(d(t.geometry),l(t.material));break;case"PointCloud":case"Points":i=new bt(d(t.geometry),l(t.material));break;case"Sprite":i=new At(l(t.material));break;case"Group":i=new St;break;default:i=new o}if(i.uuid=t.uuid,void 0!==t.name&&(i.name=t.name),void 0!==t.matrix?(e.fromArray(t.matrix),e.decompose(i.position,i.quaternion,i.scale)):(void 0!==t.position&&i.position.fromArray(t.position),void 0!==t.rotation&&i.rotation.fromArray(t.rotation),void 0!==t.quaternion&&i.quaternion.fromArray(t.quaternion),void 0!==t.scale&&i.scale.fromArray(t.scale)),void 0!==t.castShadow&&(i.castShadow=t.castShadow),void 0!==t.receiveShadow&&(i.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(i.shadow.bias=t.shadow.bias),void 0!==t.shadow.radius&&(i.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&i.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(i.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(i.visible=t.visible),void 0!==t.userData&&(i.userData=t.userData),void 0!==t.children){r=t.children;for(c=0;c<r.length;c++)i.add(this.parseObject(r[c],n,s))}if("LOD"===t.type)for(t=t.levels,r=0;r<t.length;r++)c=t[r],u=i.getObjectByProperty("uuid",c.object),void 0!==u&&i.addLevel(u,c.distance);return i}}()});var ti={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},Ds={RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},Ts={NearestFilter:1003,NearestMipMapNearestFilter:1004,NearestMipMapLinearFilter:1005,LinearFilter:1006,LinearMipMapNearestFilter:1007,LinearMipMapLinearFilter:1008};Object.assign(m.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){return e=this.getUtoTmapping(e),this.getPoint(e,t)},getPoints:function(e){void 0===e&&(e=5);for(var n=[],t=0;t<=e;t++)n.push(this.getPoint(t/e));return n},getSpacedPoints:function(e){void 0===e&&(e=5);for(var n=[],t=0;t<=e;t++)n.push(this.getPointAt(t/e));return n},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,s,n=[],o=this.getPoint(0),i=0;for(n.push(0),t=1;t<=e;t++)s=this.getPoint(t/e),i+=s.distanceTo(o),n.push(i),o=s;return this.cacheArcLengths=n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var n,o,a,s=this.getLengths(),i=s.length;t=t||e*s[i-1];for(n=0,o=i-1;n<=o;)if(0>(a=s[e=Math.floor(n+(o-n)/2)]-t))n=e+1;else{if(!(0<a)){o=e;break}o=e-1}return s[e=o]===t?e/(i-1):(e+(t-(n=s[e]))/(s[e+1]-n))/(i-1)},getTangent:function(e){var t=e-1e-4;return 0>t&&(t=0),1<(e+=1e-4)&&(e=1),t=this.getPoint(t),this.getPoint(e).clone().sub(t).normalize()},getTangentAt:function(e){return e=this.getUtoTmapping(e),this.getTangent(e)},computeFrenetFrames:function(e,n){var s,u,h,f,a=new t,o=[],i=[],r=[],l=new t,m=new c;for(s=0;s<=e;s++)u=s/e,o[s]=this.getTangentAt(u),o[s].normalize();i[0]=new t,r[0]=new t,s=Number.MAX_VALUE,u=Math.abs(o[0].x),h=Math.abs(o[0].y),f=Math.abs(o[0].z);for(u<=s&&(s=u,a.set(1,0,0)),h<=s&&(s=h,a.set(0,1,0)),f<=s&&a.set(0,0,1),l.crossVectors(o[0],a).normalize(),i[0].crossVectors(o[0],l),r[0].crossVectors(o[0],i[0]),s=1;s<=e;s++)i[s]=i[s-1].clone(),r[s]=r[s-1].clone(),l.crossVectors(o[s-1],o[s]),l.length()>Number.EPSILON&&(l.normalize(),a=Math.acos(d.clamp(o[s-1].dot(o[s]),-1,1)),i[s].applyMatrix4(m.makeRotationAxis(l,a))),r[s].crossVectors(o[s],i[s]);if(!0===n)for(a=Math.acos(d.clamp(i[0].dot(i[e]),-1,1)),a/=e,0<o[0].dot(l.crossVectors(i[0],i[e]))&&(a=-a),s=1;s<=e;s++)i[s].applyMatrix4(m.makeRotationAxis(o[s],a*s)),r[s].crossVectors(o[s],i[s]);return{tangents:o,normals:i,binormals:r}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),I.prototype=Object.create(m.prototype),I.prototype.constructor=I,I.prototype.isLineCurve=!0,I.prototype.getPoint=function(e,t){return t=t||new n,1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t},I.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},I.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},I.prototype.copy=function(e){return m.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},je.prototype=Object.assign(Object.create(m.prototype),{constructor:je,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new I(t,e))},getPoint:function(e){var n=e*this.getLength(),t=this.getCurveLengths();for(e=0;e<t.length;){if(t[e]>=n)return n=t[e]-n,t=(e=this.curves[e]).getLength(),e.getPointAt(0===t?0:1-n/t);e++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],n=0,e=0,s=this.curves.length;e<s;e++)n+=this.curves[e].getLength(),t.push(n);return this.cacheLengths=t},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,s,o,i,n=[],a=0,r=this.curves;a<r.length;a++)for(t=(t=r[a]).getPoints(t&&t.isEllipseCurve?2*e:t&&t.isLineCurve?1:t&&t.isSplineCurve?e*t.points.length:e),s=0;s<t.length;s++)o=t[s],i&&i.equals(o)||(n.push(o),i=o);return this.autoClose&&1<n.length&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(e){m.prototype.copy.call(this,e),this.curves=[];for(var t=0,n=e.curves.length;t<n;t++)this.curves.push(e.curves[t].clone());return this.autoClose=e.autoClose,this}}),W.prototype=Object.create(m.prototype),W.prototype.constructor=W,W.prototype.isEllipseCurve=!0,W.prototype.getPoint=function(e,t){t=t||new n;for(var i,o=2*Math.PI,s=this.aEndAngle-this.aStartAngle,a=Math.abs(s)<Number.EPSILON;0>s;)s+=o;for(;s>o;)s-=o;return s<Number.EPSILON&&(s=a?0:o),!0!==this.aClockwise||a||(s=s===o?-o:s-o),o=this.aStartAngle+e*s,e=this.aX+this.xRadius*Math.cos(o),i=this.aY+this.yRadius*Math.sin(o),0!==this.aRotation&&(o=Math.cos(this.aRotation),s=Math.sin(this.aRotation),e=(a=e-this.aX)*o-(i-=this.aY)*s+this.aX,i=a*s+i*o+this.aY),t.set(e,i)},W.prototype.copy=function(e){return m.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},ie.prototype=Object.create(m.prototype),ie.prototype.constructor=ie,ie.prototype.isSplineCurve=!0,ie.prototype.getPoint=function(e,t){t=t||new n;var o=(o=((s=this.points).length-1)*e)-(e=Math.floor(o)),i=s[0===e?e:e-1],a=s[e],r=s[e>s.length-2?s.length-1:e+1],s=s[e>s.length-3?s.length-1:e+2];return t.set(Xs(o,i.x,a.x,r.x,s.x),Xs(o,i.y,a.y,r.y,s.y)),t},ie.prototype.copy=function(e){m.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++)this.points.push(e.points[t].clone());return this},ee.prototype=Object.create(m.prototype),ee.prototype.constructor=ee,ee.prototype.isCubicBezierCurve=!0,ee.prototype.getPoint=function(e,t){t=t||new n;var s=this.v0,o=this.v1,i=this.v2,a=this.v3;return t.set(be(e,s.x,o.x,i.x,a.x),be(e,s.y,o.y,i.y,a.y)),t},ee.prototype.copy=function(e){return m.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},re.prototype=Object.create(m.prototype),re.prototype.constructor=re,re.prototype.isQuadraticBezierCurve=!0,re.prototype.getPoint=function(e,t){t=t||new n;var s=this.v0,o=this.v1,i=this.v2;return t.set(Oe(e,s.x,o.x,i.x),Oe(e,s.y,o.y,i.y)),t},re.prototype.copy=function(e){return m.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},wn=Object.assign(Object.create(je.prototype),{setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y)},moveTo:function(e,t){this.currentPoint.set(e,t)},lineTo:function(e,t){var s=new I(this.currentPoint.clone(),new n(e,t));this.curves.push(s),this.currentPoint.set(e,t)},quadraticCurveTo:function(e,t,s,o){e=new re(this.currentPoint.clone(),new n(e,t),new n(s,o)),this.curves.push(e),this.currentPoint.set(s,o)},bezierCurveTo:function(e,t,s,o,i,a){e=new ee(this.currentPoint.clone(),new n(e,t),new n(s,o),new n(i,a)),this.curves.push(e),this.currentPoint.set(i,a)},splineThru:function(e){var t=new ie(t=[this.currentPoint.clone()].concat(e));this.curves.push(t),this.currentPoint.copy(e[e.length-1])},arc:function(e,t,n,s,o,i){this.absarc(e+this.currentPoint.x,t+this.currentPoint.y,n,s,o,i)},absarc:function(e,t,n,s,o,i){this.absellipse(e,t,n,n,s,o,i)},ellipse:function(e,t,n,s,o,i,a,r){this.absellipse(e+this.currentPoint.x,t+this.currentPoint.y,n,s,o,i,a,r)},absellipse:function(e,t,n,s,o,i,a,r){e=new W(e,t,n,s,o,i,a,r),0<this.curves.length&&((t=e.getPoint(0)).equals(this.currentPoint)||this.lineTo(t.x,t.y)),this.curves.push(e),e=e.getPoint(1),this.currentPoint.copy(e)},copy:function(e){return je.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this}}),Me.prototype=wn,wn.constructor=Me,me.prototype=Object.assign(Object.create(wn),{constructor:me,getPointsHoles:function(e){for(var n=[],t=0,s=this.holes.length;t<s;t++)n[t]=this.holes[t].getPoints(e);return n},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){Me.prototype.copy.call(this,e),this.holes=[];for(var t=0,n=e.holes.length;t<n;t++)this.holes.push(e.holes[t].clone());return this}}),Object.assign(ws.prototype,{moveTo:function(e,t){this.currentPath=new Me,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t)},lineTo:function(e,t){this.currentPath.lineTo(e,t)},quadraticCurveTo:function(e,t,n,s){this.currentPath.quadraticCurveTo(e,t,n,s)},bezierCurveTo:function(e,t,n,s,o,i){this.currentPath.bezierCurveTo(e,t,n,s,o,i)},splineThru:function(e){this.currentPath.splineThru(e)},toShapes:function(e,t){function m(e){for(var n,o,s=[],t=0,i=e.length;t<i;t++)o=e[t],n=new me,n.curves=o.curves,s.push(n);return s}function p(e,t){for(var l=t.length,r=!1,o=l-1,a=0;a<l;o=a++){var n=t[o],s=t[a],c=s.x-n.x,i=s.y-n.y;if(Math.abs(i)>Number.EPSILON){if(0>i&&(n=t[a],c=-c,s=t[o],i=-i),!(e.y<n.y||e.y>s.y))if(e.y===n.y){if(e.x===n.x)return!0}else{if(0===(o=i*(e.x-n.x)-c*(e.y-n.y)))return!0;0>o||(r=!r)}}else if(e.y===n.y&&(s.x<=e.x&&e.x<=n.x||n.x<=e.x&&e.x<=s.x))return!0}return r}if(s=R.isClockWise,n=this.subPaths,0===n.length)return[];if(!0===t)return m(n);if(t=[],1===n.length)return c=n[0],l=new me,l.curves=c.curves,t.push(l),t;var n,s,a,r,c,u,f,d=!s(n[0].getPoints()),d=e?!d:d,l=[],i=[],h=[],o=0;i[o]=void 0,h[o]=[];for(a=0,f=n.length;a<f;a++)r=(c=n[a]).getPoints(),u=s(r),(u=e?!u:u)?(!d&&i[o]&&o++,i[o]={s:new me,p:r},i[o].s.curves=c.curves,d&&o++,h[o]=[]):h[o].push({h:c,p:r[0]});if(!i[0])return m(n);if(1<i.length){for(a=!1,e=[],s=0,n=i.length;s<n;s++)l[s]=[];for(s=0,n=i.length;s<n;s++)for(c=h[s],u=0;u<c.length;u++){for(d=c[u],o=!0,r=0;r<i.length;r++)p(d.p,i[r].p)&&(s!==r&&e.push({froms:s,tos:r,hole:u}),o?(o=!1,l[r].push(d)):a=!0);o&&l[s].push(d)}0<e.length&&(a||(h=l))}for(a=0,s=i.length;a<s;a++)for(l=i[a].s,t.push(l),n=0,c=(e=h[a]).length;n<c;n++)l.holes.push(e[n].h);return t}}),Object.assign(Kn.prototype,{isFont:!0,generateShapes:function(e,t,n){void 0===t&&(t=100),void 0===n&&(n=4),a=this.data,e=String(e).split("");var a,c,l,d,u,f,p,y,_,w,C=t/a.resolution,k=(a.boundingBox.yMax-a.boundingBox.yMin+a.underlineThickness)*C,O=0,x=0;t=[];for(_=0;_<e.length;_++)if(c=e[_],`
`===c)O=0,x-=k;else{var r,s=C,h=O,m=x;if(c=a.glyphs[c]||a.glyphs["?"]){if(f=new ws,p=[],c.o)for(var i=c._cachedOutline||(c._cachedOutline=c.o.split(" ")),o=0,E=i.length;o<E;)switch(i[o++]){case"m":u=i[o++]*s+h,d=i[o++]*s+m,f.moveTo(u,d);break;case"l":u=i[o++]*s+h,d=i[o++]*s+m,f.lineTo(u,d);break;case"q":var g=i[o++]*s+h,v=i[o++]*s+m,b=i[o++]*s+h,j=i[o++]*s+m;if(f.quadraticCurveTo(b,j,g,v),r=p[p.length-1]){w=r.x,r=r.y;for(l=1;l<=n;l++)y=l/n,Oe(y,w,b,g),Oe(y,r,j,v)}break;case"b":if(g=i[o++]*s+h,v=i[o++]*s+m,b=i[o++]*s+h,j=i[o++]*s+m,u=i[o++]*s+h,d=i[o++]*s+m,f.bezierCurveTo(b,j,u,d,g,v),r=p[p.length-1])for(w=r.x,r=r.y,l=1;l<=n;l++)be(y=l/n,w,b,u,g),be(y,r,j,d,v)}s={offsetX:c.ha*s,path:f}}else s=void 0;O+=s.offsetX,t.push(s.path)}for(n=[],a=0,e=t.length;a<e;a++)Array.prototype.push.apply(n,t[a].toShapes());return n}}),Object.assign(mo.prototype,{load:function(e,t,n,s){var i=this,o=new $(this.manager);o.setPath(this.path),o.load(e,function(e){try{var n=JSON.parse(e)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(e.substring(65,e.length-2))}e=i.parse(n),t&&t(e)},n,s)},parse:function(e){return new Kn(e)},setPath:function(e){return this.path=e,this}}),Cn={getContext:function(){return void 0===xn&&(xn=new(window.AudioContext||window.webkitAudioContext)),xn},setContext:function(e){xn=e}},Object.assign(_s.prototype,{load:function(e,t,n,s){var o=new $(this.manager);o.setResponseType("arraybuffer"),o.load(e,function(e){Cn.getContext().decodeAudioData(e,function(e){t(e)})},n,s)}}),Object.assign(Es.prototype,{update:function(){var e,t,n,s,o,i,a,r,l=new c,u=new c;return function(c){if(a!==this||s!==c.focus||o!==c.fov||e!==c.aspect*this.aspect||t!==c.near||r!==c.far||i!==c.zoom||n!==this.eyeSep){a=this,s=c.focus,o=c.fov,e=c.aspect*this.aspect,t=c.near,r=c.far,i=c.zoom;var h,m,f=c.projectionMatrix.clone(),p=(n=this.eyeSep/2)*t/s,g=t*Math.tan(d.DEG2RAD*o*.5)/i;u.elements[12]=-n,l.elements[12]=n,h=-g*e+p,m=g*e+p,f.elements[0]=2*t/(m-h),f.elements[8]=(m+h)/(m-h),this.cameraL.projectionMatrix.copy(f),h=-g*e-p,m=g*e-p,f.elements[0]=2*t/(m-h),f.elements[8]=(m+h)/(m-h),this.cameraR.projectionMatrix.copy(f)}this.cameraL.matrixWorld.copy(c.matrixWorld).multiply(u),this.cameraR.matrixWorld.copy(c.matrixWorld).multiply(l)}}()}),mn.prototype=Object.create(o.prototype),mn.prototype.constructor=mn,ys.prototype=Object.assign(Object.create(o.prototype),{constructor:ys,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(e){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){this.gain.gain.value=e},updateMatrixWorld:function(){var e=new t,s=new y,i=new t,n=new t;return function(t){o.prototype.updateMatrixWorld.call(this,t),t=this.context.listener;var a=this.up;this.matrixWorld.decompose(e,s,i),n.set(0,0,-1).applyQuaternion(s),t.positionX?(t.positionX.setValueAtTime(e.x,this.context.currentTime),t.positionY.setValueAtTime(e.y,this.context.currentTime),t.positionZ.setValueAtTime(e.z,this.context.currentTime),t.forwardX.setValueAtTime(n.x,this.context.currentTime),t.forwardY.setValueAtTime(n.y,this.context.currentTime),t.forwardZ.setValueAtTime(n.z,this.context.currentTime),t.upX.setValueAtTime(a.x,this.context.currentTime),t.upY.setValueAtTime(a.y,this.context.currentTime),t.upZ.setValueAtTime(a.z,this.context.currentTime)):(t.setPosition(e.x,e.y,e.z),t.setOrientation(n.x,n.y,n.z,a.x,a.y,a.z))}}()}),Je.prototype=Object.assign(Object.create(o.prototype),{constructor:Je,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");else{if(!1!==this.hasPlaybackControl){var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.onended=this.onEnded.bind(this),e.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,e.start(this.startTime,this.offset),this.isPlaying=!0,this.source=e,this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.offset=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.value=e,this}}),js.prototype=Object.assign(Object.create(Je.prototype),{constructor:js,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){this.panner.refDistance=e},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){this.panner.rolloffFactor=e},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){this.panner.distanceModel=e},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){this.panner.maxDistance=e},updateMatrixWorld:function(){var e=new t;return function(t){o.prototype.updateMatrixWorld.call(this,t),e.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(e.x,e.y,e.z)}}()}),Object.assign(bs.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var n=0,e=this.getFrequencyData(),t=0;t<e.length;t++)n+=e[t];return n/e.length}}),Object.assign(vs.prototype,{accumulate:function(e,t){var n,o=this.buffer,s=this.valueSize;if(e=e*s+s,n=this.cumulativeWeight,0===n){for(n=0;n!==s;++n)o[e+n]=o[n];n=t}else n+=t,this._mixBufferRegion(o,e,0,t/n,s);this.cumulativeWeight=n},apply:function(e){var n,o,i,t=this.valueSize,s=this.buffer;e=e*t+t,n=this.cumulativeWeight,o=this.binding,this.cumulativeWeight=0,1>n&&this._mixBufferRegion(s,e,3*t,1-n,t),n=t;for(i=t+t;n!==i;++n)if(s[n]!==s[n+t]){o.setValue(s,e);break}},saveOriginalState:function(){var e,t=this.buffer,n=this.valueSize,s=3*n;this.binding.getValue(t,s);for(e=n;e!==s;++e)t[e]=t[s+e%n];this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_select:function(e,t,n,s,o){if(.5<=s)for(s=0;s!==o;++s)e[t+s]=e[n+s]},_slerp:function(e,t,n,s){y.slerpFlat(e,t,e,t,e,n,s)},_lerp:function(e,t,n,s,o){for(var a,r=1-s,i=0;i!==o;++i)a=t+i,e[a]=e[a]*r+e[n+i]*s}}),Object.assign(zs.prototype,{getValue:function(e,t){this.bind();var n=this._bindings[this._targetGroup.nCachedObjects_];void 0!==n&&n.getValue(e,t)},setValue:function(e,t){for(var s=this._bindings,n=this._targetGroup.nCachedObjects_,o=s.length;n!==o;++n)s[n].setValue(e,t)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}),Object.assign(O,{Composite:zs,create:function(e,t,n){return e&&e.isAnimationObjectGroup?new O.Composite(e,t,n):new O(e,t,n)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(/[^\w-]/g,"")},parseTrackName:function(){var e=new RegExp("^"+/((?:[\w-]+[/:])*)/.source+/([\w-.]+)?/.source+/(?:\.([\w-]+)(?:\[(.+)\])?)?/.source+/\.([\w-]+)(?:\[(.+)\])?/.source+"$"),t=["material","materials","bones"];return function(n){if(!(s=e.exec(n)))throw Error("PropertyBinding: Cannot parse trackName: "+n);var s,i,o=(s={nodeName:s[2],objectName:s[3],objectIndex:s[4],propertyName:s[5],propertyIndex:s[6]}).nodeName&&s.nodeName.lastIndexOf(".");if(void 0!==o&&-1!==o&&(i=s.nodeName.substring(o+1),-1!==t.indexOf(i)&&(s.nodeName=s.nodeName.substring(0,o),s.objectName=i)),null===s.propertyName||0===s.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+n);return s}}(),findNode:function(e,t){if(!t||""===t||"root"===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var n,s=function(e){for(var s,n=0;n<e.bones.length;n++)if(s=e.bones[n],s.name===t)return s;return null}(e.skeleton);if(s)return s}return e.children&&(n=function(e){for(var s,o=0;o<e.length;o++)if(s=e[o],s.name===t||s.uuid===t||(s=n(s.children)))return s;return null},e=n(e.children))?e:null}}),Object.assign(O.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var s=this.resolvedProperty,n=0,o=s.length;n!==o;++n)e[t++]=s[n]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var s=this.resolvedProperty,n=0,o=s.length;n!==o;++n)s[n]=e[t++]},function(e,t){for(var s=this.resolvedProperty,n=0,o=s.length;n!==o;++n)s[n]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var s=this.resolvedProperty,n=0,o=s.length;n!==o;++n)s[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var n,e=this.node,s=this.parsedPath,t=s.objectName,i=s.propertyName,o=s.propertyIndex;if(e||(this.node=e=O.findNode(this.rootNode,s.nodeName)||this.rootNode),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(t){switch(n=s.objectIndex,t){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);for(e=e.skeleton.bones,t=0;t<e.length;t++)if(e[t].name===n){n=t;break}break;default:if(void 0===e[t])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[t]}if(void 0!==n){if(void 0===e[n])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[n]}}if(void 0===(n=e[i]))console.error("THREE.PropertyBinding: Trying to update property for track: "+s.nodeName+"."+i+" but it wasn't found.",e);else{if(s=this.Versioning.None,void 0!==e.needsUpdate?(s=this.Versioning.NeedsUpdate,this.targetObject=e):void 0!==e.matrixWorldNeedsUpdate&&(s=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=e),t=this.BindingType.Direct,void 0!==o){if("morphTargetInfluences"===i){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){{if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(t=0;t<this.node.geometry.morphAttributes.position.length;t++)if(e.geometry.morphAttributes.position[t].name===o){o=t;break}}}else{if(!e.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(t=0;t<this.node.geometry.morphTargets.length;t++)if(e.geometry.morphTargets[t].name===o){o=t;break}}}t=this.BindingType.ArrayElement,this.resolvedProperty=n,this.propertyIndex=o}else void 0!==n.fromArray&&void 0!==n.toArray?(t=this.BindingType.HasFromToArray,this.resolvedProperty=n):Array.isArray(n)?(t=this.BindingType.EntireArray,this.resolvedProperty=n):this.propertyName=i;this.getValue=this.GetterByBindingType[t],this.setValue=this.SetterByBindingTypeAndVersioning[t][s]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(O.prototype,{_getValue_unbound:O.prototype.getValue,_setValue_unbound:O.prototype.setValue}),Object.assign(Ns.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e,t,n,s,o,a,r,i=this._objects,g=i.length,u=this.nCachedObjects_,c=this._indicesByUUID,f=this._paths,m=this._parsedPaths,d=this._bindings,h=d.length,l=0,p=arguments.length;l!==p;++l)if(n=arguments[l],t=c[e=n.uuid],void 0===t){t=g++,c[e]=t,i.push(n);for(e=0,o=h;e!==o;++e)d[e].push(new O(n,f[e],m[e]))}else if(t<u){s=--u;for(c[(o=i[s]).uuid]=t,i[t]=o,c[e]=s,i[s]=n,e=0,o=h;e!==o;++e)a=d[e],r=a[t],a[t]=a[s],void 0===r&&(r=new O(n,f[e],m[e])),a[s]=r}else void 0!==i[t]&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.");this.nCachedObjects_=u},remove:function(){for(var t,n,d,r=this._objects,i=this.nCachedObjects_,a=this._indicesByUUID,l=this._bindings,h=l.length,c=0,u=arguments.length;c!==u;++c){var s=arguments[c],o=s.uuid,e=a[o];if(void 0!==e&&e>=i){n=i++;for(a[(t=r[n]).uuid]=e,r[e]=t,a[o]=n,r[n]=s,s=0,o=h;s!==o;++s)d=(t=l[s])[e],t[e]=t[n],t[n]=d}}this.nCachedObjects_=i},uncache:function(){for(var e,t,s,o,i,r,m,n=this._objects,u=n.length,c=this.nCachedObjects_,a=this._indicesByUUID,l=this._bindings,h=l.length,d=0,f=arguments.length;d!==f;++d)if(s=a[i=arguments[d].uuid],void 0!==s)if(delete a[i],s<c){o=--c,t=n[o],e=n[i=--u],a[t.uuid]=s,n[s]=t,a[e.uuid]=o,n[o]=e,n.pop(),t=0;for(r=h;t!==r;++t)m=(e=l[t])[i],e[s]=e[o],e[o]=m,e.pop()}else for(a[(e=n[i=--u]).uuid]=s,n[s]=e,n.pop(),t=0,r=h;t!==r;++t)(e=l[t])[s]=e[i],e.pop();this.nCachedObjects_=c},subscribe_:function(e,t){var n=this._bindingsIndicesByPath,s=n[e],o=this._bindings;if(void 0!==s)return o[s];var r=this._paths,c=this._parsedPaths,i=this._objects,l=this.nCachedObjects_,a=Array(i.length),s=o.length;for(n[e]=s,r.push(e),c.push(t),o.push(a),n=l,s=i.length;n!==s;++n)a[n]=new O(i[n],e,t);return a},unsubscribe_:function(e){if(o=this._bindingsIndicesByPath,t=o[e],void 0!==t){var t,o,i=this._paths,a=this._parsedPaths,n=this._bindings,s=n.length-1,r=n[s];o[e[s]]=t,n[t]=r,n.pop(),a[t]=a[s],a.pop(),i[t]=i[s],i.pop()}}}),Object.assign(Ls.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){n=this._clip.duration;var s=e._clip.duration,o=n/s;e.warp(1,s/n,t),this.warp(o,1,t)}return this},crossFadeTo:function(e,t,n){return e.crossFadeFrom(this,t,n)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,n){var o=this._mixer,i=o.time,s=this._timeScaleInterpolant,a=this.timeScale;return null===s&&(this._timeScaleInterpolant=s=o._lendControlInterpolant()),o=s.parameterPositions,s=s.sampleValues,o[0]=i,o[1]=i+n,s[0]=e/a,s[1]=t/a,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,n,s){if(this.enabled){{if(null!==(i=this._startTime)){if(0>(t=(e-i)*n)||0===n)return;this._startTime=null,t*=n}if(t*=this._updateTimeScale(e),n=this._updateTime(t),0<(e=this._updateWeight(e))){t=this._interpolants;for(var i=this._propertyBindings,o=0,a=t.length;o!==a;++o)t[o].evaluate(n),i[o].accumulate(s,e)}}}else this._updateWeight(e)},_updateWeight:function(e){var n,s,t=0;return this.enabled&&(t=this.weight,n=this._weightInterpolant,null!==n&&(s=n.evaluate(e)[0],t=t*s,e>n.parameterPositions[1]&&(this.stopFading(),0===s&&(this.enabled=!1)))),this._effectiveWeight=t},_updateTimeScale:function(e){var n,t=0;return this.paused||(t=this.timeScale,n=this._timeScaleInterpolant,null!==n&&(t=t*n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))),this._effectiveTimeScale=t},_updateTime:function(e){if(t=this.time+e,0===e)return t;var t,i,a,o=this._clip.duration,n=this.loop,s=this._loopCount;if(2200===n)t:{if(-1===s&&(this._loopCount=0,this._setEndings(!0,!0,!1)),t>=o)t=o;else{if(!(0>t))break t;t=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:0>e?-1:1})}else if((n=2202===n,-1===s&&(0<=e?(s=0,this._setEndings(!0,0===this.repetitions,n)):this._setEndings(0===this.repetitions,!0,n)),t>=o||0>t)&&(i=Math.floor(t/o),a=(t=t-o*i,s=s+Math.abs(i),this.repetitions-s),0>a?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=0<e?o:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<e?1:-1})):(0===a?(e=0>e,this._setEndings(e,!e,n)):this._setEndings(!1,!1,n),this._loopCount=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:i}))),n&&1==(1&s))return this.time=t,o-t;return this.time=t},_setEndings:function(e,t,n){var s=this._interpolantSettings;n?(s.endingStart=2401,s.endingEnd=2401):(s.endingStart=e?this.zeroSlopeAtStart?2401:2400:2402,s.endingEnd=t?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(e,t,n){var o=this._mixer,i=o.time,s=this._weightInterpolant;return null===s&&(this._weightInterpolant=s=o._lendControlInterpolant()),o=s.parameterPositions,s=s.sampleValues,o[0]=i,s[0]=t,o[1]=i+e,s[1]=n,this}}),Object.assign(Rs.prototype,G.prototype,{_bindAction:function(e,t){var c=e._localRoot||this._root,l=e._clip.tracks,u=l.length,d=e._propertyBindings;e=e._interpolants;var o=c.uuid,n=this._bindingsByRootAndName,i=n[o];for(void 0===i&&(i={},n[o]=i),n=0;n!==u;++n){var r=l[n],a=r.name,s=i[a];if(void 0===s){if(void 0!==(s=d[n])){null===s._cacheIndex&&(++s.referenceCount,this._addInactiveBinding(s,o,a));continue}++(s=new vs(O.create(c,a,t&&t._propertyBindings[n].binding.parsedPath),r.ValueTypeName,r.getValueSize())).referenceCount,this._addInactiveBinding(s,o,a)}d[n]=s,e[n].resultBuffer=s.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var s,o=(e._localRoot||this._root).uuid,t=e._clip.uuid,n=this._actionsByClip[t];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,t,o)}for(t=0,n=(o=e._propertyBindings).length;t!==n;++t)s=o[t],0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState());this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t,s=e._propertyBindings,n=0,o=s.length;n!==o;++n)t=s[n],0==--t.useCount&&(t.restoreOriginalState(),this._takeBackBinding(t));this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){return null!==(e=e._cacheIndex)&&e<this._nActiveActions},_addInactiveAction:function(e,t,n){var o=this._actions,i=this._actionsByClip,s=i[t];void 0===s?(s={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=s):(t=s.knownActions,e._byClipCacheIndex=t.length,t.push(e)),e._cacheIndex=o.length,o.push(e),s.actionByRoot[n]=e},_removeInactiveAction:function(e){n=(t=this._actions)[t.length-1],s=e._cacheIndex,n._cacheIndex=s,t[s]=n,t.pop(),e._cacheIndex=null;var n,s,t=e._clip.uuid,o=(s=(n=this._actionsByClip)[t]).knownActions,i=o[o.length-1],a=e._byClipCacheIndex;i._byClipCacheIndex=a,o[a]=i,o.pop(),e._byClipCacheIndex=null,delete s.actionByRoot[(e._localRoot||this._root).uuid],0===o.length&&delete n[t],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var n,t=0,s=(e=e._propertyBindings).length;t!==s;++t)n=e[t],0==--n.referenceCount&&this._removeInactiveBinding(n)},_lendAction:function(e){var t=this._actions,s=e._cacheIndex,n=this._nActiveActions++,o=t[n];e._cacheIndex=n,t[n]=e,o._cacheIndex=s,t[s]=o},_takeBackAction:function(e){var t=this._actions,s=e._cacheIndex,n=--this._nActiveActions,o=t[n];e._cacheIndex=n,t[n]=e,o._cacheIndex=s,t[s]=o},_addInactiveBinding:function(e,t,n){var o=this._bindingsByRootAndName,s=o[t],i=this._bindings;void 0===s&&(s={},o[t]=s),s[n]=e,e._cacheIndex=i.length,i.push(e)},_removeInactiveBinding:function(e){var r,t=this._bindings,s=(n=e.binding).rootNode.uuid,n=n.path,o=this._bindingsByRootAndName,i=o[s],a=t[t.length-1];e=e._cacheIndex,a._cacheIndex=e,t[e]=a,t.pop(),delete i[n];t:{for(r in i)break t;delete o[s]}},_lendBinding:function(e){var t=this._bindings,s=e._cacheIndex,n=this._nActiveBindings++,o=t[n];e._cacheIndex=n,t[n]=e,o._cacheIndex=s,t[s]=o},_takeBackBinding:function(e){var t=this._bindings,s=e._cacheIndex,n=--this._nActiveBindings,o=t[n];e._cacheIndex=n,t[n]=e,o._cacheIndex=s,t[s]=o},_lendControlInterpolant:function(){var n=this._controlInterpolants,t=this._nActiveControlInterpolants++,e=n[t];return void 0===e&&((e=new Et(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,n[t]=e),e},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,s=e.__cacheIndex,n=--this._nActiveControlInterpolants,o=t[n];e.__cacheIndex=n,t[n]=e,o.__cacheIndex=s,t[s]=o},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){o=(n=t||this._root).uuid,e=null!==(n="string"==typeof e?N.findByName(n,e):e)?n.uuid:e;var n,o,i=this._actionsByClip[e],s=null;if(void 0!==i){if(void 0!==(s=i.actionByRoot[o]))return s;s=i.knownActions[0],null===n&&(n=s._clip)}return null===n?null:(t=new Ls(this,n,t),this._bindAction(t,s),this._addInactiveAction(t,e,o),t)},existingAction:function(e,t){var n=t||this._root;return t=n.uuid,n="string"==typeof e?N.findByName(n,e):e,void 0!==(e=this._actionsByClip[n?n.uuid:e])&&e.actionByRoot[t]||null},stopAllAction:function(){for(var t=this._actions,n=this._nActiveActions,s=this._bindings,o=this._nActiveBindings,e=this._nActiveBindings=this._nActiveActions=0;e!==n;++e)t[e].reset();for(e=0;e!==o;++e)s[e].useCount=0;return this},update:function(e){e*=this.timeScale;for(var n=this._actions,o=this._nActiveActions,i=this.time+=e,a=Math.sign(e),s=this._accuIndex^=1,t=0;t!==o;++t)n[t]._update(i,e,a,s);for(e=this._bindings,n=this._nActiveBindings,t=0;t!==n;++t)e[t].apply(s);return this},getRoot:function(){return this._root},uncacheClip:function(e){if(n=this._actions,e=e.uuid,o=this._actionsByClip,void 0!==(s=o[e])){for(var t,n,s,o,a,r,i=0,c=(s=s.knownActions).length;i!==c;++i)t=s[i],this._deactivateAction(t),a=t._cacheIndex,r=n[n.length-1],t._cacheIndex=null,t._byClipCacheIndex=null,r._cacheIndex=a,n[a]=r,n.pop(),this._removeInactiveBindingsForAction(t);delete o[e]}},uncacheRoot:function(e){e=e.uuid;var t,n,o,s=this._actionsByClip;for(t in s)n=s[t].actionByRoot[e],void 0!==n&&(this._deactivateAction(n),this._removeInactiveAction(n));if(t=this._bindingsByRootAndName[e],void 0!==t)for(o in t)(e=t[o]).restoreOriginalState(),this._removeInactiveBinding(e)},uncacheAction:function(e,t){null!==(e=this.existingAction(e,t))&&(this._deactivateAction(e),this._removeInactiveAction(e))}}),fn.prototype.clone=function(){return new fn(void 0===this.value.clone?this.value:this.value.clone())},gs.prototype=Object.assign(Object.create(i.prototype),{constructor:gs,isInstancedBufferGeometry:!0,copy:function(e){return i.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)}}),Object.defineProperties(ps.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(ps.prototype,{isInterleavedBufferAttribute:!0,setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this},setXYZ:function(e,t,n,s){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=s,this},setXYZW:function(e,t,n,s,o){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=s,this.data.array[e+3]=o,this}}),Object.defineProperty(tt.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(tt.prototype,{isInterleavedBuffer:!0,setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==e?e.length/this.stride:0,this.array=e},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.dynamic=e.dynamic,this},copyAt:function(e,t,n){e*=this.stride,n*=t.stride;for(var s=0,o=this.stride;s<o;s++)this.array[e+s]=t.array[n+s];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}}),fs.prototype=Object.assign(Object.create(tt.prototype),{constructor:fs,isInstancedInterleavedBuffer:!0,copy:function(e){return tt.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),hs.prototype=Object.assign(Object.create(u.prototype),{constructor:hs,isInstancedBufferAttribute:!0,copy:function(e){return u.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.assign(Ws.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize()):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t){var n=[];return us(e,this,n,t),n.sort(Us),n},intersectObjects:function(e,t){if(n=[],!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),n;for(var n,s=0,o=e.length;s<o;s++)us(e[s],this,n,t);return n.sort(Us),n}}),Object.assign(qs.prototype,{start:function(){this.oldTime=this.startTime=("undefined"==typeof performance?Date:performance).now(),this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.autoStart=this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t,e=0;return this.autoStart&&!this.running?(this.start(),0):(this.running&&(t=("undefined"==typeof performance?Date:performance).now(),e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e),e)}}),Object.assign(Ys.prototype,{set:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.radius=e.length(),0===this.radius?this.phi=this.theta=0:(this.theta=Math.atan2(e.x,e.z),this.phi=Math.acos(d.clamp(e.y/this.radius,-1,1))),this}}),Object.assign(Gs.prototype,{set:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.radius=Math.sqrt(e.x*e.x+e.z*e.z),this.theta=Math.atan2(e.x,e.z),this.y=e.y,this}}),un.prototype=Object.create(o.prototype),un.prototype.constructor=un,un.prototype.isImmediateRenderObject=!0,dn.prototype=Object.create(v.prototype),dn.prototype.constructor=dn,dn.prototype.update=function(){var e=new t,n=new t,s=new A;return function(){if(i=["a","b","c"],this.object.updateMatrixWorld(!0),s.getNormalMatrix(this.object.matrixWorld),c=this.object.matrixWorld,a=this.geometry.attributes.position,(t=this.object.geometry)&&t.isGeometry)for(var t,i,a,c,m,r=t.vertices,h=t.faces,l=t=0,f=h.length;l<f;l++)for(var d=h[l],o=0,u=d.vertexNormals.length;o<u;o++)m=d.vertexNormals[o],e.copy(r[d[i[o]]]).applyMatrix4(c),n.copy(m).applyMatrix3(s).normalize().multiplyScalar(this.size).add(e),a.setXYZ(t,e.x,e.y,e.z),t+=1,a.setXYZ(t,n.x,n.y,n.z),t+=1;else if(t&&t.isBufferGeometry)for(i=t.attributes.position,r=t.attributes.normal,o=t=0,u=i.count;o<u;o++)e.set(i.getX(o),i.getY(o),i.getZ(o)).applyMatrix4(c),n.set(r.getX(o),r.getY(o),r.getZ(o)),n.applyMatrix3(s).normalize().multiplyScalar(this.size).add(e),a.setXYZ(t,e.x,e.y,e.z),t+=1,a.setXYZ(t,n.x,n.y,n.z),t+=1;a.needsUpdate=!0}}(),nt.prototype=Object.create(o.prototype),nt.prototype.constructor=nt,nt.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},nt.prototype.update=function(){var e=new t,n=new t;return function(){this.light.updateMatrixWorld();var t=this.light.distance?this.light.distance:1e3,s=t*Math.tan(this.light.angle);this.cone.scale.set(s,s,t),e.setFromMatrixPosition(this.light.matrixWorld),n.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(n.sub(e)),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}(),at.prototype=Object.create(v.prototype),at.prototype.constructor=at,at.prototype.updateMatrixWorld=function(){var e=new t,n=new c,s=new c;return function(t){var i,a,r,c=this.bones,l=this.geometry,d=l.getAttribute("position");s.getInverse(this.root.matrixWorld);for(a=0,r=0;a<c.length;a++)i=c[a],i.parent&&i.parent.isBone&&(n.multiplyMatrices(s,i.matrixWorld),e.setFromMatrixPosition(n),d.setXYZ(r,e.x,e.y,e.z),n.multiplyMatrices(s,i.parent.matrixWorld),e.setFromMatrixPosition(n),d.setXYZ(r+1,e.x,e.y,e.z),r+=2);l.getAttribute("position").needsUpdate=!0,o.prototype.updateMatrixWorld.call(this,t)}}(),lt.prototype=Object.create(x.prototype),lt.prototype.constructor=lt,lt.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},lt.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},Pe.prototype=Object.create(o.prototype),Pe.prototype.constructor=Pe,Pe.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Pe.prototype.update=function(){var t=.5*this.light.width,n=.5*this.light.height,s=this.line.geometry.attributes.position,e=s.array;e[0]=t,e[1]=-n,e[2]=0,e[3]=t,e[4]=n,e[5]=0,e[6]=-t,e[7]=n,e[8]=0,e[9]=-t,e[10]=-n,e[11]=0,e[12]=t,e[13]=-n,e[14]=0,s.needsUpdate=!0,void 0!==this.color?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)},ut.prototype=Object.create(o.prototype),ut.prototype.constructor=ut,ut.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},ut.prototype.update=function(){var s=new t,e=new a,n=new a;return function(){if(a=this.children[0],void 0!==this.color)this.material.color.set(this.color);else{t=a.geometry.getAttribute("color"),e.copy(this.light.color),n.copy(this.light.groundColor);for(var t,i,a,o=0,r=t.count;o<r;o++)i=o<r/2?e:n,t.setXYZ(o,i.r,i.g,i.b);t.needsUpdate=!0}a.lookAt(s.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),ln.prototype=Object.create(v.prototype),ln.prototype.constructor=ln,gn.prototype=Object.create(v.prototype),gn.prototype.constructor=gn,on.prototype=Object.create(v.prototype),on.prototype.constructor=on,on.prototype.update=function(){var e=new t,n=new t,s=new A;return function(){this.object.updateMatrixWorld(!0),s.getNormalMatrix(this.object.matrixWorld);for(var t,o,l,d=this.object.matrixWorld,a=this.geometry.attributes.position,r=(o=this.object.geometry).vertices,i=0,c=0,u=(o=o.faces).length;c<u;c++)t=o[c],l=t.normal,e.copy(r[t.a]).add(r[t.b]).add(r[t.c]).divideScalar(3).applyMatrix4(d),n.copy(l).applyMatrix3(s).normalize().multiplyScalar(this.size).add(e),a.setXYZ(i,e.x,e.y,e.z),i+=1,a.setXYZ(i,n.x,n.y,n.z),i+=1;a.needsUpdate=!0}}(),vt.prototype=Object.create(o.prototype),vt.prototype.constructor=vt,vt.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},vt.prototype.update=function(){var n=new t,s=new t,e=new t;return function(){n.setFromMatrixPosition(this.light.matrixWorld),s.setFromMatrixPosition(this.light.target.matrixWorld),e.subVectors(s,n),this.lightPlane.lookAt(e),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(e),this.targetLine.scale.z=e.length()}}(),sn.prototype=Object.create(v.prototype),sn.prototype.constructor=sn,sn.prototype.update=function(){function e(e,t,a,r){if(n.set(t,a,r).unproject(i),void 0!==(e=o[e]))for(t=s.getAttribute("position"),a=0,r=e.length;a<r;a++)t.setXYZ(e[a],n.x,n.y,n.z)}var s,o,n=new t,i=new K;return function(){s=this.geometry,o=this.pointMap,i.projectionMatrix.copy(this.camera.projectionMatrix),e("c",0,0,-1),e("t",0,0,1),e("n1",-1,-1,-1),e("n2",1,-1,-1),e("n3",-1,1,-1),e("n4",1,1,-1),e("f1",-1,-1,1),e("f2",1,-1,1),e("f3",-1,1,1),e("f4",1,1,1),e("u1",.7,1.1,-1),e("u2",-.7,1.1,-1),e("u3",0,2,-1),e("cf1",-1,0,1),e("cf2",1,0,1),e("cf3",0,-1,1),e("cf4",0,1,1),e("cn1",-1,0,-1),e("cn2",1,0,-1),e("cn3",0,-1,-1),e("cn4",0,1,-1),s.getAttribute("position").needsUpdate=!0}}(),xe.prototype=Object.create(v.prototype),xe.prototype.constructor=xe,xe.prototype.update=function(){var e=new X;return function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&e.setFromObject(this.object),!e.isEmpty()){t=e.min;var s=e.max,o=this.geometry.attributes.position,n=o.array;n[0]=s.x,n[1]=s.y,n[2]=s.z,n[3]=t.x,n[4]=s.y,n[5]=s.z,n[6]=t.x,n[7]=t.y,n[8]=s.z,n[9]=s.x,n[10]=t.y,n[11]=s.z,n[12]=s.x,n[13]=s.y,n[14]=t.z,n[15]=t.x,n[16]=s.y,n[17]=t.z,n[18]=t.x,n[19]=t.y,n[20]=t.z,n[21]=s.x,n[22]=t.y,n[23]=t.z,o.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),xe.prototype.setFromObject=function(e){return this.object=e,this.update(),this},tn.prototype=Object.create(v.prototype),tn.prototype.constructor=tn,tn.prototype.updateMatrixWorld=function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),o.prototype.updateMatrixWorld.call(this,e))},Jt.prototype=Object.create(C.prototype),Jt.prototype.constructor=Jt,Jt.prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;1e-8>Math.abs(t)&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.lookAt(this.plane.normal),o.prototype.updateMatrixWorld.call(this,e)},Ee.prototype=Object.create(o.prototype),Ee.prototype.constructor=Ee,Ee.prototype.setDirection=function(){var e,n=new t;return function(t){.99999<t.y?this.quaternion.set(0,0,0,1):-.99999>t.y?this.quaternion.set(1,0,0,0):(n.set(t.z,0,-t.x).normalize(),e=Math.acos(t.y),this.quaternion.setFromAxisAngle(n,e))}}(),Ee.prototype.setLength=function(e,t,n){void 0===t&&(t=.2*e),void 0===n&&(n=.2*t),this.line.scale.set(1,Math.max(0,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()},Ee.prototype.setColor=function(e){this.line.material.color.copy(e),this.cone.material.color.copy(e)},Zt.prototype=Object.create(v.prototype),Zt.prototype.constructor=Zt;var Mn=new t,Zn=new Un,Gn=new Un,qn=new Un;M.prototype=Object.create(m.prototype),M.prototype.constructor=M,M.prototype.isCatmullRomCurve3=!0,M.prototype.getPoint=function(e,n){n=n||new t,s=this.points,e*=(i=s.length)-(this.closed?0:1),e-=o=Math.floor(e),this.closed?o+=0<o?0:(Math.floor(Math.abs(o)/s.length)+1)*s.length:0===e&&o===i-1&&(o=i-2,e=1),this.closed||0<o?(a=s[(o-1)%i]):(Mn.subVectors(s[0],s[1]).add(s[0]),a=Mn);var s,o,i,a,r,c=s[o%i],l=s[(o+1)%i];return this.closed||o+2<i?s=s[(o+2)%i]:(Mn.subVectors(s[i-1],s[i-2]).add(s[i-1]),s=Mn),"centripetal"===this.curveType||"chordal"===this.curveType?(r="chordal"===this.curveType?.5:.25,i=Math.pow(a.distanceToSquared(c),r),1e-4>(o=Math.pow(c.distanceToSquared(l),r))&&(o=1),1e-4>i&&(i=o),1e-4>(r=Math.pow(l.distanceToSquared(s),r))&&(r=o),Zn.initNonuniformCatmullRom(a.x,c.x,l.x,s.x,i,o,r),Gn.initNonuniformCatmullRom(a.y,c.y,l.y,s.y,i,o,r),qn.initNonuniformCatmullRom(a.z,c.z,l.z,s.z,i,o,r)):"catmullrom"===this.curveType&&(Zn.initCatmullRom(a.x,c.x,l.x,s.x,this.tension),Gn.initCatmullRom(a.y,c.y,l.y,s.y,this.tension),qn.initCatmullRom(a.z,c.z,l.z,s.z,this.tension)),n.set(Zn.calc(e),Gn.calc(e),qn.calc(e)),n},M.prototype.copy=function(e){m.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++)this.points.push(e.points[t].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},ke.prototype=Object.create(m.prototype),ke.prototype.constructor=ke,ke.prototype.isCubicBezierCurve3=!0,ke.prototype.getPoint=function(e,n){n=n||new t;var s=this.v0,o=this.v1,i=this.v2,a=this.v3;return n.set(be(e,s.x,o.x,i.x,a.x),be(e,s.y,o.y,i.y,a.y),be(e,s.z,o.z,i.z,a.z)),n},ke.prototype.copy=function(e){return m.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Se.prototype=Object.create(m.prototype),Se.prototype.constructor=Se,Se.prototype.isQuadraticBezierCurve3=!0,Se.prototype.getPoint=function(e,n){n=n||new t;var s=this.v0,o=this.v1,i=this.v2;return n.set(Oe(e,s.x,o.x,i.x),Oe(e,s.y,o.y,i.y),Oe(e,s.z,o.z,i.z)),n},Se.prototype.copy=function(e){return m.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},ce.prototype=Object.create(m.prototype),ce.prototype.constructor=ce,ce.prototype.isLineCurve3=!0,ce.prototype.getPoint=function(e,n){return n=n||new t,1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},ce.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},ce.prototype.copy=function(e){return m.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Gt.prototype=Object.create(W.prototype),Gt.prototype.constructor=Gt,Gt.prototype.isArcCurve=!0,m.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(m.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Object.assign(je.prototype,{createPointsGeometry:function(e){return console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),e=this.getPoints(e),this.createGeometry(e)},createSpacedPointsGeometry:function(e){return console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),e=this.getSpacedPoints(e),this.createGeometry(e)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var n,o=new l,s=0,i=e.length;s<i;s++)n=e[s],o.vertices.push(new t(n.x,n.y,n.z||0));return o}}),Object.assign(Me.prototype,{fromPoints:function(e){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),ho.prototype=Object.create(M.prototype),uo.prototype=Object.create(M.prototype),rs.prototype=Object.create(M.prototype),Object.assign(rs.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),ln.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},at.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(vn.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(X.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),He.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(d,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),d.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),d.ceilPowerOfTwo(e)}}),Object.assign(A.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(c.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){var e;return function(){return void 0===e&&(e=new t),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),e.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,n,s,o,i){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,s,n,o,i)}}),L.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},y.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(Ae.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(me.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new te(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Ge(this,e)}}),Object.assign(n.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(t.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(g.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),l.prototype.computeTangents=function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},Object.assign(o.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)}}),Object.defineProperties(o.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(kt.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Ct.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(m.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),_.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(j.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(u.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}}}),Object.assign(i.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addDrawCall:function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(i.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(fn.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(h.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new a}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===e}}}),Object.defineProperties(B.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(D.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(ts.prototype,{getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}}),Object.defineProperties(ts.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),this.shadowMap.cullFace=e}}}),Object.defineProperties(Is.prototype,{cullFace:{get:function(){return this.renderReverseSided?2:1},set:function(e){e=1!==e,console.warn("WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to "+e+"."),this.renderReverseSided=e}}}),Object.defineProperties(_t.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Je.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new _s).load(e,function(e){t.setBuffer(e)}),this},bs.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},mn.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)},e.WebGLRenderTargetCube=yt,e.WebGLRenderTarget=_t,e.WebGLRenderer=ts,e.ShaderLib=Fe,e.UniformsLib=r,e.UniformsUtils=E,e.ShaderChunk=f,e.FogExp2=mt,e.Fog=ft,e.Scene=Sn,e.LensFlare=Jn,e.Sprite=At,e.LOD=kt,e.SkinnedMesh=bn,e.Skeleton=Ct,e.Bone=Wn,e.Mesh=x,e.LineSegments=v,e.LineLoop=Ln,e.Line=C,e.Points=bt,e.Group=St,e.VideoTexture=Fn,e.DataTexture=De,e.CompressedTexture=gt,e.CubeTexture=ae,e.CanvasTexture=Qt,e.DepthTexture=Tt,e.Texture=b,e.CompressedTextureLoader=Ss,e.DataTextureLoader=Qn,e.CubeTextureLoader=Xn,e.TextureLoader=zn,e.ObjectLoader=ao,e.MaterialLoader=On,e.BufferGeometryLoader=is,e.DefaultLoadingManager=z,e.LoadingManager=es,e.JSONLoader=cs,e.ImageLoader=Mt,e.FontLoader=mo,e.FileLoader=$,e.Loader=Ke,e.Cache=Bt,e.AudioLoader=_s,e.SpotLightShadow=Rn,e.SpotLight=Pn,e.PointLight=Hn,e.RectAreaLight=$n,e.HemisphereLight=Nn,e.DirectionalLightShadow=In,e.DirectionalLight=Bn,e.AmbientLight=Vn,e.LightShadow=Te,e.Light=j,e.StereoCamera=Es,e.PerspectiveCamera=_,e.OrthographicCamera=Ze,e.CubeCamera=mn,e.ArrayCamera=yn,e.Camera=K,e.AudioListener=ys,e.PositionalAudio=js,e.AudioContext=Cn,e.AudioAnalyser=bs,e.Audio=Je,e.VectorKeyframeTrack=Be,e.StringKeyframeTrack=An,e.QuaternionKeyframeTrack=Ft,e.NumberKeyframeTrack=Ue,e.ColorKeyframeTrack=En,e.BooleanKeyframeTrack=kn,e.PropertyMixer=vs,e.PropertyBinding=O,e.KeyframeTrack=pe,e.AnimationUtils=w,e.AnimationObjectGroup=Ns,e.AnimationMixer=Rs,e.AnimationClip=N,e.Uniform=fn,e.InstancedBufferGeometry=gs,e.BufferGeometry=i,e.Geometry=l,e.InterleavedBufferAttribute=ps,e.InstancedInterleavedBuffer=fs,e.InterleavedBuffer=tt,e.InstancedBufferAttribute=hs,e.Face3=Q,e.Object3D=o,e.Raycaster=Ws,e.Layers=ms,e.EventDispatcher=G,e.Clock=qs,e.QuaternionLinearInterpolant=Tn,e.LinearInterpolant=Et,e.DiscreteInterpolant=Dn,e.CubicInterpolant=pn,e.Interpolant=T,e.Triangle=Z,e.Math=d,e.Spherical=Ys,e.Cylindrical=Gs,e.Plane=L,e.Frustum=jn,e.Sphere=V,e.Ray=Ae,e.Matrix4=c,e.Matrix3=A,e.Box3=X,e.Box2=vn,e.Line3=He,e.Euler=ne,e.Vector4=g,e.Vector3=t,e.Vector2=n,e.Quaternion=y,e.Color=a,e.ImmediateRenderObject=un,e.VertexNormalsHelper=dn,e.SpotLightHelper=nt,e.SkeletonHelper=at,e.PointLightHelper=lt,e.RectAreaLightHelper=Pe,e.HemisphereLightHelper=ut,e.GridHelper=ln,e.PolarGridHelper=gn,e.FaceNormalsHelper=on,e.DirectionalLightHelper=vt,e.CameraHelper=sn,e.BoxHelper=xe,e.Box3Helper=tn,e.PlaneHelper=Jt,e.ArrowHelper=Ee,e.AxesHelper=Zt,e.CatmullRomCurve3=M,e.CubicBezierCurve3=ke,e.QuadraticBezierCurve3=Se,e.LineCurve3=ce,e.ArcCurve=Gt,e.EllipseCurve=W,e.SplineCurve=ie,e.CubicBezierCurve=ee,e.QuadraticBezierCurve=re,e.LineCurve=I,e.Shape=me,e.Path=Me,e.ShapePath=ws,e.Font=Kn,e.CurvePath=je,e.Curve=m,e.ShapeUtils=R,e.SceneUtils={createMultiMaterialObject:function(e,t){for(var s=new St,n=0,o=t.length;n<o;n++)s.add(new x(e,t[n]));return s},detach:function(e,t,n){e.applyMatrix(t.matrixWorld),t.remove(e),n.add(e)},attach:function(e,t,n){e.applyMatrix((new c).getInverse(n.matrixWorld)),t.remove(e),n.add(e)}},e.WebGLUtils=Fs,e.WireframeGeometry=pt,e.ParametricGeometry=Dt,e.ParametricBufferGeometry=ht,e.TetrahedronGeometry=Pt,e.TetrahedronBufferGeometry=dt,e.OctahedronGeometry=It,e.OctahedronBufferGeometry=de,e.IcosahedronGeometry=Vt,e.IcosahedronBufferGeometry=ct,e.DodecahedronGeometry=Wt,e.DodecahedronBufferGeometry=rt,e.PolyhedronGeometry=Lt,e.PolyhedronBufferGeometry=k,e.TubeGeometry=Kt,e.TubeBufferGeometry=it,e.TorusKnotGeometry=Yt,e.TorusKnotBufferGeometry=ot,e.TorusGeometry=Xt,e.TorusBufferGeometry=st,e.TextGeometry=en,e.TextBufferGeometry=et,e.SphereGeometry=nn,e.SphereBufferGeometry=ve,e.RingGeometry=wt,e.RingBufferGeometry=Qe,e.PlaneGeometry=xt,e.PlaneBufferGeometry=Ce,e.LatheGeometry=Ot,e.LatheBufferGeometry=Xe,e.ShapeGeometry=Ge,e.ShapeBufferGeometry=Ye,e.ExtrudeGeometry=te,e.ExtrudeBufferGeometry=H,e.EdgesGeometry=qe,e.ConeGeometry=hn,e.ConeBufferGeometry=rn,e.CylinderGeometry=he,e.CylinderBufferGeometry=J,e.CircleGeometry=an,e.CircleBufferGeometry=We,e.BoxGeometry=Ie,e.BoxBufferGeometry=ue,e.ShadowMaterial=$e,e.SpriteMaterial=le,e.RawShaderMaterial=Ve,e.ShaderMaterial=D,e.PointsMaterial=P,e.MeshPhysicalMaterial=we,e.MeshStandardMaterial=U,e.MeshPhongMaterial=B,e.MeshToonMaterial=ze,e.MeshNormalMaterial=Re,e.MeshLambertMaterial=Le,e.MeshDepthMaterial=oe,e.MeshDistanceMaterial=se,e.MeshBasicMaterial=F,e.LineDashedMaterial=Ne,e.LineBasicMaterial=p,e.Material=h,e.Float64BufferAttribute=zt,e.Float32BufferAttribute=s,e.Uint32BufferAttribute=ge,e.Int32BufferAttribute=Nt,e.Uint16BufferAttribute=fe,e.Int16BufferAttribute=Rt,e.Uint8ClampedBufferAttribute=Ht,e.Uint8BufferAttribute=$t,e.Int8BufferAttribute=Ut,e.BufferAttribute=u,e.REVISION="88",e.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},e.CullFaceNone=0,e.CullFaceBack=1,e.CullFaceFront=2,e.CullFaceFrontBack=3,e.FrontFaceDirectionCW=0,e.FrontFaceDirectionCCW=1,e.BasicShadowMap=0,e.PCFShadowMap=1,e.PCFSoftShadowMap=2,e.FrontSide=0,e.BackSide=1,e.DoubleSide=2,e.FlatShading=1,e.SmoothShading=2,e.NoColors=0,e.FaceColors=1,e.VertexColors=2,e.NoBlending=0,e.NormalBlending=1,e.AdditiveBlending=2,e.SubtractiveBlending=3,e.MultiplyBlending=4,e.CustomBlending=5,e.AddEquation=100,e.SubtractEquation=101,e.ReverseSubtractEquation=102,e.MinEquation=103,e.MaxEquation=104,e.ZeroFactor=200,e.OneFactor=201,e.SrcColorFactor=202,e.OneMinusSrcColorFactor=203,e.SrcAlphaFactor=204,e.OneMinusSrcAlphaFactor=205,e.DstAlphaFactor=206,e.OneMinusDstAlphaFactor=207,e.DstColorFactor=208,e.OneMinusDstColorFactor=209,e.SrcAlphaSaturateFactor=210,e.NeverDepth=0,e.AlwaysDepth=1,e.LessDepth=2,e.LessEqualDepth=3,e.EqualDepth=4,e.GreaterEqualDepth=5,e.GreaterDepth=6,e.NotEqualDepth=7,e.MultiplyOperation=0,e.MixOperation=1,e.AddOperation=2,e.NoToneMapping=0,e.LinearToneMapping=1,e.ReinhardToneMapping=2,e.Uncharted2ToneMapping=3,e.CineonToneMapping=4,e.UVMapping=300,e.CubeReflectionMapping=301,e.CubeRefractionMapping=302,e.EquirectangularReflectionMapping=303,e.EquirectangularRefractionMapping=304,e.SphericalReflectionMapping=305,e.CubeUVReflectionMapping=306,e.CubeUVRefractionMapping=307,e.RepeatWrapping=1e3,e.ClampToEdgeWrapping=1001,e.MirroredRepeatWrapping=1002,e.NearestFilter=1003,e.NearestMipMapNearestFilter=1004,e.NearestMipMapLinearFilter=1005,e.LinearFilter=1006,e.LinearMipMapNearestFilter=1007,e.LinearMipMapLinearFilter=1008,e.UnsignedByteType=1009,e.ByteType=1010,e.ShortType=1011,e.UnsignedShortType=1012,e.IntType=1013,e.UnsignedIntType=1014,e.FloatType=1015,e.HalfFloatType=1016,e.UnsignedShort4444Type=1017,e.UnsignedShort5551Type=1018,e.UnsignedShort565Type=1019,e.UnsignedInt248Type=1020,e.AlphaFormat=1021,e.RGBFormat=1022,e.RGBAFormat=1023,e.LuminanceFormat=1024,e.LuminanceAlphaFormat=1025,e.RGBEFormat=1023,e.DepthFormat=1026,e.DepthStencilFormat=1027,e.RGB_S3TC_DXT1_Format=2001,e.RGBA_S3TC_DXT1_Format=2002,e.RGBA_S3TC_DXT3_Format=2003,e.RGBA_S3TC_DXT5_Format=2004,e.RGB_PVRTC_4BPPV1_Format=2100,e.RGB_PVRTC_2BPPV1_Format=2101,e.RGBA_PVRTC_4BPPV1_Format=2102,e.RGBA_PVRTC_2BPPV1_Format=2103,e.RGB_ETC1_Format=2151,e.LoopOnce=2200,e.LoopRepeat=2201,e.LoopPingPong=2202,e.InterpolateDiscrete=2300,e.InterpolateLinear=2301,e.InterpolateSmooth=2302,e.ZeroCurvatureEnding=2400,e.ZeroSlopeEnding=2401,e.WrapAroundEnding=2402,e.TrianglesDrawMode=0,e.TriangleStripDrawMode=1,e.TriangleFanDrawMode=2,e.LinearEncoding=3e3,e.sRGBEncoding=3001,e.GammaEncoding=3007,e.RGBEEncoding=3002,e.LogLuvEncoding=3003,e.RGBM7Encoding=3004,e.RGBM16Encoding=3005,e.RGBDEncoding=3006,e.BasicDepthPacking=3200,e.RGBADepthPacking=3201,e.CubeGeometry=Ie,e.Face4=function(e,t,n,s,o,i,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new Q(e,t,n,o,i,a)},e.LineStrip=0,e.LinePieces=1,e.MeshFaceMaterial=function(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e},e.MultiMaterial=function(e){return void 0===e&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e},e.PointCloud=function(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new bt(e,t)},e.Particle=function(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new At(e)},e.ParticleSystem=function(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new bt(e,t)},e.PointCloudMaterial=function(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new P(e)},e.ParticleBasicMaterial=function(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new P(e)},e.ParticleSystemMaterial=function(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new P(e)},e.Vertex=function(e,n,s){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new t(e,n,s)},e.DynamicBufferAttribute=function(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new u(e,t).setDynamic(!0)},e.Int8Attribute=function(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new Ut(e,t)},e.Uint8Attribute=function(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new $t(e,t)},e.Uint8ClampedAttribute=function(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Ht(e,t)},e.Int16Attribute=function(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Rt(e,t)},e.Uint16Attribute=function(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new fe(e,t)},e.Int32Attribute=function(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Nt(e,t)},e.Uint32Attribute=function(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new ge(e,t)},e.Float32Attribute=function(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new s(e,t)},e.Float64Attribute=function(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new zt(e,t)},e.ClosedSplineCurve3=ho,e.SplineCurve3=uo,e.Spline=rs,e.AxisHelper=function(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new Zt(e)},e.BoundingBoxHelper=function(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new xe(e,t)},e.EdgesHelper=function(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new v(new qe(e.geometry),new p({color:void 0!==t?t:16777215}))},e.WireframeHelper=function(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new v(new pt(e.geometry),new p({color:void 0!==t?t:16777215}))},e.XHRLoader=function(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new $(e)},e.BinaryTextureLoader=function(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Qn(e)},e.GeometryUtils={merge:function(e,t,n){if(console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),t.isMesh){t.matrixAutoUpdate&&t.updateMatrix();var s=t.matrix;t=t.geometry}e.merge(t,s,n)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}},e.ImageUtils={crossOrigin:void 0,loadTexture:function(e,t,n,s){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var o=new zn;return o.setCrossOrigin(this.crossOrigin),e=o.load(e,n,void 0,s),t&&(e.mapping=t),e},loadTextureCube:function(e,t,n,s){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var o=new Xn;return o.setCrossOrigin(this.crossOrigin),e=o.load(e,n,void 0,s),t&&(e.mapping=t),e},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}},e.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(e,t){console.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},e.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},Object.defineProperty(e,"__esModule",{value:!0})}),function(e){i=e.noise={};function s(e,t,n){this.x=e,this.y=t,this.z=n}s.prototype.dot2=function(e,t){return this.x*e+this.y*t},s.prototype.dot3=function(e,t,n){return this.x*e+this.y*t+this.z*n};var i,d=[new s(1,1,0),new s(-1,1,0),new s(1,-1,0),new s(-1,-1,0),new s(1,0,1),new s(-1,0,1),new s(1,0,-1),new s(-1,0,-1),new s(0,1,1),new s(0,-1,1),new s(0,1,-1),new s(0,-1,-1)],l=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],t=new Array(512),n=new Array(512);i.seed=function(e){e>0&&e<1&&(e*=65536),(e=Math.floor(e))<256&&(e|=e<<8);for(var o,s=0;s<256;s++)o=1&s?l[s]^255&e:l[s]^e>>8&255,t[s]=t[s+256]=o,n[s]=n[s+256]=d[o%12]},i.seed(0);var u=.5*(Math.sqrt(3)-1),r=(3-Math.sqrt(3))/6,a=1/6;function c(e){return e*e*e*(e*(6*e-15)+10)}function o(e,t,n){return(1-n)*e+n*t}i.simplex2=function(e,s){var d,f,y=(e+s)*u,a=Math.floor(e+y),c=Math.floor(s+y),j=(a+c)*r,o=e-a+j,i=s-c+j;o>i?(f=1,d=0):(f=0,d=1);var p=o-f+r,b=i-d+r,g=o-1+2*r,v=i-1+2*r,_=n[(a&=255)+t[c&=255]],w=n[a+f+t[c+d]],O=n[a+1+t[c+1]],l=.5-o*o-i*i,m=.5-p*p-b*b,h=.5-g*g-v*v;return 70*((l<0?0:(l*=l)*l*_.dot2(o,i))+(m<0?0:(m*=m)*m*w.dot2(p,b))+(h<0?0:(h*=h)*h*O.dot2(g,v)))},i.simplex3=function(e,s,o){var l,d,u,h,m,f,M=.3333333333333333*(e+s+o),p=Math.floor(e+M),g=Math.floor(s+M),v=Math.floor(o+M),F=(p+g+v)*a,r=e-p+F,c=s-g+F,i=o-v+F;r>=c?c>=i?(f=1,m=0,h=0,u=1,l=1,d=0):r>=i?(f=1,m=0,h=0,u=1,l=0,d=1):(f=0,m=0,h=1,u=1,l=0,d=1):c<i?(f=0,m=0,h=1,u=0,l=1,d=1):r<i?(f=0,m=1,h=0,u=0,l=1,d=1):(f=0,m=1,h=0,u=1,l=1,d=0);var w=r-f+a,T=c-m+a,O=i-h+a,S=r-u+2*a,x=c-l+2*a,C=i-d+2*a,E=r-1+.5,k=c-1+.5,A=i-1+.5,z=n[(p&=255)+t[(g&=255)+t[v&=255]]],L=n[p+f+t[g+m+t[v+h]]],N=n[p+u+t[g+l+t[v+d]]],D=n[p+1+t[g+1+t[v+1]]],b=.6-r*r-c*c-i*i,_=.6-w*w-T*T-O*O,y=.6-S*S-x*x-C*C,j=.6-E*E-k*k-A*A;return 32*((b<0?0:(b*=b)*b*z.dot3(r,c,i))+(_<0?0:(_*=_)*_*L.dot3(w,T,O))+(y<0?0:(y*=y)*y*N.dot3(S,x,C))+(j<0?0:(j*=j)*j*D.dot3(E,k,A)))},i.perlin2=function(e,s){i=Math.floor(e),a=Math.floor(s),e-=i,s-=a;var i,a,l=n[(i&=255)+t[a&=255]].dot2(e,s),d=n[i+t[a+1]].dot2(e,s-1),u=n[i+1+t[a]].dot2(e-1,s),h=n[i+1+t[a+1]].dot2(e-1,s-1),r=c(e);return o(o(l,u,r),o(d,h,r),c(s))},i.perlin3=function(e,s,i){var a=Math.floor(e),r=Math.floor(s),l=Math.floor(i);e-=a,s-=r,i-=l;var y=n[(a&=255)+t[(r&=255)+t[l&=255]]].dot3(e,s,i),b=n[a+t[r+t[l+1]]].dot3(e,s,i-1),m=n[a+t[r+1+t[l]]].dot3(e,s-1,i),h=n[a+t[r+1+t[l+1]]].dot3(e,s-1,i-1),f=n[a+1+t[r+t[l]]].dot3(e-1,s,i),p=n[a+1+t[r+t[l+1]]].dot3(e-1,s,i-1),g=n[a+1+t[r+1+t[l]]].dot3(e-1,s-1,i),v=n[a+1+t[r+1+t[l+1]]].dot3(e-1,s-1,i-1),d=c(e),j=c(s),u=c(i);return o(o(o(y,f,d),o(b,p,d),u),o(o(m,g,d),o(h,v,d),u),j)}}(this);var _gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){"use strict";var e,t,n,s,o,i,a,r,c,l,d,u,h,m,f,p;_gsScope._gsDefine("TweenMax",["core.Animation","core.SimpleTimeline","TweenLite"],function(e,t,n){var r,l,d,c=function(e){var t,n=[],s=e.length;for(t=0;t!==s;n.push(e[t++]));return n},u=function(e,t,n){var s,o,i=e.cycle;for(o in i)s=i[o],e[o]="function"==typeof s?s(n,t[n]):s[n%s.length];delete e.cycle},s=function(e,t,o){n.call(this,e,t,o),this._cycle=0,this._yoyo=!0===this.vars.yoyo||!!this.vars.yoyoEase,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._dirty=!0,this.render=s.prototype.render},i=1e-10,a=n._internals,h=a.isSelector,m=a.isArray,o=s.prototype=n.to({},.1,{}),f=[];return s.version="1.20.1",o.constructor=s,o.kill()._gc=!1,s.killTweensOf=s.killDelayedCallsTo=n.killTweensOf,s.getTweensOf=n.getTweensOf,s.lagSmoothing=n.lagSmoothing,s.ticker=n.ticker,s.render=n.render,o.invalidate=function(){return this._yoyo=!0===this.vars.yoyo||!!this.vars.yoyoEase,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._yoyoEase=null,this._uncache(!0),n.prototype.invalidate.call(this)},o.updateTo=function(e,t){var s,o,a,r,c,l=this.ratio,i=this.vars.immediateRender||e.immediateRender;for(o in t&&this._startTime<this._timeline._time&&(this._startTime=this._timeline._time,this._uncache(!1),this._gc?this._enabled(!0,!1):this._timeline.insert(this,this._startTime-this._delay)),e)this.vars[o]=e[o];if(this._initted||i)if(t)this._initted=!1,i&&this.render(0,!0,!0);else if(this._gc&&this._enabled(!0,!1),this._notifyPluginsOfEnabled&&this._firstPT&&n._onPluginEvent("_onDisable",this),this._time/this._duration>.998)a=this._totalTime,this.render(0,!0,!1),this._initted=!1,this.render(a,!0,!1);else if(this._initted=!1,this._init(),this._time>0||i)for(c=1/(1-l),s=this._firstPT;s;)r=s.s+s.c,s.c*=c,s.s=r-s.c,s=s._next;return this},o.render=function(e,t,s){this._initted||0===this._duration&&this.vars.repeat&&this.invalidate();var o,r,l,d,m,f,p,g,j,y=this._dirty?this.totalDuration():this._totalDuration,v=this._time,h=this._totalTime,b=this._cycle,c=this._duration,u=this._rawPrevTime;if(e>=y-1e-7&&e>=0?(this._totalTime=y,this._cycle=this._repeat,this._yoyo&&0!=(1&this._cycle)?(this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0):(this._time=c,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1),this._reversed||(f=!0,d="onComplete",s=s||this._timeline.autoRemoveChildren),0===c&&(this._initted||!this.vars.lazy||s)&&(this._startTime===this._timeline._duration&&(e=0),(0>u||0>=e&&e>=-1e-7||u===i&&"isPause"!==this.data)&&u!==e&&(s=!0,u>i&&(d="onReverseComplete")),this._rawPrevTime=j=!t||e||u===e?e:i)):1e-7>e?(this._totalTime=this._time=this._cycle=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==h||0===c&&u>0)&&(d="onReverseComplete",f=this._reversed),0>e&&(this._active=!1,0===c&&(this._initted||!this.vars.lazy||s)&&(u>=0&&(s=!0),this._rawPrevTime=j=!t||e||u===e?e:i)),this._initted||(s=!0)):(this._totalTime=this._time=e,0!==this._repeat&&(g=c+this._repeatDelay,this._cycle=this._totalTime/g>>0,0!==this._cycle&&this._cycle===this._totalTime/g&&e>=h&&this._cycle--,this._time=this._totalTime-this._cycle*g,this._yoyo&&0!=(1&this._cycle)&&(this._time=c-this._time,(r=this._yoyoEase||this.vars.yoyoEase)&&(this._yoyoEase||(!0!==r||this._initted?this._yoyoEase=r=!0===r?this._ease:r instanceof Ease?r:Ease.map[r]:(r=this.vars.ease,this._yoyoEase=r=r?r instanceof Ease?r:"function"==typeof r?new Ease(r,this.vars.easeParams):Ease.map[r]||n.defaultEase:n.defaultEase)),this.ratio=r?1-r.getRatio((c-this._time)/c):0)),this._time>c?this._time=c:this._time<0&&(this._time=0)),this._easeType&&!r?(o=this._time/c,(1===(m=this._easeType)||3===m&&o>=.5)&&(o=1-o),3===m&&(o*=2),1===(p=this._easePower)?o*=o:2===p?o*=o*o:3===p?o*=o*o*o:4===p&&(o*=o*o*o*o),1===m?this.ratio=1-o:2===m?this.ratio=o:this._time/c<.5?this.ratio=o/2:this.ratio=1-o/2):r||(this.ratio=this._ease.getRatio(this._time/c))),v!==this._time||s||b!==this._cycle){if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!s&&this._firstPT&&(!1!==this.vars.lazy&&this._duration||this.vars.lazy&&!this._duration))return this._time=v,this._totalTime=h,this._rawPrevTime=u,this._cycle=b,a.lazyTweens.push(this),void(this._lazy=[e,t]);!this._time||f||r?f&&this._ease._calcEnd&&!r&&(this.ratio=this._ease.getRatio(0===this._time?0:1)):this.ratio=this._ease.getRatio(this._time/c)}for(!1!==this._lazy&&(this._lazy=!1),this._active||!this._paused&&this._time!==v&&e>=0&&(this._active=!0),0===h&&(2===this._initted&&e>0&&this._init(),this._startAt&&(e>=0?this._startAt.render(e,t,s):d||(d="_dummyGS")),this.vars.onStart&&(0!==this._totalTime||0===c)&&(t||this._callback("onStart"))),l=this._firstPT;l;)l.f?l.t[l.p](l.c*this.ratio+l.s):l.t[l.p]=l.c*this.ratio+l.s,l=l._next;this._onUpdate&&(0>e&&this._startAt&&this._startTime&&this._startAt.render(e,t,s),t||(this._totalTime!==h||d)&&this._callback("onUpdate")),this._cycle!==b&&(t||this._gc||this.vars.onRepeat&&this._callback("onRepeat")),d&&(!this._gc||s)&&(0>e&&this._startAt&&!this._onUpdate&&this._startTime&&this._startAt.render(e,t,s),f&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!t&&this.vars[d]&&this._callback(d),0===c&&this._rawPrevTime===i&&j!==i&&(this._rawPrevTime=0))}else h!==this._totalTime&&this._onUpdate&&(t||this._callback("onUpdate"))},s.to=function(e,t,n){return new s(e,t,n)},s.from=function(e,t,n){return n.runBackwards=!0,n.immediateRender=0!=n.immediateRender,new s(e,t,n)},s.fromTo=function(e,t,n,o){return o.startAt=n,o.immediateRender=0!=o.immediateRender&&0!=n.immediateRender,new s(e,t,o)},s.staggerTo=s.allTo=function(e,t,o,i,a,r,l){i=i||0;var d,p,g,v,j=0,y=[],_=function(){o.onComplete&&o.onComplete.apply(o.onCompleteScope||this,arguments),a.apply(l||o.callbackScope||this,r||f)},w=o.cycle,b=o.startAt&&o.startAt.cycle;for(m(e)||("string"==typeof e&&(e=n.selector(e)||e),h(e)&&(e=c(e))),e=e||[],0>i&&((e=c(e)).reverse(),i*=-1),v=e.length-1,p=0;v>=p;p++){for(g in d={},o)d[g]=o[g];if(w&&(u(d,e,p),null!=d.duration&&(t=d.duration,delete d.duration)),b){for(g in b=d.startAt={},o.startAt)b[g]=o.startAt[g];u(d.startAt,e,p)}d.delay=j+(d.delay||0),p===v&&a&&(d.onComplete=_),y[p]=new s(e[p],t,d),j+=i}return y},s.staggerFrom=s.allFrom=function(e,t,n,o,i,a,r){return n.runBackwards=!0,n.immediateRender=0!=n.immediateRender,s.staggerTo(e,t,n,o,i,a,r)},s.staggerFromTo=s.allFromTo=function(e,t,n,o,i,a,r,c){return o.startAt=n,o.immediateRender=0!=o.immediateRender&&0!=n.immediateRender,s.staggerTo(e,t,o,i,a,r,c)},s.delayedCall=function(e,t,n,o,i){return new s(t,0,{delay:e,onComplete:t,onCompleteParams:n,callbackScope:o,onReverseComplete:t,onReverseCompleteParams:n,immediateRender:!1,useFrames:i,overwrite:0})},s.set=function(e,t){return new s(e,0,t)},s.isTweening=function(e){return n.getTweensOf(e,!0).length>0},r=function(e,t){for(var o=[],i=0,s=e._first;s;)s instanceof n?o[i++]=s:(t&&(o[i++]=s),i=(o=o.concat(r(s,t))).length),s=s._next;return o},l=s.getAllTweens=function(t){return r(e._rootTimeline,t).concat(r(e._rootFramesTimeline,t))},s.killAll=function(e,n,s,o){n==null&&(n=!0),s==null&&(s=!0);var i,a,r,c=l(0!=o),d=c.length,u=n&&s&&o;for(a=0;d>a;a++)i=c[a],(u||i instanceof t||(r=i.target===i.vars.onComplete)&&s||n&&!r)&&(e?i.totalTime(i._reversed?0:i.totalDuration()):i._enabled(!1,!1))},s.killChildTweensOf=function(e,t){if(e!=null){var o,i,r,l,u,d=a.tweenLookup;if("string"==typeof e&&(e=n.selector(e)||e),h(e)&&(e=c(e)),m(e))for(o=e.length;--o>-1;)s.killChildTweensOf(e[o],t);else{for(l in i=[],d)for(r=d[l].target.parentNode;r;)r===e&&(i=i.concat(d[l].tweens)),r=r.parentNode;for(u=i.length,o=0;u>o;o++)t&&i[o].totalTime(i[o].totalDuration()),i[o]._enabled(!1,!1)}}},d=function(e,n,s,o){n=!1!==n,s=!1!==s;for(var i,a,r=l(o=!1!==o),d=n&&s&&o,c=r.length;--c>-1;)i=r[c],(d||i instanceof t||(a=i.target===i.vars.onComplete)&&s||n&&!a)&&i.paused(e)},s.pauseAll=function(e,t,n){d(!0,e,t,n)},s.resumeAll=function(e,t,n){d(!1,e,t,n)},s.globalTimeScale=function(t){var s=e._rootTimeline,o=n.ticker.time;return arguments.length?(t=t||i,s._startTime=o-(o-s._startTime)*s._timeScale/t,s=e._rootFramesTimeline,o=n.ticker.frame,s._startTime=o-(o-s._startTime)*s._timeScale/t,s._timeScale=e._rootTimeline._timeScale=t,t):s._timeScale},o.progress=function(e,t){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&0!=(1&this._cycle)?1-e:e)+this._cycle*(this._duration+this._repeatDelay),t):this._time/this.duration()},o.totalProgress=function(e,t){return arguments.length?this.totalTime(this.totalDuration()*e,t):this._totalTime/this.totalDuration()},o.time=function(e,t){return arguments.length?(this._dirty&&this.totalDuration(),e>this._duration&&(e=this._duration),this._yoyo&&0!=(1&this._cycle)?e=this._duration-e+this._cycle*(this._duration+this._repeatDelay):0!==this._repeat&&(e+=this._cycle*(this._duration+this._repeatDelay)),this.totalTime(e,t)):this._time},o.duration=function(t){return arguments.length?e.prototype.duration.call(this,t):this._duration},o.totalDuration=function(e){return arguments.length?-1===this._repeat?this:this.duration((e-this._repeat*this._repeatDelay)/(this._repeat+1)):(this._dirty&&(this._totalDuration=-1===this._repeat?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat,this._dirty=!1),this._totalDuration)},o.repeat=function(e){return arguments.length?(this._repeat=e,this._uncache(!0)):this._repeat},o.repeatDelay=function(e){return arguments.length?(this._repeatDelay=e,this._uncache(!0)):this._repeatDelay},o.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},s},!0),_gsScope._gsDefine("TimelineLite",["core.Animation","core.SimpleTimeline","TweenLite"],function(e,t,n){var o=function(e){t.call(this,e),this._labels={},this.autoRemoveChildren=!0===this.vars.autoRemoveChildren,this.smoothChildTiming=!0===this.vars.smoothChildTiming,this._sortChildren=!0,this._onUpdate=this.vars.onUpdate;var s,o,n=this.vars;for(o in n)s=n[o],i(s)&&-1!==s.join("").indexOf("{self}")&&(n[o]=this._swapSelfInParams(s));i(n.tweens)&&this.add(n.tweens,0,n.align,n.stagger)},a=1e-10,r=n._internals,g=o._internals={},f=r.isSelector,i=r.isArray,u=r.lazyTweens,d=r.lazyRender,c=_gsScope._gsDefine.globals,l=function(e){var t,n={};for(t in e)n[t]=e[t];return n},h=function(e,t,n){var s,o,i=e.cycle;for(o in i)s=i[o],e[o]="function"==typeof s?s(n,t[n]):s[n%s.length];delete e.cycle},p=g.pauseCallback=function(){},m=function(e){var t,n=[],s=e.length;for(t=0;t!==s;n.push(e[t++]));return n},s=o.prototype=new t;return o.version="1.20.1",s.constructor=o,s.kill()._gc=s._forcingPlayhead=s._hasPause=!1,s.to=function(e,t,s,o){var i=s.repeat&&c.TweenMax||n;return t?this.add(new i(e,t,s),o):this.set(e,s,o)},s.from=function(e,t,s,o){return this.add((s.repeat&&c.TweenMax||n).from(e,t,s),o)},s.fromTo=function(e,t,s,o,i){var a=o.repeat&&c.TweenMax||n;return t?this.add(a.fromTo(e,t,s,o),i):this.set(e,o,i)},s.staggerTo=function(e,t,s,i,a,r,c,d){var u,p,g=new o({onComplete:r,onCompleteParams:c,callbackScope:d,smoothChildTiming:this.smoothChildTiming}),v=s.cycle;for("string"==typeof e&&(e=n.selector(e)||e),f(e=e||[])&&(e=m(e)),0>(i=i||0)&&((e=m(e)).reverse(),i*=-1),p=0;p<e.length;p++)(u=l(s)).startAt&&(u.startAt=l(u.startAt),u.startAt.cycle&&h(u.startAt,e,p)),v&&(h(u,e,p),null!=u.duration&&(t=u.duration,delete u.duration)),g.to(e[p],t,u,p*i);return this.add(g,a)},s.staggerFrom=function(e,t,n,s,o,i,a,r){return n.immediateRender=0!=n.immediateRender,n.runBackwards=!0,this.staggerTo(e,t,n,s,o,i,a,r)},s.staggerFromTo=function(e,t,n,s,o,i,a,r,c){return s.startAt=n,s.immediateRender=0!=s.immediateRender&&0!=n.immediateRender,this.staggerTo(e,t,s,o,i,a,r,c)},s.call=function(e,t,s,o){return this.add(n.delayedCall(0,e,t,s),o)},s.set=function(e,t,s){return s=this._parseTimeOrLabel(s,0,!0),null==t.immediateRender&&(t.immediateRender=s===this._time&&!this._paused),this.add(new n(e,0,t),s)},o.exportRoot=function(e,t){null==(e=e||{}).smoothChildTiming&&(e.smoothChildTiming=!0);var s,r,i=new o(e),a=i._timeline;for(t==null&&(t=!0),a._remove(i,!0),i._startTime=0,i._rawPrevTime=i._time=i._totalTime=a._time,s=a._first;s;)r=s._next,t&&s instanceof n&&s.target===s.vars.onComplete||i.add(s,s._startTime-s._delay),s=r;return a.add(i,0),i},s.add=function(s,a,r,c){var l,d,u,h,m,f;if("number"!=typeof a&&(a=this._parseTimeOrLabel(a,0,!0,s)),!(s instanceof e)){if(s instanceof Array||s&&s.push&&i(s)){for(r=r||"normal",c=c||0,u=a,m=s.length,h=0;m>h;h++)i(l=s[h])&&(l=new o({tweens:l})),this.add(l,u),"string"!=typeof l&&"function"!=typeof l&&("sequence"===r?u=l._startTime+l.totalDuration()/l._timeScale:"start"===r&&(l._startTime-=l.delay())),u+=c;return this._uncache(!0)}if("string"==typeof s)return this.addLabel(s,a);if("function"!=typeof s)throw"Cannot add "+s+" into the timeline; it is not a tween, timeline, function, or string.";s=n.delayedCall(0,s)}if(t.prototype.add.call(this,s,a),s._time&&s.render((this.rawTime()-s._startTime)*s._timeScale,!1,!1),(this._gc||this._time===this._duration)&&!this._paused&&this._duration<this.duration())for(f=(d=this).rawTime()>s._startTime;d._timeline;)f&&d._timeline.smoothChildTiming?d.totalTime(d._totalTime,!0):d._gc&&d._enabled(!0,!1),d=d._timeline;return this},s.remove=function(t){if(t instanceof e){this._remove(t,!1);var n,s=t._timeline=t.vars.useFrames?e._rootFramesTimeline:e._rootTimeline;return t._startTime=(t._paused?t._pauseTime:s._time)-(t._reversed?t.totalDuration()-t._totalTime:t._totalTime)/t._timeScale,this}if(t instanceof Array||t&&t.push&&i(t)){for(n=t.length;--n>-1;)this.remove(t[n]);return this}return"string"==typeof t?this.removeLabel(t):this.kill(null,t)},s._remove=function(e,n){return t.prototype._remove.call(this,e,n),this._last?this._time>this.duration()&&(this._time=this._duration,this._totalTime=this._totalDuration):this._time=this._totalTime=this._duration=this._totalDuration=0,this},s.append=function(e,t){return this.add(e,this._parseTimeOrLabel(null,t,!0,e))},s.insert=s.insertMultiple=function(e,t,n,s){return this.add(e,t||0,n,s)},s.appendMultiple=function(e,t,n,s){return this.add(e,this._parseTimeOrLabel(null,t,!0,e),n,s)},s.addLabel=function(e,t){return this._labels[e]=this._parseTimeOrLabel(t),this},s.addPause=function(e,t,s,o){var i=n.delayedCall(0,p,s,o||this);return i.vars.onComplete=i.vars.onReverseComplete=t,i.data="isPause",this._hasPause=!0,this.add(i,e)},s.removeLabel=function(e){return delete this._labels[e],this},s.getLabelTime=function(e){return null!=this._labels[e]?this._labels[e]:-1},s._parseTimeOrLabel=function(t,n,s,o){var a,r;if(o instanceof e&&o.timeline===this)this.remove(o);else if(o&&(o instanceof Array||o.push&&i(o)))for(a=o.length;--a>-1;)o[a]instanceof e&&o[a].timeline===this&&this.remove(o[a]);if(r=this.duration()>99999999999?this.recent().endTime(!1):this._duration,"string"==typeof n)return this._parseTimeOrLabel(n,s&&"number"==typeof t&&null==this._labels[n]?t-r:0,s);if(n=n||0,"string"!=typeof t||!isNaN(t)&&null==this._labels[t])t==null&&(t=r);else{if(-1===(a=t.indexOf("=")))return null==this._labels[t]?s?this._labels[t]=r+n:n:this._labels[t]+n;n=parseInt(t.charAt(a-1)+"1",10)*Number(t.substr(a+1)),t=a>1?this._parseTimeOrLabel(t.substr(0,a-1),0,s):r}return Number(t)+n},s.seek=function(e,t){return this.totalTime("number"==typeof e?e:this._parseTimeOrLabel(e),!1!==t)},s.stop=function(){return this.paused(!0)},s.gotoAndPlay=function(e,t){return this.play(e,t)},s.gotoAndStop=function(e,t){return this.pause(e,t)},s.render=function(e,t,n){this._gc&&this._enabled(!0,!1);var s,o,i,c,l,h,m,f=this._dirty?this.totalDuration():this._totalDuration,r=this._time,g=this._startTime,v=this._timeScale,p=this._paused;if(e>=f-1e-7&&e>=0)this._totalTime=this._time=f,this._reversed||this._hasPausedChild()||(c=!0,i="onComplete",l=!!this._timeline.autoRemoveChildren,0===this._duration&&(0>=e&&e>=-1e-7||this._rawPrevTime<0||this._rawPrevTime===a)&&this._rawPrevTime!==e&&this._first&&(l=!0,this._rawPrevTime>a&&(i="onReverseComplete"))),this._rawPrevTime=this._duration||!t||e||this._rawPrevTime===e?e:a,e=f+1e-4;else if(1e-7>e)if(this._totalTime=this._time=0,(0!==r||0===this._duration&&this._rawPrevTime!==a&&(this._rawPrevTime>0||0>e&&this._rawPrevTime>=0))&&(i="onReverseComplete",c=this._reversed),0>e)this._active=!1,this._timeline.autoRemoveChildren&&this._reversed?(l=c=!0,i="onReverseComplete"):this._rawPrevTime>=0&&this._first&&(l=!0),this._rawPrevTime=e;else{if(this._rawPrevTime=this._duration||!t||e||this._rawPrevTime===e?e:a,0===e&&c)for(s=this._first;s&&0===s._startTime;)s._duration||(c=!1),s=s._next;e=0,this._initted||(l=!0)}else{if(this._hasPause&&!this._forcingPlayhead&&!t){if(e>=r)for(s=this._first;s&&s._startTime<=e&&!o;)s._duration||"isPause"!==s.data||s.ratio||0===s._startTime&&0===this._rawPrevTime||(o=s),s=s._next;else for(s=this._last;s&&s._startTime>=e&&!o;)s._duration||"isPause"===s.data&&s._rawPrevTime>0&&(o=s),s=s._prev;o&&(this._time=e=o._startTime,this._totalTime=e+this._cycle*(this._totalDuration+this._repeatDelay))}this._totalTime=this._time=this._rawPrevTime=e}if(this._time!==r&&this._first||n||l||o){if(this._initted||(this._initted=!0),this._active||!this._paused&&this._time!==r&&e>0&&(this._active=!0),0===r&&this.vars.onStart&&(0===this._time&&this._duration||t||this._callback("onStart")),(m=this._time)>=r)for(s=this._first;s&&(h=s._next,m===this._time&&(!this._paused||p));)(s._active||s._startTime<=m&&!s._paused&&!s._gc)&&(o===s&&this.pause(),s._reversed?s.render((s._dirty?s.totalDuration():s._totalDuration)-(e-s._startTime)*s._timeScale,t,n):s.render((e-s._startTime)*s._timeScale,t,n)),s=h;else for(s=this._last;s&&(h=s._prev,m===this._time&&(!this._paused||p));){if(s._active||s._startTime<=r&&!s._paused&&!s._gc){if(o===s){for(o=s._prev;o&&o.endTime()>this._time;)o.render(o._reversed?o.totalDuration()-(e-o._startTime)*o._timeScale:(e-o._startTime)*o._timeScale,t,n),o=o._prev;o=null,this.pause()}s._reversed?s.render((s._dirty?s.totalDuration():s._totalDuration)-(e-s._startTime)*s._timeScale,t,n):s.render((e-s._startTime)*s._timeScale,t,n)}s=h}this._onUpdate&&(t||(u.length&&d(),this._callback("onUpdate"))),i&&(this._gc||(g===this._startTime||v!==this._timeScale)&&(0===this._time||f>=this.totalDuration())&&(c&&(u.length&&d(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!t&&this.vars[i]&&this._callback(i)))}},s._hasPausedChild=function(){for(var e=this._first;e;){if(e._paused||e instanceof o&&e._hasPausedChild())return!0;e=e._next}return!1},s.getChildren=function(e,t,s,o){o=o||-9999999999;for(var a=[],i=this._first,r=0;i;)i._startTime<o||(i instanceof n?!1!==t&&(a[r++]=i):(!1!==s&&(a[r++]=i),!1!==e&&(r=(a=a.concat(i.getChildren(!0,t,s))).length))),i=i._next;return a},s.getTweensOf=function(e,t){var s,o,i=this._gc,a=[],r=0;for(i&&this._enabled(!0,!0),s=(o=n.getTweensOf(e)).length;--s>-1;)(o[s].timeline===this||t&&this._contains(o[s]))&&(a[r++]=o[s]);return i&&this._enabled(!1,!0),a},s.recent=function(){return this._recent},s._contains=function(e){for(var t=e.timeline;t;){if(t===this)return!0;t=t.timeline}return!1},s.shiftChildren=function(e,t,n){n=n||0;for(var o,s=this._first,i=this._labels;s;)s._startTime>=n&&(s._startTime+=e),s=s._next;if(t)for(o in i)i[o]>=n&&(i[o]+=e);return this._uncache(!0)},s._kill=function(e,t){if(!e&&!t)return this._enabled(!1,!1);for(var n=t?this.getTweensOf(t):this.getChildren(!0,!0,!1),s=n.length,o=!1;--s>-1;)n[s]._kill(e,t)&&(o=!0);return o},s.clear=function(e){var t=this.getChildren(!1,!0,!0),n=t.length;for(this._time=this._totalTime=0;--n>-1;)t[n]._enabled(!1,!1);return!1!==e&&(this._labels={}),this._uncache(!0)},s.invalidate=function(){for(var t=this._first;t;)t.invalidate(),t=t._next;return e.prototype.invalidate.call(this)},s._enabled=function(e,n){if(e===this._gc)for(var s=this._first;s;)s._enabled(e,!0),s=s._next;return t.prototype._enabled.call(this,e,n)},s.totalTime=function(){this._forcingPlayhead=!0;var o=e.prototype.totalTime.apply(this,arguments);return this._forcingPlayhead=!1,o},s.duration=function(e){return arguments.length?(0!==this.duration()&&0!==e&&this.timeScale(this._duration/e),this):(this._dirty&&this.totalDuration(),this._duration)},s.totalDuration=function(e){if(!arguments.length){if(this._dirty){for(var o,i,n=0,t=this._last,s=999999999999;t;)o=t._prev,t._dirty&&t.totalDuration(),t._startTime>s&&this._sortChildren&&!t._paused?this.add(t,t._startTime-t._delay):s=t._startTime,t._startTime<0&&!t._paused&&(n-=t._startTime,this._timeline.smoothChildTiming&&(this._startTime+=t._startTime/this._timeScale),this.shiftChildren(-t._startTime,!1,-9999999999),s=0),(i=t._startTime+t._totalDuration/t._timeScale)>n&&(n=i),t=o;this._duration=this._totalDuration=n,this._dirty=!1}return this._totalDuration}return e&&this.totalDuration()?this.timeScale(this._totalDuration/e):this},s.paused=function(t){if(!t)for(var n=this._first,s=this._time;n;)n._startTime===s&&"isPause"===n.data&&(n._rawPrevTime=0),n=n._next;return e.prototype.paused.apply(this,arguments)},s.usesFrames=function(){for(var t=this._timeline;t._timeline;)t=t._timeline;return t===e._rootFramesTimeline},s.rawTime=function(e){return e&&(this._paused||this._repeat&&this.time()>0&&this.totalProgress()<1)?this._totalTime%(this._duration+this._repeatDelay):this._paused?this._totalTime:(this._timeline.rawTime(e)-this._startTime)*this._timeScale},o},!0),_gsScope._gsDefine("TimelineMax",["TimelineLite","TweenLite","easing.Ease"],function(e,t,n){var i=function(t){e.call(this,t),this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._cycle=0,this._yoyo=!0===this.vars.yoyo,this._dirty=!0},o=1e-10,a=t._internals,r=a.lazyTweens,c=a.lazyRender,l=_gsScope._gsDefine.globals,d=new n(null,null,1,0),s=i.prototype=new e;return s.constructor=i,s.kill()._gc=!1,i.version="1.20.1",s.invalidate=function(){return this._yoyo=!0===this.vars.yoyo,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._uncache(!0),e.prototype.invalidate.call(this)},s.addCallback=function(e,n,s,o){return this.add(t.delayedCall(0,e,s,o),n)},s.removeCallback=function(e,t){if(e)if(t==null)this._kill(null,e);else for(var n=this.getTweensOf(e,!1),s=n.length,o=this._parseTimeOrLabel(t);--s>-1;)n[s]._startTime===o&&n[s]._enabled(!1,!1);return this},s.removePause=function(t){return this.removeCallback(e._internals.pauseCallback,t)},s.tweenTo=function(e,n){n=n||{};var s,i,a,o={ease:d,useFrames:this.usesFrames(),immediateRender:!1},r=n.repeat&&l.TweenMax||t;for(a in n)o[a]=n[a];return o.time=this._parseTimeOrLabel(e),i=Math.abs(Number(o.time)-this._time)/this._timeScale||.001,s=new r(this,i,o),o.onStart=function(){s.target.paused(!0),s.vars.time!==s.target.time()&&i===s.duration()&&s.duration(Math.abs(s.vars.time-s.target.time())/s.target._timeScale),n.onStart&&n.onStart.apply(n.onStartScope||n.callbackScope||s,n.onStartParams||[])},s},s.tweenFromTo=function(e,t,n){n=n||{},e=this._parseTimeOrLabel(e),n.startAt={onComplete:this.seek,onCompleteParams:[e],callbackScope:this},n.immediateRender=!1!==n.immediateRender;var s=this.tweenTo(t,n);return s.duration(Math.abs(s.vars.time-e)/this._timeScale||.001)},s.render=function(e,t,n){this._gc&&this._enabled(!0,!1);var s,i,u,h,f,g,b,_,j=this._dirty?this.totalDuration():this._totalDuration,a=this._duration,l=this._time,v=this._totalTime,O=this._startTime,x=this._timeScale,d=this._rawPrevTime,y=this._paused,m=this._cycle;if(e>=j-1e-7&&e>=0)this._locked||(this._totalTime=j,this._cycle=this._repeat),this._reversed||this._hasPausedChild()||(f=!0,u="onComplete",h=!!this._timeline.autoRemoveChildren,0===this._duration&&(0>=e&&e>=-1e-7||0>d||d===o)&&d!==e&&this._first&&(h=!0,d>o&&(u="onReverseComplete"))),this._rawPrevTime=this._duration||!t||e||this._rawPrevTime===e?e:o,this._yoyo&&0!=(1&this._cycle)?this._time=e=0:(this._time=a,e=a+1e-4);else if(1e-7>e)if(this._locked||(this._totalTime=this._cycle=0),this._time=0,(0!==l||0===a&&d!==o&&(d>0||0>e&&d>=0)&&!this._locked)&&(u="onReverseComplete",f=this._reversed),0>e)this._active=!1,this._timeline.autoRemoveChildren&&this._reversed?(h=f=!0,u="onReverseComplete"):d>=0&&this._first&&(h=!0),this._rawPrevTime=e;else{if(this._rawPrevTime=a||!t||e||this._rawPrevTime===e?e:o,0===e&&f)for(s=this._first;s&&0===s._startTime;)s._duration||(f=!1),s=s._next;e=0,this._initted||(h=!0)}else if(0===a&&0>d&&(h=!0),this._time=this._rawPrevTime=e,this._locked||(this._totalTime=e,0!==this._repeat&&(g=a+this._repeatDelay,this._cycle=this._totalTime/g>>0,0!==this._cycle&&this._cycle===this._totalTime/g&&e>=v&&this._cycle--,this._time=this._totalTime-this._cycle*g,this._yoyo&&0!=(1&this._cycle)&&(this._time=a-this._time),this._time>a?(this._time=a,e=a+1e-4):this._time<0?this._time=e=0:e=this._time)),this._hasPause&&!this._forcingPlayhead&&!t){if((e=this._time)>=l||this._repeat&&m!==this._cycle)for(s=this._first;s&&s._startTime<=e&&!i;)s._duration||"isPause"!==s.data||s.ratio||0===s._startTime&&0===this._rawPrevTime||(i=s),s=s._next;else for(s=this._last;s&&s._startTime>=e&&!i;)s._duration||"isPause"===s.data&&s._rawPrevTime>0&&(i=s),s=s._prev;i&&i._startTime<a&&(this._time=e=i._startTime,this._totalTime=e+this._cycle*(this._totalDuration+this._repeatDelay))}if(this._cycle!==m&&!this._locked){var p=this._yoyo&&0!=(1&m),C=p===(this._yoyo&&0!=(1&this._cycle)),E=this._totalTime,w=this._cycle,k=this._rawPrevTime,A=this._time;if(this._totalTime=m*a,this._cycle<m?p=!p:this._totalTime+=a,this._time=l,this._rawPrevTime=0===a?d-1e-4:d,this._cycle=m,this._locked=!0,l=p?0:a,this.render(l,t,0===a),t||this._gc||this.vars.onRepeat&&(this._cycle=w,this._locked=!1,this._callback("onRepeat")),l!==this._time)return;if(C&&(this._cycle=m,this._locked=!0,l=p?a+1e-4:-1e-4,this.render(l,!0,!1)),this._locked=!1,this._paused&&!y)return;this._time=A,this._totalTime=E,this._cycle=w,this._rawPrevTime=k}if(this._time!==l&&this._first||n||h||i){if(this._initted||(this._initted=!0),this._active||!this._paused&&this._totalTime!==v&&e>0&&(this._active=!0),0===v&&this.vars.onStart&&(0===this._totalTime&&this._totalDuration||t||this._callback("onStart")),(_=this._time)>=l)for(s=this._first;s&&(b=s._next,_===this._time&&(!this._paused||y));)(s._active||s._startTime<=this._time&&!s._paused&&!s._gc)&&(i===s&&this.pause(),s._reversed?s.render((s._dirty?s.totalDuration():s._totalDuration)-(e-s._startTime)*s._timeScale,t,n):s.render((e-s._startTime)*s._timeScale,t,n)),s=b;else for(s=this._last;s&&(b=s._prev,_===this._time&&(!this._paused||y));){if(s._active||s._startTime<=l&&!s._paused&&!s._gc){if(i===s){for(i=s._prev;i&&i.endTime()>this._time;)i.render(i._reversed?i.totalDuration()-(e-i._startTime)*i._timeScale:(e-i._startTime)*i._timeScale,t,n),i=i._prev;i=null,this.pause()}s._reversed?s.render((s._dirty?s.totalDuration():s._totalDuration)-(e-s._startTime)*s._timeScale,t,n):s.render((e-s._startTime)*s._timeScale,t,n)}s=b}this._onUpdate&&(t||(r.length&&c(),this._callback("onUpdate"))),u&&(this._locked||this._gc||(O===this._startTime||x!==this._timeScale)&&(0===this._time||j>=this.totalDuration())&&(f&&(r.length&&c(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!t&&this.vars[u]&&this._callback(u)))}else v!==this._totalTime&&this._onUpdate&&(t||this._callback("onUpdate"))},s.getActive=function(e,t,n){e==null&&(e=!0),t==null&&(t=!0),n==null&&(n=!1);var s,o,i=[],a=this.getChildren(e,t,n),r=0,c=a.length;for(s=0;c>s;s++)(o=a[s]).isActive()&&(i[r++]=o);return i},s.getLabelAfter=function(e){e||0!==e&&(e=this._time);var t,n=this.getLabelsArray(),s=n.length;for(t=0;s>t;t++)if(n[t].time>e)return n[t].name;return null},s.getLabelBefore=function(e){e==null&&(e=this._time);for(var t=this.getLabelsArray(),n=t.length;--n>-1;)if(t[n].time<e)return t[n].name;return null},s.getLabelsArray=function(){var e,t=[],n=0;for(e in this._labels)t[n++]={time:this._labels[e],name:e};return t.sort(function(e,t){return e.time-t.time}),t},s.invalidate=function(){return this._locked=!1,e.prototype.invalidate.call(this)},s.progress=function(e,t){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&0!=(1&this._cycle)?1-e:e)+this._cycle*(this._duration+this._repeatDelay),t):this._time/this.duration()||0},s.totalProgress=function(e,t){return arguments.length?this.totalTime(this.totalDuration()*e,t):this._totalTime/this.totalDuration()||0},s.totalDuration=function(t){return arguments.length?-1!==this._repeat&&t?this.timeScale(this.totalDuration()/t):this:(this._dirty&&(e.prototype.totalDuration.call(this),this._totalDuration=-1===this._repeat?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat),this._totalDuration)},s.time=function(e,t){return arguments.length?(this._dirty&&this.totalDuration(),e>this._duration&&(e=this._duration),this._yoyo&&0!=(1&this._cycle)?e=this._duration-e+this._cycle*(this._duration+this._repeatDelay):0!==this._repeat&&(e+=this._cycle*(this._duration+this._repeatDelay)),this.totalTime(e,t)):this._time},s.repeat=function(e){return arguments.length?(this._repeat=e,this._uncache(!0)):this._repeat},s.repeatDelay=function(e){return arguments.length?(this._repeatDelay=e,this._uncache(!0)):this._repeatDelay},s.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},s.currentLabel=function(e){return arguments.length?this.seek(e,!0):this.getLabelBefore(this._time+1e-8)},i},!0),f=180/Math.PI,e=[],t=[],n=[],i={},p=_gsScope._gsDefine.globals,o=function(e,t,n,s){n===s&&(n=s-(s-t)/1e6),e===t&&(t=e+(n-e)/1e6),this.a=e,this.b=t,this.c=n,this.d=s,this.da=s-e,this.ca=n-e,this.ba=t-e},a=function(e,t,n,s){var a={a:e},o={},i={},r={c:s},c=(e+t)/2,h=(t+n)/2,l=(n+s)/2,d=(c+h)/2,u=(h+l)/2,m=(u-d)/8;return a.b=c+(e-c)/4,o.b=d+m,a.c=o.a=(a.b+o.b)/2,o.c=i.a=(d+u)/2,i.b=u-m,r.b=l+(s-l)/4,i.c=r.a=(i.b+r.b)/2,[a,o,i,r]},l=function(s,o,i,r,c){var l,d,h,f,p,g,v,b,j,y,_,w,O,x=s.length-1,m=0,u=s[0].a;for(p=0;x>p;p++)f=(l=s[m]).a,d=l.d,O=s[m+1].d,c?(g=e[p],w=((y=t[p])+g)*o*.25/(r?.5:n[p]||.5),j=d-((v=d-(d-f)*(r?.5*o:0!==g?w/g:0))+(((b=d+(O-d)*(r?.5*o:0!==y?w/y:0))-v)*(3*g/(g+y)+.5)/4||0))):j=d-((v=d-(d-f)*o*.5)+(b=d+(O-d)*o*.5))/2,v+=j,b+=j,l.c=_=v,l.b=0!==p?u:u=l.a+.6*(l.c-l.a),l.da=d-f,l.ca=_-f,l.ba=u-f,i?(h=a(f,u,_,d),s.splice(m,1,h[0],h[1],h[2],h[3]),m+=4):m++,u=b;(l=s[m]).b=u,l.c=u+.4*(l.d-u),l.da=l.d-l.a,l.ca=l.c-l.a,l.ba=u-l.a,i&&(h=a(l.a,u,l.c,l.d),s.splice(m,1,h[0],h[1],h[2],h[3]))},d=function(n,s,i,a){var r,c,d,u,h,m,l=[];if(a)for(r=(n=[a].concat(n)).length;--r>-1;)"string"==typeof(u=n[r][s])&&"="===u.charAt(1)&&(n[r][s]=a[s]+Number(u.charAt(0)+u.substr(2)));if(0>(m=n.length-2))return l[0]=new o(n[0][s],0,0,n[0][s]),l;for(r=0;m>r;r++)d=n[r][s],c=n[r+1][s],l[r]=new o(d,0,0,c),i&&(h=n[r+2][s],e[r]=(e[r]||0)+(c-d)*(c-d),t[r]=(t[r]||0)+(h-c)*(h-c));return l[r]=new o(n[r][s],0,0,n[r+1][s]),l},r=function(s,o,a,r,c,u){var h,m,f,g,v,j,y,_,b={},p=[],w=u||s[0];for(m in c="string"==typeof c?","+c+",":",x,y,z,left,top,right,bottom,marginTop,marginLeft,marginRight,marginBottom,paddingLeft,paddingTop,paddingRight,paddingBottom,backgroundPosition,backgroundPosition_y,",o==null&&(o=1),s[0])p.push(m);if(s.length>1){for(_=s[s.length-1],v=!0,h=p.length;--h>-1;)if(m=p[h],Math.abs(w[m]-_[m])>.05){v=!1;break}v&&(s=s.concat(),u&&s.unshift(u),s.push(s[1]),u=s[s.length-3])}for(e.length=t.length=n.length=0,h=p.length;--h>-1;)m=p[h],i[m]=-1!==c.indexOf(","+m+","),b[m]=d(s,m,i[m],u);for(h=e.length;--h>-1;)e[h]=Math.sqrt(e[h]),t[h]=Math.sqrt(t[h]);if(!r){for(h=p.length;--h>-1;)if(i[m])for(y=(g=b[p[h]]).length-1,f=0;y>f;f++)j=g[f+1].da/t[f]+g[f].da/e[f]||0,n[f]=(n[f]||0)+j*j;for(h=n.length;--h>-1;)n[h]=Math.sqrt(n[h])}for(h=p.length,f=a?4:1;--h>-1;)g=b[m=p[h]],l(g,o,a,r,i[m]),v&&(g.splice(0,f),g.splice(g.length-f,f));return b},u=function(e,t,n){var s,i,a,r,c,l,d,h,m,f,g,v={},u="cubic"===(t=t||"soft")?3:2,b="soft"===t,p=[];if(b&&n&&(e=[n].concat(e)),e==null||e.length<u+1)throw"invalid Bezier data";for(c in e[0])p.push(c);for(f=p.length;--f>-1;){for(v[c=p[f]]=i=[],a=0,d=e.length,s=0;d>s;s++)r=n==null?e[s][c]:"string"==typeof(l=e[s][c])&&"="===l.charAt(1)?n[c]+Number(l.charAt(0)+l.substr(2)):Number(l),b&&s>1&&d-1>s&&(i[a++]=(r+i[a-2])/2),i[a++]=r;for(d=a-u+1,a=0,s=0;d>s;s+=u)r=i[s],m=i[s+1],h=i[s+2],g=2===u?0:i[s+3],i[a++]=l=3===u?new o(r,m,h,g):new o(r,(2*m+r)/3,(2*m+h)/3,h);i.length=a}return v},h=function(e,t,n){for(var s,o,i,a,r,c,d,u,h,m,f,p=1/n,l=e.length;--l>-1;)for(a=(i=e[l]).a,d=i.d-a,u=i.c-a,h=i.b-a,r=c=0,o=1;n>=o;o++)r=c-(c=((s=p*o)*s*d+3*(m=1-s)*(s*u+m*h))*s),t[f=l*n+o-1]=(t[f]||0)+r*r},m=function(e,t){var n,s,c,l,i=[],d=[],o=0,a=0,m=(t=t>>0||6)-1,u=[],r=[];for(c in e)h(e[c],i,t);for(l=i.length,n=0;l>n;n++)o+=Math.sqrt(i[n]),r[s=n%t]=o,s===m&&(a+=o,u[s=n/t>>0]=r,d[s]=a,o=0,r=[]);return{length:a,lengths:d,segments:u}},s=_gsScope._gsDefine.plugin({propName:"bezier",priority:-1,version:"1.3.8",API:2,global:!0,init:function(e,t,n){this._target=e,t instanceof Array&&(t={values:t}),this._func={},this._mod={},this._props=[],this._timeRes=null==t.timeResolution?6:parseInt(t.timeResolution,10);var s,i,a,d,h,f,c=t.values||[],l={},p=c[0],o=t.autoRotate||n.vars.orientToBezier;for(s in this._autoRotate=o?o instanceof Array?o:[["x","y","rotation",!0===o?0:Number(o)||0]]:null,p)this._props.push(s);for(i=this._props.length;--i>-1;)s=this._props[i],this._overwriteProps.push(s),f=this._func[s]="function"==typeof e[s],l[s]=f?e[s.indexOf("set")||"function"!=typeof e["get"+s.substr(3)]?s:"get"+s.substr(3)]():parseFloat(e[s]),h||l[s]!==c[0][s]&&(h=l);if((this._beziers="cubic"!==t.type&&"quadratic"!==t.type&&"soft"!==t.type?r(c,isNaN(t.curviness)?1:t.curviness,!1,"thruBasic"===t.type,t.correlate,h):u(c,t.type,l),this._segCount=this._beziers[s].length,this._timeRes)&&(d=m(this._beziers,this._timeRes),this._length=d.length,this._lengths=d.lengths,this._segments=d.segments,this._l1=this._li=this._s1=this._si=0,this._l2=this._lengths[0],this._curSeg=this._segments[0],this._s2=this._curSeg[0],this._prec=1/this._curSeg.length),o=this._autoRotate)for(this._initialRotations=[],o[0]instanceof Array||(this._autoRotate=o=[o]),i=o.length;--i>-1;){for(a=0;3>a;a++)s=o[i][a],this._func[s]="function"==typeof e[s]&&e[s.indexOf("set")||"function"!=typeof e["get"+s.substr(3)]?s:"get"+s.substr(3)];s=o[i][2],this._initialRotations[i]=(this._func[s]?this._func[s].call(this._target):this._target[s])||0,this._overwriteProps.push(s)}return this._startRatio=n.vars.runBackwards?1:0,!0},set:function(e){var t,n,s,o,i,a,r,c,u,h,m,p,g,v,b,j,_,w,l=this._segCount,y=this._func,d=this._target,O=e!==this._startRatio;if(this._timeRes){if(h=this._lengths,o=this._curSeg,e*=this._length,t=this._li,e>this._l2&&l-1>t){for(p=l-1;p>t&&(this._l2=h[++t])<=e;);this._l1=h[t-1],this._li=t,this._curSeg=o=this._segments[t],this._s2=o[this._s1=this._si=0]}else if(e<this._l1&&t>0){for(;t>0&&(this._l1=h[--t])>=e;);0===t&&e<this._l1?this._l1=0:t++,this._l2=h[t],this._li=t,this._curSeg=o=this._segments[t],this._s1=o[(this._si=o.length-1)-1]||0,this._s2=o[this._si]}if(u=t,e-=this._l1,t=this._si,e>this._s2&&t<o.length-1){for(p=o.length-1;p>t&&(this._s2=o[++t])<=e;);this._s1=o[t-1],this._si=t}else if(e<this._s1&&t>0){for(;t>0&&(this._s1=o[--t])>=e;);0===t&&e<this._s1?this._s1=0:t++,this._s2=o[t],this._si=t}s=(t+(e-this._s1)/(this._s2-this._s1))*this._prec||0}else s=(e-(u=0>e?0:e>=1?l-1:l*e>>0)*(1/l))*l;for(j=1-s,t=this._props.length;--t>-1;)i=this._props[t],r=(s*s*(n=this._beziers[i][u]).da+3*j*(s*n.ca+j*n.ba))*s+n.a,this._mod[i]&&(r=this._mod[i](r,d)),y[i]?d[i](r):d[i]=r;if(this._autoRotate){c=this._autoRotate;for(t=c.length;--t>-1;)i=c[t][2],_=c[t][3]||0,w=!0===c[t][4]?1:f,n=this._beziers[c[t][0]],a=this._beziers[c[t][1]],n&&a&&(n=n[u],a=a[u],m=n.a+(n.b-n.a)*s,m+=((v=n.b+(n.c-n.b)*s)-m)*s,v+=(n.c+(n.d-n.c)*s-v)*s,g=a.a+(a.b-a.a)*s,g+=((b=a.b+(a.c-a.b)*s)-g)*s,b+=(a.c+(a.d-a.c)*s-b)*s,r=O?Math.atan2(b-g,v-m)*w+_:this._initialRotations[t],this._mod[i]&&(r=this._mod[i](r,d)),y[i]?d[i](r):d[i]=r)}}}),c=s.prototype,s.bezierThrough=r,s.cubicToQuadratic=a,s._autoCSS=!0,s.quadraticToCubic=function(e,t,n){return new o(e,(2*t+e)/3,(2*t+n)/3,n)},s._cssRegister=function(){if(t=p.CSSPlugin,t){var t,e=t._internals,n=e._parseToProxy,o=e._setPluginRatio,i=e.CSSPropTween;e._registerComplexSpecialProp("bezier",{parser:function(e,t,a,r,c,l){t instanceof Array&&(t={values:t}),l=new s;var u,h,m,p=t.values,f=p.length-1,g=[],d={};if(0>f)return c;for(h=0;f>=h;h++)u=n(e,p[h],r,c,l,f!==h),g[h]=u.end;for(m in t)d[m]=t[m];return d.values=g,(c=new i(e,"bezier",0,0,u.pt,2)).data=u,c.plugin=l,c.setRatio=o,0===d.autoRotate&&(d.autoRotate=!0),!d.autoRotate||d.autoRotate instanceof Array||(h=!0===d.autoRotate?0:Number(d.autoRotate),d.autoRotate=null!=u.end.left?[["left","top","rotation",h,!1]]:null!=u.end.x&&[["x","y","rotation",h,!1]]),d.autoRotate&&(r._transform||r._enableTransforms(!1),u.autoRotate=r._target._gsTransform,u.proxy.rotation=u.autoRotate.rotation||0,r._overwriteProps.push("rotation")),l._onInitTween(u.proxy,d,r._tween),c}})}},c._mod=function(e){for(var t,n=this._overwriteProps,s=n.length;--s>-1;)(t=e[n[s]])&&"function"==typeof t&&(this._mod[n[s]]=t)},c._kill=function(e){var t,s,n=this._props;for(s in this._beziers)if(s in e)for(delete this._beziers[s],delete this._func[s],t=n.length;--t>-1;)n[t]===s&&n.splice(t,1);if(n=this._autoRotate)for(t=n.length;--t>-1;)e[n[t][2]]&&n.splice(t,1);return this._super._kill.call(this,e)},_gsScope._gsDefine("plugins.CSSPlugin",["plugins.TweenPlugin","TweenLite"],function(e,t){var a,F,U,ee,s=function(){e.call(this,"css"),this._overwriteProps.length=0,this.setRatio=s.prototype.setRatio},Ie=_gsScope._gsDefine.globals,m={},n=s.prototype=new e("css");n.constructor=s,s.version="1.20.0",s.API=2,s.defaultTransformPerspective=0,s.defaultSkewType="compensated",s.defaultSmoothOrigin=!0,n="px",s.suffixMap={top:n,right:n,bottom:n,left:n,width:n,height:n,fontSize:n,padding:n,margin:n,perspective:n,lineHeight:""};var O,k,A,M,V,G,je,ue,le,Ae,L=/(?:-|\.|\b)(\d|\.|e-)+/g,he=/(?:\d|-\d|\.\d|-\.\d|\+=\d|-=\d|\+=.\d|-=\.\d)+/g,ae=/(?:\+=|-=|-|\b)[\d\-.]+[a-zA-Z0-9]*(?:%|\b)/gi,oe=/(?![+-]?\d*\.?\d+|[+-]|e[+-]\d+)[^0-9]/g,I=/(?:\d|-|\+|=|#|\.)*/g,me=/opacity *= *([^)]*)/i,Ne=/opacity:([^;]*)/i,Re=/alpha\(opacity *=.+?\)/i,Pe=/^(rgb|hsl)/,pe=/([A-Z])/g,Oe=/-([a-z])/gi,Be=/(^(?:url\("|url\())|(?:("\))$|\)$)/gi,ve=function(e,t){return t.toUpperCase()},Ve=/(?:Left|Right|Width)/i,qe=/(M11|M12|M21|M22)=[\d\-.e]+/gi,Ye=/progid:DXImageTransform\.Microsoft\.Matrix\(.+?\)/i,_=/,(?=[^)]*(?:\(|$))/gi,Ge=/[\s,(]/i,d=Math.PI/180,x=180/Math.PI,W={},Xe={style:{}},v=_gsScope.document||{createElement:function(){return Xe}},$=function(e,t){return v.createElementNS?v.createElementNS(t||"http://www.w3.org/1999/xhtml",e):v.createElement(e)},j=$("div"),ie=$("img"),g=s._internals={_specialProps:m},y=(_gsScope.navigator||{}).userAgent||"",E=function(){var t=y.indexOf("Android"),e=$("a");return ue=-1!==y.indexOf("Safari")&&-1===y.indexOf("Chrome")&&(-1===t||parseFloat(y.substr(t+8,2))>3),Ae=ue&&parseFloat(y.substr(y.indexOf("Version/")+8,2))<6,le=-1!==y.indexOf("Firefox"),(/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(y)||/Trident\/.*rv:([0-9]{1,}[.0-9]{0,})/.exec(y))&&(A=parseFloat(RegExp.$1)),!!e&&(e.style.cssText="top:1px;opacity:.55;",/^0.55/.test(e.style.opacity))}(),ke=function(e){return me.test("string"==typeof e?e:(e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?parseFloat(RegExp.$1)/100:1},Fe=function(e){_gsScope.console&&console.log(e)},Me="",_e="",P=function(e,t){var n,s,o=(t=t||j).style;if(void 0!==o[e])return e;for(e=e.charAt(0).toUpperCase()+e.substr(1),s=["O","Moz","ms","Ms","Webkit"],n=5;--n>-1&&void 0===o[s[n]+e];);return n>=0?(Me="-"+(_e=3===n?"ms":s[n]).toLowerCase()+"-",_e+e):null},b=v.defaultView?v.defaultView.getComputedStyle:function(){},o=s.getStyle=function(e,t,n,s,o){var i;return E||"opacity"!==t?(!s&&e.style[t]?i=e.style[t]:(n=n||b(e))?i=n[t]||n.getPropertyValue(t)||n.getPropertyValue(t.replace(pe,"-$1").toLowerCase()):e.currentStyle&&(i=e.currentStyle[t]),o==null||i&&"none"!==i&&"auto"!==i&&"auto auto"!==i?i:o):ke(e)},f=g.convertToPixels=function(e,n,i,a,r){if("px"===a||!a&&"lineHeight"!==n)return i;if("auto"===a||!i)return 0;var c,l,m,u=Ve.test(n),d=e,h=j.style,p=0>i,g=1===i;if(p&&(i=-i),g&&(i*=100),"lineHeight"!==n||a)if("%"===a&&-1!==n.indexOf("border"))c=i/100*(u?e.clientWidth:e.clientHeight);else{if(h.cssText="border:0 solid red;position:"+o(e,"position")+";line-height:0;","%"!==a&&d.appendChild&&"v"!==a.charAt(0)&&"rem"!==a)h[u?"borderLeftWidth":"borderTopWidth"]=i+a;else{if(d=e.parentNode||v.body,-1!==o(d,"display").indexOf("flex")&&(h.position="absolute"),l=d._gsCache,m=t.ticker.frame,l&&u&&l.time===m)return l.width*i/100;h[u?"width":"height"]=i+a}d.appendChild(j),c=parseFloat(j[u?"offsetWidth":"offsetHeight"]),d.removeChild(j),u&&"%"===a&&!1!==s.cacheWidths&&((l=d._gsCache=d._gsCache||{}).time=m,l.width=c/i*100),0!==c||r||(c=f(e,n,i,a,!0))}else l=b(e).lineHeight,e.style.lineHeight=i,c=parseFloat(b(e).lineHeight),e.style.lineHeight=l;return g&&(c/=100),p?-c:c},xe=g.calculateOffset=function(e,t,n){if("absolute"!==o(e,"position",n))return 0;var s="left"===t?"Left":"Top",i=o(e,"margin"+s,n);return e["offset"+s]-(f(e,t,parseFloat(i),i.replace(I,""))||0)},T=function(e,t){var s,o,i,n={};if(t=t||b(e,null))if(s=t.length)for(;--s>-1;)(-1===(i=t[s]).indexOf("-transform")||J===i)&&(n[i.replace(Oe,ve)]=t.getPropertyValue(i));else for(s in t)(-1===s.indexOf("Transform")||l===s)&&(n[s]=t[s]);else if(t=e.currentStyle||e.style)for(s in t)"string"==typeof s&&void 0===n[s]&&(n[s.replace(Oe,ve)]=t[s]);return E||(n.opacity=ke(e)),o=D(e,t,!1),n.rotation=o.rotation,n.skewX=o.skewX,n.scaleX=o.scaleX,n.scaleY=o.scaleY,n.x=o.x,n.y=o.y,p&&(n.z=o.z,n.rotationX=o.rotationX,n.rotationY=o.rotationY,n.scaleZ=o.scaleZ),n.filters&&delete n.filters,n},se=function(e,t,n,s,o){var i,a,r,c={},l=e.style;for(i in n)"cssText"!==i&&"length"!==i&&isNaN(i)&&(t[i]!==(a=n[i])||o&&o[i])&&-1===i.indexOf("Origin")&&("number"==typeof a||"string"==typeof a)&&(c[i]="auto"!==a||"left"!==i&&"top"!==i?""!==a&&"auto"!==a&&"none"!==a||"string"!=typeof t[i]||""===t[i].replace(oe,"")?a:0:xe(e,i),void 0!==l[i]&&(r=new re(l,i,l[i],r)));if(s)for(i in s)"className"!==i&&(c[i]=s[i]);return{difs:c,firstMPT:r}},Ke={width:["Left","Right"],height:["Top","Bottom"]},ze=["marginLeft","marginRight","marginTop","marginBottom"],Ue=function(e,t,n){if("svg"===(e.nodeName+"").toLowerCase())return(n||b(e))[t]||0;if(e.getCTM&&te(e))return e.getBBox()[t]||0;var s=parseFloat("width"===t?e.offsetWidth:e.offsetHeight),i=Ke[t],a=i.length;for(n=n||b(e,null);--a>-1;)s-=parseFloat(o(e,"padding"+i[a],n,!0))||0,s-=parseFloat(o(e,"border"+i[a]+"Width",n,!0))||0;return s},C=function(e,t){if("contain"===e||"auto"===e||"auto auto"===e)return e+" ";(e==null||""===e)&&(e="0 0");var i,s=e.split(" "),n=-1!==e.indexOf("left")?"0%":-1!==e.indexOf("right")?"100%":s[0],o=-1!==e.indexOf("top")?"0%":-1!==e.indexOf("bottom")?"100%":s[1];if(s.length>3&&!t){for(s=e.split(", ").join(",").split(","),e=[],i=0;i<s.length;i++)e.push(C(s[i]));return e.join(",")}return o==null?o="center"===n?"50%":"0":"center"===o&&(o="50%"),("center"===n||isNaN(parseFloat(n))&&-1===(n+"").indexOf("="))&&(n="50%"),e=n+" "+o+(s.length>2?" "+s[2]:""),t&&(t.oxp=-1!==n.indexOf("%"),t.oyp=-1!==o.indexOf("%"),t.oxr="="===n.charAt(1),t.oyr="="===o.charAt(1),t.ox=parseFloat(n.replace(oe,"")),t.oy=parseFloat(o.replace(oe,"")),t.v=e),t||e},B=function(e,t){return"function"==typeof e&&(e=e(O,k)),"string"==typeof e&&"="===e.charAt(1)?parseInt(e.charAt(0)+"1",10)*parseFloat(e.substr(2)):parseFloat(e)-parseFloat(t)||0},h=function(e,t){return"function"==typeof e&&(e=e(O,k)),e==null?t:"string"==typeof e&&"="===e.charAt(1)?parseInt(e.charAt(0)+"1",10)*parseFloat(e.substr(2))+t:parseFloat(e)||0},N=function(e,t,n,s){var o,i,a,r,c,l=1e-6;return"function"==typeof e&&(e=e(O,k)),e==null?a=t:"number"==typeof e?a=e:(i=360,r=e.split("_"),o=((c="="===e.charAt(1))?parseInt(e.charAt(0)+"1",10)*parseFloat(r[0].substr(2)):parseFloat(r[0]))*(-1===e.indexOf("rad")?1:x)-(c?0:t),r.length&&(s&&(s[n]=t+o),-1!==e.indexOf("short")&&(o%=i)!==o%180&&(o=0>o?o+i:o-i),-1!==e.indexOf("_cw")&&0>o?o=(o+9999999999*i)%i-(o/i|0)*i:-1!==e.indexOf("ccw")&&o>0&&(o=(o-9999999999*i)%i-(o/i|0)*i)),a=t+o),l>a&&a>-l&&(a=0),a},H={aqua:[0,255,255],lime:[0,255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,255],navy:[0,0,128],white:[255,255,255],fuchsia:[255,0,255],olive:[128,128,0],yellow:[255,255,0],orange:[255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[255,0,0],pink:[255,192,203],cyan:[0,255,255],transparent:[255,255,255,0]},Q=function(e,t,n){return 255*(1>6*(e=0>e?e+1:e>1?e-1:e)?t+(n-t)*e*6:.5>e?n:2>3*e?t+(n-t)*(2/3-e)*6:t)+.5|0},q=s.parseColor=function(e,t){var n,s,o,i,a,r,c,l,d,u,h;if(e)if("number"==typeof e)n=[e>>16,e>>8&255,255&e];else{if(","===e.charAt(e.length-1)&&(e=e.substr(0,e.length-1)),H[e])n=H[e];else if("#"===e.charAt(0))4===e.length&&(o=e.charAt(1),s=e.charAt(2),i=e.charAt(3),e="#"+o+o+s+s+i+i),n=[(e=parseInt(e.substr(1),16))>>16,e>>8&255,255&e];else if("hsl"===e.substr(0,3))if(n=h=e.match(L),t){if(-1!==e.indexOf("="))return e.match(he)}else a=Number(n[0])%360/360,c=Number(n[1])/100,o=2*(r=Number(n[2])/100)-(s=.5>=r?r*(c+1):r+c-r*c),n.length>3&&(n[3]=Number(e[3])),n[0]=Q(a+1/3,o,s),n[1]=Q(a,o,s),n[2]=Q(a-1/3,o,s);else n=e.match(L)||H.transparent;n[0]=Number(n[0]),n[1]=Number(n[1]),n[2]=Number(n[2]),n.length>3&&(n[3]=Number(n[3]))}else n=H.black;return t&&!h&&(o=n[0]/255,s=n[1]/255,i=n[2]/255,r=((l=Math.max(o,s,i))+(u=Math.min(o,s,i)))/2,l===u?a=c=0:(d=l-u,c=r>.5?d/(2-l-u):d/(l+u),a=l===o?(s-i)/d+(i>s?6:0):l===s?(i-o)/d+2:(o-s)/d+4,a*=60),n[0]=a+.5|0,n[1]=100*c+.5|0,n[2]=100*r+.5|0),n},be=function(e,t){var n,o,a,i=e.match(u)||[],s=0,r="";if(!i.length)return e;for(o=0;o<i.length;o++)n=i[o],s+=(a=e.substr(s,e.indexOf(n,s)-s)).length+n.length,3===(n=q(n,t)).length&&n.push(1),r+=a+(t?"hsla("+n[0]+","+n[1]+"%,"+n[2]+"%,"+n[3]:"rgba("+n.join(","))+")";return r+e.substr(s)},u="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3}){1,2}\\b",Te,Ce,Se,fe;for(n in H)u+="|"+n+"\\b";u=new RegExp(u+")","gi"),s.colorStringFilter=function(e){var t,n=e[0]+" "+e[1];u.test(n)&&(t=-1!==n.indexOf("hsl(")||-1!==n.indexOf("hsla("),e[0]=be(e[0],t),e[1]=be(e[1],t)),u.lastIndex=0},t.defaultStringFilter||(t.defaultStringFilter=s.colorStringFilter);var de=function(e,t,n,s){if(e==null)return function(e){return e};var a,c=t?(e.match(u)||[""])[0]:"",i=e.split(c).join("").match(ae)||[],l=e.substr(0,e.indexOf(i[0])),d=")"===e.charAt(e.length-1)?")":"",r=-1!==e.indexOf(" ")?" ":",",o=i.length,h=o>0?i[0].replace(L,""):"";return o?a=t?function(e){if("number"==typeof e)e+=h;else if(s&&_.test(e)){for(m=e.replace(_,"|").split("|"),t=0;t<m.length;t++)m[t]=a(m[t]);return m.join(",")}if(p=(e.match(u)||[c])[0],t=(f=e.split(p).join("").match(ae)||[]).length,o>t--)for(var t,m,f,p;++t<o;)f[t]=n?f[(t-1)/2|0]:i[t];return l+f.join(r)+r+p+d+(-1!==e.indexOf("inset")?" inset":"")}:function(e){if("number"==typeof e)e+=h;else if(s&&_.test(e)){for(c=e.replace(_,"|").split("|"),t=0;t<c.length;t++)c[t]=a(c[t]);return c.join(",")}if(t=(u=e.match(ae)||[]).length,o>t--)for(var t,c,u;++t<o;)u[t]=n?u[(t-1)/2|0]:i[t];return l+u.join(r)+d}:function(e){return e}},ce=function(e){return e=e.split(","),function(t,n,s,o,i,a,r){var c,l=(n+"").split(" ");for(r={},c=0;4>c;c++)r[e[c]]=l[c]=l[c]||l[(c-1)/2>>0];return o.parse(t,r,i,a)}},re=(g._setPluginRatio=function(e){this.plugin.setRatio(e);for(var t,s,i,a,r,o=this.data,c=o.proxy,n=o.firstMPT,l=1e-6;n;)s=c[n.v],n.r?s=Math.round(s):l>s&&s>-l&&(s=0),n.t[n.p]=s,n=n._next;if(o.autoRotate&&(o.autoRotate.rotation=o.mod?o.mod(c.rotation,this.t):c.rotation),1===e||0===e)for(n=o.firstMPT,r=1===e?"e":"b";n;){if((t=n.t).type){if(1===t.type){for(a=t.xs0+t.s+t.xs1,i=1;i<t.l;i++)a+=t["xn"+i]+t["xs"+(i+1)];t[r]=a}}else t[r]=t.s+t.xs0;n=n._next}},function(e,t,n,s,o){this.t=e,this.p=t,this.v=n,this.r=o,s&&(s._prev=this,this._next=s)}),r=(g._parseToProxy=function(e,t,n,s,o,i){var a,r,c,d,m,l=s,u={},h={},f=n._transform,p=W;for(n._transform=null,W=t,s=m=n.parse(e,t,s,o),W=p,i&&(n._transform=f,l&&(l._prev=null,l._prev&&(l._prev._next=null)));s&&s!==l;){if(s.type<=1&&(h[a=s.p]=s.s+s.c,u[a]=s.s,i||(c=new re(s,"s",a,c,s.r),s.c=0),1===s.type))for(d=s.l;--d>0;)r="xn"+d,h[a=s.p+"_"+r]=s.data[r],u[a]=s[r],i||(c=new re(s,r,a,c,s.rxp[r]));s=s._next}return{proxy:u,end:h,firstMPT:c,pt:m}},g.CSSPropTween=function(e,t,n,s,o,i,a,c,l,d,u){this.t=e,this.p=t,this.s=n,this.c=s,this.n=a||t,e instanceof r||ee.push(this.n),this.r=c,this.type=i||0,l&&(this.pr=l,F=!0),this.b=void 0===d?n:d,this.e=void 0===u?n+s:u,o&&(this._next=o,o._prev=this)}),K=function(e,t,n,s,o,i){var a=new r(e,t,n,s-n,o,-1,i);return a.b=n,a.e=a.xs0=s,a},R=s.parseComplex=function(e,t,n,o,i,a,c,l,d,h){n=n||a||"","function"==typeof o&&(o=o(O,k)),c=new r(e,t,0,0,c,h?2:1,null,!1,l,n,o),o+="",i&&u.test(o+n)&&(o=[n,o],s.colorStringFilter(o),n=o[0],o=o[1]);var m,f,p,g,v,b,j,y,w,A,S,M,T,x=n.split(", ").join(",").split(" "),C=o.split(", ").join(",").split(" "),F=x.length,z=!1!==G;for((-1!==o.indexOf(",")||-1!==n.indexOf(","))&&(x=x.join(" ").replace(_,", ").split(" "),C=C.join(" ").replace(_,", ").split(" "),F=x.length),F!==C.length&&(F=(x=(a||"").split(" ")).length),c.plugin=d,c.setRatio=h,u.lastIndex=0,p=0;F>p;p++)if(m=x[p],f=C[p],(A=parseFloat(m))||0===A)c.appendXtra("",A,B(f,A),f.replace(he,""),z&&-1!==f.indexOf("px"),!0);else if(i&&u.test(m))g=")"+((g=f.indexOf(")")+1)?f.substr(g):""),M=-1!==f.indexOf("hsl")&&E,v=f,m=q(m,M),f=q(f,M),(b=m.length+f.length>6)&&!E&&0===f[3]?(c["xs"+c.l]+=c.l?" transparent":"transparent",c.e=c.e.split(C[p]).join("transparent")):(E||(b=!1),M?c.appendXtra(v.substr(0,v.indexOf("hsl"))+(b?"hsla(":"hsl("),m[0],B(f[0],m[0]),",",!1,!0).appendXtra("",m[1],B(f[1],m[1]),"%,",!1).appendXtra("",m[2],B(f[2],m[2]),b?"%,":"%"+g,!1):c.appendXtra(v.substr(0,v.indexOf("rgb"))+(b?"rgba(":"rgb("),m[0],f[0]-m[0],",",!0,!0).appendXtra("",m[1],f[1]-m[1],",",!0).appendXtra("",m[2],f[2]-m[2],b?",":g,!0),b&&(m=m.length<4?1:m[3],c.appendXtra("",m,(f.length<4?1:f[3])-m,g,!1))),u.lastIndex=0;else if(S=m.match(L)){if(!(T=f.match(he))||T.length!==S.length)return c;for(j=0,w=0;w<S.length;w++)y=S[w],v=m.indexOf(y,j),c.appendXtra(m.substr(j,v-j),Number(y),B(T[w],y),"",z&&"px"===m.substr(v+y.length,2),0===w),j=v+y.length;c["xs"+c.l]+=m.substr(j)}else c["xs"+c.l]+=c.l||c["xs"+c.l]?" "+f:f;if(-1!==o.indexOf("=")&&c.data){for(g=c.xs0+c.data.s,p=1;p<c.l;p++)g+=c["xs"+p]+c.data["xn"+p];c.e=g+c["xs"+p]}return c.l||(c.type=-1,c.xs0=c.e),c.xfirst||c},c=9;for((n=r.prototype).l=n.pr=0;--c>0;)n["xn"+c]=0,n["xs"+c]="";n.xs0="",n._next=n._prev=n.xfirst=n.data=n.plugin=n.setRatio=n.rxp=null,n.appendXtra=function(e,t,n,s,o,i){var a=this,c=a.l;return a["xs"+c]+=i&&(c||a["xs"+c])?" "+e:e||"",n||0===c||a.plugin?(a.l++,a.type=a.setRatio?2:1,a["xs"+a.l]=s||"",c>0?(a.data["xn"+c]=t+n,a.rxp["xn"+c]=o,a["xn"+c]=t,a.plugin||(a.xfirst=new r(a,"xn"+c,t,n,a.xfirst||a,0,a.n,o,a.pr),a.xfirst.xs0=0),a):(a.data={s:t+n},a.rxp={},a.s=t,a.c=n,a.r=o,a)):(a["xs"+c]+=t+(s||""),a)};var ye=function(e,t){t=t||{},this.p=t.prefix&&P(e)||e,m[e]=m[this.p]=this,this.format=t.formatter||de(t.defaultValue,t.color,t.collapsible,t.multi),t.parser&&(this.parse=t.parser),this.clrs=t.color,this.multi=t.multi,this.keyword=t.keyword,this.dflt=t.defaultValue,this.pr=t.priority||0},i=g._registerComplexSpecialProp=function(e,t,n){"object"!=typeof t&&(t={parser:n});var s,o=e.split(","),i=t.defaultValue;for(n=n||[i],s=0;s<o.length;s++)t.prefix=0===s&&t.prefix,t.defaultValue=n[s]||i,new ye(o[s],t)},He=g._registerPluginProp=function(e){if(!m[e]){var t=e.charAt(0).toUpperCase()+e.substr(1)+"Plugin";i(e,{parser:function(e,n,s,o,i,a,r){var c=Ie.com.greensock.plugins[t];return c?(c._cssRegister(),m[s].parse(e,n,s,o,i,a,r)):(Fe("Error: "+t+" js file not loaded."),i)}})}};(n=ye.prototype).parseComplex=function(e,t,n,s,o,i){var a,r,c,d,u,h,l=this.keyword;if(this.multi&&(_.test(n)||_.test(t)?(r=t.replace(_,"|").split("|"),c=n.replace(_,"|").split("|")):l&&(r=[t],c=[n])),c){for(d=c.length>r.length?c.length:r.length,a=0;d>a;a++)t=r[a]=r[a]||this.dflt,n=c[a]=c[a]||this.dflt,l&&(u=t.indexOf(l))!==(h=n.indexOf(l))&&(-1===h?r[a]=r[a].split(l).join(""):-1===u&&(r[a]+=" "+l));t=r.join(", "),n=c.join(", ")}return R(e,this.p,t,n,this.clrs,this.dflt,s,this.pr,o,i)},n.parse=function(e,t,n,s,i,r){return this.parseComplex(e.style,this.format(o(e,this.p,a,!1,this.dflt)),this.format(t),i,r)},s.registerSpecialProp=function(e,t,n){i(e,{parser:function(e,s,o,i,a,c){var d=new r(e,o,0,0,a,2,o,!1,n);return d.plugin=c,d.setRatio=t(e,s,i._tween,o),d},priority:n})},s.useSVGTransformAttr=!0;var w,ge="scaleX,scaleY,scaleZ,x,y,z,skewX,skewY,rotation,rotationX,rotationY,perspective,xPercent,yPercent".split(","),l=P("transform"),J=Me+"transform",z=P("transformOrigin"),p=null!==P("perspective"),X=g.Transform=function(){this.perspective=parseFloat(s.defaultTransformPerspective)||0,this.force3D=!1!==s.defaultForce3D&&!!p&&(s.defaultForce3D||"auto")},De=_gsScope.SVGElement,we=function(e,t,n){var s,o=v.createElementNS("http://www.w3.org/2000/svg",e),i=/([a-z])([A-Z])/g;for(s in n)o.setAttributeNS(null,s.replace(i,"$1-$2").toLowerCase(),n[s]);return t.appendChild(o),o},S=v.documentElement||{},Le=function(){var e,t,s,n=A||/Android/i.test(y)&&!_gsScope.chrome;return v.createElementNS&&!n&&(t=we("svg",S),s=(e=we("rect",t,{width:100,height:50,x:100})).getBoundingClientRect().width,e.style[z]="50% 50%",e.style[l]="scaleX(0.5)",n=s===e.getBoundingClientRect().width&&!(le&&p),S.removeChild(t)),n}(),Z=function(e,t,n,o,i,a){var r,d,u,h,m,f,p,g,v,b,j,y,_,w,l=e._gsTransform,c=Y(e,!0);l&&(_=l.xOrigin,w=l.yOrigin),(!o||(u=o.split(" ")).length<2)&&(0===(r=e.getBBox()).x&&0===r.y&&r.width+r.height===0&&(r={x:parseFloat(e.hasAttribute("x")?e.getAttribute("x"):e.hasAttribute("cx")?e.getAttribute("cx"):0)||0,y:parseFloat(e.hasAttribute("y")?e.getAttribute("y"):e.hasAttribute("cy")?e.getAttribute("cy"):0)||0,width:0,height:0}),u=[(-1!==(t=C(t).split(" "))[0].indexOf("%")?parseFloat(t[0])/100*r.width:parseFloat(t[0]))+r.x,(-1!==t[1].indexOf("%")?parseFloat(t[1])/100*r.height:parseFloat(t[1]))+r.y]),n.xOrigin=f=parseFloat(u[0]),n.yOrigin=p=parseFloat(u[1]),o&&c!==ne&&(b=c[0],r=c[1],v=c[2],g=c[3],y=c[4],j=c[5],(d=b*g-r*v)&&(h=f*(g/d)+p*(-v/d)+(v*j-g*y)/d,m=f*(-r/d)+p*(b/d)-(b*j-r*y)/d,f=n.xOrigin=u[0]=h,p=n.yOrigin=u[1]=m)),l&&(a&&(n.xOffset=l.xOffset,n.yOffset=l.yOffset,l=n),i||!1!==i&&!1!==s.defaultSmoothOrigin?(h=f-_,m=p-w,l.xOffset+=h*c[0]+m*c[2]-h,l.yOffset+=h*c[1]+m*c[3]-m):l.xOffset=l.yOffset=0),a||e.setAttribute("data-svg-origin",u.join(" "))},Ee=function(e){var t,n=$("svg",this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),s=this.parentNode,o=this.nextSibling,i=this.style.cssText;if(S.appendChild(n),n.appendChild(this),this.style.display="block",e)try{t=this.getBBox(),this._originalGetBBox=this.getBBox,this.getBBox=Ee}catch{}else this._originalGetBBox&&(t=this._originalGetBBox());return o?s.insertBefore(this,o):s.appendChild(this),S.removeChild(n),this.style.cssText=i,t},te=function(e){return!(!(De&&e.getCTM&&function(e){try{return e.getBBox()}catch{return Ee.call(e,!0)}}(e))||e.parentNode&&!e.ownerSVGElement)},ne=[1,0,0,1,0,0],Y=function(e,t){var n,s,i,a,d,u,h=e._gsTransform||new X,m=1e5,r=e.style;if(l?n=o(e,J,null,!0):e.currentStyle&&(n=(n=e.currentStyle.filter.match(qe))&&4===n.length?[n[0].substr(4),Number(n[2].substr(4)),Number(n[1].substr(4)),n[3].substr(4),h.x||0,h.y||0].join(","):""),i=!n||"none"===n||"matrix(1, 0, 0, 1, 0, 0)"===n,!l||!(u="none"===b(e).display)&&e.parentNode||(u&&(a=r.display,r.display="block"),e.parentNode||(d=1,S.appendChild(e)),i=!(n=o(e,J,null,!0))||"none"===n||"matrix(1, 0, 0, 1, 0, 0)"===n,a?r.display=a:u&&M(r,"display"),d&&S.removeChild(e)),(h.svg||e.getCTM&&te(e))&&(i&&-1!==(r[l]+"").indexOf("matrix")&&(n=r[l],i=0),s=e.getAttribute("transform"),i&&s&&(-1!==s.indexOf("matrix")?(n=s,i=0):-1!==s.indexOf("translate")&&(n="matrix(1,0,0,1,"+s.match(/(?:-|\b)[\d\-.e]+\b/gi).join(",")+")",i=0))),i)return ne;for(s=(n||"").match(L)||[],c=s.length;--c>-1;)a=Number(s[c]),s[c]=(d=a-(a|=0))?(d*m+(0>d?-.5:.5)|0)/m+a:a;return t&&s.length>6?[s[0],s[1],s[4],s[5],s[12],s[13]]:s},D=g.getTransform=function(e,n,i,a){if(e._gsTransform&&i&&!a)return e._gsTransform;var c,R,P,I,$,U,r=i&&e._gsTransform||new X,K=r.scaleX<0,H=2e-5,E=1e5,G=p&&(parseFloat(o(e,z,n,!1,"0 0 0").split(" ")[2])||r.zOrigin)||0,Q=parseFloat(s.defaultTransformPerspective)||0;if(r.svg=!!e.getCTM&&!!te(e),r.svg&&(Z(e,o(e,z,n,!1,"50% 50%")+"",r,e.getAttribute("data-svg-origin")),w=s.useSVGTransformAttr||Le),(c=Y(e))!==ne){if(16===c.length){var d,u,O,A,S,b=c[0],v=c[1],k=c[2],J=c[3],y=c[4],g=c[5],C=c[6],q=c[7],j=c[8],m=c[9],f=c[10],B=c[12],V=c[13],N=c[14],_=c[11],h=Math.atan2(C,f);r.zOrigin&&(B=j*(N=-r.zOrigin)-c[12],V=m*N-c[13],N=f*N+r.zOrigin-c[14]),r.rotationX=h*x,h&&(S=y*(u=Math.cos(-h))+j*(d=Math.sin(-h)),A=g*u+m*d,O=C*u+f*d,j=y*-d+j*u,m=g*-d+m*u,f=C*-d+f*u,_=q*-d+_*u,y=S,g=A,C=O),h=Math.atan2(-k,f),r.rotationY=h*x,h&&(A=v*(u=Math.cos(-h))-m*(d=Math.sin(-h)),O=k*u-f*d,m=v*d+m*u,f=k*d+f*u,_=J*d+_*u,b=S=b*u-j*d,v=A,k=O),h=Math.atan2(v,b),r.rotation=h*x,h&&(S=b*(u=Math.cos(h))+v*(d=Math.sin(h)),A=y*u+g*d,O=j*u+m*d,v=v*u-b*d,g=g*u-y*d,m=m*u-j*d,b=S,y=A,j=O),r.rotationX&&Math.abs(r.rotationX)+Math.abs(r.rotation)>359.9&&(r.rotationX=r.rotation=0,r.rotationY=180-r.rotationY),h=Math.atan2(y,g),r.scaleX=(Math.sqrt(b*b+v*v+k*k)*E+.5|0)/E,r.scaleY=(Math.sqrt(g*g+C*C)*E+.5|0)/E,r.scaleZ=(Math.sqrt(j*j+m*m+f*f)*E+.5|0)/E,b/=r.scaleX,y/=r.scaleY,v/=r.scaleX,g/=r.scaleY,Math.abs(h)>H?(r.skewX=h*x,y=0,"simple"!==r.skewType&&(r.scaleY*=1/Math.cos(h))):r.skewX=0,r.perspective=_?1/(0>_?-_:_):0,r.x=B,r.y=V,r.z=N,r.svg&&(r.x-=r.xOrigin-(r.xOrigin*b-r.yOrigin*y),r.y-=r.yOrigin-(r.yOrigin*v-r.xOrigin*g))}else if(!p||a||!c.length||r.x!==c[4]||r.y!==c[5]||!r.rotationX&&!r.rotationY){var W=c.length>=6,D=W?c[0]:1,T=c[1]||0,F=c[2]||0,L=W?c[3]:1;r.x=c[4]||0,r.y=c[5]||0,$=Math.sqrt(D*D+T*T),I=Math.sqrt(L*L+F*F),P=D||T?Math.atan2(T,D)*x:r.rotation||0,U=F||L?Math.atan2(F,L)*x+P:r.skewX||0,r.scaleX=$,r.scaleY=I,r.rotation=P,r.skewX=U,p&&(r.rotationX=r.rotationY=r.z=0,r.perspective=Q,r.scaleZ=1),r.svg&&(r.x-=r.xOrigin-(r.xOrigin*D+r.yOrigin*F),r.y-=r.yOrigin-(r.xOrigin*T+r.yOrigin*L))}for(R in Math.abs(r.skewX)>90&&Math.abs(r.skewX)<270&&(K?(r.scaleX*=-1,r.skewX+=r.rotation<=0?180:-180,r.rotation+=r.rotation<=0?180:-180):(r.scaleY*=-1,r.skewX+=r.skewX<=0?180:-180)),r.zOrigin=G,r)r[R]<H&&r[R]>-H&&(r[R]=0)}return i&&(e._gsTransform=r,r.svg&&(w&&e.style[l]?t.delayedCall(.001,function(){M(e.style,l)}):!w&&e.getAttribute("transform")&&t.delayedCall(.001,function(){e.removeAttribute("transform")}))),r},$e=function(e){var h,p,j,y,E,k,t=this.data,w=-t.rotation*d,C=w+t.skewX*d,a=1e5,r=(Math.cos(w)*t.scaleX*a|0)/a,n=(Math.sin(w)*t.scaleX*a|0)/a,s=(Math.sin(C)*-t.scaleY*a|0)/a,u=(Math.cos(C)*t.scaleY*a|0)/a,g=this.t.style,b=this.t.currentStyle;if(b){j=n,n=-s,s=-j,h=b.filter,g.filter="";var o,i,l=this.t.offsetWidth,m=this.t.offsetHeight,_="absolute"!==b.position,v="progid:DXImageTransform.Microsoft.Matrix(M11="+r+", M12="+n+", M21="+s+", M22="+u,O=t.x+l*t.xPercent/100,x=t.y+m*t.yPercent/100;if(null!=t.ox&&(O+=(i=(t.oxp?l*t.ox*.01:t.ox)-l/2)-(i*r+(o=(t.oyp?m*t.oy*.01:t.oy)-m/2)*n),x+=o-(i*s+o*u)),_?v+=", Dx="+((i=l/2)-(i*r+(o=m/2)*n)+O)+", Dy="+(o-(i*s+o*u)+x)+")":v+=", sizingMethod='auto expand')",-1!==h.indexOf("DXImageTransform.Microsoft.Matrix(")?g.filter=h.replace(Ye,v):g.filter=v+" "+h,(0===e||1===e)&&1===r&&0===n&&0===s&&1===u&&(_&&-1===v.indexOf("Dx=0, Dy=0")||me.test(h)&&100!==parseFloat(RegExp.$1)||-1===h.indexOf(h.indexOf("Alpha"))&&g.removeAttribute("filter")),!_){k=8>A?1:-1;for(i=t.ieOffsetX||0,o=t.ieOffsetY||0,t.ieOffsetX=Math.round((l-((0>r?-r:r)*l+(0>n?-n:n)*m))/2+O),t.ieOffsetY=Math.round((m-((0>u?-u:u)*m+(0>s?-s:s)*l))/2+x),c=0;4>c;c++)E=(j=-1!==(y=b[p=ze[c]]).indexOf("px")?parseFloat(y):f(this.t,p,parseFloat(y),y.replace(I,""))||0)!==t[p]?2>c?-t.ieOffsetX:-t.ieOffsetY:2>c?i-t.ieOffsetX:o-t.ieOffsetY,g[p]=(t[p]=Math.round(j-E*(0===c||2===c?1:k)))+"px"}}},We=g.set3DTransformRatio=g.setTransformRatio=function(e){var n,s,i,a,r,c,m,f,g,v,y,O,x,C,E,k,F,D,N,L,R,P,$,t=this.data,B=this.t.style,o=t.rotation,I=t.rotationX,H=t.rotationY,j=t.scaleX,b=t.scaleY,_=t.scaleZ,u=t.x,h=t.y,M=t.z,T=t.svg,S=t.perspective,V=t.force3D,A=t.skewY,z=t.skewX;if(A&&(z+=A,o+=A),!((1!==e&&0!==e||"auto"!==V||this.tween._totalTime!==this.tween._totalDuration&&this.tween._totalTime)&&V||M||S||H||I||1!==_)||w&&T||!p)o||z||T?(o*=d,P=z*d,k=1e5,v=Math.cos(o)*j,m=Math.sin(o)*j,g=Math.sin(o-P)*-b,c=Math.cos(o-P)*b,P&&"simple"===t.skewType&&(s=Math.tan(P-A*d),g*=s=Math.sqrt(1+s*s),c*=s,A&&(s=Math.tan(A*d),v*=s=Math.sqrt(1+s*s),m*=s)),T&&(u+=t.xOrigin-(t.xOrigin*v+t.yOrigin*g)+t.xOffset,h+=t.yOrigin-(t.xOrigin*m+t.yOrigin*c)+t.yOffset,w&&(t.xPercent||t.yPercent)&&(n=this.t.getBBox(),u+=.01*t.xPercent*n.width,h+=.01*t.yPercent*n.height),(n=1e-6)>u&&u>-n&&(u=0),n>h&&h>-n&&(h=0)),y=(v*k|0)/k+","+(m*k|0)/k+","+(g*k|0)/k+","+(c*k|0)/k+","+u+","+h+")",T&&w?this.t.setAttribute("transform","matrix("+y):B[l]=(t.xPercent||t.yPercent?"translate("+t.xPercent+"%,"+t.yPercent+"%) matrix(":"matrix(")+y):B[l]=(t.xPercent||t.yPercent?"translate("+t.xPercent+"%,"+t.yPercent+"%) matrix(":"matrix(")+j+",0,0,"+b+","+u+","+h+")";else{if(le&&((n=1e-4)>j&&j>-n&&(j=_=2e-5),n>b&&b>-n&&(b=_=2e-5),!S||t.z||t.rotationX||t.rotationY||(S=0)),o||z)o*=d,a=v=Math.cos(o),f=m=Math.sin(o),z&&(o-=z*d,a=Math.cos(o),f=Math.sin(o),"simple"===t.skewType&&(s=Math.tan((z-A)*d),a*=s=Math.sqrt(1+s*s),f*=s,t.skewY&&(s=Math.tan(A*d),v*=s=Math.sqrt(1+s*s),m*=s))),g=-f,c=a;else{if(!(H||I||1!==_||S||T))return void(B[l]=(t.xPercent||t.yPercent?"translate("+t.xPercent+"%,"+t.yPercent+"%) translate3d(":"translate3d(")+u+"px,"+h+"px,"+M+"px)"+(1!==j||1!==b?" scale("+j+","+b+")":""));v=c=1,g=m=0}C=1,x=O=R=L=N=D=0,E=S?-1/S:0,F=t.zOrigin,n=1e-6,i=",",r="0",(o=H*d)&&(a=Math.cos(o),R=-(f=Math.sin(o)),N=E*-f,x=v*f,O=m*f,C=a,E*=a,v*=a,m*=a),(o=I*d)&&(s=g*(a=Math.cos(o))+x*(f=Math.sin(o)),$=c*a+O*f,L=C*f,D=E*f,x=g*-f+x*a,O=c*-f+O*a,C*=a,E*=a,g=s,c=$),1!==_&&(x*=_,O*=_,C*=_,E*=_),1!==b&&(g*=b,c*=b,L*=b,D*=b),1!==j&&(v*=j,m*=j,R*=j,N*=j),(F||T)&&(F&&(u+=x*-F,h+=O*-F,M+=C*-F+F),T&&(u+=t.xOrigin-(t.xOrigin*v+t.yOrigin*g)+t.xOffset,h+=t.yOrigin-(t.xOrigin*m+t.yOrigin*c)+t.yOffset),n>u&&u>-n&&(u=r),n>h&&h>-n&&(h=r),n>M&&M>-n&&(M=0)),y=t.xPercent||t.yPercent?"translate("+t.xPercent+"%,"+t.yPercent+"%) matrix3d(":"matrix3d(",y+=(n>v&&v>-n?r:v)+i+(n>m&&m>-n?r:m)+i+(n>R&&R>-n?r:R),y+=i+(n>N&&N>-n?r:N)+i+(n>g&&g>-n?r:g)+i+(n>c&&c>-n?r:c),I||H||1!==_?(y+=i+(n>L&&L>-n?r:L)+i+(n>D&&D>-n?r:D)+i+(n>x&&x>-n?r:x),y+=i+(n>O&&O>-n?r:O)+i+(n>C&&C>-n?r:C)+i+(n>E&&E>-n?r:E)+i):y+=",0,0,0,0,1,0,",y+=u+i+h+i+M+i+(S?1+-M/S:1)+")",B[l]=y}};(n=X.prototype).x=n.y=n.z=n.skewX=n.skewY=n.rotation=n.rotationX=n.rotationY=n.zOrigin=n.xPercent=n.yPercent=n.xOffset=n.yOffset=0,n.scaleX=n.scaleY=n.scaleZ=1,i("transform,scale,scaleX,scaleY,scaleZ,x,y,z,rotation,rotationX,rotationY,rotationZ,skewX,skewY,shortRotation,shortRotationX,shortRotationY,shortRotationZ,transformOrigin,svgOrigin,transformPerspective,directionalRotation,parseTransform,force3D,skewType,xPercent,yPercent,smoothOrigin",{parser:function(e,t,n,i,c,u,m){if(i._lastParsedTransform===m)return c;i._lastParsedTransform=m,T=m.scale&&"function"==typeof m.scale?m.scale:0,"function"==typeof m[n]&&(I=m[n],m[n]=t),T&&(m.scale=T(O,e));var b,_,x,E,A,M,F,T,P,H,I,R=e._gsTransform,$=e.style,V=1e-6,B=ge.length,g=m,S={},L="transformOrigin",f=D(e,a,!0,g.parseTransform),y=g.transform&&("function"==typeof g.transform?g.transform(O,k):g.transform);if(f.skewType=g.skewType||f.skewType||s.defaultSkewType,i._transform=f,y&&"string"==typeof y&&l)(x=j.style)[l]=y,x.display="block",x.position="absolute",v.body.appendChild(j),b=D(j,null,!1),"simple"===f.skewType&&(b.scaleY*=Math.cos(b.skewX*d)),f.svg&&(E=f.xOrigin,A=f.yOrigin,b.x-=f.xOffset,b.y-=f.yOffset,(g.transformOrigin||g.svgOrigin)&&(y={},Z(e,C(g.transformOrigin),y,g.svgOrigin,g.smoothOrigin,!0),E=y.xOrigin,A=y.yOrigin,b.x-=y.xOffset-f.xOffset,b.y-=y.yOffset-f.yOffset),(E||A)&&(F=Y(j,!0),b.x-=E-(E*F[0]+A*F[2]),b.y-=A-(E*F[1]+A*F[3]))),v.body.removeChild(j),b.perspective||(b.perspective=f.perspective),null!=g.xPercent&&(b.xPercent=h(g.xPercent,f.xPercent)),null!=g.yPercent&&(b.yPercent=h(g.yPercent,f.yPercent));else if("object"==typeof g){if(b={scaleX:h(null!=g.scaleX?g.scaleX:g.scale,f.scaleX),scaleY:h(null!=g.scaleY?g.scaleY:g.scale,f.scaleY),scaleZ:h(g.scaleZ,f.scaleZ),x:h(g.x,f.x),y:h(g.y,f.y),z:h(g.z,f.z),xPercent:h(g.xPercent,f.xPercent),yPercent:h(g.yPercent,f.yPercent),perspective:h(g.transformPerspective,f.perspective)},null!=(M=g.directionalRotation))if("object"==typeof M)for(x in M)g[x]=M[x];else g.rotation=M;"string"==typeof g.x&&-1!==g.x.indexOf("%")&&(b.x=0,b.xPercent=h(g.x,f.xPercent)),"string"==typeof g.y&&-1!==g.y.indexOf("%")&&(b.y=0,b.yPercent=h(g.y,f.yPercent)),b.rotation=N("rotation"in g?g.rotation:"shortRotation"in g?g.shortRotation+"_short":"rotationZ"in g?g.rotationZ:f.rotation,f.rotation,"rotation",S),p&&(b.rotationX=N("rotationX"in g?g.rotationX:"shortRotationX"in g?g.shortRotationX+"_short":f.rotationX||0,f.rotationX,"rotationX",S),b.rotationY=N("rotationY"in g?g.rotationY:"shortRotationY"in g?g.shortRotationY+"_short":f.rotationY||0,f.rotationY,"rotationY",S)),b.skewX=N(g.skewX,f.skewX),b.skewY=N(g.skewY,f.skewY)}for(p&&null!=g.force3D&&(f.force3D=g.force3D,P=!0),(H=f.force3D||f.z||f.rotationX||f.rotationY||b.z||b.rotationX||b.rotationY||b.perspective)||null==g.scale||(b.scaleZ=1);--B>-1;)((y=b[_=ge[B]]-f[_])>V||-V>y||null!=g[_]||null!=W[_])&&(P=!0,c=new r(f,_,f[_],y,c),_ in S&&(c.e=S[_]),c.xs0=0,c.plugin=u,i._overwriteProps.push(c.n));return y=g.transformOrigin,f.svg&&(y||g.svgOrigin)&&(E=f.xOffset,A=f.yOffset,Z(e,C(y),b,g.svgOrigin,g.smoothOrigin),c=K(f,"xOrigin",(R?f:b).xOrigin,b.xOrigin,c,L),c=K(f,"yOrigin",(R?f:b).yOrigin,b.yOrigin,c,L),(E!==f.xOffset||A!==f.yOffset)&&(c=K(f,"xOffset",R?E:f.xOffset,f.xOffset,c,L),c=K(f,"yOffset",R?A:f.yOffset,f.yOffset,c,L)),y="0px 0px"),(y||p&&H&&f.zOrigin)&&(l?(P=!0,_=z,y=(y||o(e,_,a,!1,"50% 50%"))+"",(c=new r($,_,0,0,c,-1,L)).b=$[_],c.plugin=u,p?(x=f.zOrigin,y=y.split(" "),f.zOrigin=(y.length>2&&(0===x||"0px"!==y[2])?parseFloat(y[2]):x)||0,c.xs0=c.e=y[0]+" "+(y[1]||"50%")+" 0px",(c=new r(f,"zOrigin",0,0,c,-1,c.n)).b=x,c.xs0=c.e=f.zOrigin):c.xs0=c.e=y):C(y+"",f)),P&&(i._transformType=f.svg&&w||!H&&3!==this._transformType?2:3),I&&(m[n]=I),T&&(m.scale=T),c},prefix:!0}),i("boxShadow",{defaultValue:"0px 0px 0px 0px #999",prefix:!0,color:!0,multi:!0,keyword:"inset"}),i("borderRadius",{defaultValue:"0px",parser:function(e,t,n,s,i){t=this.format(t);var c,l,d,u,h,m,g,v,b,j,y,_,w,O,x,C,p=["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],E=e.style;for(_=parseFloat(e.offsetWidth),O=parseFloat(e.offsetHeight),C=t.split(" "),h=0;h<p.length;h++)this.p.indexOf("border")&&(p[h]=P(p[h])),-1!==(d=l=o(e,p[h],a,!1,"0px")).indexOf(" ")&&(l=d.split(" "),d=l[0],l=l[1]),c=y=C[h],b=parseFloat(d),g=d.substr((b+"").length),(w="="===c.charAt(1))?(m=parseInt(c.charAt(0)+"1",10),c=c.substr(2),m*=parseFloat(c),u=c.substr((m+"").length-(0>m?1:0))||""):(m=parseFloat(c),u=c.substr((m+"").length)),""===u&&(u=U[n]||g),u!==g&&(v=f(e,"borderLeft",b,g),j=f(e,"borderTop",b,g),"%"===u?(d=v/_*100+"%",l=j/O*100+"%"):"em"===u?(d=v/(x=f(e,"borderLeft",1,"em"))+"em",l=j/x+"em"):(d=v+"px",l=j+"px"),w&&(c=parseFloat(d)+m+u,y=parseFloat(l)+m+u)),i=R(E,p[h],d+" "+l,c+" "+y,!1,"0px",i);return i},prefix:!0,formatter:de("0px 0px 0px 0px",!1,!0)}),i("borderBottomLeftRadius,borderBottomRightRadius,borderTopLeftRadius,borderTopRightRadius",{defaultValue:"0px",parser:function(e,t,n,s,i){return R(e.style,n,this.format(o(e,n,a,!1,"0px 0px")),this.format(t),!1,"0px",i)},prefix:!0,formatter:de("0px 0px",!1,!0)}),i("backgroundPosition",{defaultValue:"0 0",parser:function(e,t,n,s,i,r){var l,d,m,f,g,v,p="background-position",u=a||b(e,null),c=this.format((u?A?u.getPropertyValue(p+"-x")+" "+u.getPropertyValue(p+"-y"):u.getPropertyValue(p):e.currentStyle.backgroundPositionX+" "+e.currentStyle.backgroundPositionY)||"0 0"),h=this.format(t);if(-1!==c.indexOf("%")!=(-1!==h.indexOf("%"))&&h.split(",").length<2&&(f=o(e,"backgroundImage").replace(Be,""))&&"none"!==f){for(d=c.split(" "),g=h.split(" "),ie.setAttribute("src",f),l=2;--l>-1;)(v=-1!==(c=d[l]).indexOf("%"))!==(-1!==g[l].indexOf("%"))&&(m=0===l?e.offsetWidth-ie.width:e.offsetHeight-ie.height,d[l]=v?parseFloat(c)/100*m+"px":parseFloat(c)/m*100+"%");c=d.join(" ")}return this.parseComplex(e.style,c,h,i,r)},formatter:C}),i("backgroundSize",{defaultValue:"0 0",formatter:function(e){return C(-1===(e+="").indexOf(" ")?e+" "+e:e)}}),i("perspective",{defaultValue:"0px",prefix:!0}),i("perspectiveOrigin",{defaultValue:"50% 50%",prefix:!0}),i("transformStyle",{prefix:!0}),i("backfaceVisibility",{prefix:!0}),i("userSelect",{prefix:!0}),i("margin",{parser:ce("marginTop,marginRight,marginBottom,marginLeft")}),i("padding",{parser:ce("paddingTop,paddingRight,paddingBottom,paddingLeft")}),i("clip",{defaultValue:"rect(0px,0px,0px,0px)",parser:function(e,t,n,s,i,r){var c,l,d;return 9>A?(c=e.currentStyle,l=8>A?" ":",",d="rect("+c.clipTop+l+c.clipRight+l+c.clipBottom+l+c.clipLeft+")",t=this.format(t).split(",").join(l)):(d=this.format(o(e,this.p,a,!1,this.dflt)),t=this.format(t)),this.parseComplex(e.style,d,t,i,r)}}),i("textShadow",{defaultValue:"0px 0px 0px #999",color:!0,multi:!0}),i("autoRound,strictUnits",{parser:function(e,t,n,s,o){return o}}),i("border",{defaultValue:"0px solid #000",parser:function(e,t,n,s,i,r){var c=o(e,"borderTopWidth",a,!1,"0px"),d=this.format(t).split(" "),l=d[0].replace(I,"");return"px"!==l&&(c=parseFloat(c)/f(e,"borderTopWidth",1,l)+l),this.parseComplex(e.style,this.format(c+" "+o(e,"borderTopStyle",a,!1,"solid")+" "+o(e,"borderTopColor",a,!1,"#000")),d.join(" "),i,r)},color:!0,formatter:function(e){var t=e.split(" ");return t[0]+" "+(t[1]||"solid")+" "+(e.match(u)||["#000"])[0]}}),i("borderWidth",{parser:ce("borderTopWidth,borderRightWidth,borderBottomWidth,borderLeftWidth")}),i("float,cssFloat,styleFloat",{parser:function(e,t,n,s,o){var a=e.style,c="cssFloat"in a?"cssFloat":"styleFloat";return new r(a,c,0,0,o,-1,n,!1,0,a[c],t)}}),Te=function(e){var i,n=this.t,t=n.filter||o(this.data,"filter")||"",s=this.s+this.c*e|0;100===s&&(-1===t.indexOf("atrix(")&&-1===t.indexOf("radient(")&&-1===t.indexOf("oader(")?(n.removeAttribute("filter"),i=!o(this.data,"filter")):(n.filter=t.replace(Re,""),i=!0)),i||(this.xn1&&(n.filter=t=t||"alpha(opacity="+s+")"),-1===t.indexOf("pacity")?0===s&&this.xn1||(n.filter=t+" alpha(opacity="+s+")"):n.filter=t.replace(me,"opacity="+s))},i("opacity,alpha,autoAlpha",{defaultValue:"1",parser:function(e,t,n,s,i,c){var l=parseFloat(o(e,"opacity",a,!1,"1")),d=e.style,u="autoAlpha"===n;return"string"==typeof t&&"="===t.charAt(1)&&(t=("-"===t.charAt(0)?-1:1)*parseFloat(t.substr(2))+l),u&&1===l&&"hidden"===o(e,"visibility",a)&&0!==t&&(l=0),E?i=new r(d,"opacity",l,t-l,i):((i=new r(d,"opacity",100*l,100*(t-l),i)).xn1=u?1:0,d.zoom=1,i.type=2,i.b="alpha(opacity="+i.s+")",i.e="alpha(opacity="+(i.s+i.c)+")",i.data=e,i.plugin=c,i.setRatio=Te),u&&((i=new r(d,"visibility",0,0,i,-1,null,!1,0,0!==l?"inherit":"hidden",0===t?"hidden":"inherit")).xs0="inherit",s._overwriteProps.push(i.n),s._overwriteProps.push(n)),i}}),M=function(e,t){t&&(e.removeProperty?(("ms"===t.substr(0,2)||"webkit"===t.substr(0,6))&&(t="-"+t),e.removeProperty(t.replace(pe,"-$1").toLowerCase())):e.removeAttribute(t))},Ce=function(e){if(this.t._gsClassPT=this,1===e||0===e){this.t.setAttribute("class",0===e?this.b:this.e);for(var t=this.data,n=this.t.style;t;)t.v?n[t.p]=t.v:M(n,t.p),t=t._next;1===e&&this.t._gsClassPT===this&&(this.t._gsClassPT=null)}else this.t.getAttribute("class")!==this.e&&this.t.setAttribute("class",this.e)},i("className",{parser:function(e,t,n,s,o,i,c){var l,d,u,h,f,m=e.getAttribute("class")||"",p=e.style.cssText;if((o=s._classNamePT=new r(e,n,0,0,o,2)).setRatio=Ce,o.pr=-11,F=!0,o.b=m,f=T(e,a),u=e._gsClassPT){for(h={},l=u.data;l;)h[l.p]=1,l=l._next;u.setRatio(1)}return e._gsClassPT=o,o.e="="!==t.charAt(1)?t:m.replace(new RegExp("(?:\\s|^)"+t.substr(2)+"(?![\\w-])"),"")+("+"===t.charAt(0)?" "+t.substr(2):""),e.setAttribute("class",o.e),d=se(e,f,T(e),c,h),e.setAttribute("class",m),o.data=d.firstMPT,e.style.cssText=p,o.xfirst=s.parse(e,d.difs,o,i)}}),Se=function(e){if((1===e||0===e)&&this.data._totalTime===this.data._totalDuration&&"isFromStart"!==this.data.data){var t,n,s,i,a,o=this.t.style,r=m.transform.parse;if("all"===this.e)o.cssText="",s=!0;else for(n=(i=this.e.split(" ").join("").split(",")).length;--n>-1;)t=i[n],m[t]&&(m[t].parse===r?s=!0:t="transformOrigin"===t?z:m[t].p),M(o,t);s&&(M(o,l),(a=this.t._gsTransform)&&(a.svg&&(this.t.removeAttribute("data-svg-origin"),this.t.removeAttribute("transform")),delete this.t._gsTransform))}};for(i("clearProps",{parser:function(e,t,n,s,o){return(o=new r(e,n,0,0,o,2)).setRatio=Se,o.e=t,o.pr=-10,o.data=s._tween,F=!0,o}}),n="bezier,throwProps,physicsProps,physics2D".split(","),c=n.length;c--;)He(n[c]);return(n=s.prototype)._firstPT=n._lastParsedTransform=n._transform=null,n._onInitTween=function(e,t,n,i){if(!e.nodeType)return!1;this._target=k=e,this._tween=n,this._vars=t,O=i,G=t.autoRound,F=!1,U=t.suffixMap||s.suffixMap,a=b(e,""),ee=this._overwriteProps;var c,d,h,f,p,g,v,j,y,u=e.style;if(je&&""===u.zIndex&&("auto"===(h=o(e,"zIndex",a))||""===h)&&this._addLazySet(u,"zIndex",0),"string"==typeof t&&(f=u.cssText,h=T(e,a),u.cssText=f+";"+t,h=se(e,h,T(e)).difs,!E&&Ne.test(t)&&(h.opacity=parseFloat(RegExp.$1)),t=h,u.cssText=f),t.className?this._firstPT=d=m.className.parse(e,t.className,"className",this,null,null,t):this._firstPT=d=this.parse(e,t,null),this._transformType){for(y=3===this._transformType,l?ue&&(je=!0,""===u.zIndex&&("auto"===(j=o(e,"zIndex",a))||""===j)&&this._addLazySet(u,"zIndex",0),Ae&&this._addLazySet(u,"WebkitBackfaceVisibility",this._vars.WebkitBackfaceVisibility||(y?"visible":"hidden"))):u.zoom=1,c=d;c&&c._next;)c=c._next;p=new r(e,"transform",0,0,null,2),this._linkCSSP(p,null,c),p.setRatio=l?We:$e,p.data=this._transform||D(e,a,!0),p.tween=n,p.pr=-1,ee.pop()}if(F){for(;d;){for(v=d._next,c=f;c&&c.pr>d.pr;)c=c._next;(d._prev=c?c._prev:g)?d._prev._next=d:f=d,(d._next=c)?c._prev=d:g=d,d=v}this._firstPT=f}return!0},n.parse=function(e,t,n,s){var i,c,l,d,u,h,p,g,j,y,v=e.style;for(i in t){if("function"==typeof(c=t[i])&&(c=c(O,k)),y=m[i])n=y.parse(e,c,i,this,n,s,t);else{if("--"===i.substr(0,2)){this._tween._propLookup[i]=this._addTween.call(this._tween,e.style,"setProperty",b(e).getPropertyValue(i)+"",c+"",i,!1,i);continue}h=o(e,i,a)+"",g="string"==typeof c,"color"===i||"fill"===i||"stroke"===i||-1!==i.indexOf("Color")||g&&Pe.test(c)?(g||(c=((c=q(c)).length>3?"rgba(":"rgb(")+c.join(",")+")"),n=R(v,i,h,c,!0,"transparent",n,0,s)):g&&Ge.test(c)?n=R(v,i,h,c,!0,null,n,0,s):(p=(l=parseFloat(h))||0===l?h.substr((l+"").length):"",(""===h||"auto"===h)&&("width"===i||"height"===i?(l=Ue(e,i,a),p="px"):"left"===i||"top"===i?(l=xe(e,i,a),p="px"):(l="opacity"!==i?0:1,p="")),(j=g&&"="===c.charAt(1))?(d=parseInt(c.charAt(0)+"1",10),c=c.substr(2),d*=parseFloat(c),u=c.replace(I,"")):(d=parseFloat(c),u=g?c.replace(I,""):""),""===u&&(u=i in U?U[i]:p),c=d||0===d?(j?d+l:d)+u:t[i],p!==u&&(""!==u||"lineHeight"===i)&&(d||0===d)&&l&&(l=f(e,i,l,p),"%"===u?(l/=f(e,i,100,"%")/100,!0!==t.strictUnits&&(h=l+"%")):"em"===u||"rem"===u||"vw"===u||"vh"===u?l/=f(e,i,1,u):"px"!==u&&(d=f(e,i,d,u),u="px"),j&&(d||0===d)&&(c=d+l+u)),j&&(d+=l),!l&&0!==l||!d&&0!==d?void 0!==v[i]&&(c||c+""!="NaN"&&c!=null)?(n=new r(v,i,d||l||0,0,n,-1,i,!1,0,h,c)).xs0="none"!==c||"display"!==i&&-1===i.indexOf("Style")?c:h:Fe("invalid "+i+" tween value: "+t[i]):(n=new r(v,i,l,d-l,n,0,i,!1!==G&&("px"===u||"zIndex"===i),0,h,c)).xs0=u)}s&&n&&!n.plugin&&(n.plugin=s)}return n},n.setRatio=function(e){var n,s,o,t=this._firstPT,i=1e-6;if(1!==e||this._tween._time!==this._tween._duration&&0!==this._tween._time)if(e||this._tween._time!==this._tween._duration&&0!==this._tween._time||-1e-6===this._tween._rawPrevTime)for(;t;){if(n=t.c*e+t.s,t.r?n=Math.round(n):i>n&&n>-i&&(n=0),t.type)if(1===t.type)if(2===(s=t.l))t.t[t.p]=t.xs0+n+t.xs1+t.xn1+t.xs2;else if(3===s)t.t[t.p]=t.xs0+n+t.xs1+t.xn1+t.xs2+t.xn2+t.xs3;else if(4===s)t.t[t.p]=t.xs0+n+t.xs1+t.xn1+t.xs2+t.xn2+t.xs3+t.xn3+t.xs4;else if(5===s)t.t[t.p]=t.xs0+n+t.xs1+t.xn1+t.xs2+t.xn2+t.xs3+t.xn3+t.xs4+t.xn4+t.xs5;else{for(o=t.xs0+n+t.xs1,s=1;s<t.l;s++)o+=t["xn"+s]+t["xs"+(s+1)];t.t[t.p]=o}else-1===t.type?t.t[t.p]=t.xs0:t.setRatio&&t.setRatio(e);else t.t[t.p]=n+t.xs0;t=t._next}else for(;t;)2!==t.type?t.t[t.p]=t.b:t.setRatio(e),t=t._next;else for(;t;){if(2!==t.type)if(t.r&&-1!==t.type)if(n=Math.round(t.s+t.c),t.type){if(1===t.type){for(s=t.l,o=t.xs0+n+t.xs1,s=1;s<t.l;s++)o+=t["xn"+s]+t["xs"+(s+1)];t.t[t.p]=o}}else t.t[t.p]=n+t.xs0;else t.t[t.p]=t.e;else t.setRatio(e);t=t._next}},n._enableTransforms=function(e){this._transform=this._transform||D(this._target,a,!0),this._transformType=this._transform.svg&&w||!e&&3!==this._transformType?2:3},fe=function(){this.t[this.p]=this.e,this.data._linkCSSP(this,this._next,null,!0)},n._addLazySet=function(e,t,n){var s=this._firstPT=new r(e,t,0,0,this._firstPT,2);s.e=n,s.setRatio=fe,s.data=this},n._linkCSSP=function(e,t,n,s){return e&&(t&&(t._prev=e),e._next&&(e._next._prev=e._prev),e._prev?e._prev._next=e._next:this._firstPT===e&&(this._firstPT=e._next,s=!0),n?n._next=e:s||null!==this._firstPT||(this._firstPT=e),e._next=t,e._prev=n),e},n._mod=function(e){for(var t=this._firstPT;t;)"function"==typeof e[t.p]&&e[t.p]===Math.round&&(t.r=1),t=t._next},n._kill=function(t){var n,s,i,o=t;if(t.autoAlpha||t.alpha){for(i in o={},t)o[i]=t[i];o.opacity=1,o.autoAlpha&&(o.visibility=1)}for(t.className&&(n=this._classNamePT)&&((s=n.xfirst)&&s._prev?this._linkCSSP(s._prev,n._next,s._prev._prev):s===this._firstPT&&(this._firstPT=n._next),n._next&&this._linkCSSP(n._next,n._next._next,s._prev),this._classNamePT=null),n=this._firstPT;n;)n.plugin&&n.plugin!==i&&n.plugin._kill&&(n.plugin._kill(t),i=n.plugin),n=n._next;return e.prototype._kill.call(this,o)},V=function(e,t,n){var s,o,i,a;if(e.slice)for(s=e.length;--s>-1;)V(e[s],t,n);else for(s=(a=e.childNodes).length;--s>-1;)i=(o=a[s]).type,o.style&&(t.push(T(o)),n&&n.push(o)),1!==i&&9!==i&&11!==i||!o.childNodes.length||V(o,t,n)},s.cascadeTo=function(e,n,s){var o,i,a,l,r=t.to(e,n,s),u=[r],d=[],h=[],c=[],m=t._internals.reservedProps;for(e=r._targets||r.target,V(e,d,c),r.render(n,!0,!0),V(e,h),r.render(0,!0,!0),r._enabled(!0),o=c.length;--o>-1;)if((a=se(c[o],d[o],h[o])).firstMPT){for(i in a=a.difs,s)m[i]&&(a[i]=s[i]);for(i in l={},a)l[i]=d[o][i];u.push(t.fromTo(c[o],n,l,a))}return u},e.activate([s]),s},!0),function(){var t=_gsScope._gsDefine.plugin({propName:"roundProps",version:"1.6.0",priority:-1,API:2,init:function(e,t,n){return this._tween=n,!0}}),n=function(e){for(;e;)e.f||e.blob||(e.m=Math.round),e=e._next},e=t.prototype;e._onInitAllProps=function(){for(var e,s,i,t=this._tween,a=t.vars.roundProps.join?t.vars.roundProps:t.vars.roundProps.split(","),o=a.length,r={},c=t._propLookup.roundProps;--o>-1;)r[a[o]]=Math.round;for(o=a.length;--o>-1;)for(i=a[o],e=t._firstPT;e;)s=e._next,e.pg?e.t._mod(r):e.n===i&&(2===e.f&&e.t?n(e.t._firstPT):(this._add(e.t,i,e.s,e.c),s&&(s._prev=e._prev),e._prev?e._prev._next=s:t._firstPT===e&&(t._firstPT=s),e._next=e._prev=null,t._propLookup[i]=c)),e=s;return!1},e._add=function(e,t,n,s){this._addTween(e,t,n,n+s,t,Math.round),this._overwriteProps.push(t)}}(),_gsScope._gsDefine.plugin({propName:"attr",API:2,version:"0.6.1",init:function(e,t,n,s){var o,i;if("function"!=typeof e.setAttribute)return!1;for(o in t)"function"==typeof(i=t[o])&&(i=i(s,e)),this._addTween(e,"setAttribute",e.getAttribute(o)+"",i+"",o,!1,o),this._overwriteProps.push(o);return!0}}),_gsScope._gsDefine.plugin({propName:"directionalRotation",version:"0.3.1",API:2,init:function(e,t,n,s){"object"!=typeof t&&(t={rotation:t}),this.finals={};var o,i,r,c,l,d,a=!0===t.useRadians?2*Math.PI:360,u=1e-6;for(i in t)"useRadians"!==i&&("function"==typeof(l=t[i])&&(l=l(s,e)),r=(d=(l+"").split("_"))[0],c=parseFloat("function"!=typeof e[i]?e[i]:e[i.indexOf("set")||"function"!=typeof e["get"+i.substr(3)]?i:"get"+i.substr(3)]()),o=(l=this.finals[i]="string"==typeof r&&"="===r.charAt(1)?c+parseInt(r.charAt(0)+"1",10)*Number(r.substr(2)):Number(r)||0)-c,d.length&&(-1!==(r=d.join("_")).indexOf("short")&&(o%=a)!==o%(a/2)&&(o=0>o?o+a:o-a),-1!==r.indexOf("_cw")&&0>o?o=(o+9999999999*a)%a-(o/a|0)*a:-1!==r.indexOf("ccw")&&o>0&&(o=(o-9999999999*a)%a-(o/a|0)*a)),(o>u||-u>o)&&(this._addTween(e,i,c,c+o,i),this._overwriteProps.push(i)));return!0},set:function(e){var t;if(1!==e)this._super.setRatio.call(this,e);else for(t=this._firstPT;t;)t.f?t.t[t.p](this.finals[t.p]):t.t[t.p]=this.finals[t.p],t=t._next}})._autoCSS=!0,_gsScope._gsDefine("easing.Back",["easing.Ease"],function(e){var o,a,l,f=_gsScope.GreenSockGlobals||_gsScope,g=f.com.greensock,m=2*Math.PI,h=Math.PI/2,s=g._class,t=function(t,n){var o=s("easing."+t,function(){},!0),i=o.prototype=new e;return i.constructor=o,i.getRatio=n,o},c=e.register||function(){},r=function(e,t,n,o){var a=s("easing."+e,{easeOut:new t,easeIn:new n,easeInOut:new o},!0);return c(a,e),a},u=function(e,t,n){this.t=e,this.v=t,n&&(this.next=n,n.prev=this,this.c=n.v-t,this.gap=n.t-e)},d=function(t,n){var o=s("easing."+t,function(e){this._p1=e||0===e?e:1.70158,this._p2=1.525*this._p1},!0),i=o.prototype=new e;return i.constructor=o,i.getRatio=n,i.config=function(e){return new o(e)},o},p=r("Back",d("BackOut",function(e){return(e-=1)*e*((this._p1+1)*e+this._p1)+1}),d("BackIn",function(e){return e*e*((this._p1+1)*e-this._p1)}),d("BackInOut",function(e){return(e*=2)<1?.5*e*e*((this._p2+1)*e-this._p2):.5*((e-=2)*e*((this._p2+1)*e+this._p2)+2)})),i=s("easing.SlowMo",function(e,t,n){t=t||0===t?t:.7,e==null?e=.7:e>1&&(e=1),this._p=1!==e?t:0,this._p1=(1-e)/2,this._p2=e,this._p3=this._p1+this._p2,this._calcEnd=!0===n},!0),n=i.prototype=new e;return n.constructor=i,n.getRatio=function(e){var t=e+(.5-e)*this._p;return e<this._p1?this._calcEnd?1-(e=1-e/this._p1)*e:t-(e=1-e/this._p1)*e*e*e*t:e>this._p3?this._calcEnd?1-(e=(e-this._p3)/this._p1)*e:t+(e-t)*(e=(e-this._p3)/this._p1)*e*e*e:this._calcEnd?1:t},i.ease=new i(.7,.7),n.config=i.config=function(e,t,n){return new i(e,t,n)},a=s("easing.SteppedEase",function(e,t){e=e||1,this._p1=1/e,this._p2=e+(t?0:1),this._p3=t?1:0},!0),(n=a.prototype=new e).constructor=a,n.getRatio=function(e){return 0>e?e=0:e>=1&&(e=.999999999),((this._p2*e|0)+this._p3)*this._p1},n.config=a.config=function(e,t){return new a(e,t)},o=s("easing.RoughEase",function(t){for(var n,s,o,a,r,m,l=(t=t||{}).taper||"none",h=[],g=0,d=0|(t.points||20),i=d,f=!1!==t.randomize,v=!0===t.clamp,p=t.template instanceof e?t.template:null,c="number"==typeof t.strength?.4*t.strength:.4;--i>-1;)n=f?Math.random():1/d*i,s=p?p.getRatio(n):n,"none"===l?o=c:"out"===l?o=(a=1-n)*a*c:"in"===l?o=n*n*c:.5>n?o=(a=2*n)*a*.5*c:o=(a=2*(1-n))*a*.5*c,f?s+=Math.random()*o-.5*o:i%2?s+=.5*o:s-=.5*o,v&&(s>1?s=1:0>s&&(s=0)),h[g++]={x:n,y:s};for(h.sort(function(e,t){return e.x-t.x}),r=new u(1,1,null),i=d;--i>-1;)m=h[i],r=new u(m.x,m.y,r);this._prev=new u(0,0,0!==r.t?r:r.next)},!0),(n=o.prototype=new e).constructor=o,n.getRatio=function(e){var t=this._prev;if(e>t.t){for(;t.next&&e>=t.t;)t=t.next;t=t.prev}else for(;t.prev&&e<=t.t;)t=t.prev;return this._prev=t,t.v+(e-t.t)/t.gap*t.c},n.config=function(e){return new o(e)},o.ease=new o,r("Bounce",t("BounceOut",function(e){return 1/2.75>e?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}),t("BounceIn",function(e){return(e=1-e)<1/2.75?1-7.5625*e*e:2/2.75>e?1-(7.5625*(e-=1.5/2.75)*e+.75):2.5/2.75>e?1-(7.5625*(e-=2.25/2.75)*e+.9375):1-(7.5625*(e-=2.625/2.75)*e+.984375)}),t("BounceInOut",function(e){var t=.5>e;return e=1/2.75>(e=t?1-2*e:2*e-1)?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375,t?.5*(1-e):.5*e+.5})),r("Circ",t("CircOut",function(e){return Math.sqrt(1-(e-=1)*e)}),t("CircIn",function(e){return-(Math.sqrt(1-e*e)-1)}),t("CircInOut",function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)})),l=function(t,n,o){var i=s("easing."+t,function(e,t){this._p1=e>=1?e:1,this._p2=(t||o)/(1>e?e:1),this._p3=this._p2/m*(Math.asin(1/this._p1)||0),this._p2=m/this._p2},!0),a=i.prototype=new e;return a.constructor=i,a.getRatio=n,a.config=function(e,t){return new i(e,t)},i},r("Elastic",l("ElasticOut",function(e){return this._p1*Math.pow(2,-10*e)*Math.sin((e-this._p3)*this._p2)+1},.3),l("ElasticIn",function(e){return-this._p1*Math.pow(2,10*(e-=1))*Math.sin((e-this._p3)*this._p2)},.3),l("ElasticInOut",function(e){return(e*=2)<1?this._p1*Math.pow(2,10*(e-=1))*Math.sin((e-this._p3)*this._p2)*-.5:this._p1*Math.pow(2,-10*(e-=1))*Math.sin((e-this._p3)*this._p2)*.5+1},.45)),r("Expo",t("ExpoOut",function(e){return 1-Math.pow(2,-10*e)}),t("ExpoIn",function(e){return Math.pow(2,10*(e-1))-.001}),t("ExpoInOut",function(e){return(e*=2)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*(e-1)))})),r("Sine",t("SineOut",function(e){return Math.sin(e*h)}),t("SineIn",function(e){return 1-Math.cos(e*h)}),t("SineInOut",function(e){return-.5*(Math.cos(Math.PI*e)-1)})),s("easing.EaseLookup",{find:function(t){return e.map[t]}},!0),c(f.SlowMo,"SlowMo","ease,"),c(o,"RoughEase","ease,"),c(a,"SteppedEase","ease,"),p},!0)}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),function(e,t){"use strict";var _={},C=e.document,M=e.GreenSockGlobals=e.GreenSockGlobals||e;if(!M.TweenLite){var n,o,i,c,d,q=function(e){var t,s=e.split("."),n=M;for(t=0;t<s.length;t++)n[s[t]]=n=n[s[t]]||{};return n},f=q("com.greensock"),a=1e-10,$=function(e){var t,n=[],s=e.length;for(t=0;t!==s;n.push(e[t++]));return n},Y=function(){},x=function(){var e=Object.prototype.toString,t=e.call([]);return function(n){return n!=null&&(n instanceof Array||"object"==typeof n&&!!n.push&&e.call(n)===t)}}(),y={},B=function(n,s,o,i){this.sc=y[n]?y[n].sc:[],y[n]=this,this.gsClass=null,this.func=o;var a=[];this.check=function(r){for(var l,d,u,h,c=s.length,m=c;--c>-1;)(u=y[s[c]]||new B(s[c],[])).gsClass?(a[c]=u.gsClass,m--):r&&u.sc.push(this);if(0===m&&o){if(d=(h=("com.greensock."+n).split(".")).pop(),l=q(h.join("."))[d]=this.gsClass=o.apply(o,a),i)if(M[d]=_[d]=l,"undefined"!=typeof module&&module.exports)if(n===t)for(c in module.exports=_[t]=l,_)l[c]=_[c];else _[t]&&(_[t][d]=l);else"function"==typeof define&&define.amd&&define((e.GreenSockAMDPath?e.GreenSockAMDPath+"/":"")+n.split(".").pop(),[],function(){return l});for(c=0;c<this.sc.length;c++)this.sc[c].check()}},this.check(!0)},D=e._gsDefine=function(e,t,n,s){return new B(e,t,n,s)},h=f._class=function(e,t,n){return t=t||function(){},D(e,[],function(){return t},n),t};D.globals=M;var W=[0,0,1,1],u=h("easing.Ease",function(e,t,n,s){this._func=e,this._type=n||0,this._power=s||0,this._params=t?W.concat(t):W},!0),E=u.map={},H=u.register=function(e,t,n,s){for(var o,i,a,r,c=t.split(","),l=c.length,d=(n||"easeIn,easeOut,easeInOut").split(",");--l>-1;)for(o=c[l],r=s?h("easing."+o,null,!0):f.easing[o]||{},a=d.length;--a>-1;)i=d[a],E[o+"."+i]=E[i+o]=r[i]=e.getRatio?e:e[i]||new e};for((n=u.prototype)._calcEnd=!1,n.getRatio=function(e){if(this._func)return this._params[0]=e,this._func.apply(null,this._params);var n=this._type,s=this._power,t=1===n?1-e:2===n?e:.5>e?2*e:2*(1-e);return 1===s?t*=t:2===s?t*=t*t:3===s?t*=t*t*t:4===s&&(t*=t*t*t*t),1===n?1-t:2===n?t:.5>e?t/2:1-t/2},i=(d=["Linear","Quad","Cubic","Quart","Quint,Strong"]).length;--i>-1;)n=d[i]+",Power"+i,H(new u(null,null,1,i),n,"easeOut",!0),H(new u(null,null,2,i),n,"easeIn"+(0===i?",easeNone":"")),H(new u(null,null,3,i),n,"easeInOut");E.linear=f.easing.Linear.easeIn,E.swing=f.easing.Quad.easeInOut,P=h("events.EventDispatcher",function(e){this._listeners={},this._eventTarget=e||this}),(n=P.prototype).addEventListener=function(e,t,n,s,i){i=i||0;var r,l,a=this._listeners[e],d=0;for(this!==o||c||o.wake(),a==null&&(this._listeners[e]=a=[]),r=a.length;--r>-1;)(l=a[r]).c===t&&l.s===n?a.splice(r,1):0===d&&l.pr<i&&(d=r+1);a.splice(d,0,{c:t,s:n,up:s,pr:i})},n.removeEventListener=function(e,t){var n,s=this._listeners[e];if(s)for(n=s.length;--n>-1;)if(s[n].c===t)return void s.splice(n,1)},n.dispatchEvent=function(e){var t,s,o,n=this._listeners[e];if(n)for((o=n.length)>1&&(n=n.slice(0)),s=this._eventTarget;--o>-1;)(t=n[o])&&(t.up?t.c.call(t.s||s,{type:e,target:s}):t.c.call(t.s||s))};var k=e.requestAnimationFrame,T=e.cancelAnimationFrame,O=Date.now||function(){return(new Date).getTime()},b=O();for(i=(d=["ms","moz","webkit","o"]).length;--i>-1&&!k;)k=e[d[i]+"RequestAnimationFrame"],T=e[d[i]+"CancelAnimationFrame"]||e[d[i]+"CancelRequestAnimationFrame"];h("Ticker",function(e,t){var s,i,l,d,h,n=this,m=O(),r=!1!==t&&!!k&&"auto",u=500,p=33,f=function(e){var t,a,o=O()-b;o>u&&(m+=o-p),b+=o,n.time=(b-m)/1e3,t=n.time-d,(!i||t>0||!0===e)&&(n.frame++,d+=t+(t>=l?.004:l-t),a=!0),!0!==e&&(s=h(f)),a&&n.dispatchEvent("tick")};P.call(n),n.time=n.frame=0,n.tick=function(){f(!0)},n.lagSmoothing=function(e,t){u=e||1/a,p=Math.min(t,u,0)},n.sleep=function(){s!=null&&(r&&T?T(s):clearTimeout(s),h=Y,s=null,n===o&&(c=!1))},n.wake=function(e){null!==s?n.sleep():e?m+=-b+(b=O()):n.frame>10&&(b=O()-u+5),h=0===i?Y:r&&k?k:function(e){return setTimeout(e,1e3*(d-n.time)+1|0)},n===o&&(c=!0),f(2)},n.fps=function(e){return arguments.length?(l=1/((i=e)||60),d=this.time+l,void n.wake()):i},n.useRAF=function(e){return arguments.length?(n.sleep(),r=e,void n.fps(i)):r},n.fps(e),setTimeout(function(){"auto"===r&&n.frame<5&&"hidden"!==C.visibilityState&&n.useRAF(!1)},1500)}),(n=f.Ticker.prototype=new f.events.EventDispatcher).constructor=f.Ticker,r=h("core.Animation",function(e,t){if(this.vars=t=t||{},this._duration=this._totalDuration=e||0,this._delay=Number(t.delay)||0,this._timeScale=1,this._active=!0===t.immediateRender,this.data=t.data,this._reversed=!0===t.reversed,p){c||o.wake();var n=this.vars.useFrames?g:p;n.add(this,n._time),this.vars.paused&&this.paused(!0)}}),o=r.ticker=new f.Ticker,(n=r.prototype)._dirty=n._gc=n._initted=n._paused=!1,n._totalTime=n._time=0,n._rawPrevTime=-1,n._next=n._last=n._onUpdate=n._timeline=n.timeline=null,n._paused=!1,z=function(){c&&O()-b>2e3&&"hidden"!==C.visibilityState&&o.wake();var e=setTimeout(z,2e3);e.unref&&e.unref()},z(),n.play=function(e,t){return e!=null&&this.seek(e,t),this.reversed(!1).paused(!1)},n.pause=function(e,t){return e!=null&&this.seek(e,t),this.paused(!0)},n.resume=function(e,t){return e!=null&&this.seek(e,t),this.paused(!1)},n.seek=function(e,t){return this.totalTime(Number(e),!1!==t)},n.restart=function(e,t){return this.reversed(!1).paused(!1).totalTime(e?-this._delay:0,!1!==t,!0)},n.reverse=function(e,t){return e!=null&&this.seek(e||this.totalDuration(),t),this.reversed(!0).paused(!1)},n.render=function(){},n.invalidate=function(){return this._time=this._totalTime=0,this._initted=this._gc=!1,this._rawPrevTime=-1,(this._gc||!this.timeline)&&this._enabled(!0),this},n.isActive=function(){var t,e=this._timeline,n=this._startTime;return!e||!this._gc&&!this._paused&&e.isActive()&&(t=e.rawTime(!0))>=n&&t<n+this.totalDuration()/this._timeScale-1e-7},n._enabled=function(e,t){return c||o.wake(),this._gc=!e,this._active=this.isActive(),!0!==t&&(e&&!this.timeline?this._timeline.add(this,this._startTime-this._delay):!e&&this.timeline&&this._timeline._remove(this,!0)),!1},n._kill=function(){return this._enabled(!1,!1)},n.kill=function(e,t){return this._kill(e,t),this},n._uncache=function(e){for(var t=e?this:this.timeline;t;)t._dirty=!0,t=t.timeline;return this},n._swapSelfInParams=function(e){for(var t=e.length,n=e.concat();--t>-1;)"{self}"===e[t]&&(n[t]=this);return n},n._callback=function(e){var n=this.vars,s=n[e],t=n[e+"Params"],o=n[e+"Scope"]||n.callbackScope||this;switch(t?t.length:0){case 0:s.call(o);break;case 1:s.call(o,t[0]);break;case 2:s.call(o,t[0],t[1]);break;default:s.apply(o,t)}},n.eventCallback=function(e,t,n,s){if("on"===(e||"").substr(0,2)){var o=this.vars;if(1===arguments.length)return o[e];t==null?delete o[e]:(o[e]=t,o[e+"Params"]=x(n)&&-1!==n.join("").indexOf("{self}")?this._swapSelfInParams(n):n,o[e+"Scope"]=s),"onUpdate"===e&&(this._onUpdate=t)}return this},n.delay=function(e){return arguments.length?(this._timeline.smoothChildTiming&&this.startTime(this._startTime+e-this._delay),this._delay=e,this):this._delay},n.duration=function(e){return arguments.length?(this._duration=this._totalDuration=e,this._uncache(!0),this._timeline.smoothChildTiming&&this._time>0&&this._time<this._duration&&0!==e&&this.totalTime(this._totalTime*(e/this._duration),!0),this):(this._dirty=!1,this._duration)},n.totalDuration=function(e){return this._dirty=!1,arguments.length?this.duration(e):this._totalDuration},n.time=function(e,t){return arguments.length?(this._dirty&&this.totalDuration(),this.totalTime(e>this._duration?this._duration:e,t)):this._time},n.totalTime=function(e,t,n){if(c||o.wake(),!arguments.length)return this._totalTime;if(this._timeline){if(0>e&&!n&&(e+=this.totalDuration()),this._timeline.smoothChildTiming){this._dirty&&this.totalDuration();var i=this._totalDuration,s=this._timeline;if(e>i&&!n&&(e=i),this._startTime=(this._paused?this._pauseTime:s._time)-(this._reversed?i-e:e)/this._timeScale,s._dirty||this._uncache(!1),s._timeline)for(;s._timeline;)s._timeline._time!==(s._startTime+s._totalTime)/s._timeScale&&s.totalTime(s._totalTime,!0),s=s._timeline}this._gc&&this._enabled(!0,!1),(this._totalTime!==e||0===this._duration)&&(m.length&&w(),this.render(e,t,!1),m.length&&w())}return this},n.progress=n.totalProgress=function(e,t){var n=this.duration();return arguments.length?this.totalTime(n*e,t):n?this._time/n:this.ratio},n.startTime=function(e){return arguments.length?(e!==this._startTime&&(this._startTime=e,this.timeline&&this.timeline._sortChildren&&this.timeline.add(this,e-this._delay)),this):this._startTime},n.endTime=function(e){return this._startTime+(0!=e?this.totalDuration():this.duration())/this._timeScale},n.timeScale=function(e){if(!arguments.length)return this._timeScale;if(e=e||a,this._timeline&&this._timeline.smoothChildTiming){var t=this._pauseTime,n=t||0===t?t:this._timeline.totalTime();this._startTime=n-(n-this._startTime)*this._timeScale/e}return this._timeScale=e,this._uncache(!1)},n.reversed=function(e){return arguments.length?(e!=this._reversed&&(this._reversed=e,this.totalTime(this._timeline&&!this._timeline.smoothChildTiming?this.totalDuration()-this._totalTime:this._totalTime,!0)),this):this._reversed},n.paused=function(e){if(!arguments.length)return this._paused;var t,s,n=this._timeline;return e!=this._paused&&n&&(c||e||o.wake(),s=(t=n.rawTime())-this._pauseTime,!e&&n.smoothChildTiming&&(this._startTime+=s,this._uncache(!1)),this._pauseTime=e?t:null,this._paused=e,this._active=this.isActive(),!e&&0!==s&&this._initted&&this.duration()&&(t=n.smoothChildTiming?this._totalTime:(t-this._startTime)/this._timeScale,this.render(t,t===this._totalTime,!0))),this._gc&&!e&&this._enabled(!0,!1),this},S=h("core.SimpleTimeline",function(e){r.call(this,0,e),this.autoRemoveChildren=this.smoothChildTiming=!0}),(n=S.prototype=new r).constructor=S,n.kill()._gc=!1,n._first=n._last=n._recent=null,n._sortChildren=!1,n.add=n.insert=function(e,t){var o,i;if(e._startTime=Number(t||0)+e._delay,e._paused&&this!==e._timeline&&(e._pauseTime=e._startTime+(this.rawTime()-e._startTime)/e._timeScale),e.timeline&&e.timeline._remove(e,!0),e.timeline=e._timeline=this,e._gc&&e._enabled(!0,!0),o=this._last,this._sortChildren)for(i=e._startTime;o&&o._startTime>i;)o=o._prev;return o?(e._next=o._next,o._next=e):(e._next=this._first,this._first=e),e._next?e._next._prev=e:this._last=e,e._prev=o,this._recent=e,this._timeline&&this._uncache(!0),this},n._remove=function(e,t){return e.timeline===this&&(t||e._enabled(!1,!0),e._prev?e._prev._next=e._next:this._first===e&&(this._first=e._next),e._next?e._next._prev=e._prev:this._last===e&&(this._last=e._prev),e._next=e._prev=e.timeline=null,e===this._recent&&(this._recent=this._last),this._timeline&&this._uncache(!0)),this},n.render=function(e,t,n){var o,s=this._first;for(this._totalTime=this._time=this._rawPrevTime=e;s;)o=s._next,(s._active||e>=s._startTime&&!s._paused&&!s._gc)&&(s._reversed?s.render((s._dirty?s.totalDuration():s._totalDuration)-(e-s._startTime)*s._timeScale,t,n):s.render((e-s._startTime)*s._timeScale,t,n)),s=o},n.rawTime=function(){return c||o.wake(),this._totalTime},s=h("TweenLite",function(t,n,o){if(r.call(this,n,o),this.render=s.prototype.render,t==null)throw"Cannot tween a null target.";this.target=t="string"!=typeof t?t:s.selector(t)||t;var i,c,l,u=t.jquery||t.length&&t!==e&&t[0]&&(t[0]===e||t[0].nodeType&&t[0].style&&!t.nodeType),d=this.vars.overwrite;if(this._overwrite=d=d==null?K[s.defaultOverwrite]:"number"==typeof d?d>>0:K[d],(u||t instanceof Array||t.push&&x(t))&&"number"!=typeof t[0])for(this._targets=l=$(t),this._propLookup=[],this._siblings=[],c=0;c<l.length;c++)(i=l[c])?"string"!=typeof i?i.length&&i!==e&&i[0]&&(i[0]===e||i[0].nodeType&&i[0].style&&!i.nodeType)?(l.splice(c--,1),this._targets=l=l.concat($(i))):(this._siblings[c]=A(i,this,!1),1===d&&this._siblings[c].length>1&&L(i,this,null,1,this._siblings[c])):"string"==typeof(i=l[c--]=s.selector(i))&&l.splice(c+1,1):l.splice(c--,1);else this._propLookup={},this._siblings=A(t,this,!1),1===d&&this._siblings.length>1&&L(t,this,null,1,this._siblings);(this.vars.immediateRender||0===n&&0===this._delay&&!1!==this.vars.immediateRender)&&(this._time=-a,this.render(Math.min(0,-this._delay)))},!0),F=function(t){return t&&t.length&&t!==e&&t[0]&&(t[0]===e||t[0].nodeType&&t[0].style&&!t.nodeType)},(n=s.prototype=new r).constructor=s,n.kill()._gc=!1,n.ratio=0,n._firstPT=n._targets=n._overwrittenProps=n._startAt=null,n._notifyPluginsOfEnabled=n._lazy=!1,s.version="1.20.1",s.defaultEase=n._ease=new u(null,null,1,1),s.defaultOverwrite="auto",s.ticker=o,s.autoSleep=120,s.lagSmoothing=function(e,t){o.lagSmoothing(e,t)},s.selector=e.$||e.jQuery||function(t){var n=e.$||e.jQuery;return n?(s.selector=n,n(t)):void 0===C?t:C.querySelectorAll?C.querySelectorAll(t):C.getElementById("#"===t.charAt(0)?t.substr(1):t)};var s,r,l,S,F,z,P,m=[],N={},J=/(?:(-|-=|\+=)?\d*\.?\d*(?:e[-+]?\d+)?)[0-9]/gi,ee=/[+-]=-?[.\d]/,X=function(e){for(var n,t=this._firstPT,s=1e-6;t;)n=t.blob?1===e&&this.end?this.end:e?this.join(""):this.start:t.c*e+t.s,t.m?n=t.m(n,this._target||t.t):s>n&&n>-s&&!t.blob&&(n=0),t.f?t.fp?t.t[t.p](t.fp,n):t.t[t.p](n):t.t[t.p]=n,t=t._next},V=function(e,t,n,s){var i,a,d,u,h,m,f,o=[],c=0,r="",l=0;for(o.start=e,o.end=t,e=o[0]=e+"",t=o[1]=t+"",n&&(n(o),e=o[0],t=o[1]),o.length=0,d=e.match(J)||[],m=t.match(J)||[],s&&(s._next=null,s.blob=1,o._firstPT=o._applyPT=s),f=m.length,a=0;f>a;a++)i=m[a],r+=(h=t.substr(c,t.indexOf(i,c)-c))||!a?h:",",c+=h.length,l?l=(l+1)%5:"rgba("===h.substr(-5)&&(l=1),i===d[a]||d.length<=a?r+=i:(r&&(o.push(r),r=""),u=parseFloat(d[a]),o.push(u),o._firstPT={_next:o._firstPT,t:o,p:o.length-1,s:u,c:("="===i.charAt(1)?parseInt(i.charAt(0)+"1",10)*parseFloat(i.substr(2)):parseFloat(i)-u)||0,f:0,m:l&&4>l?Math.round:0}),c+=i.length;return(r+=t.substr(c))&&o.push(r),o.setRatio=X,ee.test(t)&&(o.end=0),o},U=function(e,t,n,o,i,a,r,c,l){"function"==typeof o&&(o=o(l||0,e));var f=typeof e[t],m="function"!==f?"":t.indexOf("set")||"function"!=typeof e["get"+t.substr(3)]?t:"get"+t.substr(3),u="get"!==n?n:m?r?e[m](r):e[m]():e[t],h="string"==typeof o&&"="===o.charAt(1),d={t:e,p:t,s:u,f:"function"===f,pg:0,n:i||t,m:a?"function"==typeof a?a:Math.round:0,pr:0,c:h?parseInt(o.charAt(0)+"1",10)*parseFloat(o.substr(2)):parseFloat(o)-u||0};return("number"!=typeof u||"number"!=typeof o&&!h)&&(r||isNaN(u)||!h&&isNaN(o)||"boolean"==typeof u||"boolean"==typeof o?(d.fp=r,d={t:V(u,h?parseFloat(d.s)+d.c:o,c||s.defaultStringFilter,d),p:"setRatio",s:0,c:1,f:2,pg:0,n:i||t,pr:0,m:0}):(d.s=parseFloat(u),h||(d.c=parseFloat(o)-d.s||0))),d.c?((d._next=this._firstPT)&&(d._next._prev=d),this._firstPT=d,d):void 0},R=s._internals={isArray:x,isSelector:F,lazyTweens:m,blobDif:V},v=s._plugins={},j=R.tweenLookup={},te=0,I=R.reservedProps={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1,autoCSS:1,lazy:1,onOverwrite:1,callbackScope:1,stringFilter:1,id:1,yoyoEase:1},K={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,true:1,false:0},g=r._rootFramesTimeline=new S,p=r._rootTimeline=new S,G=30,w=R.lazyRender=function(){var e,t=m.length;for(N={};--t>-1;)(e=m[t])&&!1!==e._lazy&&(e.render(e._lazy[0],e._lazy[1],!0),e._lazy=!1);m.length=0};p._startTime=o.time,g._startTime=o.frame,p._active=g._active=!0,setTimeout(w,1),r._updateRoot=s.render=function(){if(m.length&&w(),p.render((o.time-p._startTime)*p._timeScale,!1,!1),g.render((o.frame-g._startTime)*g._timeScale,!1,!1),m.length&&w(),o.frame>=G){for(e in G=o.frame+(parseInt(s.autoSleep,10)||120),j){for(t=(n=j[e].tweens).length;--t>-1;)n[t]._gc&&n.splice(t,1);0===n.length&&delete j[e]}if((!(e=p._first)||e._paused)&&s.autoSleep&&!g._first&&1===o._listeners.tick.length){for(var e,t,n;e&&e._paused;)e=e._next;e||o.sleep()}}},o.addEventListener("tick",r._updateRoot);var A=function(e,t,n){var o,i,s=e._gsTweenID;if(j[s||(e._gsTweenID=s="t"+te++)]||(j[s]={target:e,tweens:[]}),t&&((o=j[s].tweens)[i=o.length]=t,n))for(;--i>-1;)o[i]===t&&o.splice(i,1);return j[s].tweens},Z=function(e,t,n,o){var a,r,i=e.vars.onOverwrite;return i&&(a=i(e,t,n,o)),(i=s.onOverwrite)&&(r=i(e,t,n,o)),!1!==a&&!1!==r},L=function(e,t,n,s,o){if(1===s||s>=4){for(f=o.length,r=0;f>r;r++)if((i=o[r])!==t)i._gc||i._kill(null,e,t)&&(c=!0);else if(5===s)break;return c}var i,r,c,l,f,d=t._startTime+a,u=[],h=0,m=0===t._duration;for(r=o.length;--r>-1;)(i=o[r])===t||i._gc||i._paused||(i._timeline!==t._timeline?(l=l||Q(t,0,m),0===Q(i,l,m)&&(u[h++]=i)):i._startTime<=d&&i._startTime+i.totalDuration()/i._timeScale>d&&((m||!i._initted)&&d-i._startTime<=2e-10||(u[h++]=i)));for(r=h;--r>-1;)if(i=u[r],2===s&&i._kill(n,e,t)&&(c=!0),2!==s||!i._firstPT&&i._initted){if(2!==s&&!Z(i,t))continue;i._enabled(!1,!1)&&(c=!0)}return c},Q=function(e,t,n){for(var s=e._timeline,i=s._timeScale,o=e._startTime;s._timeline;){if(o+=s._startTime,i*=s._timeScale,s._paused)return-100;s=s._timeline}return(o/=i)>t?o-t:n&&o===t||!e._initted&&2*a>o-t?a:(o+=e.totalDuration()/e._timeScale/i)>t+a?0:o-t-a};if(n._init=function(){var t,n,i,a,l,d,e=this.vars,c=this._overwrittenProps,h=this._duration,r=!!e.immediateRender,o=e.ease;if(e.startAt){{for(a in this._startAt&&(this._startAt.render(-1,!0),this._startAt.kill()),n={},e.startAt)n[a]=e.startAt[a];if(n.overwrite=!1,n.immediateRender=!0,n.lazy=r&&!1!==e.lazy,n.startAt=n.delay=null,n.onUpdate=e.onUpdate,n.onUpdateScope=e.onUpdateScope||e.callbackScope||this,this._startAt=s.to(this.target,0,n),r)if(this._time>0)this._startAt=null;else if(0!==h)return}}else if(e.runBackwards&&0!==h)if(this._startAt)this._startAt.render(-1,!0),this._startAt.kill(),this._startAt=null;else{for(a in 0!==this._time&&(r=!1),t={},e)I[a]&&"autoCSS"!==a||(t[a]=e[a]);if(t.overwrite=0,t.data="isFromStart",t.lazy=r&&!1!==e.lazy,t.immediateRender=r,this._startAt=s.to(this.target,0,t),r){if(0===this._time)return}else this._startAt._init(),this._startAt._enabled(!1),this.vars.immediateRender&&(this._startAt=null)}if(this._ease=o=o?o instanceof u?o:"function"==typeof o?new u(o,e.easeParams):E[o]||s.defaultEase:s.defaultEase,e.easeParams instanceof Array&&o.config&&(this._ease=o.config.apply(o,e.easeParams)),this._easeType=this._ease._type,this._easePower=this._ease._power,this._firstPT=null,this._targets)for(d=this._targets.length,i=0;d>i;i++)this._initProps(this._targets[i],this._propLookup[i]={},this._siblings[i],c?c[i]:null,i)&&(l=!0);else l=this._initProps(this.target,this._propLookup,this._siblings,c,0);if(l&&s._onPluginEvent("_onInitAllProps",this),c&&(this._firstPT||"function"!=typeof this.target&&this._enabled(!1,!1)),e.runBackwards)for(t=this._firstPT;t;)t.s+=t.c,t.c=-t.c,t=t._next;this._onUpdate=e.onUpdate,this._initted=!0},n._initProps=function(t,n,s,o,i){var a,r,c,l,d,u;if(t==null)return!1;for(a in N[t._gsTweenID]&&w(),this.vars.css||t.style&&t!==e&&t.nodeType&&v.css&&!1!==this.vars.autoCSS&&function(e,t){var n,s={};for(n in e)I[n]||n in t&&"transform"!==n&&"x"!==n&&"y"!==n&&"width"!==n&&"height"!==n&&"className"!==n&&"border"!==n||!(!v[n]||v[n]&&v[n]._autoCSS)||(s[n]=e[n],delete e[n]);e.css=s}(this.vars,t),this.vars)if(c=this.vars[a],I[a])c&&(c instanceof Array||c.push&&x(c))&&-1!==c.join("").indexOf("{self}")&&(this.vars[a]=c=this._swapSelfInParams(c,this));else if(v[a]&&(r=new v[a])._onInitTween(t,this.vars[a],this,i)){for(this._firstPT=l={_next:this._firstPT,t:r,p:"setRatio",s:0,c:1,f:1,n:a,pg:1,pr:r._priority,m:0},d=r._overwriteProps.length;--d>-1;)n[r._overwriteProps[d]]=this._firstPT;(r._priority||r._onInitAllProps)&&(u=!0),(r._onDisable||r._onEnable)&&(this._notifyPluginsOfEnabled=!0),l._next&&(l._next._prev=l)}else n[a]=U.call(this,t,a,"get",c,a,0,null,this.vars.stringFilter,i);return o&&this._kill(o,t)?this._initProps(t,n,s,o,i):this._overwrite>1&&this._firstPT&&s.length>1&&L(t,this,n,this._overwrite,s)?(this._kill(n,t),this._initProps(t,n,s,o,i)):(this._firstPT&&(!1!==this.vars.lazy&&this._duration||this.vars.lazy&&!this._duration)&&(N[t._gsTweenID]=!0),u)},n.render=function(e,t,n){var o,c,l,f,d=this._time,i=this._duration,r=this._rawPrevTime;if(e>=i-1e-7&&e>=0)this._totalTime=this._time=i,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1,this._reversed||(l=!0,c="onComplete",n=n||this._timeline.autoRemoveChildren),0===i&&(this._initted||!this.vars.lazy||n)&&(this._startTime===this._timeline._duration&&(e=0),(0>r||0>=e&&e>=-1e-7||r===a&&"isPause"!==this.data)&&r!==e&&(n=!0,r>a&&(c="onReverseComplete")),this._rawPrevTime=f=!t||e||r===e?e:a);else if(1e-7>e)this._totalTime=this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==d||0===i&&r>0)&&(c="onReverseComplete",l=this._reversed),0>e&&(this._active=!1,0===i&&(this._initted||!this.vars.lazy||n)&&(r>=0&&(r!==a||"isPause"!==this.data)&&(n=!0),this._rawPrevTime=f=!t||e||r===e?e:a)),(!this._initted||this._startAt&&this._startAt.progress())&&(n=!0);else if(this._totalTime=this._time=e,this._easeType){var s=e/i,u=this._easeType,h=this._easePower;(1===u||3===u&&s>=.5)&&(s=1-s),3===u&&(s*=2),1===h?s*=s:2===h?s*=s*s:3===h?s*=s*s*s:4===h&&(s*=s*s*s*s),this.ratio=1===u?1-s:2===u?s:.5>e/i?s/2:1-s/2}else this.ratio=this._ease.getRatio(e/i);if(this._time!==d||n){if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!n&&this._firstPT&&(!1!==this.vars.lazy&&this._duration||this.vars.lazy&&!this._duration))return this._time=this._totalTime=d,this._rawPrevTime=r,m.push(this),void(this._lazy=[e,t]);this._time&&!l?this.ratio=this._ease.getRatio(this._time/i):l&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(!1!==this._lazy&&(this._lazy=!1),this._active||!this._paused&&this._time!==d&&e>=0&&(this._active=!0),0===d&&(this._startAt&&(e>=0?this._startAt.render(e,t,n):c||(c="_dummyGS")),this.vars.onStart&&(0!==this._time||0===i)&&(t||this._callback("onStart"))),o=this._firstPT;o;)o.f?o.t[o.p](o.c*this.ratio+o.s):o.t[o.p]=o.c*this.ratio+o.s,o=o._next;this._onUpdate&&(0>e&&this._startAt&&-1e-4!==e&&this._startAt.render(e,t,n),t||(this._time!==d||l||n)&&this._callback("onUpdate")),c&&(!this._gc||n)&&(0>e&&this._startAt&&!this._onUpdate&&-1e-4!==e&&this._startAt.render(e,t,n),l&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!t&&this.vars[c]&&this._callback(c),0===i&&this._rawPrevTime===a&&f!==a&&(this._rawPrevTime=0))}},n._kill=function(e,t,n){if("all"===e&&(e=null),e==null&&(t==null||t===this.target))return this._lazy=!1,this._enabled(!1,!1);t="string"!=typeof t?t||this._targets||this.target:s.selector(t)||t;var o,i,a,r,c,l,d,u,h,m=n&&this._time&&n._startTime===this._startTime&&this._timeline===n._timeline;if((x(t)||F(t))&&"number"!=typeof t[0])for(i=t.length;--i>-1;)this._kill(e,t[i],n)&&(d=!0);else{if(this._targets){for(i=this._targets.length;--i>-1;)if(t===this._targets[i]){a=this._propLookup[i]||{},this._overwrittenProps=this._overwrittenProps||[],c=this._overwrittenProps[i]=e?this._overwrittenProps[i]||{}:"all";break}}else{if(t!==this.target)return!1;a=this._propLookup,c=this._overwrittenProps=e?this._overwrittenProps||{}:"all"}if(a){if(u=e||a,h=e!==c&&"all"!==c&&e!==a&&("object"!=typeof e||!e._tempKill),n&&(s.onOverwrite||this.vars.onOverwrite)){for(r in u)a[r]&&(l||(l=[]),l.push(r));if((l||!e)&&!Z(this,n,t,l))return!1}for(r in u)(o=a[r])&&(m&&(o.f?o.t[o.p](o.s):o.t[o.p]=o.s,d=!0),o.pg&&o.t._kill(u)&&(d=!0),o.pg&&0!==o.t._overwriteProps.length||(o._prev?o._prev._next=o._next:o===this._firstPT&&(this._firstPT=o._next),o._next&&(o._next._prev=o._prev),o._next=o._prev=null),delete a[r]),h&&(c[r]=1);!this._firstPT&&this._initted&&this._enabled(!1,!1)}}return d},n.invalidate=function(){return this._notifyPluginsOfEnabled&&s._onPluginEvent("_onDisable",this),this._firstPT=this._overwrittenProps=this._startAt=this._onUpdate=null,this._notifyPluginsOfEnabled=this._active=this._lazy=!1,this._propLookup=this._targets?{}:[],r.prototype.invalidate.call(this),this.vars.immediateRender&&(this._time=-a,this.render(Math.min(0,-this._delay))),this},n._enabled=function(e,t){if(c||o.wake(),e&&this._gc){var n,i=this._targets;if(i)for(n=i.length;--n>-1;)this._siblings[n]=A(i[n],this,!0);else this._siblings=A(this.target,this,!0)}return r.prototype._enabled.call(this,e,t),!!this._notifyPluginsOfEnabled&&!!this._firstPT&&s._onPluginEvent(e?"_onEnable":"_onDisable",this)},s.to=function(e,t,n){return new s(e,t,n)},s.from=function(e,t,n){return n.runBackwards=!0,n.immediateRender=0!=n.immediateRender,new s(e,t,n)},s.fromTo=function(e,t,n,o){return o.startAt=n,o.immediateRender=0!=o.immediateRender&&0!=n.immediateRender,new s(e,t,o)},s.delayedCall=function(e,t,n,o,i){return new s(t,0,{delay:e,onComplete:t,onCompleteParams:n,callbackScope:o,onReverseComplete:t,onReverseCompleteParams:n,immediateRender:!1,lazy:!1,useFrames:i,overwrite:0})},s.set=function(e,t){return new s(e,0,t)},s.getTweensOf=function(e,t){if(e==null)return[];var n,o,i,a;if(e="string"!=typeof e?e:s.selector(e)||e,(x(e)||F(e))&&"number"!=typeof e[0]){for(n=e.length,o=[];--n>-1;)o=o.concat(s.getTweensOf(e[n],t));for(n=o.length;--n>-1;)for(a=o[n],i=n;--i>-1;)a===o[i]&&o.splice(n,1)}else if(e._gsTweenID)for(n=(o=A(e).concat()).length;--n>-1;)(o[n]._gc||t&&!o[n].isActive())&&o.splice(n,1);return o||[]},s.killTweensOf=s.killDelayedCallsTo=function(e,t,n){"object"==typeof t&&(n=t,t=!1);for(var o=s.getTweensOf(e,t),i=o.length;--i>-1;)o[i]._kill(n,e)},l=h("plugins.TweenPlugin",function(e,t){this._overwriteProps=(e||"").split(","),this._propName=this._overwriteProps[0],this._priority=t||0,this._super=l.prototype},!0),n=l.prototype,l.version="1.19.0",l.API=2,n._firstPT=null,n._addTween=U,n.setRatio=X,n._kill=function(e){var n,s=this._overwriteProps,t=this._firstPT;if(null!=e[this._propName])this._overwriteProps=[];else for(n=s.length;--n>-1;)null!=e[s[n]]&&s.splice(n,1);for(;t;)null!=e[t.n]&&(t._next&&(t._next._prev=t._prev),t._prev?(t._prev._next=t._next,t._prev=null):this._firstPT===t&&(this._firstPT=t._next)),t=t._next;return!1},n._mod=n._roundProps=function(e){for(var n,t=this._firstPT;t;)(n=e[this._propName]||null!=t.n&&e[t.n.split(this._propName+"_").join("")])&&"function"==typeof n&&(2===t.f?t.t._applyPT.m=n:t.m=n),t=t._next},s._onPluginEvent=function(e,t){var s,o,i,a,r,n=t._firstPT;if("_onInitAllProps"===e){for(;n;){for(r=n._next,s=o;s&&s.pr>n.pr;)s=s._next;(n._prev=s?s._prev:a)?n._prev._next=n:o=n,(n._next=s)?s._prev=n:a=n,n=r}n=t._firstPT=o}for(;n;)n.pg&&"function"==typeof n.t[e]&&n.t[e]()&&(i=!0),n=n._next;return i},l.activate=function(e){for(var t=e.length;--t>-1;)e[t].API===l.API&&(v[(new e[t])._propName]=e[t]);return!0},D.plugin=function(e){if(!(e&&e.propName&&e.init&&e.API))throw"illegal plugin definition.";var n,s=e.propName,a=e.priority||0,r=e.overwriteProps,o={init:"_onInitTween",set:"setRatio",kill:"_kill",round:"_mod",mod:"_mod",initAll:"_onInitAllProps"},t=h("plugins."+s.charAt(0).toUpperCase()+s.substr(1)+"Plugin",function(){l.call(this,s,a),this._overwriteProps=r||[]},!0===e.global),i=t.prototype=new l(s);for(n in i.constructor=t,t.API=e.API,o)"function"==typeof e[n]&&(i[o[n]]=e[n]);return t.version=e.version,l.activate([t]),t},d=e._gsQueue){for(i=0;i<d.length;i++)d[i]();for(n in y)y[n].func||e.console.log("GSAP encountered missing dependency: "+n)}c=!1}}("undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window,"TweenMax")