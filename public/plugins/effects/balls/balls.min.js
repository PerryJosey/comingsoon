!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Matter=e()}(function(){return function e(t,n,s){function o(i,r){if(!n[i]){if(!t[i]){var c,l,d="function"==typeof require&&require;if(!r&&d)return d(i,!0);if(a)return a(i,!0);throw l=new Error("Cannot find module '"+i+"'"),l.code="MODULE_NOT_FOUND",l}c=n[i]={exports:{}},t[i][0].call(c.exports,function(e){var n=t[i][1][e];return o(n||e)},c,c.exports,e,t,n,s)}return n[i].exports}for(var a="function"==typeof require&&require,i=0;i<s.length;i++)o(s[i]);return o}({1:[function(e,t){s={},t.exports=s;var s,o=e("../geometry/Vertices"),i=e("../geometry/Vector"),l=e("../core/Sleeping"),c=(e("../render/Render"),e("../core/Common")),a=e("../geometry/Bounds"),r=e("../geometry/Axes");!function(){s._inertiaScale=4,s._nextCollidingGroupId=1,s._nextNonCollidingGroupId=-1,s._nextCategory=1,s.create=function(e){var s={id:c.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:o.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0},lineWidth:0}},n=c.extend(s,e);return t(n,e),n},s.nextGroup=function(e){return e?s._nextNonCollidingGroupId--:s._nextCollidingGroupId++},s.nextCategory=function(){return s._nextCategory=s._nextCategory<<1,s._nextCategory};var e,t=function(e,t){t=t||{},s.set(e,{bounds:e.bounds||a.create(e.vertices),positionPrev:e.positionPrev||i.clone(e.position),anglePrev:e.anglePrev||e.angle,vertices:e.vertices,parts:e.parts||[e],isStatic:e.isStatic,isSleeping:e.isSleeping,parent:e.parent||e}),o.rotate(e.vertices,e.angle,e.position),r.rotate(e.axes,e.angle),a.update(e.bounds,e.vertices,e.velocity),s.set(e,{axes:t.axes||e.axes,area:t.area||e.area,mass:t.mass||e.mass,inertia:t.inertia||e.inertia});var n=e.isStatic?"#2e2b44":c.choose(["#006BA6","#0496FF","#FFBC42","#D81159","#8F2D56"]),l=c.shadeColor(n,-20);e.render.fillStyle=e.render.fillStyle||n,e.render.strokeStyle=e.render.strokeStyle||l,e.render.sprite.xOffset+=-(e.bounds.min.x-e.position.x)/(e.bounds.max.x-e.bounds.min.x),e.render.sprite.yOffset+=-(e.bounds.min.y-e.position.y)/(e.bounds.max.y-e.bounds.min.y)};s.set=function(e,t,n){var o;for(o in"string"==typeof t&&(o=t,(t={})[o]=n),t)if(n=t[o],t.hasOwnProperty(o))switch(o){case"isStatic":s.setStatic(e,n);break;case"isSleeping":l.set(e,n);break;case"mass":s.setMass(e,n);break;case"density":s.setDensity(e,n);break;case"inertia":s.setInertia(e,n);break;case"vertices":s.setVertices(e,n);break;case"position":s.setPosition(e,n);break;case"angle":s.setAngle(e,n);break;case"velocity":s.setVelocity(e,n);break;case"angularVelocity":s.setAngularVelocity(e,n);break;case"parts":s.setParts(e,n);break;default:e[o]=n}},s.setStatic=function(e,t){for(var n,s=0;s<e.parts.length;s++)n=e.parts[s],n.isStatic=t,t?(n._original={restitution:n.restitution,friction:n.friction,mass:n.mass,inertia:n.inertia,density:n.density,inverseMass:n.inverseMass,inverseInertia:n.inverseInertia},n.restitution=0,n.friction=1,n.mass=n.inertia=n.density=1/0,n.inverseMass=n.inverseInertia=0,n.positionPrev.x=n.position.x,n.positionPrev.y=n.position.y,n.anglePrev=n.angle,n.angularVelocity=0,n.speed=0,n.angularSpeed=0,n.motion=0):n._original&&(n.restitution=n._original.restitution,n.friction=n._original.friction,n.mass=n._original.mass,n.inertia=n._original.inertia,n.density=n._original.density,n.inverseMass=n._original.inverseMass,n.inverseInertia=n._original.inverseInertia,delete n._original)},s.setMass=function(e,t){e.mass=t,e.inverseMass=1/e.mass,e.density=e.mass/e.area},s.setDensity=function(e,t){s.setMass(e,t*e.area),e.density=t},s.setInertia=function(e,t){e.inertia=t,e.inverseInertia=1/e.inertia},s.setVertices=function(e,t){t[0].body===e?e.vertices=t:e.vertices=o.create(t,e),e.axes=r.fromVertices(e.vertices),e.area=o.area(e.vertices),s.setMass(e,e.density*e.area);var n=o.centre(e.vertices);o.translate(e.vertices,n,-1),s.setInertia(e,s._inertiaScale*o.inertia(e.vertices,e.mass)),o.translate(e.vertices,e.position),a.update(e.bounds,e.vertices,e.velocity)},s.setParts=function(t,n,i){for(n=n.slice(0),t.parts.length=0,t.parts.push(t),t.parent=t,r=0;r<n.length;r++)l=n[r],l!==t&&(l.parent=t,t.parts.push(l));if(1!==t.parts.length){if(i=void 0===i||i){c=[];for(r=0;r<n.length;r++)c=c.concat(n[r].vertices);o.clockwiseSort(c);var a,r,c,l,d=o.hull(c),u=o.centre(d);s.setVertices(t,d),o.translate(t.vertices,u)}a=e(t),t.area=a.area,t.parent=t,t.position.x=a.centre.x,t.position.y=a.centre.y,t.positionPrev.x=a.centre.x,t.positionPrev.y=a.centre.y,s.setMass(t,a.mass),s.setInertia(t,a.inertia),s.setPosition(t,a.centre)}},s.setPosition=function(e,t){var n,r,s=i.sub(t,e.position);e.positionPrev.x+=s.x,e.positionPrev.y+=s.y;for(r=0;r<e.parts.length;r++)n=e.parts[r],n.position.x+=s.x,n.position.y+=s.y,o.translate(n.vertices,s),a.update(n.bounds,n.vertices,e.velocity)},s.setAngle=function(e,t){var n,c,s=t-e.angle;e.anglePrev+=s;for(c=0;c<e.parts.length;c++)n=e.parts[c],n.angle+=s,o.rotate(n.vertices,s,e.position),r.rotate(n.axes,s),a.update(n.bounds,n.vertices,e.velocity),c>0&&i.rotateAbout(n.position,s,e.position,n.position)},s.setVelocity=function(e,t){e.positionPrev.x=e.position.x-t.x,e.positionPrev.y=e.position.y-t.y,e.velocity.x=t.x,e.velocity.y=t.y,e.speed=i.magnitude(e.velocity)},s.setAngularVelocity=function(e,t){e.anglePrev=e.angle-t,e.angularVelocity=t,e.angularSpeed=Math.abs(e.angularVelocity)},s.translate=function(e,t){s.setPosition(e,i.add(e.position,t))},s.rotate=function(e,t){s.setAngle(e,e.angle+t)},s.scale=function(t,n,i){for(var l,d,u=0;u<t.parts.length;u++)l=t.parts[u],o.scale(l.vertices,n,i,t.position),l.axes=r.fromVertices(l.vertices),t.isStatic||(l.area=o.area(l.vertices),s.setMass(l,t.density*l.area),o.translate(l.vertices,{x:-l.position.x,y:-l.position.y}),s.setInertia(l,o.inertia(l.vertices,l.mass)),o.translate(l.vertices,{x:l.position.x,y:l.position.y})),a.update(l.bounds,l.vertices,t.velocity);t.circleRadius&&(n===i?t.circleRadius*=n:t.circleRadius=null),!t.isStatic&&(d=e(t),t.area=d.area,s.setMass(t,d.mass),s.setInertia(t,d.inertia))},s.update=function(e,t,n,s){var c,l,d=Math.pow(t*n*e.timeScale,2),u=1-e.frictionAir*n*e.timeScale,h=e.position.x-e.positionPrev.x,m=e.position.y-e.positionPrev.y;e.velocity.x=h*u*s+e.force.x/e.mass*d,e.velocity.y=m*u*s+e.force.y/e.mass*d,e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.position.x+=e.velocity.x,e.position.y+=e.velocity.y,e.angularVelocity=(e.angle-e.anglePrev)*u*s+e.torque/e.inertia*d,e.anglePrev=e.angle,e.angle+=e.angularVelocity,e.speed=i.magnitude(e.velocity),e.angularSpeed=Math.abs(e.angularVelocity);for(l=0;l<e.parts.length;l++)c=e.parts[l],o.translate(c.vertices,e.velocity),l>0&&(c.position.x+=e.velocity.x,c.position.y+=e.velocity.y),0!==e.angularVelocity&&(o.rotate(c.vertices,e.angularVelocity,e.position),r.rotate(c.axes,e.angularVelocity),l>0&&i.rotateAbout(c.position,e.angularVelocity,e.position,c.position)),a.update(c.bounds,c.vertices,e.velocity)},s.applyForce=function(e,t,n){e.force.x+=n.x,e.force.y+=n.y;var s=t.x-e.position.x,o=t.y-e.position.y;e.torque+=s*n.y-o*n.x},e=function(e){for(var n,t={mass:0,area:0,inertia:0,centre:{x:0,y:0}},s=1===e.parts.length?0:1;s<e.parts.length;s++)n=e.parts[s],t.mass+=n.mass,t.area+=n.area,t.inertia+=n.inertia,t.centre=i.add(t.centre,i.mult(n.position,n.mass!==1/0?n.mass:1));return t.centre=i.div(t.centre,t.mass!==1/0?t.mass:e.parts.length),t}}()},{"../core/Common":14,"../core/Sleeping":22,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29,"../render/Render":31}],2:[function(e,t){s={},t.exports=s;var s,a=e("../core/Events"),o=e("../core/Common"),i=e("./Body");s.create=function(e){return o.extend({id:o.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{}},e)},s.setModified=function(e,t,n,o){if(e.isModified=t,n&&e.parent&&s.setModified(e.parent,t,n,o),o)for(var a,i=0;i<e.composites.length;i++)a=e.composites[i],s.setModified(a,t,n,o)},s.add=function(e,t){var n,i,r=[].concat(t);a.trigger(e,"beforeAdd",{object:t});for(i=0;i<r.length;i++)switch(n=r[i],n.type){case"body":if(n.parent!==n){o.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}s.addBody(e,n);break;case"constraint":s.addConstraint(e,n);break;case"composite":s.addComposite(e,n);break;case"mouseConstraint":s.addConstraint(e,n.constraint)}return a.trigger(e,"afterAdd",{object:t}),e},s.remove=function(e,t,n){var o,i,r=[].concat(t);a.trigger(e,"beforeRemove",{object:t});for(i=0;i<r.length;i++)switch(o=r[i],o.type){case"body":s.removeBody(e,o,n);break;case"constraint":s.removeConstraint(e,o,n);break;case"composite":s.removeComposite(e,o,n);break;case"mouseConstraint":s.removeConstraint(e,o.constraint)}return a.trigger(e,"afterRemove",{object:t}),e},s.addComposite=function(e,t){return e.composites.push(t),t.parent=e,s.setModified(e,!0,!0,!1),e},s.removeComposite=function(e,t,n){var i,a=o.indexOf(e.composites,t);if(-1!==a&&(s.removeCompositeAt(e,a),s.setModified(e,!0,!0,!1)),n)for(i=0;i<e.composites.length;i++)s.removeComposite(e.composites[i],t,!0);return e},s.removeCompositeAt=function(e,t){return e.composites.splice(t,1),s.setModified(e,!0,!0,!1),e},s.addBody=function(e,t){return e.bodies.push(t),s.setModified(e,!0,!0,!1),e},s.removeBody=function(e,t,n){var i,a=o.indexOf(e.bodies,t);if(-1!==a&&(s.removeBodyAt(e,a),s.setModified(e,!0,!0,!1)),n)for(i=0;i<e.composites.length;i++)s.removeBody(e.composites[i],t,!0);return e},s.removeBodyAt=function(e,t){return e.bodies.splice(t,1),s.setModified(e,!0,!0,!1),e},s.addConstraint=function(e,t){return e.constraints.push(t),s.setModified(e,!0,!0,!1),e},s.removeConstraint=function(e,t,n){var i,a=o.indexOf(e.constraints,t);if(-1!==a&&s.removeConstraintAt(e,a),n)for(i=0;i<e.composites.length;i++)s.removeConstraint(e.composites[i],t,!0);return e},s.removeConstraintAt=function(e,t){return e.constraints.splice(t,1),s.setModified(e,!0,!0,!1),e},s.clear=function(e,t,n){if(n)for(var o=0;o<e.composites.length;o++)s.clear(e.composites[o],t,!0);return t?e.bodies=e.bodies.filter(function(e){return e.isStatic}):e.bodies.length=0,e.constraints.length=0,e.composites.length=0,s.setModified(e,!0,!0,!1),e},s.allBodies=function(e){for(var t=[].concat(e.bodies),n=0;n<e.composites.length;n++)t=t.concat(s.allBodies(e.composites[n]));return t},s.allConstraints=function(e){for(var t=[].concat(e.constraints),n=0;n<e.composites.length;n++)t=t.concat(s.allConstraints(e.composites[n]));return t},s.allComposites=function(e){for(var t=[].concat(e.composites),n=0;n<e.composites.length;n++)t=t.concat(s.allComposites(e.composites[n]));return t},s.get=function(e,t,n){var o,i;switch(n){case"body":o=s.allBodies(e);break;case"constraint":o=s.allConstraints(e);break;case"composite":o=s.allComposites(e).concat(e)}return o?0===(i=o.filter(function(e){return e.id.toString()===t.toString()})).length?null:i[0]:null},s.move=function(e,t,n){return s.remove(e,t),s.add(n,t),e},s.rebase=function(e){for(var n=s.allBodies(e).concat(s.allConstraints(e)).concat(s.allComposites(e)),t=0;t<n.length;t++)n[t].id=o.nextId();return s.setModified(e,!0,!0,!1),e},s.translate=function(e,t,n){for(var a=n?s.allBodies(e):e.bodies,o=0;o<a.length;o++)i.translate(a[o],t);return s.setModified(e,!0,!0,!1),e},s.rotate=function(e,t,n,o){for(var c=Math.cos(t),l=Math.sin(t),d=o?s.allBodies(e):e.bodies,r=0;r<d.length;r++){var a=d[r],u=a.position.x-n.x,h=a.position.y-n.y;i.setPosition(a,{x:n.x+(u*c-h*l),y:n.y+(u*l+h*c)}),i.rotate(a,t)}return s.setModified(e,!0,!0,!1),e},s.scale=function(e,t,n,o,a){for(l=a?s.allBodies(e):e.bodies,r=0;r<l.length;r++){var r,l,c=l[r],d=c.position.x-o.x,u=c.position.y-o.y;i.setPosition(c,{x:o.x+d*t,y:o.y+u*n}),i.scale(c,t,n)}return s.setModified(e,!0,!0,!1),e}},{"../core/Common":14,"../core/Events":16,"./Body":1}],3:[function(e,t){s={},t.exports=s;var s,o=e("./Composite"),i=(e("../constraint/Constraint"),e("../core/Common"));s.create=function(e){var t=o.create(),n={label:"World",gravity:{x:0,y:1,scale:.001},bounds:{min:{x:-1/0,y:-1/0},max:{x:1/0,y:1/0}}};return i.extend(t,n,e)}},{"../constraint/Constraint":12,"../core/Common":14,"./Composite":2}],4:[function(e,t){var s={};t.exports=s,s.create=function(e){return{id:s.id(e),vertex:e,normalImpulse:0,tangentImpulse:0}},s.id=function(e){return e.body.id+"_"+e.index}},{}],5:[function(e,t){s={},t.exports=s;var s,i=e("./SAT"),a=e("./Pair"),o=e("../geometry/Bounds");s.collisions=function(e,t){for(var n,r,c,l,u,h,m,f,g,p=[],v=t.pairs.table,d=0;d<e.length;d++)if(n=e[d][0],r=e[d][1],(!n.isStatic&&!n.isSleeping||!r.isStatic&&!r.isSleeping)&&s.canCollide(n.collisionFilter,r.collisionFilter)&&o.overlaps(n.bounds,r.bounds))for(u=n.parts.length>1?1:0;u<n.parts.length;u++)for(c=n.parts[u],h=r.parts.length>1?1:0;h<r.parts.length;h++)l=r.parts[h],(c===n&&l===r||o.overlaps(c.bounds,l.bounds))&&(m=v[a.id(c,l)],g=m&&m.isActive?m.collision:null,f=i.collides(c,l,g),f.collided&&p.push(f));return p},s.canCollide=function(e,t){return e.group===t.group&&0!==e.group?e.group>0:0!=(e.mask&t.category)&&0!=(t.mask&e.category)}},{"../geometry/Bounds":26,"./Pair":7,"./SAT":11}],6:[function(e,t){s={},t.exports=s;var s,i=e("./Pair"),a=e("./Detector"),o=e("../core/Common");!function(){s.create=function(e){var t={controller:s,detector:a.collisions,buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return o.extend(t,e)},s.update=function(e,s,o,i){var a,h,m,f,p,g,b,j,y,O,v=o.world,_=e.buckets,w=!1;for(b=0;b<s.length;b++)if(a=s[b],(!a.isSleeping||i)&&!(a.bounds.max.x<v.bounds.min.x||a.bounds.min.x>v.bounds.max.x||a.bounds.max.y<v.bounds.min.y||a.bounds.min.y>v.bounds.max.y)&&(h=n(e,a),!a.region||h.id!==a.region.id||i)){a.region&&!i||(a.region=h),g=t(h,a.region);for(m=g.startCol;m<=g.endCol;m++)for(f=g.startRow;f<=g.endRow;f++)p=_[O=r(m,f)],y=m>=h.startCol&&m<=h.endCol&&f>=h.startRow&&f<=h.endRow,j=m>=a.region.startCol&&m<=a.region.endCol&&f>=a.region.startRow&&f<=a.region.endRow,!y&&j&&j&&p&&d(e,p,a),(a.region===h||y&&!j||i)&&(p||(p=c(_,O)),l(e,p,a));a.region=h,w=!0}w&&(e.pairsList=u(e))},s.clear=function(e){e.buckets={},e.pairs={},e.pairsList=[]};var t=function(t,n){var s=Math.min(t.startCol,n.startCol),o=Math.max(t.endCol,n.endCol),i=Math.min(t.startRow,n.startRow),a=Math.max(t.endRow,n.endRow);return e(s,o,i,a)},n=function(t,n){var s=n.bounds,o=Math.floor(s.min.x/t.bucketWidth),i=Math.floor(s.max.x/t.bucketWidth),a=Math.floor(s.min.y/t.bucketHeight),r=Math.floor(s.max.y/t.bucketHeight);return e(o,i,a,r)},e=function(e,t,n,s){return{id:e+","+t+","+n+","+s,startCol:e,endCol:t,startRow:n,endRow:s}},r=function(e,t){return"C"+e+"R"+t},c=function(e,t){return e[t]=[]},l=function(e,t,n){for(o=0;o<t.length;o++)if(s=t[o],!(n.id===s.id||n.isStatic&&s.isStatic)){var s,o,a=i.id(n,s),r=e.pairs[a];r?r[2]+=1:e.pairs[a]=[n,s,1]}t.push(n)},d=function(e,t,n){t.splice(o.indexOf(t,n),1);for(s=0;s<t.length;s++){var s,r=t[s],c=i.id(n,r),a=e.pairs[c];a&&(a[2]-=1)}},u=function(e){for(var s,i=[],n=o.keys(e.pairs),t=0;t<n.length;t++)(s=e.pairs[n[t]])[2]>0?i.push(s):delete e.pairs[n[t]];return i}}()},{"../core/Common":14,"./Detector":5,"./Pair":7}],7:[function(e,t){var o,s={};t.exports=s,o=e("./Contact"),s.create=function(e,t){var i=e.bodyA,a=e.bodyB,n=e.parentA,o=e.parentB,r={id:s.id(i,a),bodyA:i,bodyB:a,contacts:{},activeContacts:[],separation:0,isActive:!0,isSensor:i.isSensor||a.isSensor,timeCreated:t,timeUpdated:t,inverseMass:n.inverseMass+o.inverseMass,friction:Math.min(n.friction,o.friction),frictionStatic:Math.max(n.frictionStatic,o.frictionStatic),restitution:Math.max(n.restitution,o.restitution),slop:Math.max(n.slop,o.slop)};return s.update(r,e,t),r},s.update=function(e,t,n){var r,l=e.contacts,d=t.supports,c=e.activeContacts,i=t.parentA,a=t.parentB;if(e.collision=t,e.inverseMass=i.inverseMass+a.inverseMass,e.friction=Math.min(i.friction,a.friction),e.frictionStatic=Math.max(i.frictionStatic,a.frictionStatic),e.restitution=Math.max(i.restitution,a.restitution),e.slop=Math.max(i.slop,a.slop),c.length=0,t.collided){for(r=0;r<d.length;r++){var u=d[r],h=o.id(u),m=l[h];m?c.push(m):c.push(l[h]=o.create(u))}e.separation=t.depth,s.setActive(e,!0,n)}else!0===e.isActive&&s.setActive(e,!1,n)},s.setActive=function(e,t,n){t?(e.isActive=!0,e.timeUpdated=n):(e.isActive=!1,e.activeContacts.length=0)},s.id=function(e,t){return e.id<t.id?"A"+e.id+"B"+t.id:"A"+t.id+"B"+e.id}},{"./Contact":4}],8:[function(e,t){s={},t.exports=s;var s,o=e("./Pair"),i=e("../core/Common");s.create=function(e){return i.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},e)},s.update=function(e,t,n){var s,a,r,c,l=e.list,u=e.table,d=e.collisionStart,h=e.collisionEnd,m=e.collisionActive,f=[];for(d.length=0,h.length=0,m.length=0,a=0;a<t.length;a++)(r=t[a]).collided&&(c=o.id(r.bodyA,r.bodyB),f.push(c),(s=u[c])?(s.isActive?m.push(s):d.push(s),o.update(s,r,n)):(s=o.create(r,n),u[c]=s,d.push(s),l.push(s)));for(a=0;a<l.length;a++)(s=l[a]).isActive&&-1===i.indexOf(f,s.id)&&(o.setActive(s,!1,n),h.push(s))},s.removeOld=function(e,t){var n,s,a,r,o=e.list,c=e.table,i=[];for(n=0;n<o.length;n++)(a=(s=o[n]).collision).bodyA.isSleeping||a.bodyB.isSleeping?s.timeUpdated=t:t-s.timeUpdated>1e3&&i.push(n);for(n=0;n<i.length;n++)delete c[(s=o[r=i[n]-n]).id],o.splice(r,1)},s.clear=function(e){return e.table={},e.list.length=0,e.collisionStart.length=0,e.collisionActive.length=0,e.collisionEnd.length=0,e}},{"../core/Common":14,"./Pair":7}],9:[function(e,t){s={},t.exports=s;var s,i=e("../geometry/Vector"),a=e("./SAT"),o=e("../geometry/Bounds"),r=e("../factory/Bodies"),c=e("../geometry/Vertices");s.ray=function(e,t,n,s){s=s||1e-100;for(var c,l,d,m,p=i.angle(t,n),g=i.magnitude(i.sub(t,n)),v=.5*(n.x+t.x),b=.5*(n.y+t.y),u=r.rectangle(v,b,g,s,{angle:p}),f=[],h=0;h<e.length;h++)if(c=e[h],o.overlaps(c.bounds,u.bounds))for(d=1===c.parts.length?0:1;d<c.parts.length;d++)if(m=c.parts[d],o.overlaps(m.bounds,u.bounds)&&(l=a.collides(m,u),l.collided)){l.body=l.bodyA=l.bodyB=c,f.push(l);break}return f},s.region=function(e,t,n){for(var i,a,r=[],s=0;s<e.length;s++)i=e[s],a=o.overlaps(i.bounds,t),(a&&!n||!a&&n)&&r.push(i);return r},s.point=function(e,t){for(var n,s,a,r=[],i=0;i<e.length;i++)if(n=e[i],o.contains(n.bounds,t))for(s=1===n.parts.length?0:1;s<n.parts.length;s++)if(a=n.parts[s],o.contains(a.bounds,t)&&c.contains(a.vertices,t)){r.push(n);break}return r}},{"../factory/Bodies":23,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29,"./SAT":11}],10:[function(e,t){o={},t.exports=o;var o,a=e("../geometry/Vertices"),s=e("../geometry/Vector"),i=e("../core/Common"),r=e("../geometry/Bounds");o._restingThresh=4,o._restingThreshTangent=6,o._positionDampen=.9,o._positionWarming=.8,o._frictionNormalMultiplier=5,o.preSolvePosition=function(e){var t,n,s;for(t=0;t<e.length;t++)(n=e[t]).isActive&&(s=n.activeContacts.length,n.collision.parentA.totalContacts+=s,n.collision.parentB.totalContacts+=s)},o.solvePosition=function(e,t){var n,i,a,r,c,l,d,u,h,m=s._temp[0],f=s._temp[1],p=s._temp[2],g=s._temp[3];for(r=0;r<e.length;r++)(i=e[r]).isActive&&!i.isSensor&&(a=(c=i.collision).parentA,n=c.parentB,l=c.normal,h=s.sub(s.add(n.positionImpulse,n.position,m),s.add(a.positionImpulse,s.sub(n.position,c.penetration,f),p),g),i.separation=s.dot(l,h));for(r=0;r<e.length;r++)!(i=e[r]).isActive||i.isSensor||i.separation<0||(a=(c=i.collision).parentA,n=c.parentB,l=c.normal,d=(i.separation-i.slop)*t,(a.isStatic||n.isStatic)&&(d*=2),a.isStatic||a.isSleeping||(u=o._positionDampen/a.totalContacts,a.positionImpulse.x+=l.x*d*u,a.positionImpulse.y+=l.y*d*u),n.isStatic||n.isSleeping||(u=o._positionDampen/n.totalContacts,n.positionImpulse.x-=l.x*d*u,n.positionImpulse.y-=l.y*d*u))},o.postSolvePosition=function(e){for(var t,n,i,c=0;c<e.length;c++)if(t=e[c],t.totalContacts=0,0!==t.positionImpulse.x||0!==t.positionImpulse.y){for(i=0;i<t.parts.length;i++)n=t.parts[i],a.translate(n.vertices,t.positionImpulse),r.update(n.bounds,n.vertices,t.velocity),n.position.x+=t.positionImpulse.x,n.position.y+=t.positionImpulse.y;t.positionPrev.x+=t.positionImpulse.x,t.positionPrev.y+=t.positionImpulse.y,s.dot(t.positionImpulse,t.velocity)<0?(t.positionImpulse.x=0,t.positionImpulse.y=0):(t.positionImpulse.x*=o._positionWarming,t.positionImpulse.y*=o._positionWarming)}},o.preSolveVelocity=function(e){var t,n,i,a,r,c,l,d,u,h,m,f,p,g,o=s._temp[0],v=s._temp[1];for(l=0;l<e.length;l++)if((r=e[l]).isActive&&!r.isSensor)for(h=r.activeContacts,t=(a=r.collision).parentA,n=a.parentB,m=a.normal,f=a.tangent,u=0;u<h.length;u++)g=(p=h[u]).vertex,c=p.normalImpulse,i=p.tangentImpulse,0===c&&0===i||(o.x=m.x*c+f.x*i,o.y=m.y*c+f.y*i,t.isStatic||t.isSleeping||(d=s.sub(g,t.position,v),t.positionPrev.x+=o.x*t.inverseMass,t.positionPrev.y+=o.y*t.inverseMass,t.anglePrev+=s.cross(d,o)*t.inverseInertia),n.isStatic||n.isSleeping||(d=s.sub(g,n.position,v),n.positionPrev.x-=o.x*n.inverseMass,n.positionPrev.y-=o.y*n.inverseMass,n.anglePrev-=s.cross(d,o)*n.inverseInertia))},o.solveVelocity=function(e,t){for(var b=t*t,l=s._temp[0],L=s._temp[1],N=s._temp[2],z=s._temp[3],P=s._temp[4],T=s._temp[5],j=0;j<e.length;j++)if(c=e[j],c.isActive&&!c.isSensor){var g=c.collision,a=g.parentA,n=g.parentB,f=g.normal,_=g.tangent,w=c.activeContacts,H=1/w.length;a.velocity.x=a.position.x-a.positionPrev.x,a.velocity.y=a.position.y-a.positionPrev.y,n.velocity.x=n.position.x-n.positionPrev.x,n.velocity.y=n.position.y-n.positionPrev.y,a.angularVelocity=a.angle-a.anglePrev,n.angularVelocity=n.angle-n.anglePrev;for(v=0;v<w.length;v++){var c,v,E,k,r=w[v],x=r.vertex,y=s.sub(x,a.position,L),O=s.sub(x,n.position,N),B=s.add(a.velocity,s.mult(s.perp(y),a.angularVelocity),z),I=s.add(n.velocity,s.mult(s.perp(O),n.angularVelocity),P),A=s.sub(B,I,T),h=s.dot(f,A),m=s.dot(_,A),F=Math.abs(m),R=i.sign(m),u=(1+c.restitution)*h,D=i.clamp(c.separation+h,0,1)*o._frictionNormalMultiplier,d=m,p=1/0;F>c.friction*c.frictionStatic*D*b&&(p=F,d=i.clamp(c.friction*R*b,-p,p));var C=s.cross(y,f),M=s.cross(O,f),S=H/(a.inverseMass+n.inverseMass+a.inverseInertia*C*C+n.inverseInertia*M*M);u*=S,d*=S,h<0&&h*h>o._restingThresh*b?r.normalImpulse=0:(k=r.normalImpulse,r.normalImpulse=Math.min(r.normalImpulse+u,0),u=r.normalImpulse-k),m*m>o._restingThreshTangent*b?r.tangentImpulse=0:(E=r.tangentImpulse,r.tangentImpulse=i.clamp(r.tangentImpulse+d,-p,p),d=r.tangentImpulse-E),l.x=f.x*u+_.x*d,l.y=f.y*u+_.y*d,a.isStatic||a.isSleeping||(a.positionPrev.x+=l.x*a.inverseMass,a.positionPrev.y+=l.y*a.inverseMass,a.anglePrev+=s.cross(y,l)*a.inverseInertia),n.isStatic||n.isSleeping||(n.positionPrev.x-=l.x*n.inverseMass,n.positionPrev.y-=l.y*n.inverseMass,n.anglePrev-=s.cross(O,l)*n.inverseInertia)}}}},{"../core/Common":14,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],11:[function(e,t){i={},t.exports=i;var i,o=e("../geometry/Vertices"),s=e("../geometry/Vector");!function(){i.collides=function(t,i,a){if(g=!1,a){var r,c,l,d,u,f,g,v,m=t.parent,h=i.parent,b=m.speed*m.speed+m.angularSpeed*m.angularSpeed+h.speed*h.speed+h.angularSpeed*h.angularSpeed;g=a&&a.collided&&b<.2,r=a}else r={collided:!1,bodyA:t,bodyB:i};if(a&&g){{var p=r.axisBody,j=p===t?i:t,y=[p.axes[a.axisNumber]];if(c=e(p.vertices,j.vertices,y),r.reused=!0,c.overlap<=0)return r.collided=!1,r}}else{if((f=e(t.vertices,i.vertices,t.axes)).overlap<=0)return r.collided=!1,r;if((v=e(i.vertices,t.vertices,i.axes)).overlap<=0)return r.collided=!1,r;f.overlap<v.overlap?(c=f,r.axisBody=t):(c=v,r.axisBody=i),r.axisNumber=c.axisNumber}return r.bodyA=t.id<i.id?t:i,r.bodyB=t.id<i.id?i:t,r.collided=!0,r.depth=c.overlap,r.parentA=r.bodyA.parent,r.parentB=r.bodyB.parent,t=r.bodyA,i=r.bodyB,s.dot(c.axis,s.sub(i.position,t.position))<0?r.normal={x:c.axis.x,y:c.axis.y}:r.normal={x:-c.axis.x,y:-c.axis.y},r.tangent=s.perp(r.normal),r.penetration=r.penetration||{},r.penetration.x=r.normal.x*r.depth,r.penetration.y=r.normal.y*r.depth,d=n(t,i,r.normal),l=[],(o.contains(t.vertices,d[0])&&l.push(d[0]),o.contains(t.vertices,d[1])&&l.push(d[1]),l.length<2)&&(u=n(i,t,s.neg(r.normal)),o.contains(i.vertices,u[0])&&l.push(u[0]),l.length<2&&o.contains(i.vertices,u[1])&&l.push(u[1])),l.length<1&&(l=[d[0]]),r.supports=l,r};var e=function(e,n,o){for(var a,r,l=s._temp[0],d=s._temp[1],i={overlap:Number.MAX_VALUE},c=0;c<o.length;c++){if(r=o[c],t(l,e,r),t(d,n,r),(a=Math.min(l.max-d.min,d.max-l.min))<=0)return i.overlap=a,i;a<i.overlap&&(i.overlap=a,i.axis=r,i.axisNumber=c)}return i},t=function(e,t,n){for(var o,i=s.dot(t[0],n),a=i,r=1;r<t.length;r+=1)o=s.dot(t[r],n),o>a?a=o:o<i&&(i=o);e.min=i,e.max=a},n=function(e,t,n){for(var o,c,d,u,l=Number.MAX_VALUE,i=s._temp[0],a=t.vertices,r=e.position,h=0;h<a.length;h++)o=a[h],i.x=o.x-r.x,i.y=o.y-r.y,(d=-s.dot(n,i))<l&&(l=d,c=o);return o=a[c.index-1>=0?c.index-1:a.length-1],i.x=o.x-r.x,i.y=o.y-r.y,l=-s.dot(n,i),u=o,o=a[(c.index+1)%a.length],i.x=o.x-r.x,i.y=o.y-r.y,(d=-s.dot(n,i))<l&&(u=o),[c,u]}}()},{"../geometry/Vector":28,"../geometry/Vertices":29}],12:[function(e,t){o={},t.exports=o;var o,a=e("../geometry/Vertices"),s=e("../geometry/Vector"),c=e("../core/Sleeping"),l=e("../geometry/Bounds"),d=e("../geometry/Axes"),r=e("../core/Common"),i=1e-6;o.create=function(e){t=e,t.bodyA&&!t.pointA&&(t.pointA={x:0,y:0}),t.bodyB&&!t.pointB&&(t.pointB={x:0,y:0});var t,n=t.bodyA?s.add(t.bodyA.position,t.pointA):t.pointA,o=t.bodyB?s.add(t.bodyB.position,t.pointB):t.pointB,a=s.magnitude(s.sub(n,o));return t.length=t.length||a||i,t.render=r.extend({visible:!0,lineWidth:2,strokeStyle:"#ffffff"},t.render),t.id=t.id||r.nextId(),t.label=t.label||"Constraint",t.type="constraint",t.stiffness=t.stiffness||1,t.angularStiffness=t.angularStiffness||0,t.angleA=t.bodyA?t.bodyA.angle:t.angleA,t.angleB=t.bodyB?t.bodyB.angle:t.angleB,t.plugin={},t},o.solveAll=function(e,t){for(var n=0;n<e.length;n++)o.solve(e[n],t)},o.solve=function(e,t){var r,c,l,d,h,m,f,p,g,v,b,j,y,_,w,C,n=e.bodyA,o=e.bodyB,O=e.pointA,x=e.pointB;if(n&&!n.isStatic&&(e.pointA=s.rotate(O,n.angle-e.angleA),e.angleA=n.angle),o&&!o.isStatic&&(e.pointB=s.rotate(x,o.angle-e.angleB),e.angleB=o.angle),d=O,c=x,n&&(d=s.add(n.position,O)),o&&(c=s.add(o.position,x)),d&&c){f=s.sub(d,c),r=s.magnitude(f),0===r&&(r=i);var E=(r-e.length)/r,u=s.div(f,r),a=s.mult(f,.5*E*e.stiffness*t*t);Math.abs(1-r/e.length)<.001*t||(n&&!n.isStatic?(m={x:d.x-n.position.x+a.x,y:d.y-n.position.y+a.y},n.velocity.x=n.position.x-n.positionPrev.x,n.velocity.y=n.position.y-n.positionPrev.y,n.angularVelocity=n.angle-n.anglePrev,g=s.add(n.velocity,s.mult(s.perp(m),n.angularVelocity)),j=s.dot(m,u),_=n.inverseMass+n.inverseInertia*j*j):(g={x:0,y:0},_=n?n.inverseMass:0),o&&!o.isStatic?(p={x:c.x-o.position.x-a.x,y:c.y-o.position.y-a.y},o.velocity.x=o.position.x-o.positionPrev.x,o.velocity.y=o.position.y-o.positionPrev.y,o.angularVelocity=o.angle-o.anglePrev,v=s.add(o.velocity,s.mult(s.perp(p),o.angularVelocity)),y=s.dot(p,u),w=o.inverseMass+o.inverseInertia*y*y):(v={x:0,y:0},w=o?o.inverseMass:0),C=s.sub(v,g),h=s.dot(u,C)/(_+w),h>0&&(h=0),b={x:u.x*h,y:u.y*h},n&&!n.isStatic&&(l=s.cross(m,b)*n.inverseInertia*(1-e.angularStiffness),n.constraintImpulse.x-=a.x,n.constraintImpulse.y-=a.y,n.constraintImpulse.angle+=l,n.position.x-=a.x,n.position.y-=a.y,n.angle+=l),o&&!o.isStatic&&(l=s.cross(p,b)*o.inverseInertia*(1-e.angularStiffness),o.constraintImpulse.x+=a.x,o.constraintImpulse.y+=a.y,o.constraintImpulse.angle-=l,o.position.x+=a.x,o.position.y+=a.y,o.angle-=l))}},o.postSolveAll=function(e){for(r=0;r<e.length;r++){var n,i,r,o=e[r],t=o.constraintImpulse;if(0!==t.x||0!==t.y||0!==t.angle){c.set(o,!1);for(i=0;i<o.parts.length;i++)n=o.parts[i],a.translate(n.vertices,t),i>0&&(n.position.x+=t.x,n.position.y+=t.y),0!==t.angle&&(a.rotate(n.vertices,t.angle,o.position),d.rotate(n.axes,t.angle),i>0&&s.rotateAbout(n.position,t.angle,o.position,n.position)),l.update(n.bounds,n.vertices,o.velocity);t.angle=0,t.x=0,t.y=0}}}},{"../core/Common":14,"../core/Sleeping":22,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],13:[function(e,t){o={},t.exports=o;var o,c=e("../geometry/Vertices"),a=e("../core/Sleeping"),i=e("../core/Mouse"),s=e("../core/Events"),l=e("../collision/Detector"),d=e("./Constraint"),u=e("../body/Composite"),r=e("../core/Common"),h=e("../geometry/Bounds");!function(){o.create=function(t,n){a=(t?t.mouse:null)||(n?n.mouse:null),a||(t&&t.render&&t.render.canvas?a=i.create(t.render.canvas):n&&n.element?a=i.create(n.element):(a=i.create(),r.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var a,l={type:"mouseConstraint",mouse:a,element:null,body:null,constraint:d.create({label:"Mouse Constraint",pointA:a.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),collisionFilter:{category:1,mask:4294967295,group:0}},c=r.extend(l,n);return s.on(t,"beforeUpdate",function(){var n=u.allBodies(t.world);o.update(c,n),e(c)}),c},o.update=function(e,t){var r,d,u,o=e.mouse,i=e.constraint,n=e.body;if(0===o.button){if(i.bodyB)a.set(i.bodyB,!1),i.pointA=o.position;else for(r=0;r<t.length;r++)if(n=t[r],h.contains(n.bounds,o.position)&&l.canCollide(n.collisionFilter,e.collisionFilter))for(d=n.parts.length>1?1:0;d<n.parts.length;d++)if(u=n.parts[d],c.contains(u.vertices,o.position)){i.pointA=o.position,i.bodyB=e.body=n,i.pointB={x:o.position.x-n.position.x,y:o.position.y-n.position.y},i.angleB=n.angle,a.set(n,!1),s.trigger(e,"startdrag",{mouse:o,body:n});break}}else i.bodyB=e.body=null,i.pointB=null,n&&s.trigger(e,"enddrag",{mouse:o,body:n})};var e=function(e){var t=e.mouse,n=t.sourceEvents;n.mousemove&&s.trigger(e,"mousemove",{mouse:t}),n.mousedown&&s.trigger(e,"mousedown",{mouse:t}),n.mouseup&&s.trigger(e,"mouseup",{mouse:t}),i.clearSourceEvents(t)}}()},{"../body/Composite":2,"../collision/Detector":5,"../core/Common":14,"../core/Events":16,"../core/Mouse":19,"../core/Sleeping":22,"../geometry/Bounds":26,"../geometry/Vertices":29,"./Constraint":12}],14:[function(e,t){var s={};t.exports=s,function(){s._nextId=0,s._seed=0,s.extend=function(e,t){"boolean"==typeof t?(a=2,i=t):(a=1,i=!0);for(var n,o,i,a,r=a;r<arguments.length;r++)if(o=arguments[r],o)for(n in o)i&&o[n]&&o[n].constructor===Object?e[n]&&e[n].constructor!==Object?e[n]=o[n]:(e[n]=e[n]||{},s.extend(e[n],i,o[n])):e[n]=o[n];return e},s.clone=function(e,t){return s.extend({},t,e)},s.keys=function(e){if(Object.keys)return Object.keys(e);var n,t=[];for(n in e)t.push(n);return t},s.values=function(e){if(t=[],Object.keys){for(var t,o,s=Object.keys(e),n=0;n<s.length;n++)t.push(e[s[n]]);return t}for(o in e)t.push(e[o]);return t},s.get=function(e,t,n,s){t=t.split(".").slice(n,s);for(var o=0;o<t.length;o+=1)e=e[t[o]];return e},s.set=function(e,t,n,o,i){var a=t.split(".").slice(o,i);return s.get(e,t,0,-1)[a[a.length-1]]=n,n},s.shadeColor=function(e,t){var n=parseInt(e.slice(1),16),s=Math.round(2.55*t),o=(n>>16)+s,i=(n>>8&255)+s,a=(255&n)+s;return"#"+(16777216+65536*(o<255?o<1?0:o:255)+256*(i<255?i<1?0:i:255)+(a<255?a<1?0:a:255)).toString(16).slice(1)},s.shuffle=function(e){for(t=e.length-1;t>0;t--){var t,n=Math.floor(s.random()*(t+1)),o=e[t];e[t]=e[n],e[n]=o}return e},s.choose=function(e){return e[Math.floor(s.random()*e.length)]},s.isElement=function(e){try{return e instanceof HTMLElement}catch{return"object"==typeof e&&1===e.nodeType&&"object"==typeof e.style&&"object"==typeof e.ownerDocument}},s.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},s.isFunction=function(e){return"function"==typeof e},s.isPlainObject=function(e){return"object"==typeof e&&e.constructor===Object},s.isString=function(e){return"[object String]"===toString.call(e)},s.clamp=function(e,t,n){return e<t?t:e>n?n:e},s.sign=function(e){return e<0?-1:1},s.now=function(){var e=window.performance||{};return e.now=e.now||e.webkitNow||e.msNow||e.oNow||e.mozNow||function(){return+new Date},e.now()},s.random=function(e,n){return n=void 0!==n?n:1,(e=void 0!==e?e:0)+t()*(n-e)};var e,t=function(){return s._seed=(9301*s._seed+49297)%233280,s._seed/233280};s.colorToNumber=function(e){return 3==(e=e.replace("#","")).length&&(e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)),parseInt(e,16)},s.logLevel=1,s.log=function(){console&&s.logLevel>0&&s.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},s.info=function(){console&&s.logLevel>0&&s.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},s.warn=function(){console&&s.logLevel>0&&s.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},s.nextId=function(){return s._nextId++},s.indexOf=function(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1},s.map=function(e,t){if(e.map)return e.map(t);for(var s=[],n=0;n<e.length;n+=1)s.push(t(e[n]));return s},s.topologicalSort=function(t){var n,s=[],o=[],i=[];for(n in t)o[n]||i[n]||e(n,o,i,t,s);return s},e=function(t,n,s,o,i){var a,r,c=o[t]||[];s[t]=!0;for(a=0;a<c.length;a+=1)r=c[a],s[r]||n[r]||e(r,n,s,o,i);s[t]=!1,n[t]=!0,i.push(t)},s.chain=function(){for(var t,s,e=[],n=0;n<arguments.length;n+=1)t=arguments[n],t._chained?e.push.apply(e,t._chained):e.push(t);return s=function(){for(var n,s,o=new Array(arguments.length),t=0,i=arguments.length;t<i;t++)o[t]=arguments[t];for(t=0;t<e.length;t+=1)s=e[t].apply(n,o),void 0!==s&&(n=s);return n},s._chained=e,s},s.chainPathBefore=function(e,t,n){return s.set(e,t,s.chain(n,s.get(e,t)))},s.chainPathAfter=function(e,t,n){return s.set(e,t,s.chain(s.get(e,t),n))}}()},{}],15:[function(e,t){s={},t.exports=s;var s,u=e("../body/World"),l=e("./Sleeping"),i=e("../collision/Resolver"),h=e("../render/Render"),c=e("../collision/Pairs"),m=(e("./Metrics"),e("../collision/Grid")),a=e("./Events"),r=e("../body/Composite"),d=e("../constraint/Constraint"),o=e("./Common"),f=e("../body/Body");!function(){s.create=function(e,t){t=(t=o.isElement(e)?t:e)||{},((e=o.isElement(e)?e:null)||t.render)&&o.warn("Engine.create: engine.render is deprecated (see docs)");var s,i={positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},timing:{timestamp:0,timeScale:1},broadphase:{controller:m}},n=o.extend(i,t);return(e||n.render)&&(s={element:e,controller:h},n.render=o.extend(s,n.render)),n.render&&n.render.controller&&(n.render=n.render.controller.create(n.render)),n.render&&(n.render.engine=n),n.world=t.world||u.create(n.world),n.pairs=c.create(),n.broadphase=n.broadphase.controller.create(n.broadphase),n.metrics=n.metrics||{extended:!1},n},s.update=function(s,o,u){o=o||1e3/60,u=u||1;var f,p,j,y,g=s.world,m=s.timing,v=s.broadphase,b=[];m.timestamp+=o*m.timeScale,j={timestamp:m.timestamp},a.trigger(s,"beforeUpdate",j),p=r.allBodies(g),y=r.allConstraints(g);for(s.enableSleeping&&l.update(p,m.timeScale),t(p,g.gravity),n(p,o,m.timeScale,u,g.bounds),f=0;f<s.constraintIterations;f++)d.solveAll(y,m.timeScale);d.postSolveAll(p),v.controller?(g.isModified&&v.controller.clear(v),v.controller.update(v,p,s,g.isModified),b=v.pairsList):b=p,g.isModified&&r.setModified(g,!1,!1,!0);var w=v.detector(b,s),h=s.pairs,_=m.timestamp;for(c.update(h,w,_),c.removeOld(h,_),s.enableSleeping&&l.afterCollisions(h.list,m.timeScale),h.collisionStart.length>0&&a.trigger(s,"collisionStart",{pairs:h.collisionStart}),i.preSolvePosition(h.list),f=0;f<s.positionIterations;f++)i.solvePosition(h.list,m.timeScale);for(i.postSolvePosition(p),i.preSolveVelocity(h.list),f=0;f<s.velocityIterations;f++)i.solveVelocity(h.list,m.timeScale);return h.collisionActive.length>0&&a.trigger(s,"collisionActive",{pairs:h.collisionActive}),h.collisionEnd.length>0&&a.trigger(s,"collisionEnd",{pairs:h.collisionEnd}),e(p),a.trigger(s,"afterUpdate",j),s},s.merge=function(e,t){if(o.extend(e,t),t.world){e.world=t.world,s.clear(e);for(var i,a=r.allBodies(e.world),n=0;n<a.length;n++)i=a[n],l.set(i,!1),i.id=o.nextId()}},s.clear=function(e){var t,n,s=e.world;c.clear(e.pairs),t=e.broadphase,t.controller&&(n=r.allBodies(s),t.controller.clear(t),t.controller.update(t,n,e,!0))};var e=function(e){for(var t,n=0;n<e.length;n++)t=e[n],t.force.x=0,t.force.y=0,t.torque=0},t=function(e,t){var n,s,o=void 0!==t.scale?t.scale:.001;if((0!==t.x||0!==t.y)&&0!==o)for(s=0;s<e.length;s++)n=e[s],n.isStatic||n.isSleeping||(n.force.y+=n.mass*t.y*o,n.force.x+=n.mass*t.x*o)},n=function(e,t,n,s){for(var i,a=0;a<e.length;a++)i=e[a],i.isStatic||i.isSleeping||f.update(i,t,n,s)}}()},{"../body/Body":1,"../body/Composite":2,"../body/World":3,"../collision/Grid":6,"../collision/Pairs":8,"../collision/Resolver":10,"../constraint/Constraint":12,"../render/Render":31,"./Common":14,"./Events":16,"./Metrics":18,"./Sleeping":22}],16:[function(e,t){var o,s={};t.exports=s,o=e("./Common"),s.on=function(e,t,n){for(var s,i=t.split(" "),o=0;o<i.length;o++)s=i[o],e.events=e.events||{},e.events[s]=e.events[s]||[],e.events[s].push(n);return n},s.off=function(e,t,n){if(t){"function"==typeof t&&(n=t,t=o.keys(e.events).join(" "));for(var s,i,c,r=t.split(" "),a=0;a<r.length;a++){if(s=e.events[r[a]],c=[],n&&s)for(i=0;i<s.length;i++)s[i]!==n&&c.push(s[i]);e.events[r[a]]=c}}else e.events={}},s.trigger=function(e,t,n){if(e.events){n||(n={}),i=t.split(" ");for(var s,i,a,r,c,l=0;l<i.length;l++)if(a=i[l],r=e.events[a]){(c=o.clone(n,!1)).name=a,c.source=e;for(s=0;s<r.length;s++)r[s].apply(e,[c])}}}},{"./Common":14}],17:[function(e,t){s={},t.exports=s;var s,i=e("./Plugin"),o=e("./Common");s.name="matter-js",s.version="0.12.0",s.uses=[],s.used=[],s.use=function(){i.use(s,Array.prototype.slice.call(arguments))},s.before=function(e,t){return e=e.replace(/^Matter./,""),o.chainPathBefore(s,e,t)},s.after=function(e,t){return e=e.replace(/^Matter./,""),o.chainPathAfter(s,e,t)}},{"./Common":14,"./Plugin":20}],18:[function(){},{"../body/Composite":2,"./Common":14}],19:[function(e,t){var o,s={};t.exports=s,o=e("../core/Common"),!function(){s.create=function(t){var n={};return t||o.log("Mouse.create: element was undefined, defaulting to document.body","warn"),n.element=t||document.body,n.absolute={x:0,y:0},n.position={x:0,y:0},n.mousedownPosition={x:0,y:0},n.mouseupPosition={x:0,y:0},n.offset={x:0,y:0},n.scale={x:1,y:1},n.wheelDelta=0,n.button=-1,n.pixelRatio=n.element.getAttribute("data-pixel-ratio")||1,n.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},n.mousemove=function(t){var s=e(t,n.element,n.pixelRatio);t.changedTouches&&(n.button=0,t.preventDefault()),n.absolute.x=s.x,n.absolute.y=s.y,n.position.x=n.absolute.x*n.scale.x+n.offset.x,n.position.y=n.absolute.y*n.scale.y+n.offset.y,n.sourceEvents.mousemove=t},n.mousedown=function(t){var s=e(t,n.element,n.pixelRatio);t.changedTouches?(n.button=0,t.preventDefault()):n.button=t.button,n.absolute.x=s.x,n.absolute.y=s.y,n.position.x=n.absolute.x*n.scale.x+n.offset.x,n.position.y=n.absolute.y*n.scale.y+n.offset.y,n.mousedownPosition.x=n.position.x,n.mousedownPosition.y=n.position.y,n.sourceEvents.mousedown=t},n.mouseup=function(t){var s=e(t,n.element,n.pixelRatio);t.changedTouches&&t.preventDefault(),n.button=-1,n.absolute.x=s.x,n.absolute.y=s.y,n.position.x=n.absolute.x*n.scale.x+n.offset.x,n.position.y=n.absolute.y*n.scale.y+n.offset.y,n.mouseupPosition.x=n.position.x,n.mouseupPosition.y=n.position.y,n.sourceEvents.mouseup=t},n.mousewheel=function(e){n.wheelDelta=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail)),e.preventDefault()},s.setElement(n,n.element),n},s.setElement=function(e,t){e.element=t,t.addEventListener("mousemove",e.mousemove),t.addEventListener("mousedown",e.mousedown),t.addEventListener("mouseup",e.mouseup),t.addEventListener("mousewheel",e.mousewheel),t.addEventListener("DOMMouseScroll",e.mousewheel),t.addEventListener("touchmove",e.mousemove),t.addEventListener("touchstart",e.mousedown),t.addEventListener("touchend",e.mouseup)},s.clearSourceEvents=function(e){e.sourceEvents.mousemove=null,e.sourceEvents.mousedown=null,e.sourceEvents.mouseup=null,e.sourceEvents.mousewheel=null,e.wheelDelta=0},s.setOffset=function(e,t){e.offset.x=t.x,e.offset.y=t.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y},s.setScale=function(e,t){e.scale.x=t.x,e.scale.y=t.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y};var e=function(e,t,n){var o,i,s=t.getBoundingClientRect(),r=document.documentElement||document.body.parentNode||document.body,c=void 0!==window.pageXOffset?window.pageXOffset:r.scrollLeft,l=void 0!==window.pageYOffset?window.pageYOffset:r.scrollTop,a=e.changedTouches;return a?(o=a[0].pageX-s.left-c,i=a[0].pageY-s.top-l):(o=e.pageX-s.left-c,i=e.pageY-s.top-l),{x:o/(t.clientWidth/(t.width||t.clientWidth)*n),y:i/(t.clientHeight/(t.height||t.clientHeight)*n)}}}()},{"../core/Common":14}],20:[function(e,t){var o,s={};t.exports=s,o=e("./Common"),s._registry={},s.register=function(e){if(s.isPlugin(e)||o.warn("Plugin.register:",s.toString(e),"does not implement all required fields."),e.name in s._registry){var t=s._registry[e.name],n=s.versionParse(e.version).number,i=s.versionParse(t.version).number;n>i?(o.warn("Plugin.register:",s.toString(t),"was upgraded to",s.toString(e)),s._registry[e.name]=e):n<i?o.warn("Plugin.register:",s.toString(t),"can not be downgraded to",s.toString(e)):e!==t&&o.warn("Plugin.register:",s.toString(e),"is already registered to different plugin object")}else s._registry[e.name]=e;return e},s.resolve=function(e){return s._registry[s.dependencyParse(e).name]},s.toString=function(e){return"string"==typeof e?e:(e.name||"anonymous")+"@"+(e.version||e.range||"0.0.0")},s.isPlugin=function(e){return e&&e.name&&e.version&&e.install},s.isUsed=function(e,t){return e.used.indexOf(t)>-1},s.isFor=function(e,t){var n=e.for&&s.dependencyParse(e.for);return!e.for||t.name===n.name&&s.versionSatisfies(t.version,n.range)},s.use=function(e,t){if(e.uses=(e.uses||[]).concat(t||[]),0!==e.uses.length){for(var n,c=s.dependencies(e),r=o.topologicalSort(c),i=[],a=0;a<r.length;a+=1)r[a]!==e.name&&(n=s.resolve(r[a]),n?s.isUsed(e,n.name)||(s.isFor(n,e)||(o.warn("Plugin.use:",s.toString(n),"is for",n.for,"but installed on",s.toString(e)+"."),n._warned=!0),n.install?n.install(e):(o.warn("Plugin.use:",s.toString(n),"does not specify an install function."),n._warned=!0),n._warned?(i.push("ðŸ”¶ "+s.toString(n)),delete n._warned):i.push("âœ… "+s.toString(n)),e.used.push(n.name)):i.push("âŒ "+r[a]));i.length>0&&o.info(i.join("  "))}else o.warn("Plugin.use:",s.toString(e),"does not specify any dependencies to install.")},s.dependencies=function(e,t){var i,a=s.dependencyParse(e),n=a.name;if(!(n in(t=t||{}))){e=s.resolve(e)||e,t[n]=o.map(e.uses||[],function(t){s.isPlugin(t)&&s.register(t);var i=s.dependencyParse(t),n=s.resolve(t);return n&&!s.versionSatisfies(n.version,i.range)?(o.warn("Plugin.dependencies:",s.toString(n),"does not satisfy",s.toString(i),"used by",s.toString(a)+"."),n._warned=!0,e._warned=!0):n||(o.warn("Plugin.dependencies:",s.toString(t),"used by",s.toString(a),"could not be resolved."),e._warned=!0),i.name});for(i=0;i<t[n].length;i+=1)s.dependencies(t[n][i],t);return t}},s.dependencyParse=function(e){return o.isString(e)?(/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?))?$/.test(e)||o.warn("Plugin.dependencyParse:",e,"is not a valid dependency string."),{name:e.split("@")[0],range:e.split("@")[1]||"*"}):{name:e.name,range:e.range||e.version}},s.versionParse=function(e){/^\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?$/.test(e)||o.warn("Plugin.versionParse:",e,"is not a valid version or range."),n=e.split("-"),e=n[0];var n,s=isNaN(Number(e[0])),i=s?e.substr(1):e,t=o.map(i.split("."),function(e){return Number(e)});return{isRange:s,version:i,range:e,operator:s?e[0]:"",parts:t,prerelease:n[1],number:1e8*t[0]+1e4*t[1]+t[2]}},s.versionSatisfies=function(e,t){t=t||"*";var i=s.versionParse(t),n=i.parts,a=s.versionParse(e),o=a.parts;if(i.isRange){if("*"===i.operator||"*"===e)return!0;if("~"===i.operator)return o[0]===n[0]&&o[1]===n[1]&&o[2]>=n[2];if("^"===i.operator)return n[0]>0?o[0]===n[0]&&a.number>=i.number:n[1]>0?o[1]===n[1]&&o[2]>=n[2]:o[2]===n[2]}return e===t||"*"===e}},{"./Common":14}],21:[function(e,t){o={},t.exports=o;var o,s=e("./Events"),a=e("./Engine"),i=e("./Common");!function(){var e,t,n;("undefined"!=typeof window&&(e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),e)||(e=function(e){n=setTimeout(function(){e(i.now())},1e3/60)},t=function(){clearTimeout(n)}),o.create=function(e){var t=i.extend({fps:60,correction:1,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,timeScalePrev:1,frameRequestId:null,isFixed:!1,enabled:!0},e);return t.delta=t.delta||1e3/t.fps,t.deltaMin=t.deltaMin||1e3/t.fps,t.deltaMax=t.deltaMax||1e3/(.5*t.fps),t.fps=1e3/t.delta,t},o.run=function(t,n){return void 0!==t.positionIterations&&(n=t,t=o.create()),function s(i){t.frameRequestId=e(s),i&&t.enabled&&o.tick(t,n,i)}(),t},o.tick=function(e,t,n){var i,c=t.timing,r=1,o={timestamp:c.timestamp};s.trigger(e,"beforeTick",o),s.trigger(t,"beforeTick",o),e.isFixed?i=e.delta:(i=n-e.timePrev||e.delta,e.timePrev=n,e.deltaHistory.push(i),e.deltaHistory=e.deltaHistory.slice(-e.deltaSampleSize),r=(i=(i=(i=Math.min.apply(null,e.deltaHistory))<e.deltaMin?e.deltaMin:i)>e.deltaMax?e.deltaMax:i)/e.delta,e.delta=i),0!==e.timeScalePrev&&(r*=c.timeScale/e.timeScalePrev),0===c.timeScale&&(r=0),e.timeScalePrev=c.timeScale,e.correction=r,e.frameCounter+=1,n-e.counterTimestamp>=1e3&&(e.fps=e.frameCounter*((n-e.counterTimestamp)/1e3),e.counterTimestamp=n,e.frameCounter=0),s.trigger(e,"tick",o),s.trigger(t,"tick",o),t.world.isModified&&t.render&&t.render.controller&&t.render.controller.clear&&t.render.controller.clear(t.render),s.trigger(e,"beforeUpdate",o),a.update(t,i,r),s.trigger(e,"afterUpdate",o),t.render&&t.render.controller&&(s.trigger(e,"beforeRender",o),s.trigger(t,"beforeRender",o),t.render.controller.world(t.render),s.trigger(e,"afterRender",o),s.trigger(t,"afterRender",o)),s.trigger(e,"afterTick",o),s.trigger(t,"afterTick",o)},o.stop=function(e){t(e.frameRequestId)},o.start=function(e,t){o.run(e,t)}}()},{"./Common":14,"./Engine":15,"./Events":16}],22:[function(e,t){var o,s={};t.exports=s,o=e("./Events"),s._motionWakeThreshold=.18,s._motionSleepThreshold=.08,s._minBias=.9,s.update=function(e,t){for(var n,i,a,r,c=t*t*t,o=0;o<e.length;o++)n=e[o],i=n.speed*n.speed+n.angularSpeed*n.angularSpeed,0===n.force.x&&0===n.force.y?(a=Math.min(n.motion,i),r=Math.max(n.motion,i),n.motion=s._minBias*a+(1-s._minBias)*r,n.sleepThreshold>0&&n.motion<s._motionSleepThreshold*c?(n.sleepCounter+=1,n.sleepCounter>=n.sleepThreshold&&s.set(n,!0)):n.sleepCounter>0&&(n.sleepCounter-=1)):s.set(n,!1)},s.afterCollisions=function(e,t){for(c=t*t*t,i=0;i<e.length;i++)if(r=e[i],r.isActive){var i,a,r,c,d,l=r.collision,n=l.bodyA.parent,o=l.bodyB.parent;!(n.isSleeping&&o.isSleeping||n.isStatic||o.isStatic)&&(n.isSleeping||o.isSleeping)&&(a=n.isSleeping&&!n.isStatic?n:o,d=a===n?o:n,!a.isStatic&&d.motion>s._motionWakeThreshold*c&&s.set(a,!1))}},s.set=function(e,t){var n=e.isSleeping;t?(e.isSleeping=!0,e.sleepCounter=e.sleepThreshold,e.positionImpulse.x=0,e.positionImpulse.y=0,e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.anglePrev=e.angle,e.speed=0,e.angularSpeed=0,e.motion=0,n||o.trigger(e,"sleepStart")):(e.isSleeping=!1,e.sleepCounter=0,n&&o.trigger(e,"sleepEnd"))}},{"./Events":16}],23:[function(e,t){(function(n){o={},t.exports=o;var o,s=e("../geometry/Vertices"),i=e("../core/Common"),a=e("../body/Body"),l=e("../geometry/Bounds"),c=e("../geometry/Vector"),r="undefined"!=typeof window?window.decomp:void 0!==n?n.decomp:null;o.rectangle=function(e,t,n,o,r){r=r||{};var c,l={label:"Rectangle Body",position:{x:e,y:t},vertices:s.fromPath("L 0 0 L "+n+" 0 L "+n+" "+o+" L 0 "+o)};return r.chamfer&&(c=r.chamfer,l.vertices=s.chamfer(l.vertices,c.radius,c.quality,c.qualityMin,c.qualityMax),delete r.chamfer),a.create(i.extend({},l,r))},o.trapezoid=function(e,t,n,o,r,c){c=c||{};var l,d=n*(r*=.5),u=d+(1-2*r)*n,m=u+d,f=r<.5?"L 0 0 L "+d+" "+-o+" L "+u+" "+-o+" L "+m+" 0":"L 0 0 L "+u+" "+-o+" L "+m+" 0",h={label:"Trapezoid Body",position:{x:e,y:t},vertices:s.fromPath(f)};return c.chamfer&&(l=c.chamfer,h.vertices=s.chamfer(h.vertices,l.radius,l.quality,l.qualityMin,l.qualityMax),delete c.chamfer),a.create(i.extend({},h,c))},o.circle=function(e,t,n,s,a){s=s||{};var r,c={label:"Circle Body",circleRadius:n};return a=a||25,r=Math.ceil(Math.max(10,Math.min(a,n))),r%2==1&&(r+=1),o.polygon(e,t,r,n,i.extend({},c,s))},o.polygon=function(e,t,n,r,c){if(c=c||{},n<3)return o.circle(e,t,r,c);for(var l,d,h=2*Math.PI/n,m="",p=.5*h,u=0;u<n;u+=1){var f=p+u*h,g=Math.cos(f)*r,v=Math.sin(f)*r;m+="L "+g.toFixed(3)+" "+v.toFixed(3)+" "}return d={label:"Polygon Body",position:{x:e,y:t},vertices:s.fromPath(m)},c.chamfer&&(l=c.chamfer,d.vertices=s.chamfer(d.vertices,l.radius,l.quality,l.qualityMin,l.qualityMax),delete c.chamfer),a.create(i.extend({},d,c))},o.fromVertices=function(e,t,n,o,d,u,h){for(o=o||{},f=[],d=void 0!==d&&d,u=void 0!==u?u:.01,h=void 0!==h?h:10,r||i.warn("Bodies.fromVertices: poly-decomp.js required. Could not decompose vertices. Fallback to convex hull."),i.isArray(n[0])||(n=[n]),y=0;y<n.length;y+=1)if(p=n[y],(A=s.isConvex(p))||!r)p=A?s.clockwiseSort(p):s.hull(p),f.push({position:{x:e,y:t},vertices:p});else{_=p.map(function(e){return[e.x,e.y]}),r.makeCCW(_),!1!==u&&r.removeCollinearPoints(_,u),k=r.quickDecomp(_);for(m=0;m<k.length;m++)w=k[m].map(function(e){return{x:e[0],y:e[1]}}),h>0&&s.area(w)<h||f.push({position:s.centre(w),vertices:w})}for(m=0;m<f.length;m++)f[m]=a.create(i.extend(f[m],o));if(d)for(m=0;m<f.length;m++){O=f[m];for(j=m+1;j<f.length;j++)if(b=f[j],l.overlaps(O.bounds,b.bounds)){var m,f,p,g,v,b,j,y,_,w,O,E,k,A,S,M,x=O.vertices,C=b.vertices;for(v=0;v<O.vertices.length;v++)for(g=0;g<b.vertices.length;g++)S=c.magnitudeSquared(c.sub(x[(v+1)%x.length],C[g])),M=c.magnitudeSquared(c.sub(x[v],C[(g+1)%C.length])),S<5&&M<5&&(x[v].isInternal=!0,C[g].isInternal=!0)}}return f.length>1?(E=a.create(i.extend({parts:f.slice(0)},o)),a.setPosition(E,{x:e,y:t}),E):f[0]}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../body/Body":1,"../core/Common":14,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],24:[function(e,t){o={},t.exports=o;var o,s=e("../body/Composite"),i=e("../constraint/Constraint"),a=e("../core/Common"),c=e("../body/Body"),r=e("./Bodies");o.stack=function(e,t,n,o,i,a,r){for(var l,u,h,m,p,j,g=s.create({label:"Stack"}),d=e,v=t,b=0,f=0;f<o;f++){for(u=0,h=0;h<n;h++)l=r(d,v,h,f,p,b),l?(m=l.bounds.max.y-l.bounds.min.y,j=l.bounds.max.x-l.bounds.min.x,m>u&&(u=m),c.translate(l,{x:.5*j,y:.5*m}),d=l.bounds.max.x+i,s.addBody(g,l),p=l,b+=1):d+=i;v+=u+a,d=e}return g},o.chain=function(e,t,n,o,r,c){for(h=e.bodies,l=1;l<h.length;l++){var l,h,d=h[l-1],u=h[l],m=d.bounds.max.y-d.bounds.min.y,f=d.bounds.max.x-d.bounds.min.x,p=u.bounds.max.y-u.bounds.min.y,g={bodyA:d,pointA:{x:f*t,y:m*n},bodyB:u,pointB:{x:(u.bounds.max.x-u.bounds.min.x)*o,y:p*r}},v=a.extend(g,c);s.addConstraint(e,i.create(v))}return e.label+=" Chain",e},o.mesh=function(e,t,n,o,r){var c,l,d,h,m,u=e.bodies;for(l=0;l<n;l++){for(c=1;c<t;c++)h=u[c-1+l*t],d=u[c+l*t],s.addConstraint(e,i.create(a.extend({bodyA:h,bodyB:d},r)));if(l>0)for(c=0;c<t;c++)h=u[c+(l-1)*t],d=u[c+l*t],s.addConstraint(e,i.create(a.extend({bodyA:h,bodyB:d},r))),o&&c>0&&(m=u[c-1+(l-1)*t],s.addConstraint(e,i.create(a.extend({bodyA:m,bodyB:d},r)))),o&&c<t-1&&(m=u[c+1+(l-1)*t],s.addConstraint(e,i.create(a.extend({bodyA:m,bodyB:d},r))))}return e.label+=" Mesh",e},o.pyramid=function(e,t,n,s,i,a,r){return o.stack(e,t,n,s,i,a,function(t,o,a,l,d,u){var h=Math.min(s,Math.ceil(n/2)),m=d?d.bounds.max.x-d.bounds.min.x:0;if(!(l>h||a<(l=h-l)||a>n-1-l))return 1===u&&c.translate(d,{x:(a+(n%2==1?1:-1))*m,y:0}),r(e+(d?a*m:0)+a*i,o,a,l,d,u)})},o.newtonsCradle=function(e,t,n,o,a){for(var d,u,l=s.create({label:"Newtons Cradle"}),c=0;c<n;c++)d=r.circle(e+c*(1.9*o),t+a,o,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),u=i.create({pointA:{x:e+c*(1.9*o),y:t},bodyB:d}),s.addBody(l,d),s.addConstraint(l,u);return l},o.car=function(e,t,n,o,a){var d=c.nextGroup(!0),h=.5*-n-20,m=.5*n- -20,l=s.create({label:"Car"}),u=r.trapezoid(e,t,n,o,.3,{collisionFilter:{group:d},friction:.01,chamfer:{radius:10}}),f=r.circle(e+h,t+0,a,{collisionFilter:{group:d},friction:.8,density:.01}),p=r.circle(e+m,t+0,a,{collisionFilter:{group:d},friction:.8,density:.01}),g=i.create({bodyA:u,pointA:{x:h,y:0},bodyB:f,stiffness:.2,render:{lineWidth:0}}),v=i.create({bodyA:u,pointA:{x:m,y:0},bodyB:p,stiffness:.2,render:{lineWidth:0}});return s.addBody(l,u),s.addBody(l,f),s.addBody(l,p),s.addConstraint(l,g),s.addConstraint(l,v),l},o.softBody=function(e,t,n,s,i,c,l,d,u,h){u=a.extend({inertia:1/0},u),h=a.extend({stiffness:.4},h);var m=o.stack(e,t,n,s,i,c,function(e,t){return r.circle(e,t,d,u)});return o.mesh(m,n,s,l,h),m.label="Soft Body",m}},{"../body/Body":1,"../body/Composite":2,"../constraint/Constraint":12,"../core/Common":14,"./Bodies":23}],25:[function(e,t){s={},t.exports=s;var s,o=e("../geometry/Vector"),i=e("../core/Common");s.fromVertices=function(e){for(s={},t=0;t<e.length;t++){var t,s,a=(t+1)%e.length,n=o.normalise({x:e[a].y-e[t].y,y:e[t].x-e[a].x}),r=0===n.y?1/0:n.x/n.y;s[r=r.toFixed(3).toString()]=n}return i.values(s)},s.rotate=function(e,t){if(0!==t)for(var n,a,o=Math.cos(t),i=Math.sin(t),s=0;s<e.length;s++)n=e[s],a=n.x*o-n.y*i,n.y=n.x*i+n.y*o,n.x=a}},{"../core/Common":14,"../geometry/Vector":28}],26:[function(e,t){var s={};t.exports=s,s.create=function(e){var t={min:{x:0,y:0},max:{x:0,y:0}};return e&&s.update(t,e),t},s.update=function(e,t,n){e.min.x=1/0,e.max.x=-1/0,e.min.y=1/0,e.max.y=-1/0;for(var s,o=0;o<t.length;o++)s=t[o],s.x>e.max.x&&(e.max.x=s.x),s.x<e.min.x&&(e.min.x=s.x),s.y>e.max.y&&(e.max.y=s.y),s.y<e.min.y&&(e.min.y=s.y);n&&(n.x>0?e.max.x+=n.x:e.min.x+=n.x,n.y>0?e.max.y+=n.y:e.min.y+=n.y)},s.contains=function(e,t){return t.x>=e.min.x&&t.x<=e.max.x&&t.y>=e.min.y&&t.y<=e.max.y},s.overlaps=function(e,t){return e.min.x<=t.max.x&&e.max.x>=t.min.x&&e.max.y>=t.min.y&&e.min.y<=t.max.y},s.translate=function(e,t){e.min.x+=t.x,e.max.x+=t.x,e.min.y+=t.y,e.max.y+=t.y},s.shift=function(e,t){var n=e.max.x-e.min.x,s=e.max.y-e.min.y;e.min.x=t.x,e.max.x=t.x+n,e.min.y=t.y,e.max.y=t.y+s}},{}],27:[function(e,t){var s={};t.exports=s,e("../geometry/Bounds"),!function(){s.pathToVertices=function(t,n){var s,o,i,a,c,u,h,m,f,p,g,b,j,v=[],d=0,r=0,l=0;n=n||15,f=function(e,t,n){var s,i=n%2==1&&n>1;(!o||e!=o.x||t!=o.y)&&(o&&i?(h=o.x,u=o.y):(h=0,u=0),s={x:h+e,y:u+t},!i&&o||(o=s),v.push(s),r=h+e,l=u+t)},p=function(e){var t=e.pathSegTypeAsLetter.toUpperCase();if("Z"!==t){switch(t){case"M":case"L":case"T":case"C":case"S":case"Q":r=e.x,l=e.y;break;case"H":r=e.x;break;case"V":l=e.y}f(r,l,e.pathSegType)}};for(e(t),j=t.getTotalLength(),c=[],s=0;s<t.pathSegList.numberOfItems;s+=1)c.push(t.pathSegList.getItem(s));for(i=c.concat();d<j;){if((a=c[t.getPathSegAtLength(d)])!=b){for(;i.length&&i[0]!=a;)p(i.shift());b=a}switch(a.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":m=t.getPointAtLength(d),f(m.x,m.y,0)}d+=n}for(s=0,g=i.length;s<g;++s)p(i[s]);return v};var e=function(e){for(var t,a,r,c,l,d,u,h,i=e.pathSegList,s=0,n=0,m=i.numberOfItems,o=0;o<m;++o){if(t=i.getItem(o),a=t.pathSegTypeAsLetter,/[MLHVCSQTA]/.test(a))"x"in t&&(s=t.x),"y"in t&&(n=t.y);else switch("x1"in t&&(d=s+t.x1),"x2"in t&&(l=s+t.x2),"y1"in t&&(r=n+t.y1),"y2"in t&&(c=n+t.y2),"x"in t&&(s+=t.x),"y"in t&&(n+=t.y),a){case"m":i.replaceItem(e.createSVGPathSegMovetoAbs(s,n),o);break;case"l":i.replaceItem(e.createSVGPathSegLinetoAbs(s,n),o);break;case"h":i.replaceItem(e.createSVGPathSegLinetoHorizontalAbs(s),o);break;case"v":i.replaceItem(e.createSVGPathSegLinetoVerticalAbs(n),o);break;case"c":i.replaceItem(e.createSVGPathSegCurvetoCubicAbs(s,n,d,r,l,c),o);break;case"s":i.replaceItem(e.createSVGPathSegCurvetoCubicSmoothAbs(s,n,l,c),o);break;case"q":i.replaceItem(e.createSVGPathSegCurvetoQuadraticAbs(s,n,d,r),o);break;case"t":i.replaceItem(e.createSVGPathSegCurvetoQuadraticSmoothAbs(s,n),o);break;case"a":i.replaceItem(e.createSVGPathSegArcAbs(s,n,t.r1,t.r2,t.angle,t.largeArcFlag,t.sweepFlag),o);break;case"z":case"Z":s=u,n=h}"M"!=a&&"m"!=a||(u=s,h=n)}}}()},{"../geometry/Bounds":26}],28:[function(e,t){var s={};t.exports=s,s.create=function(e,t){return{x:e||0,y:t||0}},s.clone=function(e){return{x:e.x,y:e.y}},s.magnitude=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},s.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y},s.rotate=function(e,t){var n=Math.cos(t),s=Math.sin(t);return{x:e.x*n-e.y*s,y:e.x*s+e.y*n}},s.rotateAbout=function(e,t,n,s){var a,o=Math.cos(t),i=Math.sin(t);return s||(s={}),a=n.x+((e.x-n.x)*o-(e.y-n.y)*i),s.y=n.y+((e.x-n.x)*i+(e.y-n.y)*o),s.x=a,s},s.normalise=function(e){var t=s.magnitude(e);return 0===t?{x:0,y:0}:{x:e.x/t,y:e.y/t}},s.dot=function(e,t){return e.x*t.x+e.y*t.y},s.cross=function(e,t){return e.x*t.y-e.y*t.x},s.cross3=function(e,t,n){return(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x)},s.add=function(e,t,n){return n||(n={}),n.x=e.x+t.x,n.y=e.y+t.y,n},s.sub=function(e,t,n){return n||(n={}),n.x=e.x-t.x,n.y=e.y-t.y,n},s.mult=function(e,t){return{x:e.x*t,y:e.y*t}},s.div=function(e,t){return{x:e.x/t,y:e.y/t}},s.perp=function(e,t){return{x:(t=!0===t?-1:1)*-e.y,y:t*e.x}},s.neg=function(e){return{x:-e.x,y:-e.y}},s.angle=function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)},s._temp=[s.create(),s.create(),s.create(),s.create(),s.create(),s.create()]},{}],29:[function(e,t){o={},t.exports=o;var o,s=e("../geometry/Vector"),i=e("../core/Common");o.create=function(e,t){for(var s,i,o=[],n=0;n<e.length;n++)s=e[n],i={x:s.x,y:s.y,index:n,body:t,isInternal:!1},o.push(i);return o},o.fromPath=function(e,t){var n=[];return e.replace(/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/gi,function(e,t,s){n.push({x:parseFloat(t),y:parseFloat(s)})}),o.create(n,t)},o.centre=function(e){for(var n,a,r,c=o.area(e,!0),i={x:0,y:0},t=0;t<e.length;t++)n=(t+1)%e.length,a=s.cross(e[t],e[n]),r=s.mult(s.add(e[t],e[n]),a),i=s.add(i,r);return s.div(i,6*c)},o.mean=function(e){for(var n={x:0,y:0},t=0;t<e.length;t++)n.x+=e[t].x,n.y+=e[t].y;return s.div(n,e.length)},o.area=function(e,t){for(var s=0,o=e.length-1,n=0;n<e.length;n++)s+=(e[o].x-e[n].x)*(e[o].y+e[n].y),o=n;return t?s/2:Math.abs(s)/2},o.inertia=function(e,t){for(var i,a,r=0,c=0,n=e,o=0;o<n.length;o++)i=(o+1)%n.length,r+=(a=Math.abs(s.cross(n[i],n[o])))*(s.dot(n[i],n[i])+s.dot(n[i],n[o])+s.dot(n[o],n[o])),c+=a;return t/6*(r/c)},o.translate=function(e,t,n){var s;if(n)for(s=0;s<e.length;s++)e[s].x+=t.x*n,e[s].y+=t.y*n;else for(s=0;s<e.length;s++)e[s].x+=t.x,e[s].y+=t.y;return e},o.rotate=function(e,t,n){if(0!==t){for(var i=Math.cos(t),a=Math.sin(t),o=0;o<e.length;o++){var s=e[o],r=s.x-n.x,c=s.y-n.y;s.x=n.x+(r*i-c*a),s.y=n.y+(r*a+c*i)}return e}},o.contains=function(e,t){for(n=0;n<e.length;n++){var n,s=e[n],o=e[(n+1)%e.length];if((t.x-s.x)*(o.y-s.y)+(t.y-s.y)*(s.x-o.x)>0)return!1}return!0},o.scale=function(e,t,n,i){if(1===t&&1===n)return e;i=i||o.centre(e);for(var r,c,a=0;a<e.length;a++)c=e[a],r=s.sub(c,i),e[a].x=i.x+r.x*t,e[a].y=i.y+r.y*n;return e},o.chamfer=function(e,t,n,o,a){(t=t||[8]).length||(t=[t]),n=void 0!==n?n:-1,o=o||2,a=a||14;for(d=[],r=0;r<e.length;r++){var v=e[r-1>=0?r-1:e.length-1],c=e[r],p=e[(r+1)%e.length],h=t[r<t.length?r:t.length-1];if(0!==h){var r,d,u,g,m=s.normalise({x:c.y-v.y,y:v.x-c.x}),f=s.normalise({x:p.y-c.y,y:c.x-p.x}),b=Math.sqrt(2*Math.pow(h,2)),j=s.mult(i.clone(m),h),y=s.normalise(s.mult(s.add(m,f),.5)),_=s.sub(c,s.mult(y,b)),l=n;-1===n&&(l=1.75*Math.pow(h,.32)),(l=i.clamp(l,o,a))%2==1&&(l+=1);for(g=Math.acos(s.dot(m,f))/l,u=0;u<l;u++)d.push(s.add(s.rotate(j,g*u),_))}else d.push(c)}return d},o.clockwiseSort=function(e){var t=o.mean(e);return e.sort(function(e,n){return s.angle(t,e)-s.angle(t,n)}),e},o.isConvex=function(e){var t,n,i,a,s=0,o=e.length;if(o<3)return null;for(t=0;t<o;t++)if(i=(t+2)%o,a=(e[n=(t+1)%o].x-e[t].x)*(e[i].y-e[n].y),(a-=(e[n].y-e[t].y)*(e[i].x-e[n].x))<0?s|=1:a>0&&(s|=2),3===s)return!1;return 0!==s||null},o.hull=function(e){var o,i,t=[],n=[];for((e=e.slice(0)).sort(function(e,t){var n=e.x-t.x;return 0!==n?n:e.y-t.y}),o=0;o<e.length;o++){for(i=e[o];n.length>=2&&s.cross3(n[n.length-2],n[n.length-1],i)<=0;)n.pop();n.push(i)}for(o=e.length-1;o>=0;o--){for(i=e[o];t.length>=2&&s.cross3(t[t.length-2],t[t.length-1],i)<=0;)t.pop();t.push(i)}return t.pop(),n.pop(),t.concat(n)}},{"../core/Common":14,"../geometry/Vector":28}],30:[function(e,t){var s=t.exports=e("../core/Matter");s.Body=e("../body/Body"),s.Composite=e("../body/Composite"),s.World=e("../body/World"),s.Contact=e("../collision/Contact"),s.Detector=e("../collision/Detector"),s.Grid=e("../collision/Grid"),s.Pairs=e("../collision/Pairs"),s.Pair=e("../collision/Pair"),s.Query=e("../collision/Query"),s.Resolver=e("../collision/Resolver"),s.SAT=e("../collision/SAT"),s.Constraint=e("../constraint/Constraint"),s.MouseConstraint=e("../constraint/MouseConstraint"),s.Common=e("../core/Common"),s.Engine=e("../core/Engine"),s.Events=e("../core/Events"),s.Mouse=e("../core/Mouse"),s.Runner=e("../core/Runner"),s.Sleeping=e("../core/Sleeping"),s.Plugin=e("../core/Plugin"),s.Bodies=e("../factory/Bodies"),s.Composites=e("../factory/Composites"),s.Axes=e("../geometry/Axes"),s.Bounds=e("../geometry/Bounds"),s.Svg=e("../geometry/Svg"),s.Vector=e("../geometry/Vector"),s.Vertices=e("../geometry/Vertices"),s.Render=e("../render/Render"),s.RenderPixi=e("../render/RenderPixi"),s.World.add=s.Composite.add,s.World.remove=s.Composite.remove,s.World.addComposite=s.Composite.addComposite,s.World.addBody=s.Composite.addBody,s.World.addConstraint=s.Composite.addConstraint,s.World.clear=s.Composite.clear,s.Engine.run=s.Runner.run},{"../body/Body":1,"../body/Composite":2,"../body/World":3,"../collision/Contact":4,"../collision/Detector":5,"../collision/Grid":6,"../collision/Pair":7,"../collision/Pairs":8,"../collision/Query":9,"../collision/Resolver":10,"../collision/SAT":11,"../constraint/Constraint":12,"../constraint/MouseConstraint":13,"../core/Common":14,"../core/Engine":15,"../core/Events":16,"../core/Matter":17,"../core/Metrics":18,"../core/Mouse":19,"../core/Plugin":20,"../core/Runner":21,"../core/Sleeping":22,"../factory/Bodies":23,"../factory/Composites":24,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Svg":27,"../geometry/Vector":28,"../geometry/Vertices":29,"../render/Render":31,"../render/RenderPixi":32}],31:[function(e,t){s={},t.exports=s;var s,o=e("../core/Common"),a=e("../body/Composite"),r=e("../geometry/Bounds"),c=e("../core/Events"),d=e("../collision/Grid"),l=e("../geometry/Vector"),i=e("../core/Mouse");!function(){"undefined"!=typeof window&&(e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(function(){e(o.now())},1e3/60)},t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),s.create=function(e){var i={controller:s,engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,options:{width:800,height:600,pixelRatio:1,background:"#18181d",wireframeBackground:"#0f0f13",hasBounds:!!e.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},t=o.extend(i,e);return t.canvas&&(t.canvas.width=t.options.width||t.canvas.width,t.canvas.height=t.options.height||t.canvas.height),t.mouse=e.mouse,t.engine=e.engine,t.canvas=t.canvas||n(t.options.width,t.options.height),t.context=t.canvas.getContext("2d"),t.textures={},t.bounds=t.bounds||{min:{x:0,y:0},max:{x:t.canvas.width,y:t.canvas.height}},1!==t.options.pixelRatio&&s.setPixelRatio(t,t.options.pixelRatio),o.isElement(t.element)?t.element.appendChild(t.canvas):o.log("Render.create: options.element was undefined, render.canvas was created but not appended","warn"),t},s.run=function(t){!function n(){t.frameRequestId=e(n),s.world(t)}()},s.stop=function(e){t(e.frameRequestId)},s.setPixelRatio=function(e,t){var s=e.options,n=e.canvas;"auto"===t&&(t=u(n)),s.pixelRatio=t,n.setAttribute("data-pixel-ratio",t),n.width=s.width*t,n.height=s.height*t,n.style.width=s.width+"px",n.style.height=s.height+"px",e.context.scale(t,t)},s.lookAt=function(e,t,n,s){s=void 0===s||s,t=o.isArray(t)?t:[t],n=n||{x:0,y:0};for(a={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},h=0;h<t.length;h+=1){var r=t[h],d=r.bounds?r.bounds.min:r.min||r.position||r,u=r.bounds?r.bounds.max:r.max||r.position||r;d&&u&&(d.x<a.min.x&&(a.min.x=d.x),u.x>a.max.x&&(a.max.x=u.x),d.y<a.min.y&&(a.min.y=d.y),u.y>a.max.y&&(a.max.y=u.y))}var a,h,c=a.max.x-a.min.x+2*n.x,l=a.max.y-a.min.y+2*n.y,v=e.canvas.height,p=e.canvas.width/v,g=c/l,m=1,f=1;g>p?f=g/p:m=p/g,e.options.hasBounds=!0,e.bounds.min.x=a.min.x,e.bounds.max.x=a.min.x+c*m,e.bounds.min.y=a.min.y,e.bounds.max.y=a.min.y+l*f,s&&(e.bounds.min.x+=.5*c-c*m*.5,e.bounds.max.x+=.5*c-c*m*.5,e.bounds.min.y+=.5*l-l*f*.5,e.bounds.max.y+=.5*l-l*f*.5),e.bounds.min.x-=n.x,e.bounds.max.x-=n.x,e.bounds.min.y-=n.y,e.bounds.max.y-=n.y,e.mouse&&(i.setScale(e.mouse,{x:(e.bounds.max.x-e.bounds.min.x)/e.canvas.width,y:(e.bounds.max.y-e.bounds.min.y)/e.canvas.height}),i.setOffset(e.mouse,e.bounds.min))},s.startViewTransform=function(e){var t=e.bounds.max.x-e.bounds.min.x,n=e.bounds.max.y-e.bounds.min.y,s=t/e.options.width,o=n/e.options.height;e.context.scale(1/s,1/o),e.context.translate(-e.bounds.min.x,-e.bounds.min.y)},s.endViewTransform=function(e){e.context.setTransform(e.options.pixelRatio,0,0,e.options.pixelRatio,0,0)},s.world=function(e){var u,p,h=e.engine,x=h.world,O=e.canvas,n=e.context,t=e.options,v=a.allBodies(x),g=a.allConstraints(x),_=t.wireframes?t.wireframeBackground:t.background,o=[],b=[],w={timestamp:h.timing.timestamp};if(c.trigger(e,"beforeRender",w),e.currentBackground!==_&&m(e,_),n.globalCompositeOperation="source-in",n.fillStyle="transparent",n.fillRect(0,0,O.width,O.height),n.globalCompositeOperation="source-over",t.hasBounds){for(u=0;u<v.length;u++)p=v[u],r.overlaps(p.bounds,e.bounds)&&o.push(p);for(u=0;u<g.length;u++){var f=g[u],C=f.bodyA,E=f.bodyB,j=f.pointA,y=f.pointB;C&&(j=l.add(C.position,f.pointA)),E&&(y=l.add(E.position,f.pointB)),j&&y&&(r.contains(e.bounds,j)||r.contains(e.bounds,y))&&b.push(f)}s.startViewTransform(e),e.mouse&&(i.setScale(e.mouse,{x:(e.bounds.max.x-e.bounds.min.x)/e.canvas.width,y:(e.bounds.max.y-e.bounds.min.y)/e.canvas.height}),i.setOffset(e.mouse,e.bounds.min))}else b=g,o=v;!t.wireframes||h.enableSleeping&&t.showSleeping?s.bodies(e,o,n):(t.showConvexHulls&&s.bodyConvexHulls(e,o,n),s.bodyWireframes(e,o,n)),t.showBounds&&s.bodyBounds(e,o,n),(t.showAxes||t.showAngleIndicator)&&s.bodyAxes(e,o,n),t.showPositions&&s.bodyPositions(e,o,n),t.showVelocity&&s.bodyVelocity(e,o,n),t.showIds&&s.bodyIds(e,o,n),t.showSeparations&&s.separations(e,h.pairs.list,n),t.showCollisions&&s.collisions(e,h.pairs.list,n),t.showVertexNumbers&&s.vertexNumbers(e,o,n),t.showMousePosition&&s.mousePosition(e,e.mouse,n),s.constraints(b,n),t.showBroadphase&&h.broadphase.controller===d&&s.grid(e,h.broadphase,n),t.showDebug&&s.debug(e,n),t.hasBounds&&s.endViewTransform(e),c.trigger(e,"afterRender",w)},s.debug=function(e,t){var n,i,r,s=t,o=e.engine,l=o.world,c=o.metrics,d=e.options;if(a.allBodies(l),o.timing.timestamp-(e.debugTimestamp||0)>=500&&(i="",c.timing&&(i+="fps: "+Math.round(c.timing.fps)+"    "),e.debugString=i,e.debugTimestamp=o.timing.timestamp),e.debugString){s.font="12px Arial",d.wireframes?s.fillStyle="rgba(255,255,255,0.5)":s.fillStyle="rgba(0,0,0,0.5)";for(r=e.debugString.split(`
`),n=0;n<r.length;n++)s.fillText(r[n],50,50+18*n)}},s.constraints=function(e,t){for(var n,o,i,s=t,a=0;a<e.length;a++)n=e[a],n.render.visible&&n.pointA&&n.pointB&&(o=n.bodyA,i=n.bodyB,o?(s.beginPath(),s.moveTo(o.position.x+n.pointA.x,o.position.y+n.pointA.y)):(s.beginPath(),s.moveTo(n.pointA.x,n.pointA.y)),i?s.lineTo(i.position.x+n.pointB.x,i.position.y+n.pointB.y):s.lineTo(n.pointB.x,n.pointB.y),n.render.lineWidth&&(s.lineWidth=n.render.lineWidth,s.strokeStyle=n.render.strokeStyle,s.stroke()))},s.bodyShadows=function(e,t,n){for(s=n,a=(e.engine,0);a<t.length;a++)if(o=t[a],o.render.visible){if(o.circleRadius)s.beginPath(),s.arc(o.position.x,o.position.y,o.circleRadius,0,2*Math.PI),s.closePath();else{s.beginPath(),s.moveTo(o.vertices[0].x,o.vertices[0].y);for(i=1;i<o.vertices.length;i++)s.lineTo(o.vertices[i].x,o.vertices[i].y);s.closePath()}var s,o,i,a,r=o.position.x-.5*e.options.width,c=o.position.y-.2*e.options.height,l=Math.abs(r)+Math.abs(c);s.shadowColor="rgba(0,0,0,0.15)",s.shadowOffsetX=.05*r,s.shadowOffsetY=.05*c,s.shadowBlur=1+12*Math.min(1,l/1e3),s.fill(),s.shadowColor=null,s.shadowOffsetX=null,s.shadowOffsetY=null,s.shadowBlur=null}},s.bodies=function(e,t,n){var s,i,a,r,c,d,u,o=n,l=(e.engine,e.options),m=l.showInternalEdges||!l.wireframes;for(d=0;d<t.length;d++)if((c=t[d]).render.visible)for(u=c.parts.length>1?1:0;u<c.parts.length;u++)if((s=c.parts[u]).render.visible){if(l.showSleeping&&c.isSleeping?o.globalAlpha=.5*s.render.opacity:1!==s.render.opacity&&(o.globalAlpha=s.render.opacity),s.render.sprite&&s.render.sprite.texture&&!l.wireframes)a=s.render.sprite,r=h(e,a.texture),o.translate(s.position.x,s.position.y),o.rotate(s.angle),o.drawImage(r,r.width*-a.xOffset*a.xScale,r.height*-a.yOffset*a.yScale,r.width*a.xScale,r.height*a.yScale),o.rotate(-s.angle),o.translate(-s.position.x,-s.position.y);else{if(s.circleRadius)o.beginPath(),o.arc(s.position.x,s.position.y,s.circleRadius,0,2*Math.PI);else{o.beginPath(),o.moveTo(s.vertices[0].x,s.vertices[0].y);for(i=1;i<s.vertices.length;i++)!s.vertices[i-1].isInternal||m?o.lineTo(s.vertices[i].x,s.vertices[i].y):o.moveTo(s.vertices[i].x,s.vertices[i].y),s.vertices[i].isInternal&&!m&&o.moveTo(s.vertices[(i+1)%s.vertices.length].x,s.vertices[(i+1)%s.vertices.length].y);o.lineTo(s.vertices[0].x,s.vertices[0].y),o.closePath()}l.wireframes?(o.lineWidth=1,o.strokeStyle="#bbb",o.stroke()):(o.fillStyle=s.render.fillStyle,s.render.lineWidth&&(o.lineWidth=s.render.lineWidth,o.strokeStyle=s.render.strokeStyle,o.stroke()),o.fill())}o.globalAlpha=1}},s.bodyWireframes=function(e,t,n){var s,o,a,r,c,i=n,l=e.options.showInternalEdges;for(i.beginPath(),r=0;r<t.length;r++)if((a=t[r]).render.visible)for(c=a.parts.length>1?1:0;c<a.parts.length;c++){for(s=a.parts[c],i.moveTo(s.vertices[0].x,s.vertices[0].y),o=1;o<s.vertices.length;o++)!s.vertices[o-1].isInternal||l?i.lineTo(s.vertices[o].x,s.vertices[o].y):i.moveTo(s.vertices[o].x,s.vertices[o].y),s.vertices[o].isInternal&&!l&&i.moveTo(s.vertices[(o+1)%s.vertices.length].x,s.vertices[(o+1)%s.vertices.length].y);i.lineTo(s.vertices[0].x,s.vertices[0].y)}i.lineWidth=1,i.strokeStyle="#bbb",i.stroke()},s.bodyConvexHulls=function(e,t,n){var s,i,a,o=n;for(o.beginPath(),a=0;a<t.length;a++)if((s=t[a]).render.visible&&1!==s.parts.length){for(o.moveTo(s.vertices[0].x,s.vertices[0].y),i=1;i<s.vertices.length;i++)o.lineTo(s.vertices[i].x,s.vertices[i].y);o.lineTo(s.vertices[0].x,s.vertices[0].y)}o.lineWidth=1,o.strokeStyle="rgba(255,255,255,0.2)",o.stroke()},s.vertexNumbers=function(e,t,n){var s,o,i,a,r,c=n;for(i=0;i<t.length;i++){r=t[i].parts;for(a=r.length>1?1:0;a<r.length;a++){s=r[a];for(o=0;o<s.vertices.length;o++)c.fillStyle="rgba(255,255,255,0.2)",c.fillText(i+"_"+o,s.position.x+.8*(s.vertices[o].x-s.position.x),s.position.y+.8*(s.vertices[o].y-s.position.y))}}},s.mousePosition=function(e,t,n){var s=n;s.fillStyle="rgba(255,255,255,0.8)",s.fillText(t.position.x+"  "+t.position.y,t.position.x+5,t.position.y-5)},s.bodyBounds=function(e,t,n){var s,i,a,r,o=n,c=(e.engine,e.options);o.beginPath();for(i=0;i<t.length;i++)if(t[i].render.visible)for(a=t[i].parts,r=a.length>1?1:0;r<a.length;r++)s=a[r],o.rect(s.bounds.min.x,s.bounds.min.y,s.bounds.max.x-s.bounds.min.x,s.bounds.max.y-s.bounds.min.y);c.wireframes?o.strokeStyle="rgba(255,255,255,0.08)":o.strokeStyle="rgba(0,0,0,0.1)",o.lineWidth=1,o.stroke()},s.bodyAxes=function(e,t,n){var s,i,a,r,c,l,d,o=n,u=(e.engine,e.options);for(o.beginPath(),c=0;c<t.length;c++)if(l=t[c],r=l.parts,l.render.visible)if(u.showAxes)for(i=r.length>1?1:0;i<r.length;i++)for(s=r[i],a=0;a<s.axes.length;a++)d=s.axes[a],o.moveTo(s.position.x,s.position.y),o.lineTo(s.position.x+20*d.x,s.position.y+20*d.y);else for(i=r.length>1?1:0;i<r.length;i++)for(s=r[i],a=0;a<s.axes.length;a++)o.moveTo(s.position.x,s.position.y),o.lineTo((s.vertices[0].x+s.vertices[s.vertices.length-1].x)/2,(s.vertices[0].y+s.vertices[s.vertices.length-1].y)/2);u.wireframes?(o.strokeStyle="indianred",o.lineWidth=1):(o.strokeStyle="rgba(255, 255, 255, 0.4)",o.globalCompositeOperation="overlay",o.lineWidth=2),o.stroke(),o.globalCompositeOperation="source-over"},s.bodyPositions=function(e,t,n){var o,i,a,r,s=n,c=(e.engine,e.options);for(s.beginPath(),o=0;o<t.length;o++)if((i=t[o]).render.visible)for(a=0;a<i.parts.length;a++)r=i.parts[a],s.arc(r.position.x,r.position.y,3,0,2*Math.PI,!1),s.closePath();for(c.wireframes?s.fillStyle="indianred":s.fillStyle="rgba(0,0,0,0.5)",s.fill(),s.beginPath(),o=0;o<t.length;o++)(i=t[o]).render.visible&&(s.arc(i.positionPrev.x,i.positionPrev.y,2,0,2*Math.PI,!1),s.closePath());s.fillStyle="rgba(255,165,0,0.8)",s.fill()},s.bodyVelocity=function(e,t,n){var s,i,o=n;o.beginPath();for(i=0;i<t.length;i++)s=t[i],s.render.visible&&(o.moveTo(s.position.x,s.position.y),o.lineTo(s.position.x+2*(s.position.x-s.positionPrev.x),s.position.y+2*(s.position.y-s.positionPrev.y)));o.lineWidth=3,o.strokeStyle="cornflowerblue",o.stroke()},s.bodyIds=function(e,t,n){var s,o,i,a,r=n;for(s=0;s<t.length;s++)if(t[s].render.visible){i=t[s].parts;for(o=i.length>1?1:0;o<i.length;o++)a=i[o],r.font="12px Arial",r.fillStyle="rgba(255,255,255,0.5)",r.fillText(a.id,a.position.x+10,a.position.y-10)}},s.collisions=function(e,t,n){var s,i,a,r,c,l,d,o=n,u=e.options;for(o.beginPath(),a=0;a<t.length;a++)if((s=t[a]).isActive)for(i=s.collision,l=0;l<s.activeContacts.length;l++)d=s.activeContacts[l].vertex,o.rect(d.x-1.5,d.y-1.5,3.5,3.5);for(u.wireframes?o.fillStyle="rgba(255,255,255,0.7)":o.fillStyle="orange",o.fill(),o.beginPath(),a=0;a<t.length;a++)(s=t[a]).isActive&&(i=s.collision,s.activeContacts.length>0)&&(r=s.activeContacts[0].vertex.x,c=s.activeContacts[0].vertex.y,2===s.activeContacts.length&&(r=(s.activeContacts[0].vertex.x+s.activeContacts[1].vertex.x)/2,c=(s.activeContacts[0].vertex.y+s.activeContacts[1].vertex.y)/2),i.bodyB===i.supports[0].body||!0===i.bodyA.isStatic?o.moveTo(r-8*i.normal.x,c-8*i.normal.y):o.moveTo(r+8*i.normal.x,c+8*i.normal.y),o.lineTo(r,c));u.wireframes?o.strokeStyle="rgba(255,165,0,0.7)":o.strokeStyle="orange",o.lineWidth=1,o.stroke()},s.separations=function(e,t,n){var s,o,a,r,c,l,i=n,d=e.options;for(i.beginPath(),c=0;c<t.length;c++)(l=t[c]).isActive&&(o=(r=l.collision).bodyA,s=1,(a=r.bodyB).isStatic||o.isStatic||(s=.5),a.isStatic&&(s=0),i.moveTo(a.position.x,a.position.y),i.lineTo(a.position.x-r.penetration.x*s,a.position.y-r.penetration.y*s),s=1,a.isStatic||o.isStatic||(s=.5),o.isStatic&&(s=0),i.moveTo(o.position.x,o.position.y),i.lineTo(o.position.x+r.penetration.x*s,o.position.y+r.penetration.y*s));d.wireframes?i.strokeStyle="rgba(255,165,0,0.5)":i.strokeStyle="orange",i.stroke()},s.grid=function(e,t,n){s=n,e.options.wireframes?s.strokeStyle="rgba(255,180,0,0.1)":s.strokeStyle="rgba(255,180,0,0.5)",s.beginPath();for(var s,a,r,c=o.keys(t.buckets),i=0;i<c.length;i++)a=c[i],t.buckets[a].length<2||(r=a.split(/C|R/),s.rect(.5+parseInt(r[1],10)*t.bucketWidth,.5+parseInt(r[2],10)*t.bucketHeight,t.bucketWidth,t.bucketHeight));s.lineWidth=1,s.stroke()},s.inspector=function(e,t){e.engine;var n,r=e.selected,s=e.render,c=s.options;if(c.hasBounds){var o,i,a,l=s.bounds.max.x-s.bounds.min.x,d=s.bounds.max.y-s.bounds.min.y,u=l/s.options.width,h=d/s.options.height;t.scale(1/u,1/h),t.translate(-s.bounds.min.x,-s.bounds.min.y)}for(i=0;i<r.length;i++){switch(o=r[i].data,t.translate(.5,.5),t.lineWidth=1,t.strokeStyle="rgba(255,165,0,0.9)",t.setLineDash([1,2]),o.type){case"body":n=o.bounds,t.beginPath(),t.rect(Math.floor(n.min.x-3),Math.floor(n.min.y-3),Math.floor(n.max.x-n.min.x+6),Math.floor(n.max.y-n.min.y+6)),t.closePath(),t.stroke();break;case"constraint":a=o.pointA,o.bodyA&&(a=o.pointB),t.beginPath(),t.arc(a.x,a.y,10,0,2*Math.PI),t.closePath(),t.stroke()}t.setLineDash([]),t.translate(-.5,-.5)}null!==e.selectStart&&(t.translate(.5,.5),t.lineWidth=1,t.strokeStyle="rgba(255,165,0,0.6)",t.fillStyle="rgba(255,165,0,0.1)",n=e.selectBounds,t.beginPath(),t.rect(Math.floor(n.min.x),Math.floor(n.min.y),Math.floor(n.max.x-n.min.x),Math.floor(n.max.y-n.min.y)),t.closePath(),t.stroke(),t.fill(),t.translate(-.5,-.5)),c.hasBounds&&t.setTransform(1,0,0,1,0,0)};var e,t,n=function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n.oncontextmenu=function(){return!1},n.onselectstart=function(){return!1},n},u=function(e){var t=e.getContext("2d");return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)},h=function(e,t){var n=e.textures[t];return n||((n=e.textures[t]=new Image).src=t,n)},m=function(e,t){var n=t;/(jpg|gif|png)$/.test(t)&&(n="url("+t+")"),e.canvas.style.background=n,e.canvas.style.backgroundSize="contain",e.currentBackground=t}}()},{"../body/Composite":2,"../collision/Grid":6,"../core/Common":14,"../core/Events":16,"../core/Mouse":19,"../geometry/Bounds":26,"../geometry/Vector":28}],32:[function(e,t){s={},t.exports=s;var s,i=e("../geometry/Bounds"),a=e("../body/Composite"),o=e("../core/Common"),c=e("../core/Events"),r=e("../geometry/Vector");!function(){"undefined"!=typeof window&&(e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(function(){e(o.now())},1e3/60)},t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),s.create=function(e){o.warn("RenderPixi.create: Matter.RenderPixi is deprecated (see docs)");var n={controller:s,engine:null,element:null,frameRequestId:null,canvas:null,renderer:null,container:null,spriteContainer:null,pixiOptions:null,options:{width:800,height:600,background:"#fafafa",wireframeBackground:"#222",hasBounds:!1,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1}},t=o.extend(n,e),i=!t.options.wireframes&&"transparent"===t.options.background;return t.pixiOptions=t.pixiOptions||{view:t.canvas,transparent:i,antialias:!0,backgroundColor:e.background},t.mouse=e.mouse,t.engine=e.engine,t.renderer=t.renderer||new PIXI.WebGLRenderer(t.options.width,t.options.height,t.pixiOptions),t.container=t.container||new PIXI.Container,t.spriteContainer=t.spriteContainer||new PIXI.Container,t.canvas=t.canvas||t.renderer.view,t.bounds=t.bounds||{min:{x:0,y:0},max:{x:t.options.width,y:t.options.height}},c.on(t.engine,"beforeUpdate",function(){s.clear(t)}),t.textures={},t.sprites={},t.primitives={},t.container.addChild(t.spriteContainer),o.isElement(t.element)?t.element.appendChild(t.canvas):o.warn('No "render.element" passed, "render.canvas" was not inserted into document.'),t.canvas.oncontextmenu=function(){return!1},t.canvas.onselectstart=function(){return!1},t},s.run=function(t){!function n(){t.frameRequestId=e(n),s.world(t)}()},s.stop=function(e){t(e.frameRequestId)},s.clear=function(e){for(var n,t=e.container,s=e.spriteContainer;t.children[0];)t.removeChild(t.children[0]);for(;s.children[0];)s.removeChild(s.children[0]);n=e.sprites["bg-0"],e.textures={},e.sprites={},e.primitives={},e.sprites["bg-0"]=n,n&&t.addChildAt(n,0),e.container.addChild(e.spriteContainer),e.currentBackground=null,t.scale.set(1,1),t.position.set(0,0)},s.setBackground=function(e,t){if(e.currentBackground!==t){var i,a,r=t.indexOf&&-1!==t.indexOf("#"),s=e.sprites["bg-0"];r?(i=o.colorToNumber(t),e.renderer.backgroundColor=i,s&&e.container.removeChild(s)):s||(a=n(e,t),(s=e.sprites["bg-0"]=new PIXI.Sprite(a)).position.x=0,s.position.y=0,e.container.addChildAt(s,0)),e.currentBackground=t}},s.world=function(e){var t,d,v=e.engine.world,w=e.renderer,h=e.container,l=e.options,o=a.allBodies(v),u=a.allConstraints(v),c=[];l.wireframes?s.setBackground(e,l.wireframeBackground):s.setBackground(e,l.background);var y=e.bounds.max.x-e.bounds.min.x,_=e.bounds.max.y-e.bounds.min.y,p=y/e.options.width,g=_/e.options.height;if(l.hasBounds){for(t=0;t<o.length;t++)d=o[t],d.render.sprite.visible=i.overlaps(d.bounds,e.bounds);for(t=0;t<u.length;t++){var n=u[t],b=n.bodyA,j=n.bodyB,m=n.pointA,f=n.pointB;b&&(m=r.add(b.position,n.pointA)),j&&(f=r.add(j.position,n.pointB)),m&&f&&(i.contains(e.bounds,m)||i.contains(e.bounds,f))&&c.push(n)}h.scale.set(1/p,1/g),h.position.set(-e.bounds.min.x*(1/p),-e.bounds.min.y*(1/g))}else c=u;for(t=0;t<o.length;t++)s.body(e,o[t]);for(t=0;t<c.length;t++)s.constraint(e,c[t]);w.render(h)},s.constraint=function(e,t){e.engine;var a=t.bodyA,r=t.bodyB,s=t.pointA,i=t.pointB,l=e.container,c=t.render,d="c-"+t.id,n=e.primitives[d];n||(n=e.primitives[d]=new PIXI.Graphics),c.visible&&t.pointA&&t.pointB?(-1===o.indexOf(l.children,n)&&l.addChild(n),n.clear(),n.beginFill(0,0),n.lineStyle(c.lineWidth,o.colorToNumber(c.strokeStyle),1),a?n.moveTo(a.position.x+s.x,a.position.y+s.y):n.moveTo(s.x,s.y),r?n.lineTo(r.position.x+i.x,r.position.y+i.y):n.lineTo(i.x,i.y),n.endFill()):n.clear()},s.body=function(e,t){if(e.engine,i=t.render,i.visible)if(i.sprite&&i.sprite.texture){var i,a="b-"+t.id,n=e.sprites[a],r=e.spriteContainer;n||(n=e.sprites[a]=l(e,t)),-1===o.indexOf(r.children,n)&&r.addChild(n),n.position.x=t.position.x,n.position.y=t.position.y,n.rotation=t.angle,n.scale.x=i.sprite.xScale||1,n.scale.y=i.sprite.yScale||1}else{var c="b-"+t.id,s=e.primitives[c],u=e.container;s||((s=e.primitives[c]=d(e,t)).initialAngle=t.angle),-1===o.indexOf(u.children,s)&&u.addChild(s),s.position.x=t.position.x,s.position.y=t.position.y,s.rotation=t.angle-s.initialAngle}};var e,t,l=function(e,t){var o=t.render.sprite.texture,i=n(e,o),s=new PIXI.Sprite(i);return s.anchor.x=t.render.sprite.xOffset,s.anchor.y=t.render.sprite.yOffset,s},d=function(e,t){var n,i,c,a=t.render,r=e.options,s=new PIXI.Graphics,l=o.colorToNumber(a.fillStyle),d=o.colorToNumber(a.strokeStyle),u=o.colorToNumber(a.strokeStyle),h=o.colorToNumber("#bbb"),m=o.colorToNumber("#CD5C5C");s.clear();for(c=t.parts.length>1?1:0;c<t.parts.length;c++){n=t.parts[c],r.wireframes?(s.beginFill(0,0),s.lineStyle(1,h,1)):(s.beginFill(l,1),s.lineStyle(a.lineWidth,d,1)),s.moveTo(n.vertices[0].x-t.position.x,n.vertices[0].y-t.position.y);for(i=1;i<n.vertices.length;i++)s.lineTo(n.vertices[i].x-t.position.x,n.vertices[i].y-t.position.y);s.lineTo(n.vertices[0].x-t.position.x,n.vertices[0].y-t.position.y),s.endFill(),(r.showAngleIndicator||r.showAxes)&&(s.beginFill(0,0),r.wireframes?s.lineStyle(1,m,1):s.lineStyle(1,u),s.moveTo(n.position.x-t.position.x,n.position.y-t.position.y),s.lineTo((n.vertices[0].x+n.vertices[n.vertices.length-1].x)/2-t.position.x,(n.vertices[0].y+n.vertices[n.vertices.length-1].y)/2-t.position.y),s.endFill())}return s},n=function(e,t){var n=e.textures[t];return n||(n=e.textures[t]=PIXI.Texture.fromImage(t)),n}}()},{"../body/Composite":2,"../core/Common":14,"../core/Events":16,"../geometry/Bounds":26,"../geometry/Vector":28}]},{},[30])(30)}),jQuery(document).ready(function(e){let s=Matter.Engine,r=Matter.Render,o=Matter.World,n=(Matter.Mouse,Matter.Bodies),h=(Matter.Common,Matter.Vertices,Matter.Svg,Matter.Constraint,Matter.Composites,Matter.MouseConstraint),t=s.create(),c=null;function l(){Math.random(),e("canvas").remove(),cancelAnimationFrame(c);let i=e(window).width(),a=e(window).height();t.events={},o.clear(t.world),s.clear(t),t=s.create(),t.world.gravity.x=0,t.world.gravity.y=0;let d=h.create(t);o.add(t.world,d);let u=r.create({element:document.getElementById("balls"),engine:t,options:{wireframes:!1,background:!1,width:i,height:a,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}});o.add(t.world,[n.rectangle(i/2,a/2,500,46,{isStatic:!0,render:{fillStyle:"transparent"}}),n.rectangle(i/2,a/2-40,180,20,{isStatic:!0,render:{fillStyle:"transparent"}}),n.rectangle(i/2,a/2+40,180,20,{isStatic:!0,render:{fillStyle:"transparent"}}),n.rectangle(i/2,a- -1,i,1,{isStatic:!0,render:{fillStyle:"#FFFFFF"}}),n.rectangle(i/2,-1,i,1,{isStatic:!0,render:{fillStyle:"#FFFFFF"}}),n.rectangle(-1,a/2,1,a,{isStatic:!0,render:{fillStyle:"#FFFFFF"}}),n.rectangle(i- -1,a/2,1,a,{isStatic:!0,render:{fillStyle:"#FFFFFF"}})]);for(let e=0;e<230;e++){let s=2+20*Math.random();o.add(t.world,n.circle(40+Math.random()*i-80,40+100*Math.random(),s,{render:{fillStyle:[color_balls,color_balls_2,color_balls_3,color_balls_4][Math.round(3*Math.random())]}}))}s.run(t),r.run(u);let l=0;t.world.gravity.y=4,function e(){l>8&&(t.world.gravity.x=Math.cos(l/55),t.world.gravity.y=Math.sin(l/55)),l++,c=requestAnimationFrame(e.bind(this))}()}var i,a,d,u;l(),e(window).on("resize",(a=function(){l()}.bind(this),d=200,function(){var e=this,t=arguments,n=function(){i=null,u||a.apply(e,t)},s=u&&!i;clearTimeout(i),i=setTimeout(n,d),s&&a.apply(e,t)}))})