var options={startingHue:120,clickLimiter:5,timerInterval:20,showTargets:!1,rocketSpeed:speed,rocketAcceleration:1.03,particleFriction:.95,particleGravity:1,particleMinCount:minimum,particleMaxCount:maximum,particleMinRadius:3,particleMaxRadius:5},fireworks=[],particles=[],mouse={down:!1,x:0,y:0},currentHue=options.startingHue,clickLimiterTick=0,timerTick=0,cntRocketsLaunched=0;function random(e,t){return Math.random()*(t-e)+e}function calculateDistance(e,t,n,s){var o=e-n,i=t-s;return Math.sqrt(Math.pow(o,2)+Math.pow(i,2))}window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(){window.setTimeout(callback,1e3/60)};var canvas=document.getElementById("fireworks"),canvasCtx=canvas.getContext("2d"),canvasWidth=window.innerWidth,canvasHeight=window.innerHeight;function Firework(e,t,n,s){for(this.x=this.sx=e,this.y=this.sy=t,this.tx=n,this.ty=s,this.distanceToTarget=calculateDistance(e,t,n,s),this.distanceTraveled=0,this.coordinates=[],this.coordinateCount=3;this.coordinateCount--;)this.coordinates.push([this.x,this.y]);this.angle=Math.atan2(s-t,n-e),this.speed=options.rocketSpeed,this.acceleration=options.rocketAcceleration,this.brightness=random(50,80),this.hue=currentHue,this.targetRadius=1,this.targetDirection=!1,cntRocketsLaunched++}function Particle(e,t){for(this.x=e,this.y=t,this.coordinates=[],this.coordinateCount=5;this.coordinateCount--;)this.coordinates.push([this.x,this.y]);this.angle=random(0,2*Math.PI),this.speed=random(1,10),this.friction=options.particleFriction,this.gravity=options.particleGravity,this.hue=random(currentHue-20,currentHue+20),this.brightness=random(50,80),this.alpha=1,this.decay=random(.01,.03)}function createParticles(e,t){for(var n=Math.round(random(options.particleMinCount,options.particleMaxCount));n--;)particles.push(new Particle(e,t))}function gameLoop(){requestAnimFrame(gameLoop),currentHue+=.5,canvasCtx.globalCompositeOperation="destination-out",canvasCtx.fillStyle="rgba(0, 0, 0, 0.5)",canvasCtx.fillRect(0,0,canvasWidth,canvasHeight),canvasCtx.globalCompositeOperation="lighter";for(var e=fireworks.length;e--;)fireworks[e].draw(),fireworks[e].update(e);for(e=particles.length;e--;)particles[e].draw(),particles[e].update(e);timerTick>=options.timerInterval?mouse.down||(fireworks.push(new Firework(canvasWidth/2,canvasHeight,random(0,canvasWidth),random(0,canvasHeight/2))),timerTick=0):timerTick++,clickLimiterTick>=options.clickLimiter?mouse.down&&(fireworks.push(new Firework(canvasWidth/2,canvasHeight,mouse.x,mouse.y)),clickLimiterTick=0):clickLimiterTick++}canvas.width=canvasWidth,canvas.height=canvasHeight,Firework.prototype.update=function(e){this.coordinates.pop(),this.coordinates.unshift([this.x,this.y]),this.targetDirection?this.targetRadius>1?this.targetRadius-=.15:this.targetDirection=!1:this.targetRadius<8?this.targetRadius+=.15:this.targetDirection=!0,this.speed*=this.acceleration;var t=Math.cos(this.angle)*this.speed,n=Math.sin(this.angle)*this.speed;this.distanceTraveled=calculateDistance(this.sx,this.sy,this.x+t,this.y+n),this.distanceTraveled>=this.distanceToTarget?(createParticles(this.tx,this.ty),fireworks.splice(e,1)):(this.x+=t,this.y+=n)},Firework.prototype.draw=function(){var e=this.coordinates[this.coordinates.length-1];canvasCtx.beginPath(),canvasCtx.moveTo(e[0],e[1]),canvasCtx.lineTo(this.x,this.y),canvasCtx.strokeStyle="hsl("+this.hue+",100%,"+this.brightness+"%)",canvasCtx.stroke(),options.showTargets&&(canvasCtx.beginPath(),canvasCtx.arc(this.tx,this.ty,this.targetRadius,0,2*Math.PI),canvasCtx.stroke())},Particle.prototype.update=function(e){this.coordinates.pop(),this.coordinates.unshift([this.x,this.y]),this.speed*=this.friction,this.x+=Math.cos(this.angle)*this.speed,this.y+=Math.sin(this.angle)*this.speed+this.gravity,this.alpha-=this.decay,this.alpha<=this.decay&&particles.splice(e,1)},Particle.prototype.draw=function(){this.coordinates[this.coordinates.length-1];var t=Math.round(random(options.particleMinRadius,options.particleMaxRadius)),e=canvasCtx.createRadialGradient(this.x,this.y,0,this.x,this.y,t);e.addColorStop(0,"white"),e.addColorStop(0,"white"),e.addColorStop(.1,"hsla("+this.hue+",100%,"+this.brightness+"%,"+this.alpha+")"),e.addColorStop(0,"black"),canvasCtx.beginPath(),canvasCtx.fillStyle=e,canvasCtx.arc(this.x,this.y,t,2*Math.PI,!1),canvasCtx.fill()},window.addEventListener("resize",function(){canvas.width=canvasWidth=window.innerWidth,canvas.height=canvasHeight=window.innerHeight}),canvas.addEventListener("mousemove",function(e){e.preventDefault(),mouse.x=e.pageX-canvas.offsetLeft,mouse.y=e.pageY-canvas.offsetTop}),canvas.addEventListener("mousedown",function(e){e.preventDefault(),mouse.down=!0}),canvas.addEventListener("mouseup",function(e){e.preventDefault(),mouse.down=!1}),window.onload=gameLoop()