"use strict";function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}CustomPQ=function e(){_classCallCheck(this,e),this.arr=[],this.N=0},CustomPQ.prototype=function(){var e=function(e,t){return e.time>t.time>0},t=function(e,t){var n=this.arr[e];this.arr[e]=this.arr[t],this.arr[t]=n},n=function(n){for(;n>1&&e(this.arr[Math.floor(n/2)],this.arr[n]);)t.call(this,n,Math.floor(n/2)),n=Math.floor(n/2)},s=function(n){for(;2*n<=this.N;){var s=2*n;if(s<this.N&&e(this.arr[s],this.arr[s+1])&&++s,!e(this.arr[n],this.arr[s]))break;t.call(this,n,s),n=s}};return{insert:function(e){this.arr[++this.N]=e,n.call(this,this.N)},getMin:function(){t.call(this,1,this.N);var e=this.arr[this.N--];return s.call(this,1),this.arr[this.N+1]=null,e},isEmpty:function(){return 0===this.N}}}();var CustomPQ,Ball=function(){function e(){var t=arguments.length<=4||void 0===arguments[4]?8:arguments[4];_classCallCheck(this,e),this.x=Math.random()*window.innerWidth,this.y=Math.random()*window.innerHeight,this.velocityX=5*Math.random(),this.velocityY=5*Math.random(),this.radius=t,this.mass=.5,this.count=0}return e.prototype.getCount=function(){return this.count},e.prototype.draw=function(e){e.beginPath(),e.arc(this.x,this.y,this.radius,0,360),e.fill()},e.prototype.move=function(e){this.x+=this.velocityX*e,this.y+=this.velocityY*e,Math.floor(this.x),Math.floor(this.y)},e.prototype.timeToHit=function(e){if(this===e)return 1/0;var n=e.x-this.x,s=e.y-this.y,o=e.velocityX-this.velocityX,i=e.velocityY-this.velocityY,t=n*o+s*i;if(t>0)return 1/0;var a=o*o+i*i,l=n*n+s*s,r=this.radius+e.radius,c=t*t-a*(l-r*r);return c<0?1/0:-(t+Math.sqrt(c))/a},e.prototype.timeToHitVerticallWall=function(){return this.velocityX>0?(window.innerWidth-this.x-this.radius)/this.velocityX:this.velocityX<0?(this.radius-this.x)/this.velocityX:1/0},e.prototype.timeToHitHorizontalWall=function(){return this.velocityY>0?(window.innerHeight-this.y-this.radius)/this.velocityY:this.velocityY<0?(this.radius-this.y)/this.velocityY:1/0},e.prototype.bounceOff=function(e){var n=e.x-this.x,s=e.y-this.y,r=n*(e.velocityX-this.velocityX)+s*(e.velocityY-this.velocityY),t=this.radius+e.radius,o=2*this.mass*e.mass*r/((this.mass+e.mass)*t),i=o*n/t,a=o*s/t;this.velocityX+=i/this.mass,this.velocityY+=a/this.mass,e.velocityX-=i/e.mass,e.velocityY-=a/e.mass,++this.count,++e.count},e.prototype.bounceOffVerticalWall=function(){this.velocityX=-this.velocityX,++this.count},e.prototype.bounceOffHorizontalWall=function(){this.velocityY=-this.velocityY,++this.count},e}(),BigBall=function(e){function t(){_classCallCheck(this,t),e.call(this),this.radius=24,this.mass=3}return _inherits(t,e),t}(Ball),Event=function(){function e(t,n,s){_classCallCheck(this,e),this.time=t,this.a=n,this.b=s,this.countA=n!=null?n.getCount():-1,this.countB=s!=null?s.getCount():-1}return e.prototype.isValid=function(){return(null==this.a||this.a.getCount()==this.countA)&&(null==this.b||this.b.getCount()==this.countB)},e.prototype.getA=function(){return this.a},e.prototype.getB=function(){return this.b},e.prototype.getTime=function(){return this.time},e}(),CollisionSystem=function(){function e(){_classCallCheck(this,e),this.c=document.getElementById("bubble"),this.ctx=this.c.getContext("2d"),this.balls=[],this.t=0,this.hz=1,this.pq=new CustomPQ,this.numBalls=quantity,window.addEventListener("resize",this.windowResizeHandler.bind(this),!1),this.windowResizeHandler()}return e.prototype.windowResizeHandler=function(){this.SCREEN_WIDTH=window.innerWidth,this.SCREEN_HEIGHT=window.innerHeight,this.c.width=this.SCREEN_WIDTH,this.c.height=this.SCREEN_HEIGHT;var e=this.ctx.createRadialGradient(0,0,1.3*this.SCREEN_WIDTH,0,0,0);e.addColorStop(0,color1),e.addColorStop(.3,color2),e.addColorStop(.6,color3),e.addColorStop(.8,color4),e.addColorStop(1,color5),this.ctx.fillStyle=e},e.prototype.redraw=function(){var e=this;this.ctx.clearRect(0,0,this.SCREEN_WIDTH,this.SCREEN_HEIGHT),this.balls.forEach(function(t){t.draw(e.ctx)}),this.pq.insert(new Event(this.t+1/this.hz,null,null))},e.prototype.predict=function(e){if(t=this,e!=null){this.balls.forEach(function(n){var s=e.timeToHit(n);s!==1/0&&t.pq.insert(new Event(t.t+s,e,n))});var t,n=e.timeToHitVerticallWall(),s=e.timeToHitHorizontalWall();n!==1/0&&this.pq.insert(new Event(this.t+n,e,null)),s!==1/0&&this.pq.insert(new Event(this.t+s,null,e))}},e.prototype.simulate=function(){for(var e=this,t=0;t<this.balls.length;++t)this.predict(this.balls[t]);this.pq.insert(new Event(0,null,null)),window.requestAnimationFrame(function t(){if(o=e.pq.getMin(),o.isValid()){var o,n=o.getA(),s=o.getB();e.balls.forEach(function(t){t.move(o.getTime()-e.t)}),e.t=o.getTime(),n!=null&&s!=null?n.bounceOff(s):n!=null&&s==null?n.bounceOffVerticalWall():n==null&&s!=null?s.bounceOffHorizontalWall():n==null&&s==null&&e.redraw(),e.predict(n),e.predict(s)}window.requestAnimationFrame(t)})},e.prototype.go=function(){for(var e=0;e<this.numBalls;++e)this.balls[e]=new Ball;this.balls[this.balls.length]=new BigBall,this.simulate()},e}(),cs=new CollisionSystem;cs.go()